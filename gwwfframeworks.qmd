# Waveform Generation

::: {.content-visible unless-format="pdf"}

{{< include _latexmacros.qmd >}}

:::




The matched filtering approach introduced in the previous section motivates tools for generating waveforms. Specifically the matched filtering technique is especially sensitive to the phase of the \acr{gw}, necessitating very precise waveforms in the phase. These can be varied in physical content, but also in practicality. In all cases they need to be able to cover the set of parameters (the parameter space) that one is interested in exploring. Clearly if the waveform has been generated purely heuristically, then the physical content of the detection is close to zero. One can only say one has detected a phenomenon that produces this waveform, but not much more. However, if the input parameters are physically meaningful, like the mass ratio of a binary compact inspiraling system, then the waveform constructed purely from this input, if matched to the signal, tells us that a compact binary inspiraling system with this mass ratio has been detected. This is called parameter estimation, and is key to maximsing the physics output of a detection. 

Crucially the waveform generation must be able to cover the whole parameter space (for example all feasible mass ratios) to be useful, as one does *not* know the parameters of the object one is looking for.  Ideally this waveform generation can be done in a way that is computationally efficient, as the number of parameters to explore can be large. In the end, currently, waveform generation is done in a hybrid way, where some waveforms at some parameter space points are generated from first principles, and the rest of the parameter space waveforms are interpolated. 

In this chapter we will look at the physically motivated waveform generation tools currently being developed in research. More specifically we are going to explore techniques for compact binary waveforms. Of these, there are two types, the inspiralling binaries, and the  scattering ones. Currently only the inspiralling binaries have been detected, as these are the systems for which \acr{ligo} and others are most sensitive to (see @sec-ligo) and they are by far the most common emitters of high intensity \acr{gw}s. As discussed in @sec-compactbinaries, orbiting and \acr{gw} emitting compact objects will necessarily inspiral and merge at somepoint. 

For such inspiraling binaries, the waveform has three distinct parts, corresponding to distinct phases of a binary merger: a first inspiral phase, a merger phase where a remnant compact body is produced as a result of the coalescence of the two objects, and a postmerger, or ringdown phase where the remnant still emits gravitational radiation while settling to its new stable configuration. Each phase has specific characteristics in the dynamics of the objects and thus correspondingly different frameworks are aimed at specific portions of the waveforms. Even within one phase, different regimes and thus frameworks exist, additionally dependent to the type/initial state of the two orbiting bodies.

For scattering binaries there is hope of detecting them @Mukherjee:2020hnm, but they are mainly used as a testbed for new theories making use of particle physics knowledge. Additionally one might be able to extend their validity to inspiraling binaries [see @Kalin:2019rwq]. 

Most of these techniques have two important parts. The first consists in the precise modelling of the evolution of the emitting system. In most cases, this boils down to obtaining the \acr{eom}s for the interacting bodies, however for scattering this can just be the amplitude of the event. The second part is extracting the variation of the metric due to the source movement at the measurement point, far away from the source, i.e., the waveform. Of course the metric at the source is tightly coupled to the dynamics of the system, and thus the approximations conducted at the source also effects the way one extracts the waveform. 

The only full, physically motivated waveform techniques are \acr{nr} and \acr{eob}^[There are a whole family of phenomenological frameworks that we will not discuss]. \acr{nr} is quite unique when compared to other methods. Let us look at it now before proceeding to \acr{eob} and all the partial waveform techniques. 

## \acr{nr}

The most precise physically motivated waveform-generation technique to date is numerical relativity (\acr{nr}). It was first developed as early as the 1960s [@hahn:1964]. Initially and until relatively recently, these numerical methods were unusable because of numerical instabilities. The idea, however, is simple: the \acr{efe} are a system of coupled partial differential equations (PDEs) (albeit quite nonlinear) that can be solved numerically by discretizing the fields involved, i.e. the metric in this case. The cause of instability, and the difficult nature of the problem is three-fold. First, the aforementioned non-linearities make the discretization particularly sensitive, and means that one needs a fine mesh to control error buildup. Second, the gauge freedom that simplified the derivation in the last chapter, puts limits on the type of discretization procedure, so that spurious modes are not introduced. Third, for \acr{bh}s one needs to consider what to do about the physical metric singularity, as infinity is not a number one can plug into a computer! On top of stability problems, when compact binary objects are considered, the scales involved further complicate things, as one needs enough resolution to resolve the objects, and the deformations on the metric, as well as a large enough volume to have reasonable orbits. This leads to a huge amount of points in the model, meaning such simulations (even if stable) are extremely computationally expensive.

In 2005 @Pretorius:2005gq and a little later @Campanelli:2005dd made a breakthrough advance and were able to fully compute an inspiral-merger-ringdown sequence for a \acr{bbh}. Pretorius made use of two techniques, \acr{amr} and the \acr{gh} formalism. \acr{amr}, like its name suggests dynamically modified the discretiztation as the two black holes orbited each other. The \acr{gh} formalism, on the other hand tackled the singularity problem validating the excision of the black hole, and crucially letting that region move. Both combined, were able to finally slay the proverbial  numerical dragon. 

These waveforms, like the one in @fig-pretwave confirmed the predictions made in @Buonanno:2000ef, that the merger phase of a \acr{bbh} would not be as complicated as thought. As numercal techniques evolved further, they were able to elucidate more and more complex behaviors.

![The first \acr{nr} waveform, as presented in @Pretorius:2005gq](pretwave.png){#fig-pretwave}

Nowadays, it is the backbone of all other methods and is seen as the gold standard. Of course it remains very computationally expensive and making any sizable bank of purely \acr{nr} waveforms fools endeavor. To date only a couple hundred parameter space points have been simulated. Thus \acr{nr} is used to complement, calibrate and extend the other waveform generation techniques. For example to detect the first signals \acr{ligo} and others interpolated between parameter space points to reach the ones needed for detection. However, with the advent of \acr{lisa} on the horizon, a further problem will arise. \acr{nr} results by nature only take into account the last few orbit cycles before merger. Any more than that, and computational time becomes prohibitive. \acr{lisa} with its low noise floor should be able to detect inspiraling but not yet merging binaries. To do so however will require waveform templates with hundreds of orbits, well out of reach from any modern \acr{nr} package. Nonetheless, this technique has shown and will continue to show its worth, as no approximations other than discretization are made. The physical content of such waveforms is thus quite high. 

## Inspiral methods

Before continuing to the \acr{eob} method, let us look at the techniques that focus on the inspiral part of the waveform. There are broadly speaking three methods that fall in this category. The first we have already encountered at 1st order: \acr{pn}. It is a perturbative expansion in both relative velocity (slow moving limit) and the coupling constant $\grav$ (weak field limit) of the \acr{efe}. The second is the \acr{pm} method, which is a perturbative expansion in *only* the coupling constant $\grav$. At face value the \acr{pm} method contains the \acr{pn} one as a special case, however as at zeroth order, the \acr{pm} approximation capures straight line motion, and is generally more expressive of scattering. The final approximation can be applied when the mass ratio of the object in question is large. Here one can expand around a fixed but *not* flat mertric, essentially considering one of the objects as a test-particle evolving on a background caused by the heavier object. This is called the \acr{gsf} formalism.

### \acr{pn}
 This can be achieved with a by both a classical (albeit quite complicated) perturbative treatment [see @Blanchet:2013haa;@Blanchet:1995fg], and a more contemporary \acr{eft} based approach called coyly \acr{nrgr} because it was inspired by \acr{nrqcd}.

### \acr{pm}

Historically, it was less motivating to compute scattering than orbital dynamics, however with the rise of amplitude techniques from high energy physics, both \acr{eft} and full theory results have been succesful in extracting previously unreachable orders. Additionally \acr{eft}

 as one encounters intricate families of relativistic integrals.

### \acr{gsf}


## \acr{eob}

The second main full waveform generation technique is the the effective one body (\acr{eob}) formalism. It was develepped by @Buonanno:1998gg, initially as a non-perturbative re-summing of the \acr{pn} expansion. It was later extended to include the merger and ringdown effects in @Buonanno:2000ef. Thus it became the first full waveform generating technique to actually produce a waveform. It has gotten progressively more powerful, as the \acr{pn} expansions have gotten better, and even more recently \acr{pm} results have been included @Damour:2016gwp. Additonally \acr{nr} and \acr{eob} can be combined to produce a very accurate waveform, with less computional overhead than \acr{nr} alone. 

As it's name suggests, the \acr{eob} framework tries to combine all the previous data into a hamitonian describing the motion of a single body. The idea comes from Newtonian binaries where the method to solve the two body problem is to turn it into a one body problem. Further inspiration came from the two body problem in \acr{qed} [@Brezin:1970zr] .

Consider two bodies, with masses $\mass[1]$ and $\mass[2]$, positions $\tv[1]{q}$, $\tv[1]{q}$ and momenta $\tv{\emom[1]}$ and $\tv{\emom[2]}$ respectievly. The system can be described by the following hamiltonian:

$$
\ham[\text{newton}]{\tv[1]{q},\tv[1]{q}}{\tv{\emom[1]},\tv{\emom[2]}}= \frac{\tv{\emom[1]}^2}{2\mass[1]}  + \frac{\tv{\emom[2]}^2}{2\mass[2]}  - \frac{G\mass[1]\mass[2]}{\abs{\tv[1]{q}-\tv[1]{q}}}
$$

One then transforms this hamitionan into one descibing the relative motion $\tv{q}=\tv[1]{q}-\tv[1]{q}$. One can formalise this by defining a new set of generalised coordinates, through a canonical transformation. We can even go further and employ a generating function for the transformation, ensuring that hamiton's equations stay unchanged (see @goldsteinClassicalMechanics2002). To descibe relative motion, we use jacobi coordinates $(\tv{Q},\tv{q})$:
$$
\begin{pmatrix} \tv[1]{q} \\ \tv[1]{q}\end{pmatrix}\to \underbrace{\begin{pmatrix} \frac{\mass[1]}{\totmass} & \frac{\mass[2]}{\totmass} \\ 1&-1 \end{pmatrix}}_{A} \begin{pmatrix} \tv[1]{q} \\ \tv[1]{q}\end{pmatrix}=\begin{pmatrix} \tv{Q} \\ \tv{q}\end{pmatrix}
$${#eq-jacobi2}

If we now define the following generating function for the transformation, depending on the old positions coordinates  $\tv{q_i}$ and the new momenta $\tv{P_i}$: [note the use of einstein summation]{.aside}

$$
f_{II}(\tv{q_i},\tv{P_i})=\tv{P_i}A^{ij}\tv{q}_j
$${#eq-genfunc}

Then the old momenta is given by: 

$$
\tv{\emom[i]}=\pdv{f_{II}}{\tv{q_i}}=\tv{P_i} A^{ij} \iff \tv{P_i}=[A^{-1}]{}^{ij}\tv{\emom[i]}
$${#eq-momtrans}
Where we can directly invert this equation and obtain the new momenta as:

$$
  \begin{pmatrix} \tv{P} \\ \tv{p}\end{pmatrix}=\begin{pmatrix} \tv{P_1} \\ \tv{P_2}\end{pmatrix}=\begin{pmatrix} 1&1\\ \frac{\mass[2]}{\totmass} & -\frac{\mass[1]}{\totmass} \end{pmatrix} \begin{pmatrix} \tv{\emom[1]} \\ \tv{\emom[2]}\end{pmatrix}
$$
 
Where as expected we obtain that one of the momenta descibes the center of mass momentum $\tv{P}=\tv{\emom[1]}+\tv{\emom[2]}$. The other positions are by constuction given by $\pdv{f_{II}}{\tv[1]{q}}=\tv{Q}$ and $\pdv{f_{II}}{\tv[1]{q}}=\tv{q}$ i.e the same as equation @eq-jacobi2. Finally the new hamitonian $\ham[\text{rel}]{\tv{Q},\tv{q}}{\tv{P},\tv{p}}$ can be directly obtained by the generating function:^[We just plug in the definition of the old momenta in terms of the new (@eq-momtrans):
$$ \tv{\emom[1]}=\frac{\mass[1]}{\totmass} \tv{P} + \tv{p}$$
$$ \tv{\emom[2]}=\frac{\mass[2]}{\totmass} \tv{P} - \tv{p}$$
]

$$
\ham[\text{rel}]{\tv{Q},\tv{q}}{\tv{P},\tv{p}}=\ham[\text{newton}]{\tv{Q},\tv{q}}{\tv{P},\tv{p}}+\cancelto{0}{\pdv{f_{II}}{t}}= \frac{\tv{P}^2}{2\totmass}  + \frac{\tv{p}^2}{2\redmass}  - \frac{G\mass[1]\mass[2]}{\abs{\tv{q}}}
$$
Where $\totmass = \mass[1] + \mass[2]$ is the total mass, and $\redmass = \frac{\mass[1]\mass[2]}{\totmass}$ is the reduced mass. If we move to a frame where the $\tv{Q}$ is at rest, i.e. $\tv{P}=0$ the hamiltonian colapses to a one body hamiltonian. The two-body problem we started with has can now be though of as the one body problem of a test-particle of mass $\redmass$ orbiting an external mass $\totmass$. 

The \acr{eob} framework takes the above derivation and generalises it to general relativity. The defining trick used above is to transform to 'better' coordinates. A first step is to demand that for straight line motion the \acr{com} energy $E_{\text{\small COM}}=\ct[0]{P}$, where $P$ it the 4-momentum of the entire-system, is equal to the hamiltonian. We have then:^[In the \acr{com} frame, the spacial part of the total momentum is zero (by defintion), and thus we have:
$$
\co[0]{P}^2=P^2=(\emom[1]+\emom[2])^2=\emom[1]^2+\emom[2]^2+2\emom[1]\cdot\emom[2]
$$]

$$
\mathcal{H}=\sqrt{\totmass^2(1+2\symmratio(\lorentzfactor-1))}
$$

Where $\symmratio=\frac{\redmass}{\totmass}$ is the symmetric mass ratio, and $\lorentzfactor=\frac{1}{\sqrt{1-{v^2}}}=\frac{\ct{\emom[1]}\co{\emom[2]}}{\mass[1]\mass[2]}$ is the relative lorentz-factor. Note that for noninteracting systems we have $\co{\emom}\ct{\emom}=\redmass^2$ and we can call the effective hamitonian:

$$
\Heff=\ct[0]{\emom}=\sqrt{\redmass^2+\tv{\emom}^2} = \redmass \lorentzfactor
$${#eq-straightheff}

And then we can substitute this into the hamiltonian above, and add back a generic system momentum $\tv{P}$ and obtain:

$$
\Heob=\sqrt{\totmass^2(1+2\symmratio(\frac{\Heff}{\redmass}-1))+\tv{P}^2}
$$


This Hamiltonian (with $\Heff$ given by @eq-straightheff) now describes straight line motion in a relativistic framework. The key point is that we can take $\Heff$ to be a gravitational test mass Hamiltonian, with some specific deformations and this will match the \acr{PN} result. This is more than a neat trick as this Hamiltonian when well-matched fits the gold standard \acr{nr} result up to the merger, well out of the \acr{PN} regime. Crucially this Hamiltonian framework does not take into account radiation reaction by construction (since it is based on conserved energy). 

