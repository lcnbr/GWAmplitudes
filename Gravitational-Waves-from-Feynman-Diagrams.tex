% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  11pt,
  a4paper,
  DIV=11,
  numbers=noendperiod,
  oneside]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[left=1in,marginparwidth=2.0in,textwidth=4.0in,marginparsep=0.3in]{geometry}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{cancel}
\usepackage{adjustbox}
\usepackage{microtype}
\let\[\relax \let\]\relax % avoid warnings in the log file
\DeclareRobustCommand{\[}{\begin{equation}}
\DeclareRobustCommand{\]}{\end{equation}}
\usepackage{libertinus}
\usepackage{glossaries}
\usepackage[record]{glossaries-extra}
\setabbreviationstyle[acronym]{long-short}
\input{gls.tex}



\usepackage{libertinus} % Includes unicode-math
\setmonofont[Scale=.89,Extension = .ttf,UprightFont= *-Regular,Path = assets/font/]{Julia Mono}

\usepackage{bm}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tikz}{}{\usepackage{tikz}}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Fig}
\else
  \newcommand\figurename{Fig}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Tbl}
\else
  \newcommand\tablename{Tbl}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\@ifpackageloaded{sidenotes}{}{\usepackage{sidenotes}}
\@ifpackageloaded{marginnote}{}{\usepackage{marginnote}}
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Gravitational Waves from Feynman Diagrams},
  pdfauthor={Lucien Huber},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Gravitational Waves from Feynman Diagrams}
\author{Lucien Huber}
\date{9/13/2022}

\begin{document}
\maketitle
\begin{abstract}
The goal of this thesis is to explain the nascent field of scattering
amplitudes in gravitational wave physics. We explore the context in
which these tools are revolutionizing the field, and then go into detail
of their construction and application.

We begin with a brief overview of the topic and the academic context.
The next chapter is devoted to the theoretical foundations of
gravitational waves, and their important sources. In the third chapter
we discuss the detection of these waves, highlighting the importance of
the theoretical templates. The fourth chapter explores the theoretical
methods for producing full wave templates, such as \gls{eob} and
\gls{nr} as well as the expansions and approximations used for the
inspiral: the \gls{pn} and \gls{pm} approximations.

The fifth chapter is the main focus of the thesis, and is devoted to the
scattering amplitude techniques that can be applied to the general
relativistic two-body problem. We begin with the \gls{eft} matching
technique to motivate the production of gravitational amplitudes. The
\gls{kmoc} formalism, defining the classical limit of wave functions, is
explained in detail. Finally, amplitudes in a simplified theory,
\gls{sqed} are computed, with a focus on automation of calculations. The
corresponding graphs, filters, Feynman rules and further simplifications
are all implemented in a cocktail of the relevant languages. We also
compare the results obtained with those found in the literature.

In the last chapter we provide some concluding remarks and a brief
outlook.
\end{abstract}
\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes,arrows.meta}
\usegdlibrary{trees,force}



\newcommand{\half}[1][1]{\tfrac{#1}{2}}
\newcommand{\Half}[1][1]{\frac{#1}{2}}
\newcommand{\pa}[2][]{#1(#2 #1)}
\newcommand{\bc}[2][]{#1[#2 #1]}
\newcommand{\brc}{\bc}
\newcommand{\bk}[2][]{#1\{#2 #1\}}
\newcommand{\brk}{\bk}
\newcommand{\ang}[2][]{#1\langle #2 #1\rangle}
\newcommand{\abs}[2][]{#1\vert#2 #1\vert}
\newcommand{\norm}[2][]{#1\Vert#2 #1\Vert}
\newcommand{\order}[2][]{\mathcal{O}(#2^{#1})}


\newcommand{\partialder}[1][]{\partial_{#1}}
\newcommand{\differential}{\mathrm{d}}
\newcommand{\Diff}{\mathrm{D}}


\newcommand{\pdv}[3][]{\frac{\partialder^{#1} #2}{\partialder {#3}^{#1}}} 
\newcommand{\odv}[3][]{\frac{\differential^{#1} #2}{\differential {#3}^{#1}}}
\newcommand{\mdv}[3][]{\frac{\Diff^{#1} #2}{\Diff {#3}^{#1}}}
\newcommand{\fdv}[3][]{\frac{\delta^{#1} #2}{\delta {#3}^{#1}}}
\newcommand{\jdv}[3][]{\frac{\partialder ^{#1}(#2)}{\partialder ({#3})^{#1}}}
\newcommand{\adv}[3][]{\frac{\Delta^{#1} #2}{\Delta {#3}^{#1}}}

\newcommand{\dd}[2][]{\,\differential^{#1}#2\,}

\newcommand{\euler}{e}
\let\oldexp\exp
\newcommand{\Exp}[2][]{\oldexp#1({#2}#1)}
\renewcommand{\exp}[1]{\mathrm{\euler}^{#1}}
\let\oldln\ln
\renewcommand{\ln}[2][]{\oldln#1({#2}#1)}

\newcommand{\greens}[2][ret]{\mathcal{G}_{\mathrm{#1}}(#2)}
\newcommand{\thetafn}[2][]{\Theta^{{#1}}(#2)}
\newcommand{\deltafn}[2][]{\delta^{{#1}}(#2)}


\newcommand{\iunit}{\mathring{\imath}}
\newcommand{\im}{\iunit}

\newcommand{\tv}[2][]{\mathbf{{#2}}_{#1}}
\newcommand{\lv}[2][]{{#2}_{#1}}


\newcommand{\scf}[1][]{\phi_{#1}}
\newcommand{\ascf}[1][]{\adj{\phi}_{#1}}

\newcommand{\bra}[2][]{{}_{\text{#1}}\langle #2 \vert}


\newcommand{\ket}[2][]{\vert #2 \rangle_{\text{#1}}}

\newcommand{\obs}[1]{#1}

\newcommand{\op}[1]{\mathbb{#1}}

\newcommand{\ev}[2]{\langle#2 \vert  #1 \vert #2 \rangle}
\newcommand{\av}[1]{\langle#1\rangle}

\newcommand{\ip}[2]{\langle #1 \vert #2 \rangle}
\newcommand{\dyad}[1]{\vert #1 \rangle \langle #1 \vert}
\newcommand{\com}[2]{[#1,#2]}

\newcommand{\adj}[1]{#1^\dagger}

\newcommand{\mel}[3]{\langle #1 \vert #2 \vert #3 \rangle}

\newcommand{\Smat}{S}
\newcommand{\Tmat}{T}

\newcommand{\ampl}[1][]{\mathcal{A}^{#1}}
\newcommand{\redampl}[1][]{\mathcal{\bar{A}}^{#1}}

\newcommand{\amp}[3][]{\mathcal{A}^{#1}(#2\to#3)}
\newcommand{\aamp}[3][]{\mathcal{\conj{A}}^{#1}(#2\to#3)}

\newcommand{\redamp}[3][]{\mathcal{\bar{A}}^{#1}(#2\to#3)}
\newcommand{\aredamp}[3][]{\mathcal{\conj{\bar{A}}}^{#1}(#2\to#3)}





\newcommand{\posendelta}[2][-m^2]{\deltafn[(+)]{#2^2#1}}

\newcommand{\normalized}[1]{\tilde{#1}}
\newcommand{\dn}[2][]{\,\normalized{\differential}^{#1}#2\,}
\newcommand{\ndeltafn}[2][]{\normalized{\delta}^{#1}(#2)}
\newcommand{\nposendelta}[2][-m^2]{\ndeltafn[(+)]{#2^2#1}}


\newcommand{\planck}{h}
\newcommand{\sol}{c}
\newcommand{\grav}{G}
\newcommand{\elch}{e}
\newcommand{\cosmo}{\Lambda}
\newcommand{\impactParameter}{b}
\newcommand{\emom}[1][]{p_{#1}}
\newcommand{\imom}[1][]{k_{#1}}
\newcommand{\mom}[1]{#1}



\newcommand{\mass}[1][]{m_{#1}} 
\newcommand{\charge}[1][]{Q_{#1}}


\newcommand{\FT}[3][]{\mathcal{F}_{#1}\left[#2\right]}
\newcommand{\invFT}[3][]{\mathcal{F}^{-1}_{#1}\left[#2\right]}
\newcommand{\ft}[3][x]{\hat{#2}}
\newcommand{\invft}[3][x]{\check{#2}}



\newcommand{\ind}[2]{^{#1}_{\phantom{#1}#2}} 	
\newcommand{\invind}[2]{_{#1}^{\phantom{#1}#2}}

\newcommand{\ipdv}[3][_]{#2{{}#1{,#3}}}
\newcommand{\covd}[3][_]{#2{{}#1{;#3}}}

\newcommand{\SRDA}{\Box_{SR}}



\newcommand{\co}[2][\mu]{#2{}_{#1}}
\newcommand{\ct}[2][\mu]{#2{}^{#1}}
\newcommand{\covtwotensor}[2][\mu\nu]{\co[#1]{#2}}
\newcommand{\contwotensor}[2][\mu\nu]{\ct[#1]{#2}}
\newcommand{\tensortrace}[2][\alpha]{#2\ind{#1}{#1}}
\newcommand{\mixedtwotensor}[2][\ind{\mu}{\nu}]{#2#1}
\newcommand{\tracereverse}[1]{\bar{#1}}
\newcommand{\transverseTraceless}[1]{{#1}^{TT}}

\newcommand{\metricTensor}{g}
\newcommand{\met   }[1][\mu\nu]{\co[#1]{\metricTensor}}
\newcommand{\invmet}[1][\mu\nu]{\ct[#1]{\metricTensor}}

\newcommand{\minkoskiMetric}{\eta}
\newcommand{\mink   }[1][\mu\nu]{\co[#1]{\minkoskiMetric}}
\newcommand{\invmink}[1][\mu\nu]{\ct[#1]{\minkoskiMetric}}

\newcommand{\weakTensor}{h}
\newcommand{\weakmet      }[1][\mu\nu]{\co[#1]{\weakTensor}}
\newcommand{\invweakmet   }[1][\mu\nu]{\ct[#1]{\weakTensor}} 
\newcommand{\trweakmet    }[1][\alpha]{\tensortrace[#1]{\weakTensor}}
\newcommand{\mixweakmet   }[1][\ind{\mu}{\nu}]{\weakTensor#1}

\newcommand{\pertTensor}{\textsf{h}}
\newcommand{\pertmet      }[1][\mu\nu]{\co[#1]{\pertTensor}}
\newcommand{\invpertmet   }[1][\mu\nu]{\ct[#1]{\pertTensor}} 
\newcommand{\trpertmet    }[1][\alpha]{\tensortrace[#1]{\pertTensor}}
\newcommand{\mixpertmet   }[1][\ind{\mu}{\nu}]{\pertTensor#1}

\newcommand{\pertnTensor}[1][n]{\textsf{h}_{#1}}
\newcommand{\pertnmet      }[2][\mu\nu]{\co[#1]{\pertnTensor[#2]}}
\newcommand{\invpertnmet   }[2][\mu\nu]{\ct[#1]{\pertnTensor[#2]}} 
\newcommand{\trpertnmet    }[2][\alpha]{\tensortrace[#1]{\pertnTensor[#2]}}
\newcommand{\mixpertnmet   }[2][\ind{\mu}{\nu}]{\pertnTensor[#2]#1}

\newcommand{\weakTRTensor }{\tracereverse{\weakTensor}}
\newcommand{\weakTRmet      }[1][\mu\nu]{\co[#1]{\weakTRTensor}}
\newcommand{\invweakTRmet   }[1][\mu\nu]{\ct[#1]{\weakTRTensor}}
\newcommand{\trweakTRmet    }[1][\alpha]{\tensortrace[#1]{\weakTRTensor}}
\newcommand{\mixweakTRmet   }[1][\ind{\mu}{\nu}]{\weakTRTensor#1}

\newcommand{\weakTTTensor}{\transverseTraceless{\weakTensor}}
\newcommand{\weakTTmet      }[1][ij]{\co[#1]{\weakTTTensor}}
\newcommand{\invweakTTmet   }[1][ij]{\ct[#1]{\weakTTTensor}} 
\newcommand{\trweakTTmet    }[1][\alpha]{\tensortrace[#1]{\weakTTTensor}}
\newcommand{\mixweakTTmet   }[1][\ind{\mu}{\nu}]{\weakTTTensor#1}

\newcommand{\RiemannTensor}{R}
\newcommand{\RiemannTensorExplicit}[4]{\ipdv{\LC{#1}{#2}{#3}}{#4} - \ipdv{\LC{#1}{#2}{#4}}{#3} - \LC{\alpha}{#2}{#4}\LC{#1}{\alpha}{#3}+\LC{\alpha}{#2}{#3}\LC{#1}{\alpha}{#4}}
\newcommand{\Riem}[1][\ind{\beta}{\mu\nu\rho}]{\RiemannTensor#1}
\newcommand{\RiemCt}[1][\beta\mu\nu\rho]{\ct[#1]{\RiemannTensor}}

\newcommand{\RicciTensor}{R}
\newcommand{\RicciTct}[1][\mu\nu]{\ct[#1]{\RicciTensor}}
\newcommand{\RicciTco}[1][\mu\nu]{\co[#1]{\RicciTensor}}

\newcommand{\linRicciTensor}{R^{(1)}}
\newcommand{\linRicciTct}[1][\mu\nu]{\ct[#1]{\linRicciTensor}}
\newcommand{\linRicciTco}[1][\mu\nu]{\co[#1]{\linRicciTensor}}

\newcommand{\RicciS}{R}
\newcommand{\linRicciS}{R^{(1)}}

\newcommand{\relSETensor}{\tau}
\newcommand{\relSEct}[1][\mu\nu]{\ct[#1]{\relSETensor}}
\newcommand{\relSEco}[1][\mu\nu]{\co[#1]{\relSETensor}}
\newcommand{\trrelSE}[1][\alpha]{\tensortrace[#1]{\relSETensor}}
\newcommand{\relSEmix}[1][\ind{\mu}{\nu}]{\relSETensor#1}

\newcommand{\SETensor}{T}
\newcommand{\SEct}[1][\mu\nu]{\ct[#1]{\SETensor}}
\newcommand{\SEco}[1][\mu\nu]{\co[#1]{\SETensor}}
\newcommand{\trSE}[1][\alpha]{\tensortrace[#1]{\SETensor}}
\newcommand{\SEmix}[1][\ind{\mu}{\nu}]{\SETensor#1}

\newcommand{\polTensor}{\varepsilon}
\newcommand{\polct}[1][\mu\nu]{\ct[#1]{\polTensor}}
\newcommand{\polco}[1][\mu\nu]{\co[#1]{\polTensor}}
\newcommand{\trpol}[1][\alpha]{\tensortrace[#1]{\polTensor}}
\newcommand{\polmix}[1][\ind{\mu}{\nu}]{\polTensor#1}

\newcommand{\conj}[1]{{#1{}^\ast}}

\newcommand{\conjpolTensor}{\conj{\varepsilon}}
\newcommand{\conjpolct}[1][\mu\nu]{\ct[#1]{\conjpolTensor}}
\newcommand{\conjpolco}[1][\mu\nu]{\co[#1]{\conjpolTensor}}
\newcommand{\trconjpol}[1][\alpha]{\tensortrace[#1]{\conjpolTensor}}
\newcommand{\conjpolmix}[1][\ind{\mu}{\nu}]{\conjpolTensor#1}

\newcommand{\srcTensor}{S}
\newcommand{\srcct}[1][\mu\nu]{\ct[#1]{\srcTensor}}
\newcommand{\srcco}[1][\mu\nu]{\co[#1]{\srcTensor}}
\newcommand{\trsrc}[1][\alpha]{\tensortrace[#1]{\srcTensor}}
\newcommand{\srcmix}[1][\ind{\mu}{\nu}]{\srcTensor#1}

\newcommand{\kron}[1][_{\nu}^{\mu}]{\delta#1}
\newcommand{\LC}[3]{\Gamma\ind{#1}{#2#3}}





\newcommand{\ddP}[2][]{\,\differential\Phi_{#1}(#2)\,}
\newcommand{\dPs}[2][]{\,\differential\Psi_{#1}(#2)\,}
\newcommand{\dPsb}[2][]{\,\differential\overline{\Psi}_{#1}(#2)\,} 
\newcommand{\AAngle}[1]{\Bigg\langle\hspace{-0.6em}\Bigg\langle #1\Bigg\rangle\hspace{-0.6em}\Bigg\rangle}

\newcommand{\wavenumber}[1]{\bar{#1}}
\newcommand{\tm}[1][]{q_{#1}}
\newcommand{\tw}[1][]{\wavenumber{q}_{#1}}

\newcommand{\vInt}[1][\obs{O}]{\mathcal{I}_{\text{v}}(#1)}
\newcommand{\vIntp}[1][\obs{O}]{\mathcal{I'}_{\text{v}}(#1)}
\newcommand{\vIntb}[1][\obs{O}]{\overline{\mathcal{I}_{\text{v}}'}(#1)}

\newcommand{\rInt}[1][\obs{O}]{\mathcal{I}_{\text{r}}(#1)}
\newcommand{\rIntp}[1][\obs{O}]{\mathcal{I'}_{\text{r}}(#1)}
\newcommand{\rIntb}[1][\obs{O}]{\overline{\mathcal{{I}}_{\text{r}}'}(#1)}

\newcommand{\obschange}[2][\obs{O}]{\underset{\mathclap{#2}}{\Delta}#1\,}
\newcommand{\changeob}[1][\obs{O}]{\Delta #1\,}
\newcommand{\vchangeob}[1][\obs{O}]{\Delta #1_\text{v}\,}
\newcommand{\rchangeob}[1][\obs{O}]{\Delta #1_\text{r}\,}

\newcommand{\id}{\mathbb{1}} 
\newcommand{\scatlen}{\ell_s}
\newcommand{\comptlen}{\ell_c}
\newcommand{\wfwidth}{\ell_\omega}

\newcommand{\redmass}{\mu}
\newcommand{\symmratio}{\nu}
\newcommand{\totmass}{M}
\newcommand{\ham}[3][]{\mathcal{H}_{#1}(#2,#3)}
\newcommand{\lorentzfactor}{\gamma}
\newcommand{\Heff}{\mathcal{H}_{\text{eff}}}
\newcommand{\Heob}{\mathcal{H}_\text{eob}}
\newcommand{\action}{S}
\newcommand{\lag}[1][]{\mathcal{L}_\text{#1}}
\newcommand{\pot}{V}
\newcommand{\inv}[1]{\frac{1}{#1}}
\newcommand{\coupling}{\kappa}
\newcommand{\proptwobody}[1]{\Delta_2\pa{#1}}

\newcommand{\energy}[1][]{E_{#1}}
\newcommand{\redEratio}{\xi}
\newcommand{\Dim}{D}
\newcommand{\dimreg}{\epsilon}
\newcommand{\momket}[1][p]{\ket{#1}}
\newcommand{\mombra}[1][p]{\bra{#1}}
\newcommand{\momop}{\mathbb{P}}
\newcommand{\createop}[1][p]{a_{#1}^{\dagger}}
\newcommand{\annihilop}[1][p]{a_{#1}}
\newcommand{\shellen}[1][\tv{p}]{\omega_{#1}}
\newcommand{\barevac}{0}
\newcommand{\barevack}{\ket{\barevac}}
\newcommand{\barevacb}{\bra{\barevac}}
\newcommand{\physvac}{\Omega}
\newcommand{\physvack}{\ket{\physvac}}
\newcommand{\physvacb}{\bra{\physvac}} 
\newcommand{\shellft}[1]{\breve{#1}}
\newcommand{\lrder}[1][\mu]{\overleftrightarrow{\partialder[#1]}}
\newcommand{\defeq}{\stackrel{\text{def}}{=}}
\newcommand{\askeq}{\stackrel{\text{?}}{=}}
\newcommand{\musteq}{\stackrel{\text{!}}{=}}
\newcommand{\sign}[1]{\text{sign}(#1)}
\newcommand{\wf}[1][]{f_{#1}}
\newcommand{\cwf}[1][]{\conj{f}_{#1}}
\newcommand{\cls}[1]{\breve{#1}}
\newcommand{\vel}[1][]{u_{#1}}
\newcommand{\phprop}[1][{\mu \nu}]{\tilde{D}^{#1}}
\newcommand{\feynprop}{\tilde{\Delta}_F}
\newcommand{\mands}{s}
\newcommand{\mandt}{t}
\newcommand{\mandu}{u}
\newcommand{\stellarmass}{M_\odot}
\newcommand{\quadmom}[1][ij]{I_{#1}}
\newcommand{\dist}{R}
\newcommand{\semom}[1][]{\tilde{p}_{#1}}
\newcommand{\relfact}{\sigma}


\tikzset{
    photon/.style={
        decoration={snake, amplitude=0.1cm, segment length=0.2cm},
        decorate    
    },
    gluon/.style={
        decoration={coil, aspect=0.75, mirror, segment length=1.5mm},
        decorate
    }, 
    left/.style={
        bend left=90,
        looseness=1.75
    }
}

\pgfdeclaredecoration{sl}{initial}{
  \state{initial}[width=\pgfdecoratedpathlength-1sp]{
     \pgfmoveto{\pgfpointorigin}
  }
  \state{final}{
     \pgflineto{\pgfpointorigin}
    }
}

\tikzset{parallel arrow/.style={->, 
     shorten >=2mm, shorten <=2mm, 
     decoration={sl,raise=1mm},decorate}}

\tikzset{->-/.style={decoration={
  markings,
  mark=at position #1 with {\arrow[scale=1.5]{Triangle[]}}},postaction={decorate}}}
\tikzset{
bicolor/.style 2 args={
  dashed,dash pattern=on 20pt off 20pt,#1,
  postaction={draw,dashed,dash pattern=on 20pt off 20pt,#2,dash phase=20pt}
  },
pics/mom/.style args = {#1/#2}{code={
    \draw[solid,thin,<-]
        (-2mm,1.5mm) -- node [#1,font=\footnotesize,inner sep=1pt] {#2} ++ (4mm,0mm);}
                            },
}

\newcommand{\texttip}[2]{#1}
\newcommand{\mathtip}[2]{#1}

\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[interior hidden, enhanced, borderline west={3pt}{0pt}{shadecolor}, sharp corners, boxrule=0pt, frame hidden, breakable]}{\end{tcolorbox}}\fi

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}
\addcontentsline{toc}{chapter}{Preface}

This document represents my, Lucien Huber, master thesis, the last step
in my master's degree at ETH Zurich. It can be viewed as either a
webpage at \url{https://lcnhb.github.io/GWAmplitudes}, or downloaded as
a PDF file. All code used for the thesis is provided in the GitHub
repository \url{https://github.com/lcnhb/GWAmplitudes}.

\bookmarksetup{startatroot}

\hypertarget{acknowledgements}{%
\chapter*{Acknowledgements}\label{acknowledgements}}
\addcontentsline{toc}{chapter}{Acknowledgements}

First and foremost I would like to thank my supervisor, Prof.~Babis
Anastasiou, for his trust, his support, and kindness throughout the last
half year that has led to this thesis. Without his curiosity towards
this new subject, I would have never discovered and learned about this
wonderful world at the confluence of two great physical theories,
\gls{gr} and \gls{qft} . I would also like to extend this thanks to the
rest of the theoretical particle physics group a ETH. Dr Achilleas
Lazopoulos, Dr.~Ben Ruijl, Dr.~Valentin Hirschi, Rayan Haindl, Dario
Kermanschah, Zeno Capatti, Matilde Vicini, and Julia Karlen, the many
shared lunches, coffee breaks, and discussions have been a incredible
source of inspiration and motivation for me. In particular, I would like
to thank Ben for his help with all things \texttt{FORM}, Zeno for our
very insightful discussions and your great suggestions, and Julia for
reading through the first draft of this thesis.

I would also like to thank my girlfriend, Maria Miklos, for her
patience, love, and support. Thanks for keeping me grounded and
reminding me that there is more to life than physics (such as math)!

Thanks as well to my grandfather Martin Huber, who graciously hosted me
during the start of my masters, and with which I shared many great
discussions and stories at the breakfast, dinner, and Jass table.

Finally, I would like to thank my parents for their unconditional love
and support, and without whom I would not be here today.

\bookmarksetup{startatroot}

\hypertarget{sec-intro}{%
\chapter{Introduction}\label{sec-intro}}

The detection of \glspl{gw} by the \gls{ligo} and Virgo collaborations
in 2016 (\protect\hyperlink{ref-LIGOScientific:2016aoc}{B. P. Abbott et
al. 2016}) has sparked a new era of \gls{gw} astronomy. The first
detections were of \gls{bbh} mergers. More recently, \gls{bns} mergers
(\protect\hyperlink{ref-LIGOScientific:2017vwq}{B. P. Abbott et al.
2017}) as well as \gls{nsbh} mergers have been detected
(\protect\hyperlink{ref-LIGOScientific:2021qlt}{R. Abbott et al. 2021}).
Future observatories will further increase sensitivity and will be able
to detect a wide range of astrophysical sources. Studying these
\glspl{gw} signals gives us a very powerful new window into the
universe. It allows us to study the properties of neutron stars and
black holes, and the physics of compact object mergers, but also gives
us a powerful testing apparatus for general relativity.

To detect these faint signals \gls{ligo} and Virgo have been made to be
extraordinarily sensitive instruments. This sensitivity had been the
main barrier to overcome ever since \gls{gw} were first predicted by
Einstein. Whilst sensitive measurements generally demand, and thus drive
equally precise theoretical predictions, for \gls{gw} astronomy, the
case for theoretical models is even stronger. Indeed, theoretical models
are necessary components to the detection mechanisms used at current
laser interferometers. The faint signals of strain due to the passage of
a \gls{gw} are often buried in the noise of the detector. To counteract
this, experimental physicists make use of matched filtering, an approach
where a template signal is cross correlated to the detector output. The
template is a model of the signal provided by theoretical physicists
based on physical models. The upper bound to physical content of the
detection is thus in fact set by the physical content of the template
and therefore of the theoretical model. Additionally, the more precise
the template, the higher the signal-to-noise ratio, the more probable
and precise the detection. Theoretical models are thus a crucial
component of the detection process, and there is a strong incentive to
improve their precision and breadth of applicability.

In recent years, an unlikely ally in this precision race has arisen,
based on \gls{qft} techniques
(\protect\hyperlink{ref-Goldberger:2004jt}{Goldberger and Rothstein
2006}; \protect\hyperlink{ref-Kosower:2018adc}{Kosower, Maybee, and
O'Connell 2019}; \protect\hyperlink{ref-Porto:2016pyg}{Porto 2016};
\protect\hyperlink{ref-Neill:2013wsa}{Neill and Rothstein 2013}). This
is seemingly an impossibility as \gls{qft} and \gls{gr} have
historically been the two irreconcilable theories that `together' span
the whole range of scales in the universe. \gls{qft} and the standard
model, describe physics at the smallest scales, where quantum effects
dominate. This is the physics of colliders, and condensed matter. The
standard model is our best guess as to the nature of the fundamental
constituents of `matter' and `light'.

\gls{gr} on the other hand describes physics at the largest scales,
where gravity dominates. It was developed by Einstein as the successor
to the Newtonian theory of gravity, which was not able to account for
orbital mechanics such as the precession of the perihelion of mercury.
Having passed every experimental test we have thrown at it, \gls{gr} is
by far the best theory of gravity we have yet. It can describe
cosmological phenomena, as well as the compact objects known as black
holes.

These two physics leviathans do not get along, unfortunately. \gls{gr}
is a theory of geometry, and \gls{qft} is a theory of interactions. We
can try to write and interpret one in the language of the other, but in
either case difficulties arise. Writing \gls{gr} in terms of
perturbative \gls{qft} one introduces the graviton, the spin 2 quantum
of gravity. Disappointingly, such a theory breaks down at high energies,
and is un-renormalisable . In fact the presence of black holes, that
dominate the high energy spectrum of \gls{gr}, is a testament to that
fact (\protect\hyperlink{ref-Shomer:2007vq}{Shomer 2007}). On the other
hand, whilst one can write \glspl{qft} on a curved background, this does
not quantize gravity itself, and therefore does not really address the
problem. Background independent theories such as loop quantum gravity
does not yet have semiclassical limit collapsing to \gls{gr}. String
theory, on the other hand, introduces spurious dimensions that need to
be compactified, which leads to uncountably many solutions. In short,
there is no satisfactory theory of that combines \gls{gr} and \gls{qft}
consistently.

Surprisingly, one can still use the powerful tools of one theory to
tackle problems in the other. Specifically, considering the classical
limit of \gls{qft}, allows the extraction of perturbative gravitational
dynamics from an initially quantum description of the setup. This is
interesting because the tools developed for high energy physics have
become extremely powerful and efficient theoretical machines, often
making use of diagrammatic reasoning. Tools such as Feynman diagrams,
differential equations (\protect\hyperlink{ref-Remiddi:1997ny}{Remiddi
1997}; \protect\hyperlink{ref-Bern:1993kr}{Zvi Bern, Dixon, and Kosower
1994}; \protect\hyperlink{ref-Kotikov:1990kg}{Kotikov 1991}) and more
recently generalized unitarity (\protect\hyperlink{ref-Bern:1994cg}{Z.
Bern et al. 1995}; \protect\hyperlink{ref-Bern:2004ky}{Zvi Bern et al.
2005}; \protect\hyperlink{ref-Buchbinder:2005wp}{Buchbinder and Cachazo
2005}; \protect\hyperlink{ref-Anastasiou:2006jv}{Charalampos Anastasiou
et al. 2007}), all yielding efficient computations for scattering
amplitudes, can all be applied to \emph{classical} orbital dynamics in
\gls{gr}. This is exactly the subject of this thesis.

Specifically we are interested in the diagrammatic objects that arise
when framing the two body problem similarly to particle collisions.
Diagrammatics are interesting as they are an abstraction of the problem
that enables efficient reasoning about and automation of the solutions.
We will explain where these tools shine in the broader context of
waveform approaches such as \gls{eob} , \gls{nrgr} , \gls{pm} and
\gls{pn} approximations.

This thesis is organized as follows. In Chapter~\ref{sec-gwgen} we deal
with the theoretical foundations of \glspl{gw}, exploring how they arise
through the linearized Einsteins' field equations. The subsequent
Chapter~\ref{sec-gwdetect} discusses the experimental apparatuses that
are used to detect \glspl{gw}. We describe at the techniques used to
extract the signals from the noise, and motivate precise theoretical
predictions. In Chapter~\ref{sec-wfgen} we look at how to generate
partial and full waveforms. We explore the \gls{eob} and \gls{nr}
frameworks. Motivated by the need for more precise ingredients to input
into \gls{eob}, in Chapter~\ref{sec-scat} we explain the
state-of-the-art formalisms that incorporate amplitude tools into the
program. We describe the conservative \gls{eft} matching approach, where
the system does not lose energy to its environment. Taking into account
the loss of energy due to \glspl{gw} necessitates another method: the
\gls{kmoc} formalism, which makes up the second half of the chapter. In
this context, we take a deeper look at amplitude computing tools. We
conclude with a discussion of the challenges that lie ahead, and the
future of \gls{gw} astronomy.

\bookmarksetup{startatroot}

\hypertarget{sec-gwgen}{%
\chapter{Gravitational Wave Generation}\label{sec-gwgen}}

We start by looking at where and how \glspl{gw} are generated. We will
see that \gls{gr} predicts the existence of \glspl{gw}, and we will
explore under what conditions they are observable.

\hypertarget{sgw}{%
\section{\texorpdfstring{\glspl{gw}}{}}\label{sgw}}

To this day, the most fundamental theory of gravity is \gls{gr}, due to
Einstein. It formulates spacetime as a Riemannian manifold with
curvature, determined by mass distribution. This curvature is encoded in
the metric \(\met\). Objects then move in this deformed spacetime
following \glspl{eom} written in terms of \(\met\). Interaction is thus
caused by the dependence of \(\met\) on mass distribution, which itself
evolves through \(\met\). The physical laws that governs the interaction
between mass and curvature are manifested in Einstein's field equations,

\begin{equation}\protect\hypertarget{eq-EFE}{}{
\boxed{\RicciTco-\frac{\met}{2} \RicciS+\cosmo \met=-8 \pi \grav \SEco} .
}\label{eq-EFE}\end{equation}

The \gls{lhs} of this equation contains several objects that only depend
on the metric \(\met\). \(\RicciTco\) is the Ricci tensor\sidenote{\footnotesize The
  Ricci Tensor is given by: \[
  \RicciTco \coloneq \Riem[\ind{\alpha}{\mu\alpha\nu}]=\invmet[\alpha\beta]\RiemCt[\alpha\mu\beta\nu]
  \]}, a contraction of the Riemann curvature tensor \(\Riem\). The
Riemann tensor\sidenote{\footnotesize The Riemann Tensor is given by: \[
  \Riem=\RiemannTensorExplicit{\beta}{\mu}{\nu}{\rho}.
  \]} encodes the curvature of spacetime, in terms of the
non-commutativity of covariant derivatives. When they do, it means that
they have collapsed to regular derivatives, and thus the Levi-civita
connection\sidenote{\footnotesize The Levi-Civita Connection is given by:
  \[\LC{\alpha}{\mu}{\nu}=
  \frac{1}{2} \invmet[\alpha \rho]
  \brk[\Big]{
  \ipdv{ \met[\rho \nu]}{\mu}
  +\ipdv{ \met[\rho \mu]}{\nu}
  -\ipdv{ \met}{\rho}}
  \]} must have vanished. This is only possible if the metric is flat,
\(\met=\mink\). The Riemann curvature tensor is exclusively composed of
the metric, its first, second derivatives, and it is linear in the
second derivative of the metric. In fact, it is the only possible tensor
of this form. The second term on the \gls{lhs} is the Ricci scalar, a
further contraction of the Ricci Tensor:
\(\RicciS = \invmet \RicciTco\). The final term on the \gls{lhs} is just
a proportional constant factor of the metric, \(\cosmo\), called the
cosmological constant. It can be measured and has a low known upper
bound. It is in part responsible for the expansion of the universe.

The \gls{rhs} of eq.~\ref{eq-EFE} encodes the distribution of mass and
energy in the universe, through the stress-energy tensor \(\SEco\),
which depends on the dynamical properties of the system. It is further
multiplied by the Gravitational constant \(\grav\). In empty space,
\(\SEco\) is zero.

Equation~\ref{eq-EFE} can be recast in a form where the Ricci scalar has
been substituted by the trace of the stress-energy tensor,

\begin{equation}\protect\hypertarget{eq-EFEwoR}{}{
\boxed{\RicciTco=-8 \pi \grav\left(\SEco-\trSE \frac{\met}{2}\right)+\cosmo \met} 
}\label{eq-EFEwoR}\end{equation}

Both eq.~\ref{eq-EFE} \& eq.~\ref{eq-EFEwoR} with \(\cosmo=0\) admit
wave solutions. In order to see this, let us look at these equations in
the weak field approximation. We take the metric to be a small
perturbation around the Minkowskian background,

\begin{equation}\protect\hypertarget{eq-WeakFA}{}{
    \met = \mink + \weakmet,
}\label{eq-WeakFA}\end{equation}

where \(\weakmet\) is the expansion parameter (thus considered small).
Note that if we restrict ourselves to first order in \(\weakmet\) then
all raising and lowering of indices is done with \(\mink\). Since the
\gls{lhs} of eq.~\ref{eq-EFE} is composed of the Ricci tensor and
scalar, let us see how these behave in the weak approximation. Both are
in fact made up of Levi-Civita connections, which to first order in
\(\weakmet\) is given by:
\begin{equation}\protect\hypertarget{eq-weakaffine}{}{
\LC{\alpha}{\mu}{\nu} = \frac{1}{2} \invmink[\alpha \rho]
\brk[\Big]{
    \ipdv{ \weakmet[\rho \nu]}{\mu}
    +\ipdv{ \weakmet[\rho \mu]}{\nu}
    -\ipdv{ \weakmet}{\rho}} + \order[2]{h}\quad .
}\label{eq-weakaffine}\end{equation}

Plugging eq.~\ref{eq-weakaffine} into the definition of the Ricci tensor
we see that the terms with products of the connection vanish, and we are
left with the derivative terms:

\begin{equation}\protect\hypertarget{eq-Ricciweak}{}{ 
\RicciTco  =
 \frac{\invmink[\alpha\rho]}{2}\left[ \ipdv{\weakmet[\rho\alpha]}{\mu\nu} + \ipdv{\weakmet}{\rho\alpha} - \ipdv{\weakmet[\mu\alpha]}{\rho\nu} - \ipdv{\weakmet[\nu\rho]}{\mu\alpha} \right] + \mathcal{O}(h^2)=\linRicciTco+ \mathcal{O}(h^2)
}\label{eq-Ricciweak}\end{equation}

The linearized Ricci scalar is then just
\(\linRicciS=\invmink\linRicciTco\). The symmetry of the \gls{efe} under
general diffeomorphisms implies the existence of gauge freedom. In
particular, eq.~\ref{eq-EFE}, admits an infinite number of solutions,
and in fact we can map a solution into another by changing coordinates
in such a way that the equation isn't affected. To fix this ambiguity we
choose a coordinate system (`gauge choice') by imposing the harmonic
coordinate conditions:

\begin{equation}\protect\hypertarget{eq-hcc}{}{ 
   \invmet[\alpha\beta]\LC{\mu}{\alpha}{\beta} =0
}\label{eq-hcc}\end{equation}

The harmonic coordinate conditions demand the vanishing of the trace of
the Levi-Civita connection. They have a simplified form in the weak
approximation, which we can access by plugging eq.~\ref{eq-weakaffine}
into eq.~\ref{eq-hcc}, giving:

\[
\begin{split}
    (\invmink[\alpha\beta]+\invweakmet[\alpha\beta])\frac{1}{2}(\invmink[\mu\rho]+\invweakmet[\mu\rho])\left[\ipdv{\weakmet[\alpha\rho]}{\beta}+\ipdv{\weakmet[\beta\rho]}{\alpha}-\ipdv{\weakmet[\alpha\beta]}{\rho}\right] &= 0 \\
    \invmink[\mu\rho]\invmink[\alpha\beta]\left[2\ipdv{\weakmet[\alpha\rho]}{\beta}-\ipdv{\weakmet[\alpha\beta]}{\rho}\right]+ \mathcal{O}(h^2)&= 0 \\
    \invmink[\alpha\beta]\ipdv{\weakmet[\alpha\rho]}{\beta} &= \frac{1}{2}\ipdv{\weakmet[\alpha\beta]}{\rho}\invmink[\alpha\beta] + \mathcal{O}(h^2).
\end{split}
\]

The last equation, truncated to first order, is called the De-Donder
gauge condition:

\[
\ipdv[^]{\weakmet}{\mu} = \frac{1}{2}\ipdv{\trweakmet}{\nu}
\]

In the de-Donder gauge we can simplify the terms in
eq.~\ref{eq-Ricciweak} to:

\[
    \invmink[\alpha\beta]\ipdv{\weakmet[\alpha\mu]}{\nu\beta} = \frac{1}{2}\invmink[\alpha\beta]\ipdv{\weakmet[\alpha\beta]}{\mu\nu},
\]

and \[
    \invmink[\alpha\beta]\ipdv{\weakmet[\beta\nu]}{\mu\alpha} = \frac{1}{2}\ipdv{\weakmet[\alpha\beta]}{\mu\nu}.
\]

With these two relations the expression for the linearized Ricci tensor
eq.~\ref{eq-Ricciweak} simplifies to
\begin{equation}\protect\hypertarget{eq-Ricciweak2}{}{
    \linRicciTco = \frac{1}{2}\invmink[\alpha\beta]\ipdv{\weakmet}{\alpha\beta} = \frac{1}{2}\SRDA \weakmet.
}\label{eq-Ricciweak2}\end{equation}

Where we have defined the \gls{sr} D'Alembertian differential operator
as: \(\SRDA=\invmink \partialder[\mu]\partialder[\nu]\) We can plug
eq.~\ref{eq-Ricciweak2} into eq.~\ref{eq-EFEwoR}, with \(\cosmo=0\) and
up to first order in \(\weakmet\), we get the linearized Einstein field
equations for a system of harmonic coordinates:

\begin{equation}\protect\hypertarget{eq-linearized}{}{
\square_{SR} \weakmet = -16\pi \grav \overbracket{(\SEco-\frac{\mink}{2}\trSE)}^{\srcco} ,
}\label{eq-linearized}\end{equation}
\begin{equation}\protect\hypertarget{eq-dedonder}{}{
\ipdv{\mixweakmet[\ind{\alpha}{\mu}]}{\alpha}=\frac{1}{2}\ipdv{\trweakmet}{\mu}. 
}\label{eq-dedonder}\end{equation} Recall raising and lowering indices
is done with the Minkowski metric. The tensor \(\srcco\) encodes the
behavior of the source of \glspl{gw}. One could also plug
eq.~\ref{eq-Ricciweak2} into eq.~\ref{eq-EFE}, with \(\cosmo=0\), and
express it in terms of the trace reversed perturbation:
\(\weakTRmet=\weakmet - \frac{1}{2}\trweakmet\mink\). Then, we obtain
similar and simpler equations at the cost of a more complex
perturbation: \sidenote{\footnotesize Note that the inverse change of variables is
  just: \(\weakmet=\weakTRmet-\frac{1}{2}\trweakTRmet\mink\).}
\sidenote{\footnotesize We eliminate the trace of the stress-energy tensor by using:
  \(\RicciS= 8\pi\grav\trSE\). We can write
  \(\linRicciS=-\frac{1}{2}\SRDA\trweakTRmet\), in de Donder gauge,
  which is precisely the extra term dropping out of \(\SRDA\weakmet\)
  when we express it in terms of \(\weakTRmet\).}

\begin{equation}\protect\hypertarget{eq-linearizedTR}{}{
\square_{SR} \weakTRmet = -16\pi \grav \SEco
}\label{eq-linearizedTR}\end{equation}
\begin{equation}\protect\hypertarget{eq-dedonderTR}{}{
    \ipdv[^]{\weakTRmet}{\nu}=0. 
}\label{eq-dedonderTR}\end{equation}

We can easily recover the conservation equation for the stress-energy
tensor. We take the divergence of eq.~\ref{eq-linearizedTR} and use
eq.~\ref{eq-dedonderTR} to get:

\begin{equation}\protect\hypertarget{eq-SEcons}{}{
    \ipdv[^]{\SEco}{\nu}=0.
}\label{eq-SEcons}\end{equation}

Let us look at what sorts of solutions come out of these

\hypertarget{homogeneous-solutions}{%
\section{Homogeneous solutions}\label{homogeneous-solutions}}

The first step is to consider the homogeneous solution, as all solutions
will involve these terms. Setting \(\SEco=0\) or \(\srcco=0\) yields the
wave equation in the absence of sources,
\begin{equation}\protect\hypertarget{eq-homogenous}{}{
   \SRDA \weakmet = 0 .
}\label{eq-homogenous}\end{equation}

The De-Donder gauge (eq.~\ref{eq-dedonder}) and the remaining gauge
freedom \sidenote{\footnotesize Associated to changes in coordinates of the form
  \(\ct{x}\to\ct{x}+\ct{\xi}\) with \(\SRDA\ct{\xi}=0\).} restricts the
possible forms of this solution to having only helicity \(\pm2\)
physically significant components (see Weinberg
(\protect\hyperlink{ref-Weinberg:1972}{1972})). Let us look at generic
forms of the solution. The metric \(\weakmet\) ought to be real-valued,
thus we seek real solutions of the form

\begin{equation}\protect\hypertarget{eq-solutiongeneric}{}{
    \weakmet = \polco \exp{\im k\cdot x} + \conjpolco \exp{-\im k\cdot x},
}\label{eq-solutiongeneric}\end{equation}

where \(\polco\) is the polarization tensor, \(k\) is the wave vector
and we define:
\(k\cdot x\equiv \mink \ct{k} \ct[\nu]{k} = \co{k} \ct{x}\). The
polarization tensor is a symmetric rank-2 tensor, since \(\weakmet\) is.
Substituting eq.~\ref{eq-solutiongeneric} into \(\SRDA\weakmet=0\) gives
\(\co{k} \ct{k} \equiv k^2=0\).\sidenote{\footnotesize Assuming non-zero perturbation
  \(\weakmet\) of course.} \sidenote{\footnotesize This is saying that the wavevector
  for the wave is null, thus that the wave propagates at the speed of
  light.} From eq.~\ref{eq-dedonder} we have
\begin{equation}\protect\hypertarget{eq-polk}{}{
    \polmix \co{k} = \frac{1}{2}\trpol k_\nu.
}\label{eq-polk}\end{equation} As said at the beginning of this
subsection, we still have some remaining gauge freedom, which we now
fix, choosing the following coordinate change
\(\ct{x}\to\ct{x}+\ct{\zeta}\) where: \[
\ct{\zeta}=\im \ct{A} \exp{\im k\cdot x}    =  - \im \ct{\conj{A}} \exp{ -\im k\cdot x}
\]

In the new coordinates, the tensor perturbation takes the form:

\[
\weakTensor'_{\mu\nu}=\weakmet-\pdv{\co{\zeta}}{\ct[\nu]{x}}-\pdv{\co[\nu]{\zeta}}{\ct{x}}=\polTensor'_{\mu\nu} \exp{\im k\cdot x} + \polTensor^{\prime\ast}{}_{\mu\nu} \exp{-\im k\cdot x}.
\]

with

\begin{equation}\protect\hypertarget{eq-polTprime}{}{
\polTensor'_{\mu\nu} = \polco + \co{k}\co[\nu]{A} + \co[\nu]{k}\co{A}
}\label{eq-polTprime}\end{equation}

Equations -eq.~\ref{eq-polk} and -eq.~\ref{eq-polTprime} reduce the free
components in the polarisation tensor to just two. Additionally, these
equations conspire to yield a traceless polarisation tensor
\(\trpol=0\), with \(\polco[0\mu]=0\) (see Carroll
(\protect\hyperlink{ref-Carroll:2019}{2019})). This in turn implies that
the metric perturbation itself is traceless, and thus becomes equal to
its trace-reversed counterpart. This is the so-called transverse
traceless gauge:

\[
\weakmet[0\mu]=0,\quad \trweakmet=0, \quad \ipdv[^]{\weakmet}{\nu}=0.
\]

The metric perturbation in this gauge is written as: \(\weakTTmet\). In
emtpy space we can write the two independent components of the metric
perturbation as:

\[
\weakTTmet[a b](t, \tv{x})=\left(\begin{array}{cc}
h_{+} & h_{\times} \\
h_{\times} & -h_{+}
\end{array}\right)_{a b} \cos [\omega t-\tv{k}\cdot\tv{x}],
\]

where \(h_{+}\) and \(h_{\times}\) are the so-called plus and cross
polarisations.

\hypertarget{inhomogeneous-solutions}{%
\section{Inhomogeneous solutions}\label{inhomogeneous-solutions}}

With the homogeneous part of eq.~\ref{eq-linearized} accounted for, we
are now ready to derive the inhomogeneous part. The solution of
eq.~\ref{eq-linearized} in the presence of a source term will be heavily
inspired by the analogous problem in electromagnetism, where one learns
that any linear differential equation:

\[\mathcal{\hat{L}}\phi=J\]

is solved using green's functions. If we define the following retarded
Green's function

\[
    \greens{\ct{x}-\ct{x'}} = -2\pi\,\deltafn{({x}-{x'})^2}\thetafn{t>t^{\prime}},
\]

which satisfies,

\[
    \SRDA\greens{\ct{x}-\ct{x'}} = -2\pi \deltafn[4]{\ct{x}-\ct{x'}}.
\]

Then, the solution to

\begin{equation}\protect\hypertarget{eq-EFEwave}{}{
 \SRDA \weakmet =  -16 \pi \grav \srcco
}\label{eq-EFEwave}\end{equation}

is given by

\begin{equation}\protect\hypertarget{eq-hsolInhom}{}{
    \weakmet(x) = 8G\int\dd[4]{x'}\,\greens{\ct{x}-\ct{x'}}\srcco(x').
}\label{eq-hsolInhom}\end{equation}

\marginnote{\begin{footnotesize}

One gets the parallel solution to the trace reversed equation
eq.~\ref{eq-linearizedTR} by swapping \(\srcTensor\) with \(\SETensor\)
and all \(\weakTensor\) with \(\weakTRTensor\).

\end{footnotesize}}

Indeed, plugging in eq.~\ref{eq-hsolInhom} into eq.~\ref{eq-EFEwave}, \[
    \Box_x\weakmet = 8\grav\int\dd[4]{x'}\pa[\big]{(\underbrace{\Box_x\greens{\ct{x}-\ct{x'}}}_{=-2\pi\,\deltafn{\ct{x}-\ct{x'}}}} \srcco(x') = -16\pi \grav\srcco(x).
\] We can perform the \(x^{\prime0}=t'\) integration in
eq.~\ref{eq-hsolInhom}, with the Dirac delta function, which sets \(t'\)
to be the retarded time, \(t'=t-\abs{\ct{x}-\ct{x'}}= t_r\), i.e: \[
\weakmet(x) = 8\grav\int\dd[3]{\tv{y}}\srcco(t,\tv{y})\dd{t'}\frac{\delta(t'-(t-\abs{\tv{x}-\tv{y}}))}{2\abs{\tv{x}-\tv{y}}} 
\]

\begin{equation}\protect\hypertarget{eq-solInhomt}{}{
\weakmet(\tv{x},t) = 4\grav\int\dd[3]{\tv{y}}\frac{\srcco(t-\abs{\tv{x}-\tv{y}},\tv{y})}{\abs{\tv{x}-\tv{y}}}.
}\label{eq-solInhomt}\end{equation}

We can interpret \(\weakmet(\tv{x},t)\), as the perturbation obtained by
summing up all the radiation from point-sources located at
\((\tv{x}-\tv{y},t_r)\) on the past light cone. Put differently
\(\weakmet(\tv{x},t)\) is the gravitational radiation produced by the
source \(\srcco\). Additionally, the form of the time argument of the
source tensor, imposed by the definition of the Green's function, shows
that the radiation propagates with velocity \(=1=c\). The solution given
by eq.~\ref{eq-solInhomt} satisfies the harmonic coordinate condition of
eq.~\ref{eq-linearized}, since

\[
    \covd{\SEco}{\mu}=0\ \Rightarrow\ \ipdv{\SEco}{\mu}+\underbracket{\Gamma\,\Gamma\,}_{\mathclap{\mathrm{non-linear}}}=0\ \Rightarrow\ \ipdv{\SEco}{\mu}=0,
\]

where we have ignored the non-linear terms encoded in the Levi-Civita
connections. Then,

\[
    \ipdv{\srcct}{\mu} = \partial_\mu\left(\SEco-\frac{\invmink[\mu\nu]}{2}\trSE\right) = -\frac{\invmink[\mu\nu]}{2}\ipdv{\trSE}{\mu}.
\]

Also

\[
    \trsrc[\mu] = \trSE[\mu] -\frac{\kron[_\mu^\mu]}{2}\trSE = -\trSE.
\]

Thus

\[
\begin{split}
    \ipdv{\srcct}{\mu} &= \frac{1}{2}\ipdv{\trsrc}{\mu}\invmink[\mu\nu] \\
    \ipdv{\srcmix}{\mu} &= \frac{1}{2}\ipdv{\trsrc}{\nu}.
\end{split}
\]

Then

\[
\begin{split}
    \ipdv{\mixweakmet}{\mu} &= 8\grav\pdv{} {\ct{x}} \int\dd[4]{x'} \greens{\ct{x}-\ct{x'}} \srcmix (x') \\
&= 8\grav\int\dd[4]{x'}\,\pdv{\greens{\ct{x}-\ct{x'}}}{ \ct{x}} \srcmix(x') \\
&= -8\grav\int\dd[4]{x'}\pdv{\greens{\ct{x}-\ct{x'}}}{\ct{x'}}\srcmix(x') \\
    &= \underbrace{8\grav\greens{\ct{x}-\ct{x'}}\srcmix(x')}_{=0\ \mathrm{at the boundary}} + 8G\int\dd[4]{x'}\,\greens{\ct{x}-\ct{x'}}\pdv{\srcmix(x')}{\ct{x'}} \\
    &= 8G\int\dd[4]{x'}\,\greens{\ct{x}-\ct{x'}} \frac{1}{2}\pdv{\trsrc(x')}{\ct{x'}} \\
    &=\quad \dots \quad \text{repeat in reverse} \\
    &= \pdv{} {\ct{x}} \brk[\Big]{8\grav\int\dd[4]{x'}\,\greens{\ct{x}-\ct{x'}} \frac{1}{2}\trsrc(x')} \\
    &= \frac{1}{2} \ipdv{\trweakmet}{\mu}.\checkmark
\end{split}
\]

\hypertarget{gravitational-wave-sources}{%
\section{Gravitational Wave Sources}\label{gravitational-wave-sources}}

Now that we have the general form of the solutions to the linearized
Einstein equations, we can proceed to the analysis of sources of
\glspl{gw}. The first step is to analyse the equations in the frequency
domain. We will use the following notation:

\[\FT[t]{\phi}{\omega}(\omega,\tv{x})=\int \dd{t} \phi(t,\tv{x}) \exp{\im\omega t}\]
\[\invFT[\omega]{\phi}{t}(t,\tv{x})=\int \frac{\dd{\omega}}{2\pi} \FT[t]{\phi}{\omega}(\omega,\tv{x}) \exp{- \im \omega t}\]

Let us look at frequency domain of the solution given in
eq.~\ref{eq-solInhomt}. We have
\begin{equation}\protect\hypertarget{eq-FTweakmet}{}{\begin{aligned} 
\FT[t]{\weakmet}{\omega}(\omega, \tv{x}) &=\int \dd{t} \weakmet(t,\tv{x}) \exp{\im\omega t}
\\ &=4\grav\int\dd[3]{\tv{y}}\dd{t} \frac{\srcco(t-\abs{\tv{x}-\tv{y}},\tv{y})}{\abs{\tv{x}-\tv{y}}}  \exp{\im\omega t}
\\ &=4\grav\int\dd[3]{\tv{y}}\dd{t_r} \frac{\srcco(t_r,\tv{y})}{\abs{\tv{x}-\tv{y}}}  \exp{\im\omega t_r}\exp{\im\omega\abs{\tv{x}-\tv{y}}}
\\ &=4\grav\int\dd[3]{\tv{y}} \frac{\FT[t_r]{\srcco}{\omega}(\omega,\tv{y})}{\abs{\tv{x}-\tv{y}}} \exp{\im\omega\abs{\tv{x}-\tv{y}}} .
\end{aligned}
}\label{eq-FTweakmet}\end{equation}

We can now apply various approximations to this form of the
perturbation:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Consider a compact source, centered on the origin of our coordinate
  system. This implies that \(\srcco\) is peaked and compactly supported
  in a region around the origin. We look at the radiation only in the so
  called \emph{wave zone}, at a distance \(r=\abs{\tv{x}}\) much larger
  than the dimensions of the source \(R=\abs{\tv{y}}_\text{max}\).
\item
  We assume that \(r \gg \frac{1}{\omega}\), i.e long wavelengths don't
  dominate.
\item
  We assume that \(r \gg \omega R^2\), i.e.~the ratio of \(R\) to the
  wavelength is not comparable to the ratio of \(r\) to \(R\). Using
  this approximation we can write:
\end{enumerate}

\[
\begin{split}
    \abs{\tv{x}-\tv{y}} &= r\left(1-2\hat{\tv{x}}\cdot\tv{y}+\frac{\tv{x}^{\prime2}}{r^2}\right)^{1/2} , \\
    \abs{\tv{x}-\tv{y}} &\approx r\left(1-\frac{\hat{\tv{x}}\cdot\tv{y}}{r}\right) \quad \text{with: } \hat{\tv{x}} = \frac{\tv{x}}{r}.
\end{split}
\]

If we additionally further separate the scales in the following way
\sidenote{\footnotesize We just add the condition that \(\frac{1}{\omega}\gg R\), that
  is the source radius is much smaller than the wavelength.}

\[
r\gg \brc{\frac{1}{\omega},\omega R^2}\gg R,
\]

Then eq.~\ref{eq-FTweakmet} becomes much simpler\sidenote{\footnotesize The
  approximations all conspire to be able to neglect the \(\tv{y}\)
  dependence of \(\frac{\exp{\im\omega\abs{\tv{x}-\tv{y}}}}{\abs{x-y}}\)
  in the integral.}:

\begin{equation}\protect\hypertarget{eq-FTweakmet2}{}{
\FT[t]{\weakmet}{\omega}(\omega, \tv{x})=4\grav\frac{\exp{\im\omega r}}{r} \int\dd[3]{\tv{y}} \FT[t]{\srcco}{\omega}(\omega,\tv{y}) .
}\label{eq-FTweakmet2}\end{equation}

Now, let us look at the Fourier transform of the source term. By
definition, we have

\[
\FT[t]{\srcco}{\omega}(\omega,\tv{y})=\FT[t]{\SEco}{\omega}(\omega,\tv{y})+\half \mink\FT[t]{\trSE}{\omega}(\omega,\tv{y})
\]

Thus, we can study the Fourier transform of \(\SEco\),
\(\FT[t]{\SEco}{\omega}\) instead. Using the conservation equation
eq.~\ref{eq-SEcons} in Fourier \(t\)-space, we obtain:

\begin{equation}\protect\hypertarget{eq-FTSEcons}{}{
-\ipdv[^]{ \FT[t]{\SEco[i\mu]}{\omega}}{i} = \im \omega\FT[t]{\SEco[0\mu]}{\omega}
}\label{eq-FTSEcons}\end{equation}

This equation becomes algebraic when we further Fourier transform in
\(\tv{x}\)-space:

\[
\ft[\tv{x}]{\SETensor}{\tv{k}}_{\mu\nu}(\ct[\alpha]{k}) =\ft[\tv{x}]{\SETensor}{\tv{k}}_{\mu\nu}(\omega,\tv{k}) = \int \dd[3]{\tv{y}} \FT[t]{\SEco}{\omega}(\omega,\tv{y}) \exp{\im\tv{k}\cdot\tv{y}}
\] Then the conservation equation becomes: \[
\ct{k}\SEco(\omega,\tv{k}) = 0
\]

These four equations relate the time components of
\(\ft[\tv{x}]{\SETensor}{\tv{k}}_{\mu\nu}\) to the spatial ones. We now
apply eq.~\ref{eq-FTSEcons} to itself to obtain:

\[
\ipdv[^]{\FT[t]{\SEco[ij]}{\omega}}{ij}=-\omega^2\FT[t]{\SEco[00]}{\omega}
\] which, when multiplied by \(\co[m]{x}\co[n]{x}\), and integrated over
\(\tv{x}\) gives\sidenote{\footnotesize Two integrations by parts cancel the
  \(\co[m]{x}\co[n]{x}\) term in the \gls{lhs} and since boundary terms
  are 0 (the source is finite) we have
  \[\int \dd{x} \co[m]{x}\co[n]{x} \ipdv[^]{\FT[t]{\SEco[ij]}{\omega}}{ij}=\int\dd{x} \ipdv[^]{\co[m]{x}\co[n]{x}}{ij} \FT[t]{\SEco[ij]}{\omega}\]
  The hessian of \(\co[m]{x}\co[n]{x}\) is
  \((\kron[^i_m]+\kron[^i_n])(\kron[^j_n]+\kron[^j_m])\), but since
  \(\SEco\) is symmetric the integral is
  \[\int \dd{\tv{y}} 2\FT[t]{\SEco[mn]}{\omega}(\omega,\tv{y}) \]} \[
\int \dd{\tv{x}} \FT[t]{\SEco[mn]}{\omega}(\omega,\tv{x})=-\Half[\omega^2] \int \dd{\tv{x}} \co[m]{x}\co[n]{x} \FT[t]{\SEco[00]}{\omega}(\omega,\tv{x}).
\]

Notice that the integral on the \gls{rhs} is in fact the Fourier
transform of the quadrupole moment tensor of the energy density:

\begin{equation}\protect\hypertarget{eq-quadmom}{}{
\quadmom[mn]=\int \co[m]{x}\co[n]{x} \SEco[00](t,\tv{x})\dd[3]{x}.
}\label{eq-quadmom}\end{equation}

We call its Fourier transform
\(\ft[t]{\quadmom[]}{\omega}_{mn}(\omega)\) and we can finally rewrite
eq.~\ref{eq-FTweakmet2} as:

\[
\FT[t]{\weakmet}{\omega}(\omega, \tv{x})=-{2\grav\omega^2}\frac{\exp{\im\omega r}}{r} \pa{\ft[t]{\quadmom[]}{\omega}_{mn}(\omega)+\half\mink\ft[t]{\quadmom[]}{\omega}^n{}_{n}(\omega)}
\]

Going back \(t\)-space we have:

\begin{equation}\protect\hypertarget{eq-metricquadmom}{}{
\begin{aligned}
\weakmet(t,\tv{x})&=-\frac{\grav}{\pi r}\int \dd{\omega} \exp{-\im\omega(t-r)} \omega^2 \pa{\ft[t]{\quadmom[]}{\omega}_{mn}(\omega)+\half\mink\ft[t]{\quadmom[]}{\omega}^n{}_{n}(\omega)}\\
&=\frac{\grav}{\pi r}  \odv[2]{}{t}\int \dd{\omega} \exp{-\im\omega(t_r)} \pa{\ft[t]{\quadmom[]}{\omega}_{mn}(\omega)+\half\mink\ft[t]{\quadmom[]}{\omega}^n{}_{n}(\omega)}\\
&=\frac{2\grav}{r}\odv[2]{}{t}\pa{\quadmom[mn](t_r)+\half\mink \quadmom[]^n{}_n(t_r)}
\end{aligned}
}\label{eq-metricquadmom}\end{equation}

This equation has a nice physical interpretation. The gravitational wave
produced by a non-relativistic source is proportional to the second
derivative of the quadrupole moment of the energy density at the time
\(t_r\) where the past light cone of the observer intersects the source.
The nature of gravitational radiation is in stark contrast to the
leading electromagnetic contribution which is due the change in the
\emph{dipole} moment of the charge density. The change of the dipole
moment can be attributed to the change in center of charge (for
\gls{em}), or mass (for \gls{gr}). While a center of charge is free to
move around, the center of mass (of an isolated source) is fixed by the
conservation of momentum, so the dipole moment is zero.

The quadrupole moment, on the other hand, is sensitive to the shape of
the source, which a gravitational system can modify. We observe that the
quadrupole radiation is sub-leading when compared to dipole radiation.
Thus, on top of the much smaller coupling constant, gravitational
radiation is also weakened by this fact, and thus is usually orders of
magnitude weaker than electromagnetic radiation.

In summary, any object that is modifying its shape is a source of
\glspl{gw}. All orbiting systems therefore are sources of \glspl{gw} .
However, as outlined above, only significant `changes in shape' have a
chance to be detectable. We will now explore these phenomena.

\hypertarget{sec-compactbinaries}{%
\subsection{Compact binaries}\label{sec-compactbinaries}}

How could one construct a very powerful source of \glspl{gw} ? An
example would be that of two highly-massive bodies (such that
\(\SEco[00]\) is large) that orbit each other. Furthermore, in order for
the \glspl{gw} emitted by the system to be detectable they must orbit
close enough to each other that their quadrupole moment is large. For
these very massive objects to be close enough for a small orbit, they
have to be very compact. Assuming that is the case, a funny thing
happens, as these objects orbit each other, they emit \glspl{gw} , and
in doing so they lose energy \sidenote{\footnotesize Of course this happens in every
  orbiting system just on a timescale that is negligible. Only systems
  which are massive enough to produce large amounts of radiation
  actually lose enough energy for it to matter.}. Thus, they slow down,
and their orbit shrinks. This continues until the orbit is so small that
the objects merge into a single object. Of course this is a significant
change of shape, and thus we have a constructed (if not all on purpose)
a very powerful source of \glspl{gw} . Such objects are called compact
binaries.

Let us consider two massive bodies orbiting each other. The mass of each
body is \(\mass[1]\) and \(\mass[2]\) respectively. The distance to the
observer is \(r\) and the separation between the object is given by
\(R\). The setup is shown in Figure~\ref{fig-compact-binaries}

\begin{marginfigure}

\sidecaption{\label{fig-compact-binaries}Compact binary setup}

{\centering \includegraphics{./Compact binaries.png}

}

\end{marginfigure}

To \gls{lo} in \(\grav\) the motion of the binary is described by a
Newtonian circular orbit. In barycentric coordinates, such a system is
in fact equivalent to effective one body \sidenote{\footnotesize This choice of
  wording is not a coincidence as we shall see} of reduced mass
\(\redmass=\frac{\mass[1]\mass[2]}{\totmass}\) orbiting in a
gravitational potential of mass \(\totmass=\mass[1]+\mass[2]\), at a
distance \(R\) equal to the distance between the two bodies forming the
binary. The orbit is characterized by a balancing act between the
gravitational attraction due to the potential and the centripetal force
due to the motion of the reduced mass:\sidenote{\footnotesize Or equivalently between
  conserved angular momentum and the derivative of the potential energy.}

\begin{equation}\protect\hypertarget{eq-newtongrav}{}{
\frac{\grav \totmass\redmass}{\pa{\dist}^2}=\frac{\redmass \vel^2}{\dist},
}\label{eq-newtongrav}\end{equation}

where \(\vel\) is the norm of tangential velocity, and \(\dist\) is the
distance between the two objects. eq.~\ref{eq-newtongrav} gives us the
the norm of the velocity

\[
\vel=\sqrt{\frac{\grav \totmass}{\dist}}.
\]

Thus, the orbital period is simply, in the case of

\[
T=\frac{2\pi\dist}{\vel}=2\pi\sqrt{\frac{\dist^3}{\grav\totmass}}.
\]

This also gives us angular frequency:

\begin{equation}\protect\hypertarget{eq-omega}{}{  
\Omega=\frac{2\pi}{T}=\sqrt{\frac{\grav\totmass}{\dist^3}}.
}\label{eq-omega}\end{equation}

Thus the \gls{eom} \(\tv{r}(t)\) of the reduced mass is described by a
circular orbit in the \(x-y\) plane i.e.:

\begin{equation}\protect\hypertarget{eq-eomred}{}{
\tv[xy]{r}(t)= \begin{pmatrix} \dist \cos(\Omega t)\\ \dist \sin(\Omega t) \end{pmatrix} .
}\label{eq-eomred}\end{equation}

We have not written the third \(z\) component of the trajectory as that
can be set to zero, for a well-chosen set of inertial coordinates. The
corresponding trajectory for both masses is simply given by applying the
following scaling:

\[
\redmass \tv{r}(t)  = \mass[1] \tv[1]{r}(t) = \mass[2] \tv[2]{r}(t).
\]

We can straightforwardly obtain the \(00\) component of the
energy-momentum tensor of the system \sidenote{\footnotesize The energy density is the
  same for the effective one body system and the two body system.} by
using the \gls{eom} of the reduced mass (eq.~\ref{eq-eomred}):

\[
\SEco[00](t,\tv{x}) = \redmass\deltafn{x_3}\deltafn{x_1-\dist \cos(\Omega t)}\deltafn{x_2-\dist \sin(\Omega t)},
\]

which when plugged into eq.~\ref{eq-quadmom}, gives us the quadrupole
moment of the rotating system:

\[
\begin{aligned}
\quadmom[11] &= \redmass \dist^2 \cos ^2( \Omega t)= \redmass \dist^2(1+\cos (2 \Omega t)) \\
\quadmom[22] &= \redmass \dist^2 \sin ^2( \Omega t)= \redmass \dist^2(1-\cos (2 \Omega t)) \\
\quadmom[12]=\quadmom[21] &=2  \redmass \dist^2(\cos \Omega t)(\sin \Omega t)= \redmass \dist^2 \sin (2 \Omega t) \\
\quadmom[i 3] &=0 .
\end{aligned}
\]

Thus, we have roughly:

\[
\quadmom[]\sim \redmass \dist^2 \cos (2 \Omega  t) \sim \redmass \dist^2 \sim \redmass \pa[\Big]{\frac{\grav\totmass}{\Omega^2}}^{\frac{2}{3}}= \frac{\grav\mass[1]\mass[2]}{\pa{\mass[1]+\mass[2]}^{\frac{1}{3}}}\Omega^{-\frac{4}{3}},
\]

where we have expanded in small \(\dist\) in the second relation. The
metric perturbation is then given by eq.~\ref{eq-metricquadmom} and has
norm proportional to:

\begin{equation}\protect\hypertarget{eq-hnorm}{}{
h \propto \frac{\ddot{\quadmom[]}}{r} \propto \frac{1}{r} \frac{\grav\mass[1]\mass[2]}{\pa{\mass[1]+\mass[2]}^{\frac{1}{3}}}\Omega^{\frac{2}{3}}.
}\label{eq-hnorm}\end{equation}

\hypertarget{bh-binaries}{%
\subsection{\texorpdfstring{\gls{bh}
Binaries}{ Binaries}}\label{bh-binaries}}

Taking the process described above to the limit of more massive and more
compact objects one could imagine asking for the most dense objects
possible to orbit each other. In \gls{gr} this object is called a black
hole (\gls{bh}). It is a possible solution to the full fat \gls{efe}
(eq.~\ref{eq-EFE}), in a static and isotropic universe, with point like
mass at its center. Then the solutions to the equations eq.~\ref{eq-EFE}
have a unique form (\protect\hyperlink{ref-Birkhoff:1923}{Birkhoff and
Langer 1923}), called the Schwarzschild solution.

The solution is given by, in spherical coordinates:

\begin{equation}\protect\hypertarget{eq-Schwarzschild}{}{
\dd{\tau^{2}}=\left[
    1-\frac{R_{S}}{r}
    \right]\dd{t^{2}}
-\frac{\dd{r^2}}{1-\frac{R_{S}}{r}}-r^{2}\left(\dd{ \theta^2}+\sin ^{2} \theta \dd{ \varphi^2}\right)
}\label{eq-Schwarzschild}\end{equation}

where \(R_S\) is the Schwarzschild radius, given by:\sidenote{\footnotesize we
  reinstate the speed of light, as we want to compute orders of
  magnitudes}

\[
R_S=\frac{2GM}{c^2}.
\]

For stellar masses we have \(R_S=2954\; \mathrm{m}\), quite a lot
smaller than the radius of the sun \(\sim 7\cdot10^8\; \mathrm{m}\).
Note that the metric given in eq.~\ref{eq-Schwarzschild} exhibits
singularities at both \(r=R_S\) and \(r=0\). The former is spurious, as
it is an artefact of the coordinate choice, while the latter is real, in
the sense that coordinate independent scalars formed from the metric
(such as the ricci scalar) do in fact blow up as \(r\to0\). This encodes
the non-spurious mass singularity that gives rise to the \gls{bh}
phenomena.

If we consider a comparable stellar mass \gls{bbh} system, we can use
the calculations of the previous section to compute the order of
magnitude of the perturbation. eq.~\ref{eq-omega} in terms of the
Schwarzschild radius gives us the orbital frequency

\[
f=\frac{\Omega}{2\pi}=\frac{\sol}{2\pi}\sqrt{\frac{ R_S}{\dist^3}},
\]

and the metric perturbation is given by eq.~\ref{eq-hnorm}:

\[
h = \frac{R_S^2}{\dist}.
\]

Thus, if we consider \glspl{bh} separated by ten times their
Schwarzschild radius, observed at cosmological distances
\(\sim 100 \;\mathrm{Mpc}\), we obtain the values for the scales
characterizing the binary system:

\[
\begin{aligned}
R_S &\approx 10^3\; \mathrm{m} ,\\
\dist &\approx 10^4\; \mathrm{m} ,\\ 
r &\approx 10^{23}\; \mathrm{m}.
\end{aligned}
\]

Such a system would have an orbital frequency of:

\[
f\approx 10^{2}\; \mathrm{Hz},
\]

and would perturb the metric on earth by:

\[
h\approx 10^{-21}.
\]

To have any hope of detecting such systems, one would need to have
detectors sensitive to frequency spectra up to hundreds of Hertz, with a
strain sensitivity of \(10^{-21}\). This has been achieved at \gls{ligo}
and other detectors, and has enabled the detection of such systems.

Non-spinning black holes orbiting around each other are the simplest
binary system to model. However, they are extremely unlikely to occur in
nature (realistic physical scenarios). The nature of \gls{bh} formation
implies that they necessarily also spin. Spinning black holes, also
referred to as Kerr black holes, are characterized by a different metric
tensor defining the spacetime surrounding them. The modelling of
spinning black holes is still in its infancy and will not be treated it
here.

There are many other binary systems that could feasibly be detected.
Finite-size binaries such as \glspl{ns} result in tidal phenomena that
are not present in the \gls{bh} case. Also, non-binary systems, such as
Cosmic strings, corresponding to early universe topological defects,
could produce a detectable stochastic \gls{gw} background.

\bookmarksetup{startatroot}

\hypertarget{sec-gwdetect}{%
\chapter{Gravitational Wave Detection}\label{sec-gwdetect}}

Gravitational waves were first theorized by Einstein, accompanying his
theory of general relativity. However, at the time it was not even clear
whether they were an artifact of the theory or an observable phenomenon.
Of course, as we have seen, \glspl{gw} are predicted to be extremely
weak, and thus there was initially little hope of ever detecting them.
As evidence mounted that \gls{gr} was indeed an incredibly accurate
theory of gravity, the interest in \gls{gw} detection grew. The first
detectors, resonant antennas, failed in successfully detecting
\glspl{gw}, as they were simply not sensitive enough. The more modern
laser based detectors were the finally able to claim detection, by being
extremely sensitive (the modern measurement precision at \gls{ligo} is
equivalent to measuring the distance to Alpha Centauri 4.367
light-years, to the width of a human hair \(\sim 40~\mathrm{µm}\)). The
first detection was made in 2015
(\protect\hyperlink{ref-LIGOScientific:2016aoc}{B. P. Abbott et al.
2016}), marking the beginning of a new era in astronomy, and maybe even
physics itself.

\hypertarget{laser-interferometers}{%
\section{Laser interferometers}\label{laser-interferometers}}

Laser-interferometer-based \gls{gw} detectors are essentially scaled-up
versions of the Michelson interferometer. The device, shown in
\textbf{?@fig-fig-interfertrans}, splits a beam of colimated coherent
photons (laser) into two, letting them propagate along two axes in an L
configuration, before being reflected back to the beam splitter. The two
beams, when recombined, interfere with each other, constructively or
destructively, depending on the nature of the medium they have traveled
through and the length of each arm.

\begin{figure}

\sidecaption{\label{fig-interfertrans}Principles of laser interferometer
\gls{gw} detectors}

{\centering \includegraphics{./interfertrans.png}

}

\end{figure}

For a gravitational wave to produce a measurable effect on such an
apparatus, all the optical equipment should be free to move and be
isolated from external vibrations. This is achieved by hanging the
mirror on precisely-tuned penduli. When the gravitational wave
propagates through the apparatus, it induces a relative movement between
the masses, changing the difference \(L_x-L_y\) in length of the
detectors arms, by an amount \(\Delta L\). This effect is exacerbated as
the length of the arms \(L_x \sim L_y \sim L\) is increased. It follows
that the strain is the normalized difference:

\[
\frac{\Delta L}{L}=\left[(1 / 2)\left(1+\cos ^2 (\theta)\right) \cos (2 \phi)\right] h_{+}+[\cos (\theta) \sin (2 \phi)] h_{\times} \equiv h,
\]

where \(\theta\) and \(\phi\) are the polar and azimuthal angles of the
direction of propagation of the \gls{gw} . The strain is decomposed into
components, \(h_{+}\) and \(h_{\times}\), which are the plus and cross
polarisations of the wave. The strain sensitivity can be further
increased by bouncing the light back and forth multiple times along the
arms of the interferometer. In current implementations this is achieved
using Fabry - Perot cavities spanning the whole length of the arms.

\hypertarget{sec-ligo}{%
\subsection{\texorpdfstring{\gls{ligo} and ground based
observatories}{ and ground based observatories}}\label{sec-ligo}}

\gls{ligo} implements the measurement apparatus described in the past
section, and a schematic is shown in Figure~\ref{fig-ligo}. It consists
of two detectors, both in the USA, one in Livingston Louisiana and one
in Hanford Washington, a separation of \(3000 \text{ km}\). Each
\gls{ligo} detector has two \(4\text{ km}\) long arms made up of
\(1.2\text{ m}\)-wide vacuum tubes, each operating as Fabry-Perot
cavities. The light from an effective \(750\text{ kW}\) laser bounces
back and forth inside these arms around 300 times. Thus, the effective
arm length becomes \(1200\text{ km}\), drastically improving
sensitivity.

\begin{figure}

\sidecaption{\label{fig-ligo}Schematic of \gls{ligo} detector}

{\centering \includegraphics{./ligoconcepttrans.png}

}

\end{figure}

While \gls{ligo} was the first to provide detection data, it does not
live in a vacuum. In fact for the first published detection, the data
analysis teams from \gls{ligo} joined forces with those for Virgo, the
European gravitational wave detector. The Virgo detector is located in
Cascina, Italy, and is similar to \gls{ligo} . It has \(3\text{ km}\)
long arms and a different suspension system. It joined data collection
with \gls{ligo} in the second observing run in 2017. Finally, there are
two other detectors that are now part of the collaboration, KAGRA in
Japan and GEO600 in Germany. KAGRA is a similar detector to Virgo in
scale, but is built underground further isolating it from seismic
activity .GEO600 is a smaller detector, with \(600 \text{ m}\) long
arms, built with the objective of being a test bed for future detectors.

Although they exhibit impressive sensitivity, ground based detectors are
limited, since they are subject to seismic activity, which can cause
vibrations that limits the lower bound of the frequency sensitivity of
the detectors. The optics and other higher frequency noise imposes an
upper bound to the frequency. In particular ground based detectors are
only sensitive to frequencies in the following rough range:

\[
\brc{10^{0},10^{4}}\text{ Hz}.
\]

In turn this implies that they are sensitive to the comparable, stellar
mass \sidenote{\footnotesize and a bit bigger \(\sim 1 - 10^3 \stellarmass\)} compact
binaries, which are currently believed to be the most common type of
binary systems in the universe. Of course this is not an accident, as
these detectors were purpose built for providing evidence of \gls{gw} in
general. In fact, they have been quite successful in this regard, with
upwards of 90 detections of \gls{gw} to date.

\begin{figure}

\sidecaption{\label{fig-masses}Mass distribution of Detected \gls{gw}
emiting binaries. Credit: Visualization: LIGO-Virgo-KAGRA / Aaron Geller
/ Northwestern}

{\centering \includegraphics{./Masses_of_Dead_Stars_LIGO_Virgo_KAGRA.png}

}

\end{figure}

Figure~\ref{fig-masses} shows the current library of compact binary
systems detected by \gls{ligo} -Virg-Kagra, along with those detected
through non-\gls{gw} means. The highlighted band denotes the assumed
mass gap that should exist between the neutron star and black hole mass
distributions. Note that most of the detections are compatible with the
presence of such a gap. However, there are a few detections that are
not, and these are particularly interesting. These are binaries with
masses too light to be black holes, but too heavy to be neutron stars. A
lot of research is ongoing to try and understand what these objects are,
and if they are not just measurement artefacts.

\hypertarget{lisa}{%
\subsection{\texorpdfstring{\gls{lisa}}{}}\label{lisa}}

There are many planned next generation \gls{gw} detectors, from the
Einstein telescope to Cosmic explorer. The most interesting one however
is \gls{lisa}, the first genuine space based \gls{gw} observatory. It is
a joint project between ESA and NASA, and is scheduled to launch in
2037. In Figure~\ref{fig-lisa} we see it will consist of three
satellites, in triangular formation, at a distance of 2.5 million
kilometers of each other. Each of the three \gls{lisa} spacecraft
contains a test mass free-falling within its body. Each spacecraft then
measures the distance to its neighboring test mass thus forming a space
based laser interferometer.

\begin{figure}

\sidecaption{\label{fig-lisa}Schematic of \gls{lisa} detector}

{\centering \includegraphics{./lisatrans.png}

}

\end{figure}

There are a few key differences with ground based detectors. The first
is the size of the arms means it will be sensitive to frequency ranges
such as:

\[
\brc{10^{-4},10^{0}}\text{ Hz}.
\]

This means that it will be sensitive to the most massive binaries in the
universe, supermassive black holes, such as those found at the centers
of galaxies.

The second is that it will be completely isolated from seismic activity,
and thus has a much lower noise floor. This combined with the arm length
means that \gls{lisa} is also predicted to be able to observe
\glspl{emri}, where stellar compact objects (\(<60 \stellarmass\)) orbit
around a massive black hole of around \(10^5 \stellarmass\) or more. In
this configuration the small mass is in a slowly decaying orbit, and
thus can spend around \(10^5\) orbits and between a few months and a few
years in the LISA sensitivity band before merging. This will provide us
with a very interesting new source of \gls{gw} , that also allows us to
test new approximations, such as those based on mass ratio expansions:
\gls{gsf} .

\hypertarget{matched-filtering}{%
\section{Matched filtering}\label{matched-filtering}}

The signals measured by the laser interferometers such as \gls{ligo} ,
provide a measurement of strain over time. This waveform essentially
measures the deformation of spacetime when a \gls{gw} passes through a
detector. While some \gls{gw} signals observed in laser interferometers
are clearly identified as such, mainly due to their extraordinary power
output, weaker signals are harder to identify. In fact, most of the
detections have happened under the noise floor of the detectors. How is
this possible? Matched filtering and waveform generation.

Consider some detector output signal \(s\) consisting of noise \(n\) and
a possible true \gls{gw} signal \(h_i\) (or signals, making up a family
\(\brk{h_i}\)). The nature of the noise is unpredictable and necessarily
probabilistic in nature. We can, however, model the noise as a random
variable \(n\) that follows a probability distribution \(P_n\) dependent
on variables that we consider and have measured to be significantly
impactful.

In such a probabilistic setup one could try to find the probability that
the signal \(h_i\in \brk{h_i}\) has been detected, conditional on the
actual data \(s\). This however is impractical as it requires \emph{a
priori} knowledge on the family of possible signals, information that is
inaccessible. Instead, we devise a functional
\(\mathcal{F}\brc{s,h_i}\), (a statistic) dependent on both the data and
the supposedly present \gls{gw} signal. We can then choose a threshold
\(\rho^*\) above which we claim detection of the signal \(h_i\), i.e.~if
\(\mathcal{F}\brc{s,h_i}>\rho^*\).

The functional that is used is defined in terms of the symmetric inner
product \(\ang{s,h_i}\), that correlates the data \(s\) with the
template \(h_i\), weighting by detector frequency sensitivity
\(S_n(f)\):

\[\ang{g,h}=2\int\limits_{-\infty}^{\infty}\frac{\conj{\ft{g}{2\pi f}}(f)\ft{h}{2\pi f}(f)}{S_n(\abs{f})}\dd{f}=4 \Re{\int\limits_{0}^{\infty}}\frac{\conj{\ft{g}{2\pi f}}(f)\ft{h}{2\pi}(f)}{S_n({f})}\dd{f},\]

where \(\conj{\ft{g}{2\pi}}\) is the conjugate of the frequency Fourier
transform of \(g\). \(S_n(f)\) is the \emph{noise power spectral
density}, characterising the detector sensitivity defined by:

\[
\overline{\conj{\ft{n}{2\pi f}}(f_1)\ft{n}{2\pi f}(f_2)}=\half \deltafn{f_1-f_2} S_n(f_1)\thetafn{f_1},
\]

where the bar denotes the average over the noise realisation,
\(\deltafn{f_1-f_2}\) is the Dirac delta function, and \(\thetafn{f_1}\)
is the Heaviside step function. We can now define the \emph{signal to
noise ratio} for the signal when filtered by \(h_i\) as \sidenote{\footnotesize The
  equality is due to the fact that we average over all realisations of
  noise, which averages to uniform:
  \(\overline{\ang{h_i,n}\ang{n,h_i}}=\ang{h_i,h_i}\).}

\[
\rho (s,h_i)=\frac{\ang{s,h_i}}{\operatorname{rms}\ang{n,h_i}}=\frac{\ang{s,h_i}}{\sqrt{\ang{h_i,h_i}}}.
\]

where \(\operatorname{rms}\) denotes the root-mean-square. This is the
functional \(\mathcal{F}\brc{s,h_i}\) we are after and we claim
detection if \(\rho(h_i)>\rho^*\). The functional
\(\mathcal{F}\brc{s,h_i}=\rho (s,h_i)\), provided that the noise is
normally distributed, is provably the optimal filtering technique, in
the sense that it minimizes the probability of false positives. For
example, if we have a fully Gaussian noisy signal \(s=n\) then \(\rho\)
is a normal variable with zero mean and unit variance. If a signal
\(h_i\) is present, over some again Gaussian noise \(n\), then it can be
proven that \(\rho\) is still normal but centered on
\(\sqrt{\ang{h_i,h_i}}\) with unit variance.

The threshold can be set to correspond to a desired false positive rate
\(\mathcal{F}\):\sidenote{\footnotesize The complementary error function is given by
  \(\operatorname{erfc}( z)=\frac{2}{\sqrt{\pi}} \int_z^{\infty} \exp{-t^2} \dd{t}=1-\operatorname{erf}( z).\)}

\[\mathcal{F}=\sqrt{\inv{2\pi}}\int\limits_{\rho^*}^{\infty} \exp{-\Half{\rho^2}}\dd{\rho}=\half \operatorname{erfc}(\frac{\rho^*}{\sqrt{2}}),\]

or correct detection rate \(\mathcal{D}\):

\[
\mathcal{D}=\Half\operatorname{erfc}\brc[\Big]{\frac{\rho^*- \sqrt{\ang{h_i,h_i}}}{\sqrt{2}}}.  
\]

Given a signal and a template, we have described a procedure to
determine if the signal is present or not. The physical output of a
detection is therefore bounded from above by the physics content of the
template. The matched filtering approach is contingent on having a
waveform that corresponds to the physical process that is emitting the
signal. Usually, these processes can be parametrized by a set of
parameter. In the case of a compact binary these parameters are for
example, the mass ratio of the binary, the orbit eccentricity, the
possible spin etc. The filter waveform must then naturally depend on
these parameters, be it heuristically or physically (i.e., from first
principles).

\hypertarget{pta}{%
\section{\texorpdfstring{\gls{pta}}{}}\label{pta}}

A \gls{pta} consists of an array of several pulsars whose pulse periods
(or \gls{toa} ) are monitored with very high precision by one or more
radio telescopes. Pulsars, from \textbf{pulsa}ting \textbf{r}adio
source, are though to be highly magnetized rotating neutron stars. These
neutron stars emit strong electromagnetic radiation from their magnetic
poles, which when not aligned with rotational poles, emit in the manner
of a lighthouse. The measured pulses are extremely regular in nature,
with periods ranging from a few milliseconds to a few seconds. Over a
year, the variation in the pulse period is on the order of a few
microseconds (\protect\hyperlink{ref-Detweiler:1979wn}{Detweiler 1979}).
We can therefor use pulsars as clocks, and infer their variation from
their normal cycle time. This methodology is shown in
Figure~\ref{fig-pta}.

\begin{figure}

\sidecaption{\label{fig-pta}How plusar timing arrays work}

{\centering \includegraphics{./ptatrans.png}

}

\end{figure}

\glspl{gw} propagating between the pulsar and the observer act as
anisotropic media. This will cause the pulse to be delayed or sped up,
depending on the relative direction of the wave, its polarisation axes
and the direction of the pulsar. Given a collection of such pulsars with
precisely known periods, evenly distributed in the celestial sphere,
then one can use the relative delay of the pulses to measure the
direction and nature of the wave. This setup is essentially a blown up
version of \gls{ligo} with light-year scale arms instead of kilometer
scale arms.

Currently, the set of pulsars suitable for this type of measurement is
around 40 (\protect\hyperlink{ref-Maiorano:2021}{Maiorano, De Paolis,
and Nucita 2021}). Many more pulsars have been measured but not all are
suitably regular to be used in \glspl{pta} . The frequency range of
sensitivity of \glspl{pta} has a lower bound set by observation duration
and higher bound set by cadence of measurement. Currently, the IPTA
Hobbs et al. (\protect\hyperlink{ref-Hobbs:2009yy}{2010}) has been
measuring for 13 years, with measurements being taken every week
yielding a sensitivity in a drastically different band than that of
\gls{ligo} and \gls{lisa} :

\[
\brc{10^{-9},10^{-7}}\text{Hz}.
\]

The nature of sources that can be detected by \glspl{pta} is therefore
different from that of \gls{ligo} and \gls{lisa}. The \gls{pta}
sensitivity is more suited to detect stochastic gravitational waves,
such as those emitted by early-universe phenomena, or by supermassive
black holes (\(10^6-10^9\stellarmass\)) in the centers of galaxies
\sidenote{\footnotesize more massive objects have longer orbital periods}.

\bookmarksetup{startatroot}

\hypertarget{sec-wfgen}{%
\chapter{Waveform Generation}\label{sec-wfgen}}

The matched filtering approach introduced in the previous section
motivates the development of tools for generating waveforms. The matched
filtering technique is especially sensitive to the phase of the \gls{gw}
, necessitating precise determination of the waveform template's phase.
These templates can be varied in physical content, but also in
practicality. In all cases they need to be able to cover the set of
parameters (the parameter space) that one is interested in exploring.
Clearly, if the waveform has been generated purely heuristically, then
the physical content of the detection is close to zero. From this
approach, one can only deduce that a phenomenon producing a similar
waveform was detected, but not much more. However, if the input
parameters are physically meaningful, e.g.~the mass ratio of a binary
compact inspiraling system, then the waveform constructed purely from
this input, if matched to the signal, tells us that a compact binary
inspiraling system with this mass ratio has been detected. This is
called parameter estimation, and is key to maximizing the physics output
of a detection.

Crucially, the waveform generation must be able to cover the whole
parameter space (for example all feasible mass ratios) to be useful, as
one does \emph{not} know in advance the parameters describing the system
to be identified. Ideally waveform generation should be done in a way
that is computationally efficient, as the number of parameters as well
as their range to explore is large. In the end, waveform generation is
currently performed in a hybrid way: some waveforms for specific
parameter space points, are generated from first principles, while the
rest of the parameter space waveforms are interpolated.

In this chapter we will describe the first-principles waveform
generation tools currently being developed. More specifically we will
explore techniques for compact binary waveforms. In this context
waveforms may describe inspiralling or scattering binaries. Currently,
only the inspiralling binaries have been detected, as these are the
systems whose signal \gls{ligo} and other detectors are most sensitive
to (see Section~\ref{sec-ligo}), other than being by far the most common
emitters of high-intensity \glspl{gw}. As discussed in
Section~\ref{sec-compactbinaries}, orbiting and \gls{gw} emitting
compact objects will necessarily inspiral and merge at some point.

For such inspiraling binaries, the waveform features 3 distinct phases
shown in : a first \emph{inspiral phase}, a \emph{merger phase} where a
remnant compact body is produced as a result of the coalescence of the
two objects, and a postmerger, or \emph{ringdown phase}, where the
remnant still emits gravitational radiation while settling to its new
stable configuration. Each phase is characterized by different dynamical
properties of the orbiting bodies and thus different frameworks are
aimed at describing the corresponding features of the waveforms. Even
the description of one phase involves different regimes, and thus more
specific framework, additionally dependent on the type/initial state of
the two orbiting bodies.

\begin{marginfigure}

\sidecaption{The different phases of an inspiraling binary. Source B. P.
Abbott et al. (\protect\hyperlink{ref-LIGOScientific:2016aoc}{2016})}

{\centering \includegraphics{./compactbin.png}

}

\end{marginfigure}

There is also hope to detect scattering binaries as argued in Mukherjee,
Mitra, and Chatterjee (\protect\hyperlink{ref-Mukherjee:2020hnm}{2021}),
but they are currently mainly used as a testbed for new theories making
use of particle physics knowledge. Additionally, one might be able to
extend their validity to inspiraling binaries (see
\protect\hyperlink{ref-Kalin:2019rwq}{Kalin and Porto 2020a}).

Most of these techniques have two important parts. The first consists in
the precise modelling of the evolution of the emitting system. In most
cases, this boils down to obtaining the \glspl{eom} for the interacting
bodies. For scattering, this can just be the amplitude of the event. The
second part is extracting the variation of the metric due to the source
movement at the measurement point, far away from the source, i.e., the
waveform. Of course, the metric at the source is tightly coupled to the
dynamics of the system, and thus the approximations conducted at the
source also effects the way one extracts the waveform.

The only full, first-principles waveform techniques are \gls{nr} and
\gls{eob} \sidenote{\footnotesize There are a whole family of phenomenological
  frameworks that we will not discuss}. \gls{nr} is quite unique when
compared to other methods. Let us look at it before proceeding to
\gls{eob} and all the inspiral waveform techniques.

\hypertarget{nr}{%
\section{\texorpdfstring{\acrlong{nr}}{}}\label{nr}}

The most precise, first-principles waveform-generation technique to date
is numerical relativity (\acrfull{nr}). It was developed as early as the
1960s (\protect\hyperlink{ref-hahn:1964}{Hahn and Lindquist 1964}).
Initially and until relatively recently, these numerical methods were
unusable because of numerical instabilities. The idea, however, is
simple: the \gls{efe} are a system of coupled partial differential
equations (PDEs) (albeit nonlinear) that can be solved numerically by
discretizing the metric. The causes of instability is three-fold. First,
the aforementioned non-linearities make the discretization particularly
sensitive to extreme variations, such as those close to a \gls{bh},
which means that one needs a fine mesh to control error buildup. Second,
the gauge freedom establishes limits on the type of discretization
procedures, so that spurious modes are not introduced. Third, for
\glspl{bh} one needs to consider what to do about the physical metric
singularity, as infinity is not a number one can plug into a computer!
On top of stability problems, when compact binary objects are
considered, the scales involved further complicate things, as one needs
enough resolution to resolve the objects, and the deformations on the
metric, as well as a large enough volume to have reasonable orbits. This
requires a huge amount of lattice nodes, meaning such simulations (even
if stable) are extremely computationally expensive.

In 2005 (Pretorious \protect\hyperlink{ref-Pretorius:2005gq}{Pretorius
2005}) and a little later (Campanelli et al.
\protect\hyperlink{ref-Campanelli:2005dd}{Campanelli et al. 2006}) made
a breakthrough advance and were able to fully compute an
inspiral-merger-ringdown sequence for a \gls{bbh} . Pretorius made use
of two techniques: \gls{amr} and the \gls{gh} formalism. \gls{amr} ,
like its name suggests, is a technique based on a dynamical
discretization procedure . The \gls{gh} formalism, tackles the
singularity problem validating the excision of the black hole, and
crucially letting that region move. The combination of the procedures,
were able to finally slay the proverbial numerical dragon.

These waveforms, such as the one in Figure~\ref{fig-pretwave}, confirmed
the predictions made in (Buonanno and Damour
\protect\hyperlink{ref-Buonanno:2000ef}{Alessandra Buonanno and Damour
2000}) that the merger phase of a \gls{bbh} would not be as complicated
as previously thought. As numerical techniques evolved further, they
were able to elucidate more and more complex behaviors.

\begin{figure}

\sidecaption{\label{fig-pretwave}The first \gls{nr} waveform, as
presented in Pretorius (\protect\hyperlink{ref-Pretorius:2005gq}{2005})}

{\centering \includegraphics{./pretwave.png}

}

\end{figure}

Nowadays, it is the gold standard of waveform generation. Of course, it
remains incredibly computationally expensive \sidenote{\footnotesize A single waveform
  with 10 orbits can take a week and tens of thousands of CPU hours} and
making any sizable bank of purely \gls{nr} waveforms is seen as a fools
endeavor. To date, only a couple hundred parameter space points have
been simulated. Consequently, \gls{nr} is used to complement, calibrate
and extend the other waveform generation techniques. For example to
detect the first signals \gls{ligo} and other detectors interpolated
between \gls{nr}-generated parameter space points to reach the ones
needed for detection. However, with the advent of \gls{lisa} on the
horizon, a further problem will arise. \gls{nr} results by nature only
take into account the last few orbit cycles before merger. Any more than
that and computational time becomes prohibitive. \gls{lisa}, with its
low noise floor, should be able to detect inspiraling but not yet
merging binaries. Doing so will require waveform templates with hundreds
of orbits, well out of reach of any modern \gls{nr} package.
Nonetheless, this technique has shown and will continue to show its
worth, as no approximations other than discretization are made. The
physical content of such waveforms is thus high.

\hypertarget{inspiral-methods}{%
\section{Inspiral methods}\label{inspiral-methods}}

Before continuing to the \gls{eob} method, let us look at the techniques
that focus on the inspiral part of the waveform. There are broadly
speaking three methods that fall in this category. The first we have
already encountered at 1st order: \gls{pn} . It is a perturbative
expansion in both relative velocity (slow moving limit) and the coupling
constant \(\grav\) (weak field limit) of the \gls{efe} . The second is
the \gls{pm} method, which is a perturbative expansion in \emph{only}
the coupling constant \(\grav\). At face value the \gls{pm} method
contains the \gls{pn} one as a special case, however as at zeroth order,
the \gls{pm} approximation captures straight line motion, and is
generally more expressive of scattering. The final approximation can be
applied when the mass ratio of the object in question is large. Here one
can expand around a fixed but \emph{non-flat} metric, essentially
considering one of the objects as a test-particle evolving on a
background caused by the heavier object. This is called the \gls{gsf}
formalism.

\hypertarget{pn}{%
\subsection{\texorpdfstring{\acrlong{pn}}{}}\label{pn}}

The \acrfull{pn} expansion, is a perturbative expansion of \gls{efe} in
the orbital regime, which at \gls{lo} reproduces Newtonian gravity.
Consider a system of orbiting bodies with typical values
\(\bar{M},\bar{R},\bar{v}\) for masses, separations, and velocities.
Then, the viral theorem states:

\begin{equation}\protect\hypertarget{eq-virial}{}{
\ang{T}_\tau=-\half \ang{U} \implies \quad \bar{M} \bar{v}^2\sim \frac{G \bar{M}^2}{\bar{R}}
}\label{eq-virial}\end{equation}

thus we can consider the following equivalent small parameters:

\[
\bar{v}^2\sim \frac{\grav \bar{M}}{\bar{R}}
\]

We therefore expand in both velocities and coupling constant. This can
be achieved either by a classical (albeit quite complicated)
perturbative treatment (see \protect\hyperlink{ref-Blanchet:2013haa}{Luc
Blanchet 2014}; \protect\hyperlink{ref-Blanchet:1995fg}{Luc Blanchet,
Damour, and Iyer 1995}), or a more contemporary \gls{eft}-based approach
coyly called \gls{nrgr}
(\protect\hyperlink{ref-Goldberger:2004jt}{Goldberger and Rothstein
2006}; \protect\hyperlink{ref-Sturani:2021xpq}{Sturani 2021}), itself
inspired by \gls{nrqcd} . We call \(n\)\gls{pm} the expansion carried
out to \(\order[2n]{v}\).

Regardless of method, there are a few shortcomings with this expansion.
While it is well suited to describe the \emph{motion} of objects in an
orbital regime, it is not equally effective at describing gravitational
radiation far from the source, as it exhibits divergences for
\(r\to\infty\)\sidenote{\footnotesize In HEP speak this is called an infrared
  divergence}. This means that in the \gls{gw} context, the \gls{pn}
expansion is in fact usually coupled to a weak-field approximation (see
below), outside the near zone. This is the region surrounding the
source, that is of small extent compared to the wavelength of the
emitted radiation:

\begin{equation}\protect\hypertarget{eq-nearzone}{}{
r \ll \lambda
}\label{eq-nearzone}\end{equation}

The \gls{pn} expansion can also be viewed as an expansion in small
`retardations'. To see this, consider a slowly moving source, such that
the time derivatives of the metric generated by this source will be
smaller than the spatial derivatives by a factor \(\order{v}\), \[
\frac{\partial}{\partial t}=\order{v} \frac{\partial}{\partial x^i},
\] or \(\partial_0=\order{\epsilon)} \partial_i\). Thus, the
d'Alembertian operator, applied to the metric is, to lowest order, a
Laplacian operator \[
-\frac{1}{c^2} \frac{\partial^2}{\partial t^2}+\nabla^2=\left[1+O\left(\epsilon^2\right)\right] \nabla^2 .
\]

This means that retardation effects, due to the time derivative, are
small corrections. In the \gls{pn} expansion we are consequently trying
to compute some quantity \(F(t-r)\), such as a component of the metric,
which is intrinsically a function of the retarded time \(t_r=t-r\), from
its expansion for small retardation \(r\), \[
F(t_r)=F(t)-{r} \dot{F}(t)+\frac{r^2}{2} \ddot{F}(t)+\ldots
\]

Importantly, the derivatives should bring down factors proportional to
frequency \(\Omega\) of the emitted radiation. Thus, this is in fact an
expansion in \(r \Omega\sim r / \lambda\), which is only valid in the
near zone as defined by eq.~\ref{eq-nearzone}, and breaks down outside
this zone, in the so-called \emph{radiation zone}. A serious consequence
of this fact is that the pure, naive \gls{pn} expansion is unable to
account for outgoing or incoming radiation, and thus unable to describe
isolated systems. This is where the \gls{pm} expansion comes in.

\hypertarget{pm}{%
\subsection{\texorpdfstring{\acrlong{pm}}{}}\label{pm}}

\begin{figure}

\sidecaption{\label{fig-pnpm}Comparison of \gls{pm} and \gls{pm}
expansions, with currently attained orders encircled, and highlighted in
red is the result of Z. Bern et al.
(\protect\hyperlink{ref-Bern:2019crd}{2019}). Source Z. Bern et al.
(\protect\hyperlink{ref-Bern:2019crd}{2019})}

{\centering \includegraphics{./PMPNtrans.png}

}

\end{figure}

The \acrfull{pm} expansion is a weak field expansion of \gls{efe}, in
the coupling constant \(\grav\). It thus covers all orders in velocity
of the \gls{pn} expansion, at any fixed \(\grav\) order, see
Figure~\ref{fig-pnpm}. We usually call \(nPM\) the corresponding
\(\order[n]{\grav}\)-truncated expansion. Historically, it was derived
with the objective of being the radiation zone partner to the \gls{pn}
expansion, as it provides a description of the propagation of the waves
up to the observer. When used with the \gls{pn} expansion in such a way,
the \gls{pm} expansion is used to solve the vacuum \gls{efe} . It is
usually set up to compute a version of the metric perturbation that is
exact:\sidenote{\footnotesize We have used \(\weakmet\) to denote the linear
  perturbation, whereas \(\pertmet\) is the all order metric
  perturbation.}

\[\pertmet=\sqrt{-\metricTensor} \invmet-\invmink.\]

The \gls{pm} expansion is then given as

\[
\sqrt{-\metricTensor} \invmet=\invmink+ \grav \invpertnmet{1}+\grav^2 \invpertnmet{2}+\ldots,
\]

meaning that: \[
\invpertmet=\sum\limits_{n=1}^{\infty} \grav^n \invpertnmet{n} .
\]

The \gls{efe} for this metric perturbation, when imposing De-Donder
gauge conditions (eq.~\ref{eq-dedonder}), is given by

\begin{equation}\protect\hypertarget{eq-relEFE}{}{
\SRDA \invpertmet=-16 \pi \grav \invpertmet \relSEct .
}\label{eq-relEFE}\end{equation}

where \(\relSEct\) is the effective energy-momentum tensor given by:

\[
\relSEct=(-\metricTensor)\SEct -\inv{16 \pi \grav}\ct[\mu\nu]{\Lambda}.
\]

\(\ct[\mu\nu]{\Lambda}\) contains all non-linear terms of the Einstein
tensor, and its definition can be obtained by comparing with
eq.~\ref{eq-EFE}. Thus, it depends on the metric and thus on
\(\pertmet\) in a highly non-linearly fashion. We can write it as:

\[
\ct[\mu\nu]{\Lambda}=\ct[\mu\nu]{L}[\pertTensor,\pertTensor]+\ct[\mu\nu]{M}[\pertTensor,\pertTensor,\pertTensor]+\ct[\mu\nu]{N}[\pertTensor,\pertTensor,\pertTensor,\pertTensor]+\order[5]{\pertTensor}.
\]

Here the number of \(\pertTensor\)'s in the argument of \(L,M\) and
\(N\) indicates the order of the non-linear term. In a vaccuum
eq.~\ref{eq-relEFE} reduces to

\[
\SRDA \invpertmet=\ct[\mu\nu]{\Lambda},
\]

which we can solve iteratively order by order:

\[
\begin{aligned}
\SRDA \invpertnmet{1}&=0,\\
\SRDA \invpertnmet{2}&=\ct[\mu\nu]{L}[\pertnTensor[1],\pertnTensor[1]],\\
\SRDA \invpertnmet{3}&=\ct[\mu\nu]{M}[\pertnTensor[1],\pertnTensor[1],\pertnTensor[1]]+\ct[\mu\nu]{L}[\pertnTensor[1],\pertnTensor[2]]++\ct[\mu\nu]{L}[\pertnTensor[2],\pertnTensor[1]]\\
\end{aligned}
\]

This method can be supplemented by a multipolar expansion of the
\(\invpertnmet{n}\), truncated to the specific \gls{pm} order we are
interested in. This combined expansion was pioneered by (Bonnor and
Rosenhead \protect\hyperlink{ref-Bonnor:1959}{Bonnor and Rosenhead
1959}), then formalised by (Thorne
\protect\hyperlink{ref-Thorne:1980ru}{Thorne 1980}), and finally applied
in this present context by (Blanchet
\protect\hyperlink{ref-Blanchet:1986}{L. Blanchet and Damour 1986}).

In terms of source dynamics, it is more appropriate (and uniquely able)
to describe inherently relativistic phenomena, such as gravitational
scattering. Its wider scope of applicability comes at the cost of a
higher computational complexity, as at higher orders one encounters
intricate families of relativistic integrals. Note that we have in fact
computed the 1 \gls{pm} approximation already in the
Chapter~\ref{sec-gwdetect} when we linearized the \gls{efe}. Higher
orders are far more difficult to obtain, especially for sources such as
\gls{bbh}.

With the rise of amplitude techniques from high energy physics, both
\gls{eft} and full theory results have been successful in extracting
previously unreachable orders. Such techniques are perfectly suited to
compute relativistic scattering as they were developed for this specific
task. We will see this in the next chapter.

\hypertarget{eob}{%
\section{\texorpdfstring{\acrlong{eob}}{}}\label{eob}}

The second full-waveform generation technique is the \acrfull{eob}
formalism. It was initially developed by (Buonanno and Damour
\protect\hyperlink{ref-Buonanno:1998gg}{A. Buonanno and Damour 1999}),
as a non-perturbative re-summing of the \gls{pn} expansion. It was later
extended to include the merger and ringdown effects in (Buonanno and
Damour \protect\hyperlink{ref-Buonanno:2000ef}{Alessandra Buonanno and
Damour 2000}) and one can see the produced waveform in @. Thus, it
became the first full waveform generating technique to actually produce
a waveform. It has gotten progressively more powerful, as the \gls{pn}
expansions have gotten better. More recently \gls{pm} results have also
been included Damour (\protect\hyperlink{ref-Damour:2016gwp}{2016}).
Additionally, \gls{eob} can be combined with \gls{nr} to produce a very
accurate waveform, with less computational overhead than \gls{nr} alone.

\begin{marginfigure}

\sidecaption{\label{fig-firsteob}First full \gls{eob} waveform, from
Alessandra Buonanno and Damour
(\protect\hyperlink{ref-Buonanno:2000ef}{2000})}

{\centering \includegraphics{./firsteob.png}

}

\end{marginfigure}

As its name suggests, the \gls{eob} framework combines all the \gls{pn},
\gls{pm} and \gls{nr} data into a Hamiltonian describing the motion of a
single body. It is inspired by solutions of two-body problems in
Newtonian gravity which make use of barycentric coordinates to turn it
into a one body problem. Further inspiration came from the two body
problem in \gls{qed} (see \protect\hyperlink{ref-Brezin:1970zr}{Brezin,
Itzykson, and Zinn-Justin 1970}) .

Consider two bodies, with masses \(\mass[1]\) and \(\mass[2]\),
positions \(\tv[1]{q}\), \(\tv[1]{q}\) and momenta \(\tv{\emom[1]}\) and
\(\tv{\emom[2]}\) respectively. The system can be described by the
following Hamiltonian:

\[
\ham[\text{newton}]{\tv[1]{q},\tv[1]{q}}{\tv{\emom[1]},\tv{\emom[2]}}= \frac{\tv{\emom[1]}^2}{2\mass[1]}  + \frac{\tv{\emom[2]}^2}{2\mass[2]}  - \frac{G\mass[1]\mass[2]}{\abs{\tv[1]{q}-\tv[1]{q}}}
\]

One then transforms this Hamiltonian into one describing the relative
motion \(\tv{q}=\tv[1]{q}-\tv[1]{q}\). One can formalize this by
defining a new set of generalized coordinates, through a canonical
transformation. We can go even further and employ a generating function
for the transformation, ensuring that Hamilton's equations remain
unchanged in form (see Goldstein, Poole, and Safko
(\protect\hyperlink{ref-Goldstein:2002}{2002})). To describe relative
motion, we use Jacobi coordinates \((\tv{Q},\tv{q})\):
\begin{equation}\protect\hypertarget{eq-jacobi2}{}{
\begin{pmatrix} \tv[1]{q} \\ \tv[2]{q}\end{pmatrix}\to \underbrace{\begin{pmatrix} \frac{\mass[1]}{\totmass} & \frac{\mass[2]}{\totmass} \\ 1&-1 \end{pmatrix}}_{=A} \begin{pmatrix} \tv[1]{q} \\ \tv[2]{q}\end{pmatrix}=\begin{pmatrix} \tv{Q} \\ \tv{q}\end{pmatrix}
}\label{eq-jacobi2}\end{equation}

If we now define the following generating function for the
transformation, depending on the old positions coordinates \(\tv[i]{q}\)
and the new momenta \(\tv[i]{P}\): {\marginnote{\begin{footnotesize}Note
the use of Einstein summation\end{footnotesize}}}

\begin{equation}\protect\hypertarget{eq-genfunc}{}{
f_{II}(\tv[i]{q},\tv[i]{P})=\tv[i]{P}A^{ij}\tv[j]{q},
}\label{eq-genfunc}\end{equation}

then the old momenta are given by

\begin{equation}\protect\hypertarget{eq-momtrans}{}{
\tv{\emom[i]}=\pdv{f_{II}}{\tv[i]{q}}=\tv[i]{P} A^{ij} \iff \tv[i]{P}=[A^{-1}]{}^{ij}\tv{\emom[j]}.
}\label{eq-momtrans}\end{equation}

Where we can directly invert this equation and obtain the new momenta
as:

\[
  \begin{pmatrix} \tv{P} \\ \tv{p}\end{pmatrix}=\begin{pmatrix} \tv[1]{P} \\ \tv[2]{P}\end{pmatrix}=\begin{pmatrix} 1&1\\ \frac{\mass[2]}{\totmass} & -\frac{\mass[1]}{\totmass} \end{pmatrix} \begin{pmatrix} \tv{\emom[1]} \\ \tv{\emom[2]}\end{pmatrix}
\]

As expected, we obtain that one of the momenta describes the center of
mass momentum \(\tv{P}=\tv{\emom[1]}+\tv{\emom[2]}\). The other
positions are by construction given by
\(\pdv{f_{II}}{\tv[1]{q}}=\tv{Q}\) and
\(\pdv{f_{II}}{\tv[2]{q}}=\tv{q}\) i.e the same as equation
eq.~\ref{eq-jacobi2}. Finally the new Hamiltonian
\(\ham[\text{rel}]{\tv{Q},\tv{q}}{\tv{P},\tv{p}}\) can be directly
obtained from the generating function:\sidenote{\footnotesize We just plug in the
  definition of the old momenta in terms of the new
  (eq.~\ref{eq-momtrans}):
  \[ \tv{\emom[1]}=\frac{\mass[1]}{\totmass} \tv{P} + \tv{p},\]
  \[ \tv{\emom[2]}=\frac{\mass[2]}{\totmass} \tv{P} - \tv{p}.\]}

\[
\ham[\text{rel}]{\tv{Q},\tv{q}}{\tv{P},\tv{p}}=\ham[\text{newton}]{\tv{Q},\tv{q}}{\tv{P},\tv{p}}+\cancelto{0}{\pdv{f_{II}}{t}}= \frac{\tv{P}^2}{2\totmass}  + \frac{\tv{p}^2}{2\redmass}  - \frac{G\mass[1]\mass[2]}{\abs{\tv{q}}},
\]

where \(\totmass = \mass[1] + \mass[2]\) is the total mass, and
\(\redmass = \frac{\mass[1]\mass[2]}{\totmass}\) is the reduced mass. If
we change coordinates to a frame where the \(\tv{Q}\) is at rest,
i.e.~\(\tv{P}=0\), the Hamiltonian collapses to a one body Hamiltonian.
The two-body problem we started with can now be though of as the one
body problem of a test-particle of mass \(\redmass\) orbiting an
external mass \(\totmass\).

In Newtonian gravity, a small change of coordinates makes the two body
problem exactly solvable. In much the same way, \gls{eob} generalizes
this framework to general relativity. The defining trick used above is
to transform to `better' coordinates. A first step is to demand that for
straight line motion the \gls{com} energy
\(E_{\text{\small COM}}=\ct[0]{P}\), where \(P\) it the 4-momentum of
the entire-system, is equal to the Hamiltonian. We then have:\sidenote{\footnotesize In
  the \gls{com} frame, the spatial part of the total momentum is zero
  (by definition), and thus we have: \[
  \co[0]{P}^2=P^2=(\emom[1]+\emom[2])^2=\emom[1]^2+\emom[2]^2+2\emom[1]\cdot\emom[2].
  \]}

\[
\mathcal{H}=\sqrt{\totmass^2(1+2\symmratio(\lorentzfactor-1))},
\]

where \(\symmratio=\frac{\redmass}{\totmass}\) is the symmetric mass
ratio, and
\(\lorentzfactor=\frac{1}{\sqrt{1-{v^2}}}=\frac{\ct{\emom[1]}\co{\emom[2]}}{\mass[1]\mass[2]}\)
is the relative Lorentz-factor. Note that for non-interacting systems we
have \(\co{\emom}\ct{\emom}=\redmass^2\) and we can define the effective
Hamiltonian:

\begin{equation}\protect\hypertarget{eq-straightheff}{}{
\Heff=\ct[0]{\emom}=\sqrt{\redmass^2+\tv{\emom}^2} = \redmass \lorentzfactor.
}\label{eq-straightheff}\end{equation}

We can substitute this into the Hamiltonian above, and add back a
generic system momentum \(\tv{P}\) and obtain

\[
\Heob=\sqrt{\totmass^2(1+2\symmratio(\frac{\Heff}{\redmass}-1))+\tv{P}^2}
\]

This Hamiltonian (with \(\Heff\) given by eq.~\ref{eq-straightheff}) now
describes straight line motion in a relativistic framework. The key
point is that we can take \(\Heff\) to be a gravitational test mass
Hamiltonian, with some specific deformations and this will match the
\gls{pn} result. Consider a test mass in a Schwarzschild background
eq.~\ref{eq-Schwarzschild}, i.e.~we consider the case of non-spinning
black holes. We can start from the reduced-mass shell expression:

\begin{equation}\protect\hypertarget{eq-schwarzmassshell}{}{
\invmet \ct{\emom}\ct[\nu]{\emom} =- \redmass^2
}\label{eq-schwarzmassshell}\end{equation}

where \(\invmet\) is given by eq.~\ref{eq-Schwarzschild}, where we can
set \(\theta=\Half{\pi}\) to fix the orientation \sidenote{\footnotesize This is
  always possible through a change of variables.}. Just as before, the
effective Hamiltonian is the 0th component of the momentum, which is
implicitly given by eq.~\ref{eq-schwarzmassshell}:

\[
\mathcal{H}_S=\sqrt{A_S(\redmass^2+A_S\emom[r]^2+\frac{L^2}{r^2})},
\]

where \(A_S=\frac{1}{1-R_S/r}\), \(\emom[r]\) and \(L=\emom[\phi]\) are
the radial and angular momentum respectively. We then allow deformations
from this Hamiltonian defining

\[
\Heff(r,\emom[r],\phi,L) = \sqrt{A (\redmass^2+A \bar{D} \emom[r]^2+\frac{L^2}{r^2})+Q},      
\]

where \(A,\bar{D},Q\) are the so-called \gls{eob} potentials.
\(A,\bar{D}\) correspond to the radial potentials of the effective
metric, while \(Q\) contains terms quadratic in the momentum. We can
then match these to \gls{pn} results, by matching observables.

This is more than a neat trick as this Hamiltonian, when well-matched,
fits the gold standard \gls{nr} result up to the merger, well out of the
\gls{pn} regime. Crucially, this Hamiltonian framework does not take
into account radiation reaction by construction since it is based on
conserved energy. These dissipative effects are included after the fact,
as friction terms in the \gls{eom}. The usual conservative \gls{eom} is
straightforwardly obtained through Hamilton's equations:

\[
\begin{aligned}
\dot{r}&=\pdv{\Heff}{\emom[r]},\quad \dot{\emom[r]}=- \pdv{\Heff}{r}\\
\omega=\dot{\phi}&=\pdv{\Heff}{L},\quad \dot{L}= \cancelto{0}{- \pdv{\Heff}{\phi}}.
\end{aligned}
\]

Note that, as expected, the angular momentum is conserved. We will now
spoil this conservation, by adding friction forces, also called
radiation reaction forces to the \glspl{eom} governing radial and
angular momentum dynamics:

\[
\begin{aligned}
\dot{\emom[r]}&=- \pdv{\Heff}{r} +f_r,\\
\dot{L}&=f_\phi.
\end{aligned}
\]

We can now express the energy loss:

\[
\dot{E}=\odv{\Heff}{t}=\pdv{\Heff}{r}\dot{r}+\pdv{\Heff}{\emom[r]}\dot{\emom[r]}+\pdv{\Heff}{L}\dot{L}=f_r\dot{r}+f_\phi\omega.
\]

Such dissipative effects are accounted for by matching to \gls{pn}
results for the angular momentum and energy fluxes, which are given by
the so called balance laws:

\[
\begin{aligned}
\ang{\mathcal{F}_L}&=-\ang{\dot{L}}=-\ang{f_\phi},\\
\ang{\mathcal{F}_E}&=-\ang{\dot{E}}=-\ang{f_r\dot{r}+f_\phi \omega}.
\end{aligned}
\]

We have denoted averaging with angle brackets. With this we obtain as
full of a picture of the inspiral as possible given the inputs, namely
\gls{pn} . The matching can also be done with \gls{pm} and \gls{nr}
results, further increasing the validity and precision of \gls{eob} . Of
course, we are still missing the merger and ringdown phases. The merger,
or plunge was predicted in Alessandra Buonanno and Damour
(\protect\hyperlink{ref-Buonanno:2000ef}{2000}) to be simply the peak in
the waveform. This waveform is connected smoothly to a ringdown
waveform, defined by a sum of quasi-normal modes of the remnant after
merger. Thus, one obtains a sort of Frankenstein waveform, pooling
resources from \gls{pn} , \gls{pm} , \gls{nr} and \gls{bh} perturbation
theory. Importantly, when well-matched, this waveform is almost as
accurate as \gls{nr} results, but with the added benefit of being able
to be computed in a reasonable amount of time. Of course, it is still
only as powerful as the inputs to which we match, namely the \gls{pn} or
\gls{pm} results. We will explore how to compute \gls{pm} results using
amplitudes in the next section.

\bookmarksetup{startatroot}

\hypertarget{sec-scat}{%
\chapter{\texorpdfstring{Scattering amplitudes and
\gls{gw}s}{Scattering amplitudes and }}\label{sec-scat}}

Whilst we have almost no hope to detect any \gls{gw} scattering events
with current experimental apparatuses, the scattering formalism can
still be very useful in the quest for orbital waveforms. Most
importantly, while experimental data has not been driving
\emph{gravitational} scattering theory, the interplay between
\emph{particle} scattering experiment and theory have been an enormously
fruitful endeavor for the understanding of fundamental interactions in
\gls{hep}. The back and forth between precise measurements (such as
those conducted at the \gls{lhc} ) and precise predictions for particle
scattering, has pushed the boundaries of the calculations possible. It
would be therefore very beneficial if one could apply the large
knowledge acquired for small non-gravitationally interacting particles,
to large compact orbiting bodies. We will see that it is indeed the
case.

Such techniques including \gls{eft}, double copy, generalized unitarity,
\gls{ibp} reduction, differential equations methods, developed in the
context of perturbative computations of collider observables now find an
application to the scattering problem in gravity. A key part of applying
tools originally developed for quantum systems to problems in gravity is
controlling the classical limit, a historically difficult endeavor. Once
scattering data is obtained, one needs to extract the relevant
observables. This may be in an effort to compare results from the
different methods, in which case gauge and diffeomorphism, and Lorentz
invariance are key, since different methods make different gauge and
frame choices. It can also be to extract the relevant information for
detection and data extraction, in which case the \gls{gw} waveform is
the relevant observable. In the latter case one is mostly interested in
the orbital waveform, and thus a map from unbound to bound orbits is
necessary.

Multiple formalisms have arisen to map the scattering problem to an
orbital one, and the quantum formalism to a classical one. One key way
is to map scattering data to a potential (as present in a Hamiltonian
for example). In fact this has been developped as early as the 1970s in
(\protect\hyperlink{ref-Hiida:1972xs}{Hiida and Okamura 1972};
\protect\hyperlink{ref-Iwasaki:1971vb}{Iwasaki 1971}). Further
developments happened in (\protect\hyperlink{ref-Neill:2013wsa}{Neill
and Rothstein 2013};
\protect\hyperlink{ref-Bjerrum-Bohr:2013bxa}{Bjerrum-Bohr, Donoghue, and
Vanhove 2014}; \protect\hyperlink{ref-Vaidya:2014kza}{Vaidya 2015};
\protect\hyperlink{ref-Cachazo:2017jef}{Cachazo and Guevara 2020};
\protect\hyperlink{ref-Guevara:2017csg}{Guevara 2019};
\protect\hyperlink{ref-Damour:2016gwp}{Damour 2016}). Here we will
follow the treatment in (Cheung, Rothstein, and Solon
\protect\hyperlink{ref-Cheung:2018wkq}{Cheung, Rothstein, and Solon
2018}), where the conservative part of such scattering amplitudes is
matched to an \gls{eft} and subsequently to mapped to a potential.
Recent efforts to add dissipative effects have also been successful (see
\protect\hyperlink{ref-Kalin:2022hph}{Kälin, Neef, and Porto 2022}).
This potential can then be used as input to the \gls{eob} formalism.
Furthermore, (Kalin and Porto
\protect\hyperlink{ref-Kalin:2019rwq}{Kalin and Porto 2020a},
\protect\hyperlink{ref-Kalin:2019inp}{2020b}), have shown a path forward
in directly extending unbound data to bound orbits, obviating the need
to use a potential and \gls{eob} at all.

Finally, as mentioned in the last chapter, scattering can stand on its
own and still be useful without being extended to the orbital case. The
\gls{pm} approximation can be computed from scattering amplitudes in an
\gls{eft} framework (\protect\hyperlink{ref-Kalin:2020mvi}{Kälin and
Porto 2020}). We can also explore the classical observables possible in
scattering scenarios. This has been developed in Kosower, Maybee, and
O'Connell (\protect\hyperlink{ref-Kosower:2018adc}{2019}) and was
extended to local observables \sidenote{\footnotesize local as in not time integrated
  and thus presenting time dependent dynamics} such as waveforms in
Cristofoli et al. (\protect\hyperlink{ref-Cristofoli:2021vyo}{2022}).

In this chapter we will first look at how to use amplitude data to
extract orbital and scattering waveforms. We will then look at the
\gls{kmoc} formalism to directly extract observables. Finally, we will
look at how to compute amplitudes, and comparing to results such as
those in (\protect\hyperlink{ref-Kosower:2018adc}{Kosower, Maybee, and
O'Connell 2019}; \protect\hyperlink{ref-Bern:2021xze}{Zvi Bern et al.
2022}).

\hypertarget{sec-scatamp}{%
\section{Scattering amplitudes}\label{sec-scatamp}}

In \gls{qft}, to date the only way to encode scattering data is through
a scattering amplitude. Consider a process where one starts out with a
set of particles described by a state \(\ket{i}\), that interact, and
yield a final state \(\ket{f}\). The scattering amplitude is then
defined as the probability amplitude for this process to occur. It is
simply given by
\[\mel{i}{\Smat-1}{f}=(2\pi)^4 \deltafn[(4)]{p_f-p_i}\im \ampl_{fi},\]

where \(\Smat\) is the S-matrix, encoding asymptotic time evolution,
\(\Smat=U_t(-\infty,+\infty)\). We subtract the identity from it,
forming what some call the transfer matrix \(\Tmat\), as we only are
interested in processes where something happens (i.e.~not everything
stays the same). In the above equation we also define the
\emph{scattering matrix element} \(\ampl_{fi}\) (see
\protect\hyperlink{ref-Srednicki:2007}{Srednicki 2007, 76}) or
\emph{invariant Feynman amplitude} (see
\protect\hyperlink{ref-Coleman:2018a}{Coleman 2018, 214}), by factoring
out a normalized spacetime delta-function that impose the conservation
of momentum on the external particles, and a complex unit. The
computation of \(\ampl\) is made possible by the \gls{lsz}
(\protect\hyperlink{ref-Lehmann:1954rq}{Lehmann, Symanzik, and
Zimmermann 1955}; \protect\hyperlink{ref-Collins:2019ozc}{Collins 2019})
formalism, which relates \(\ampl_{fi}\) to time-ordered correlation
functions (also known as Green's functions) of the given QFT. Green's
functions, can be expanded as an infinite sum of diagrams, weighted by a
small coupling. The diagrams encode integrals that are obtained by
applying Feynman rules which can be readily extracted from an action
describing the theory.

\hypertarget{sec-amp2pot}{%
\section{From amplitude to potential}\label{sec-amp2pot}}

Let us now look at how to map the amplitude to the gravitational
potential within the \gls{eob} formalism. We will follow the treatment
in Cheung, Rothstein, and Solon
(\protect\hyperlink{ref-Cheung:2018wkq}{2018}). We start by defining the
effective theory that describes our problem: thi orbiting bodies are
described by two scalar fields \(\wf[1]\) and \(\wf[2]\) with masses
\(\mass[1]\) and \(\mass[2]\) interacting through a long range potential
\(V(r)\). It is the \gls{eft} for non-relativistic fields. This
\gls{eft} is described by the following action

\[
\action=\int \dd{t} \lag[kin]+\lag[int],
\]

where the kinetic term is given by:

\[
\begin{aligned}
\lag[kin]=&\int \dn[\small \Dim-1]{\tv{k}} \cwf[1](-\tv{k}) \pa[\Big]{\im \partialder[t]-\sqrt{\tv{k}^2+\mass[1]} }\wf[1](\tv{k}),
\\
&+\int \dn[\small \Dim-1]{\tv{k}} \cwf[2](-\tv{k}) \pa[\Big]{\im \partialder[t]-\sqrt{\tv{k}^2+\mass[2]} }\wf[2](\tv{k}),
\end{aligned}
\]

and the interaction term is given by

\[
\lag[int]=  -\int \dn[\small \Dim-1]{\tv{k}} \dn[\small \Dim-1]{\tv{k'}} \pot(\tv{k},\tv{k'}) \cwf[1](\tv{k'}) \cwf[2](-\tv{k'}) \wf[1](\tv{k}) \wf[2](- \tv{k}).
\]

This theory is obtained from the full one by integrating out all the
massless force carriers , which are consequently encoded in the
potential \(\pot(\tv{k},\tv{k'})\) and taking the non-relativistic limit
\(\abs{\tv{k}},\abs{\tv{k'}}\ll \mass[1,2]\). In a classical system we
assume the particles to be separated by a minimum distance, called
impact parameter \(\abs{\tv{\impactParameter}}\), and consider that
their Compton wavelength
\(\comptlen\sim\inv{\abs{\tv{k}}},\inv{\abs{\tv{k'}}}\)\sidenote{\footnotesize Note
  the use of natural units.} is much smaller than this separation,

\[
\abs{\tv{\impactParameter}}\ll \comptlen \simeq \inv{\abs{\tv{k}}},\inv{\abs{\tv{k'}}}.
\]

This ensures that the particles are not interacting quantum mechanically
in any significant way. Interestingly this hierarchy of scales can be
rewritten as:

\[
\tv{J}\sim\abs{\tv{k}\times\tv{\impactParameter}}\gg 1.
\]

Thus, any two body classical system has large angular momentum. We can
extract the classical part of any quantity by taking the \gls{lo}
contribution in the inverse of the angular momentum, or equivalently:

\begin{equation}\protect\hypertarget{eq-invang}{}{
  \inv{J} \propto \inv{\abs{\impactParameter}} \sim \abs{\tv{k}-\tv{k'}}\propto \inv{\kappa},
}\label{eq-invang}\end{equation}

where \(\kappa\) is the coupling constant, which in the case of gravity
is \(\kappa=4\pi\grav\). For the first relation we used that angular
momentum is proportional to separation. We then applied the fact that in
scattering scenarios the impact parameter is proportional to the inverse
of the momentum transfer \(\sim\inv{\abs{\tv{q}}}\) where :

\[
q=(0,\tv{q})=(0,\tv{k}-\tv{k'}).
\]

The last relation in eq.~\ref{eq-invang} holds due to the virial
theorem. Since the potential must encode the coulomb potential
\(\kappa/\abs{\tv{k}-\tv{k'}}^2\propto J^3\), it must scale similarly.
We thus formulate the following ansatz for the potential:
\begin{equation}\protect\hypertarget{eq-ansatzpot}{}{
\pot(\tv{k},\tv{k'})=\sum_{n=1}^\infty \frac{\kappa^n}{\abs{\tv{k}-\tv{k'}}^{\Dim-1-n}} c_n\pa[\Big]{\frac{\tv{k}^2+\tv{k'}^2}{2}}
}\label{eq-ansatzpot}\end{equation}

Note that higher order terms in the potential could be formed by any
polynomial of momentum invariants \(\tv{k}^2\), \(\tv{k'}^2\), and
\(\tv{k}\cdot\tv{k'}\). However, not all combinations of these are
independent. The ansatz is chosen such that only the variables
\(\abs{\tv{k}-\tv{k'}}\) and \(\tv{k}^2+\tv{k'}^2\) are present, as the
others can be reabsorbed by field redefinitions, or vanish on-shell,
such as \(\tv{k}^2-\tv{k'}^2\). Note as-well that we work in
\(\Dim=4-2\dimreg\) dimensions such that the integrals are dimensionally
regulated (see \protect\hyperlink{ref-tHooft:1972tcz}{'t Hooft and
Veltman 1972}). In particular an \(\dimreg\)-power corresponds to a
logarithm \sidenote{\footnotesize The third term in the sum is given by
  \(\coupling^3\ln{\tv{k}-\tv{k'}}^2 c_3\pa[\Big]{\Half{\tv{k}^2+\tv{k'}^2}}\).}.
Finally, note that in gravity this is precisely a \gls{pm} expansion!

\hypertarget{eft-amplitude}{%
\subsection{EFT amplitude}\label{eft-amplitude}}

The first step in establishing determining the potential from a generic
scattering amplitude computed in the full theory is to compute the
amplitude in the \gls{eft}. We first identify the Feynman rules from the
action. The kinetic term encodes the propagator:

\hypertarget{fig-propagator}{}
{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\input{./tikz/propagator.tex}

\label{fig-propagator}Propagator rule

}

where the \(\im 0\) is the Feynman prescription for avoiding the poles.
The interaction term is encoded in the vertex

\hypertarget{fig-vertex}{}
{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\input{./tikz/vertex.tex}

\label{fig-vertex}Vertex rule

}

The expression for the \gls{eft} amplitude will contain the coefficient
functions from eq.~\ref{eq-ansatzpot} since they will be present as
vertex terms. Particle number must be conserved in the non-relativistic
limit \sidenote{\footnotesize As pair production is kinematically forbidden.}, so the
amplitude is a sum of bubble diagrams:

\hypertarget{fig-eftampl}{}
{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\input{././tikz/eftampl.tex}

\label{fig-eftampl}EFT amplitude

}

We can consequently neatly organize the amplitude into a sum of terms
with specific loop counts. We can also equivalently organize it into a
sum of terms with specific \(\coupling\) powers. We write,

\[\ampl_\text{EFT}=\sum\limits_{L=0}^\infty\ampl[L\text{loop}]_\text{EFT}=\sum\limits_{i=1}^\infty \ampl[(i)]_\text{EFT}.\]

Notably, these partitions do not line up for the \gls{eft} since the
vertex contains all powers of the coupling. This is in contrast to the
full theory where in fact they yield the same partition. We will
eventually want to partition over the coupling power to compare the full
theory.

Since every cut of the diagrams contributing to \(\ampl_\text{EFT}\)
contains two propagators, it is useful to define a 2-body propagator. We
can integrate over the energy components of the loop momentum, since the
vertex does not have an energy dependence:\sidenote{\footnotesize The 4-momentum
  conservation at each vertex means that the energy components of the
  two propagating momenta must carry along the energy component of the
  initial state \(\energy=\energy[1]+\energy[2]\). This can be encoded
  by demanding that \(\omega_1+\omega_2=\energy\). Taking the \gls{com}
  frame for the initial momenta means that the 3 momenta of each
  propagator must cancel i.e.~\(\tv[1]{k}+\tv[2]{k}=0\)}

\[\im \proptwobody{\tv{k}}=\int \dn{\omega} \frac{\im}{\omega-\sqrt{\tv{k}^2+m_1^2}}\frac{\im}{\energy-\omega-\sqrt{\tv{k}^2+m_2^2}}=\frac{\im}{\energy-\sqrt{\tv{k}^2+\mass[1]^2}-\sqrt{\tv{k}^2+\mass[2]^2}},\]

where the integral is performed using the residue theorem, closing the
contour in either half plane, where in either case a pole is present. We
have define \(\energy=\energy[1]+\energy[2]\) to be the \gls{com} energy
of the two initial states:\sidenote{\footnotesize which is equal to the outgoing
  energy}

\[
\energy[i]=\sqrt{\tv{p}^2+\mass[i]^2}=\sqrt{\tv{p'}^2+\mass[i]^2},
\]

where \(\tv{p}\) and \(\tv{p'}\) are the initial and final three-momenta
of the two states \sidenote{\footnotesize For example in the initial state one scalar
  field will have 3-momentum \(\tv{p}\), and the other \(-\tv{p}\)} in
the \gls{com} frame. Finally, we can write the diagram at loop level
\(L>0\) encodes:

\[ 
\ampl[L\text{loop}]_\text{EFT}= \int\prod\limits_{i=1}^L  \dn[\small \Dim-1]{\tv[i]{k}} \pot(\tv{p},\tv[1]{k})\proptwobody{\tv[1]{k}}\cdots\proptwobody{\tv[L]{k}}\pot(\tv[L]{k},\tv{p'}).
\]

This integral can be performed in the non-relativistic limit, as done by
(Bern et al. \protect\hyperlink{ref-Bern:2019crd}{Z. Bern et al. 2019})
up to 3\gls{pm}. Up to 2\gls{pm}, the amplitudes of the \gls{eft}
is:\sidenote{\footnotesize Here the re-partioning mentioned above has been applied and
  a change in loop momenta: \(\tv[i]{k}\to\tv{p}+\tv[i]{\ell}\).}

\[
\begin{aligned}
\ampl[(1)]_\text{EFT}&=-\frac{4\pi\grav c_1}{\tv{q}^2},\\
\ampl[(2)]_\text{EFT}&= \pi^2\grav^2 \Big(-\frac{2 c_2}{\abs{\tv{q}}}+\inv{\energy \redEratio \abs{\tv{q}}}\brc[\Big]{(1-3\redEratio)c_1^2+4\redEratio^2\energy^2c_1 c'_1}\\
                  & \int \dn[\Dim-1]{\tv{\ell}}\frac{32\energy\redEratio c_1^2}{\tv{\ell}^2(\tv{q}+\tv{\ell})^2(\tv{\ell}^2+2\tv{p}\tv{\ell})}\Big),
\end{aligned}
\]

where
\(\redEratio=\frac{\energy[1]\energy[2]}{\pa{\energy[1]+\energy[2]}^2}\)
is the reduced energy ratio. The arguments of the coefficient functions
\(c_1\) are kept implicit and a prime denotes a derivative with respect
to \(\tv{\emom}\). Additionally, we defined \(\tv{q}=\tv{p'}-\tv{p}\) to
be the 3-momentum transfer.

The key point is that the matching procedure requires the EFT amplitude
for two-to-two scattering to be equal to the full amplitude at every
order in the coupling constant \(\coupling\), i.e.~provided we obtain
the amplitude of the full theory, and carefully apply the same limiting
procedures, we impose that

\[
\ampl[(i)]_\text{EFT}=\ampl[(i)]_\text{full} \quad \forall i.
\]

which fixes the coefficients in the potential ansatz
eq.~\ref{eq-ansatzpot}, and fulfills the promised map from amplitude to
potential. Importantly, we must apply the limiting procedure applied
above, i.e., the classical and non-relativistic limit, which is
summarized by the following hierarchy of scales:

\[
\mass[1],\mass[2]\ll J \abs{\tv{q}} \ll \abs{\tv{q}}.
\]

In the full theory this hierarchy is equivalent to restricting to a
specific kinematic regime, following the method of regions. We consider
all the possible loop-momentum scalings, first due to the classical
limit:

\begin{longtable}[]{@{}rc@{}}
\toprule()
Region & Momentum \(\ell = (\omega,\tv{\ell})\) \\
\midrule()
\endhead
hard & \((m,m)\) \\
soft & \((\abs{\tv{\tm}},\abs{\tv{\tm}})\) \\
\bottomrule()
\end{longtable}

In this language, the soft region is responsible for the classical
limit, since we consider a small \(\abs{\tv{\tm}}\) expansion. We will
in fact explore this expansion in a different light in
Section~\ref{sec-kmoc}. Taking the \gls{nr} limit corresponds to a
subregion of the soft region, the so-called potential region:

\[ (\omega,\tv{\ell})\sim (\abs{\tv{\vel}}\abs{\tv{\tm}},\abs{\tv{\tm}}),\]

where we use that the \gls{nr} expansion is a given by
\[\abs{\tv{\emom}}\ll m\] and thus equivalently \sidenote{\footnotesize dividing by
  mass} by a small relative velocity:

\[ \abs{\tv{\vel}}\ll1.\]

To summarize, in order to obtain the form of the potential, we first
compute the amplitude in an \gls{eft}, absorbing all force carrying
particles into an effective vertex. Making an ansatz for the potential
we can compute the amplitude in the non-relativistic limit in terms of
unknown coefficients. This same amplitude can be computed in the full
theory, which, as a consequence of the limiting procedure, has
simplified kinematic dependence. The coefficients of the \gls{eft}
amplitude are then determined by matching it order by order with the
full amplitude.

Unfortunately, the procedure described above, and in fact \emph{any}
procedure trying to make contact with \gls{eob} by expanding the
gravitational potential, intrinsically does not capture the full
physics. The crucial point that makes compact binaries interesting is
that they are not isolated, energy conserving systems. The energy of the
system is lost to the gravitational waves that enable us to detect them.
Any conservative dynamics, by construction, cannot capture this loss of
energy. In the context of \gls{eob}, this radiation reaction was added
after the fact, through direct modifications of the \gls{eom}s obtained
from Hamilton's equations. It is not clear how to incorporate
dissipative data from the amplitude in the \gls{eob} framework.

One way to not encounter this difficulty is to fully bypass the
\gls{eob} framework and try to obtain observables directly from the
amplitude. This is the subject of the following sections.

\hypertarget{sec-kmoc}{%
\section{\texorpdfstring{\acrshort{kmoc}
framework}{ framework}}\label{sec-kmoc}}

The \acrfull{kmoc} framework (Kosower, Maybee, and O'Connell
(\protect\hyperlink{ref-Kosower:2018adc}{2019})) is very general, and is
aimed at taking the classical limit of a scattering event in an
unspecified theory. We will apply it later on to \gls{sqed} and gravity.

\hypertarget{conventions}{%
\subsection{Conventions}\label{conventions}}

First let us define our conventions. Throughout this section we use
relativistically natural units, i.e.~we do \emph{not} set \(\hbar=1\).
This will essentially be the small parameter that multiplies the soft
momenta that defined the region in Section~\ref{sec-amp2pot}. In this
section we will further motivate this classical limit in more detail by
taking the generally accepted limit that makes quantum physics collapse
to classical physics

\[\hbar\to0.\]

We still retain \(c=1\), meaning that, using dimensional analysis we
have that \([L][T]^{-1}=1\) i.e.~\([L]=[T]\), length and time are
measured in the same units. Correspondingly, energy is measured in units
of mass \[
\energy=mc^2\implies[\energy]=[m]=[M],
\]

and \(\hbar\) has the following units

\[
\energy=\hbar \omega\implies [M]=[\hbar][T]^{-1}\implies [\hbar]=[T][M]
.\]

Thus, momentum \(\emom\) has units of \([\emom]=[M]\) mass and
wavenumber \([\bar{\emom}]=[\frac{\emom}{\hbar}]=[T]^{-1}\) has units of
inverse time. We will denote the Lorentz-invariant phase space measure
by \(\ddP{p}\)\sidenote{\footnotesize Repeated integration will be denoted
  \(\ddP[n]{p_1,\dots,p_n}\)}:

\[
\int \ddP{p} \dots      = \int \frac{\dd[3]{\tv{p}}}{2\hbar\shellen (2\pi)^3} \dots = \int \dn[4]{p}\nposendelta[-m^2]{p} \dots,
\]

where quantities denoted by bars absorb the relevant factors of
\(2\pi\), such that \(\dn[n]{p}=\frac{\dd[n]p}{(2\pi)^n}\).
Additionally, we have defined \(\hbar\shellen=\sqrt{\tv{p}^2+m^2}\) to
be the on-shell energy and \(\delta^{(+)}\) is the normalized positive
energy on-shell delta function:

\[
\nposendelta[-m^2]{p}=(2\pi)\deltafn{\lv{p}^2-m^2}\thetafn{\ct[0]{p}}=\ndeltafn{\lv{p}^2-m^2}\thetafn{\ct[0]{p}}
\]

\hypertarget{intital-state}{%
\subsection{Intital State}\label{intital-state}}

With our conventions at hand, let us set the stage for the problem.
Imagine we want to scatter two particles, be they massive black holes,
or tiny electrons, into each other, with a constant particle number
(i.e.~a classical two in two out scattering). As mentioned in
Section~\ref{sec-scatamp}, in \gls{qft} the framework that formalizes
scattering of definite particle number states is based on the \gls{lsz}
reduction formula.

{\marginnote{\begin{footnotesize}we work in the Heisenberg picture
here\end{footnotesize}}}

Let us look at it in more detail. The first step is to define the states
we want to scatter. Suppose our theory has single particle states
\(\momket\), with mass \(\mass\), eigenstates of the momentum:

\[\ct{\momop}\momket=\ct{\emom}\momket \quad \text{with} \quad p^0=\hbar\shellen=\sqrt{\tv{\emom}^2+\mass^2}.\]

These states can be seen as special cases (the plane wave states) of
wavepacket states:\sidenote{\footnotesize A plane wave state \(\ket{f}=\momket\) would
  be given by
  \(\shellft{f}(k)=2 \hbar\shellen[\tv{k}] \ndeltafn[(3)]{\tv{k}-\tv{p}}\)}

\[\ket{f}=\int \ddP{k} \shellft{f}(k) \momket[k],\]

where \(\shellft{f}(k)\) is the momentum space wave-function or, more
mathematically, the momentum distribution function. Note that it is
almost a Fourier transform, but not quite, as it is performed on the
mass shell. If the spacetime `wave-function' \sidenote{\footnotesize Note that the
  concept of coordinate space wave-function is ill-defined in
  interacting theories. However, for such asymptotic states, the
  wave-function outside the bulk (on the infinite time boundary) is that
  of a free wave-function.} is given by

\begin{equation}\protect\hypertarget{eq-spacetimewf}{}{f(x)=\int \ddP{k} \shellft{f}(k) \exp{-\im\lv{k}\cdot\lv{x}},}\label{eq-spacetimewf}\end{equation}

so that \(\shellft{f}(k)\) is consequently given by

\begin{equation}\protect\hypertarget{eq-momdist}{}{\ip{k}{f}=\shellft{f}(k)= 2 \hbar\shellen \int \dd[3]{\tv{x}}f(x) \exp{\im k\cdot x}.}\label{eq-momdist}\end{equation}

If we now define the following operators \sidenote{\footnotesize \(f\lrder g=f\pa{\partialder[\mu]g}-\pa{\partialder[\mu]f}g\)}
\^{}{[} Note that if we replace \(f(x)\) by a plane wave state
\(\exp{-\im k\cdot x}\) we obtain and define the following:

\[
\createop[\tv{k}](t)=  \int \dd[3]{\tv{x}} \exp{-\im k\cdot x} \brc[\Big]{\hbar\shellen[\tv{k}]\wf(x)-\im \partialder[0]\wf(x)},
\]

\[
\annihilop[\tv{k}](t)=   \int \dd[3]{\tv{x}} \exp{\im k\cdot x} \brc[\Big]{\hbar\shellen[\tv{k}]\wf(x)+\im \partialder[0]\wf(x)},
\]

{]}

\[
\createop[f](t)= -  \im \int \dd[3]{\tv{x}}f(x) \lrder[0] \scf(x),
\]

\[
\annihilop[f](t)=   \im \int \dd[3]{\tv{x}}\conj{f}(x) \lrder[0] \scf(x),
\]

where \(\scf(x)\) is the Heisenberg field operator of our theory. While
these operators are time dependent, this dependence is not obtained from
applying the Heisenberg \glspl{eom} \sidenote{\footnotesize \(\odv{A_H(t)}{t}=\im\com{H_H}{A_H(t)}\)},
instead it is present through the time dependence of the wave-function
\(f(x)\). It turns out that these operators, suggestively written are
the true creation and annihilation operators in the interacting theory.

We can now define a general one particle state \(\ket{f}\) as the result
of a creation operator acting on the physical vacuum. Crucially, this
only makes sense in the boundary of the bulk, i.e.~at asymptotic times
\(t\to\pm\infty\)\sidenote{\footnotesize See Coleman
  (\protect\hyperlink{ref-Coleman:2018a}{2018}) or Collins
  (\protect\hyperlink{ref-Collins:2019ozc}{2019}) for a more in depth
  discussion of this point}. Inside the bulk, any thusly created state
would in fact not have definite particle number. This definitely makes
sense in the scattering problem because if you consider the whole system
as a state, it only has definite particle number at asymptotic times,
and inside the bulk the scattering happens, and the particle number is
not conserved (at least quantum mechanically).

Consequently, we only define asymptotic states, denoting them by an
\(\text{in}\) subscript if they were created at \(t\to-\infty\) and
\(\text{out}\) if they were created at \(t\to+\infty\):

\[ 
\ket[in]{f}\defeq\lim_{t\to-\infty}\createop[f](t)\physvack=\createop[f;\text{in}]\physvack=\int \ddP{k} \shellft{f}(k) \underbracket{\createop[\tv{k}]\physvack}_{\momket[k]}
\]

and the corresponding \(t \to +\infty\) state where in is replaced with
out. It turns out that the extension to multiparticle states is not much
more complicated. The one thing to demand is that the momentum
distributions say \(\shellft{f_1},\shellft{f_2},\dots\) have no common
support, i.e., they are not overlapping. In this case an n-particle in
state is defined as:

\[
\ket[in]{f_1,\dots,f_n}\defeq\createop[f_1;\text{in}]\createop[f_2;\text{in}]\dots\createop[f_n;\text{in}]\physvack=\int \ddP[n]{k_1,\dots,k_n} \shellft{f_1}(k_1)\dots\shellft{f_n}(k_n) \momket[k_1,\dots,k_n]. 
\]

We now have the definitions for asymptotic in and out states for any
number of particles. Before defining the setup to scatter two particles,
let us look at the meaning of the position space wave-function \(f(x)\)
as defined in eq.~\ref{eq-spacetimewf}. Consider a sharply peaked,
compactly supported momentum distribution \(\shellft{f}(k)\) around a
value \(\tv[0]{p}\) and a characteristic width \(\Delta p\). One such
function could be:

\begin{equation}\protect\hypertarget{eq-peak}{}{
f\pa{\tv{p} ; \tv[0]{p}, \Delta p}=\left\{\begin{array}{ll}
N \exp{-1 /\pa{1-\abs{\tv{p}-\tv[0]{p}}^2 / \Delta p^2}} & \text { if }\abs{\tv[0]{p}-\tv{p}}<\Delta p \\
0 & \text { if }\abs{\tv[0]{p}-\tv{p}} \geq \Delta p
\end{array}\right.,
}\label{eq-peak}\end{equation}

where \(N\) is a normalization constant. The integrand in
eq.~\ref{eq-spacetimewf}, at large \(t\) or \(\tv{x}\), will be
dominated by the stationary phase point \(\tv[s]{p}\) which is given
by:\sidenote{\footnotesize This then means that
  \[\tv[s]{p}=\frac{\mass\tv{x}\sign{t}}{\sqrt{t^2-\tv{x}^2}}\] thus
  \[\hbar\shellen[{\tv[s]{p}}]=\frac{\mass\abs{t}}{\sqrt{t^2-\tv{x}^2}}\]}

\begin{equation}\protect\hypertarget{eq-stationaryphase}{}{0=-\pdv{}{\tv[s]{p}}\pa{\hbar\shellen[{\tv[s]{p}}]t+\tv[s]{p}\cdot\tv{x}}=-\frac{\tv[s]{p}t}{\hbar\shellen[{\tv[s]{p}}]}+\tv{x}.
}\label{eq-stationaryphase}\end{equation}

In the case of a sharply peaked momentum distribution, the coordinate
space wave-function will be largest when the stationary phase point is
the same as the peak of the momentum distribution, i.e.,
\(\tv[s]{p}=\tv[0]{p}\) i.e., substituting \(\tv[s]{p}\) into
eq.~\ref{eq-stationaryphase} gives: \[
\tv{x}\simeq \frac{\tv[0]{p}t}{\hbar\shellen[{\tv[0]{p}}]}=\tv[0]{v}t.
\]

This is precisely the trajectory of the classical relativistic particle.
Now consider the case of two particles with different peaked momentum
distributions their trajectories will have different velocities, but the
same positions at time \(0\). Thus, we will shift one of these
trajectories by a so called impact parameter
\(\ct{\impactParameter}\)\sidenote{\footnotesize \(f(x)=\int \ddP{\emom} \shellft{f}({\emom})\exp{-\frac{\im}{\hbar} \emom^\mu x_\mu}\).
  Then a shifted, i.e.~translated version of \(f(x)\) can be
  written:\[\begin{aligned}f(x-x_0)&=\int \ddP{\emom} \shellft{f}({\emom})\,\exp{-\frac{\im}{\hbar} p_\mu (x^\mu-x_0^\mu)}\\&=\int \ddP{\emom} \shellft{f}({\emom})\,\exp{\frac{\im}{\hbar}p_\mu x^\mu_0}\,\exp{-\frac{\im}{\hbar} p_\mu x^\mu}\end{aligned}\]
  Thus the associated, translated state
  is:\[\ket{f}=\int \ddP{\emom} \shellft{f}({\emom})\,\exp{\frac{\im}{\hbar}p_\mu x^\mu_0}\,\ket{\emom }\]},
parametrizing the relative separation of the two particles/wave-packets.
This can be simply done by multiplying the momentum distribution
\(\shellft{\wf[1]}(p)\) by a factor of
\(\exp{\frac{\im}{\hbar} \impactParameter \cdot p}\). We take it to be
perpendicular to the initial momenta \(\emom[1],\emom[2]\). We now can
write down the initial state that we are going to study:

\begin{equation}\protect\hypertarget{eq-instate}{}{
\ket{\text{in}}=\int \ddP[2]{\emom[1],\emom[2]} \shellft{\wf[1]}(\emom[1]) \shellft{\wf[2]}(\emom[2]) \exp{\frac{\im}{\hbar} \co{\impactParameter} \ct{\emom[1]}}\ket[in]{\emom[1],\emom[2]}.
}\label{eq-instate}\end{equation}

From now on we will drop the breve and infer from the arguments the type
of \(\wf\) we are dealing with. Observe that by extracting the impact
parameter in this way, the wave-functions can be identical in form, and
will still be separated as required.

\hypertarget{change-in-observable}{%
\subsection{Change in observable}\label{change-in-observable}}

The \gls{kmoc} framework concerns itself with the change of an
observable quantity during a scattering event encoded in an operator
\(\op{O}\). For such an observable quantity \(\obs{O}\) , its change is
obtained by evaluating the difference of the expectation value of
\(\op{O}\), between in and out states \[
\Delta O=\ev{\op{O}}{\text{out}}-\ev{\op{O}}{\text{in}}.
\]

In quantum mechanics, the out states are related to the in states by the
time evolution operator, i.e., the S-matrix,
\(\ket{\text{out}}=\Smat \ket{\text{in}}\). Thus:

\marginnote{\begin{footnotesize}

In order, we use the unitarity of the S-matrix, then express the
S-matrix as the identity (no actual interaction) and the transfer matrix
\(\Tmat\). The commutators are then expanded and the part with the
identity vanish (as \(\id\) commutes with everything).

\end{footnotesize}}

\begin{equation}\protect\hypertarget{eq-DeltaO}{}{
\begin{aligned}
\Delta O    &=\ev{\adj{\Smat}\op{O}\Smat}{\text{in}}-\ev{\op{O}}{\text{in}}\\
            &\stackrel{\adj{\Smat} \Smat=\id}{=}      \ev{\adj{\Smat} \com{\op{O}}{\Smat}}{\text{in}}\\
            &\stackrel{\Smat=\id+\im \Tmat}{=}          \ev{\com{\op{O}}{\id+\im \Tmat}}{\text{in}}
                                                      -\ev{\im \adj{\Tmat} \com{\op{O}}{\id+\im \Tmat}}{\text{in}}\\
            &=    \ev{\im\com{\op{O}}{\Tmat}}{\text{in}}
                  +\ev{ \adj{\Tmat} \com{\op{O}}{\Tmat}}{\text{in}}\\
            &=\vchangeob+\Delta O_\text{r}.
\end{aligned}
}\label{eq-DeltaO}\end{equation}

If we put in the definition of our in state (eq.~\ref{eq-instate}), we
have

\[
\Delta O = \int \ddP[4]{\emom[1],\emom[2],\emom[1]',\emom[2]'} 
                  \wf[1](\emom[1]) \wf[2](\emom[2]) \cwf[1](\emom[1]') \cwf[2](\emom[2]')
                  \,\exp{\im \co{\impactParameter} \frac{\ct{\emom[1]}-\ct{\emom[1]'}}{\hbar}}
                  \brc[\big]{\vInt-\rInt},
\]

where we defined the real integrand \(\rInt\) and the virtual integrand
\(\vInt\) as the following matrix elements \sidenote{\footnotesize NB: the notation is
  slightly different in the Zvi Bern et al.
  (\protect\hyperlink{ref-Bern:2021xze}{2022}) paper}

\[
\begin{aligned}
\vInt &=\bra[in]{\emom[1]'\emom[2]'}{\im\com{\op{O}}{\Tmat}           }\ket[in]{\emom[1]\emom[2]}\\
\rInt &=\bra[in]{\emom[1]'\emom[2]'}{\adj{\Tmat}\com{\op{O}}{\Tmat}   }\ket[in]{\emom[1]\emom[2]}.
\end{aligned}
\]

Let us first look at the virtual integrand \(\vInt\):\sidenote{\footnotesize Here we
  define
  \[\obs{O}_{\text{in}}\ket{\emom[1]\emom[2]}=\op{O}\ket{\emom[1]\emom[2]}\]
  aswell as,
  \[\obs{O}_{\text{in}}'\bra{\emom[1]'\emom[2]'}=\bra{\emom[1]'\emom[2]'}\op{O}\]
  and finally
  \[\obschange{\emom'-\emom}=\obs{O}_{\text{in}}'-\obs{O}_{\text{in}}\]}

\begin{equation}\protect\hypertarget{eq-vInt}{}{
\begin{aligned}
\vInt &=\bra[in]{\emom[1]'\emom[2]'}{\im\com{\op{O}}{\Tmat}     }\ket[in]{\emom[1]\emom[2]}  \\
      &=\bra[in]{\emom[1]'\emom[2]'}{\im\op{O}\Tmat             }\ket[in]{\emom[1]\emom[2]}   
      - \bra[in]{\emom[1]'\emom[2]'}{\im \Tmat\op{O}            }\ket[in]{\emom[1]\emom[2]}\\
      &=\im \obs{O}_{\text{in}'}  \; \bra[in]{\emom[1]'\emom[2]'}{\Tmat}\ket[in]{\emom[1]\emom[2]}
      - \im \obs{O}_{\text{in}} \;    \bra[in]{\emom[1]'\emom[2]'}{\Tmat}\ket[in]{\emom[1]\emom[2]}\\
      &=\im \obschange{\emom'-\emom} \,    \bra[in]{\emom[1]'\emom[2]'}{\Tmat}\ket[in]{\emom[1]\emom[2]}\\
      &=\im \obschange{\emom'-\emom}\,\ndeltafn[4]{\emom[1]+\emom[2]-\emom[1]'-\emom[2]'} 
                                    \amp{\emom[1],\emom[2]}{\emom[1]',\emom[2]'}.
\end{aligned}
}\label{eq-vInt}\end{equation}

Note that the amplitude is from in states to in states. In order to
obtain the real integrand \(\rInt\), we insert a complete set of states
:\sidenote{\footnotesize \(1=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}\dyad{r_1 r_2 X}\)
  Where we could consider the states \({r_1,r_2,X}\) to be the final
  states after the scattering. Note that we always impose having two
  \glspl{bh}, at all times, as we have no pair annihilation, which is
  why the sum always has a two particle dyad. The additional states
  encoded in \(X\) are all possible additional messenger states (we also
  have no \gls{bh} pair production).}

\begin{equation}\protect\hypertarget{eq-rInt}{}{
\begin{aligned}
\rInt &=\bra[in]{\emom[1]'\emom[2]'}{\adj{\Tmat}\com{\op{O}}{\Tmat}}\ket[in]{\emom[1]\emom[2]}\\
      &=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}   \bra[in]{\emom[1]'\emom[2]'}\adj{\Tmat}\vert{r_1 r_2 X}\rangle\langle {r_1 r_2 X} \vert
                        \com{\op{O}}{\Tmat}\ket[in]{\emom[1]\emom[2]}\\
      &=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}  \ndeltafn[4]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}}\,
      \amp{\emom[1], \emom[2]}{r_{1}, r_{2}, r_{X}} \\
      &\qquad \obschange{rX-\emom}\,\ndeltafn[4]{\emom[1]'+\emom[2]'-r_{1}-r_{2}-r_{X}}\,
      \aamp{\emom[1]', \emom[2]'}{r_{1}, r_{2}, r_{X}},
\end{aligned}
}\label{eq-rInt}\end{equation}

where the \(X\) encodes any number of additional messenger states, and
\(r_{X}\) is the sum of their momenta. For both integrands we can
preform some variable changes and eliminate certain Dirac delta
functions. We introduce momentum shifts \(q_i=\emom[i]'-\emom[i]\) and
then integrate over \(q_2\), and finally relabel \(q_1 \to \tm\)
\sidenote{\footnotesize Introducing the momentum shifts modifies the measure in the
  following way:
  \[\begin{aligned}\ddP{\emom[i]'}&=\ddP{\emom[i]+q_i}\\=&\dn[4]{q_i}\,\ndeltafn{{(\emom[i]+q_i)^2-m_i^2}} \thetafn{{\emom[i]^0+q_i^0}}\end{aligned}\]
  Now since we also have the on-shell enforcing delta function from
  \(\ddP{\emom[i]}\) we can rewrite the delta functions:
  \[\begin{aligned}\ddP{\emom[i]}&\,\ndeltafn{(\emom[i]+q_i)^2-m_i^2}\\&=\ddP{\emom[i]}\ndeltafn{\underbracket{(\emom[i]^2-m_i^2)}_{\text{redundant}}+2 \emom[i] \cdot q_i+q_i^2}\\&=\ddP{\emom[i]}\ndeltafn{2 \emom[i] \cdot q_i+q_i^2}\end{aligned}\]
  Finally we integrate \(q_2\) by solving
  \(\ndeltafn[(4)]{\emom[1]+\emom[2]-\emom[1]'-\emom[2]'}=\ndeltafn[(4)]{q_1+q_2}\)
  and thus we just set \(q_2=-q_1\)}. Thus, we have

\begin{equation}\protect\hypertarget{eq-DeltaOv}{}{
\begin{aligned}
\vchangeob=\int &\ddP[2]{\emom[1],\emom[2]} \dn[4]{\tm}
      \ndeltafn{2 \emom[1] \cdot \tm+\tm^2} \thetafn{\ct[0]{\emom[1]}+\tm^0}\, \ndeltafn{2 \emom[2] \cdot \tm-\tm^2} \thetafn{\ct[0]{\emom[2]}-\tm^0}\\
      &\times\wf[1](\emom[1])\wf[2](\emom[2])\cwf[1](\emom[1]+\tm)\cwf[2](\emom[2]-\tm)\,\exp{-\frac{\im}{\hbar} \co{\impactParameter} \tm^\mu}\\
      &\times \im \obschange{\tm} \amp{\emom[1],\emom[2] }{\emom[1]+\tm,\emom[2]-\tm},
\end{aligned}
}\label{eq-DeltaOv}\end{equation}

\begin{equation}\protect\hypertarget{eq-DeltaOr}{}{
\begin{aligned}
\rchangeob=\sum\limits_X \int &\ddP[2+\abs{X}]{r_1, r_2,X}
      \ddP[2]{\emom[1],\emom[2]} \dn[4]{\tm} \ndeltafn{2 \emom[1] \cdot \tm+\tm^2} \thetafn{\ct[0]{\emom[1]}+\tm^0}\\
            &\times \ndeltafn{2 \emom[2] \cdot \tm-\tm^2} \thetafn{\ct[0]{\emom[2]}-\tm^0}\\
            &\times\wf[1](\emom[1])\wf[2](\emom[2])\cwf[1](\emom[1]+\tm)\cwf[2](\emom[2]-\tm)\,\exp{-\frac{\im}{\hbar} b_\mu \tm^\mu}\\
            &\times\obschange{rX-\emom}\ndeltafn[(4)]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}} \\
            &\times   \amp{\emom[1], \emom[2] }{ r_{1}, r_{2}, r_{X}}\aamp{\emom[1]+\tm, \emom[2]-\tm }{r_{1}, r_{2}, r_{X}}.
\end{aligned}
}\label{eq-DeltaOr}\end{equation}

We have arrived at an integral expression for the change in observable
\(\Delta\obs{O}\). Luckily for us, we will not need to perform these
integrals in the classical limit. We will just have carefully chosen
replacement rules for the integrated variables! Let us look at this in
more detail now.

\hypertarget{classical-limit}{%
\subsection{Classical limit}\label{classical-limit}}

Since we are concerned with classical observables, we need to explore
the classical limit of eq.~\ref{eq-DeltaO}, i.e.~the limit of
\(\hbar \to 0\). We first discuss the classical limit of wave-functions.
We impose multiple conditions on the wave-functions. The first are those
imposed by \gls{lsz} reduction. That is,

\begin{itemize}
\tightlist
\item
  Compact support momentum space wave-function
\item
  Peaked around one value of momenta
\end{itemize}

Furthermore, the classical limit of the wave-functions should make
sense, i.e.~

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  as \(\hbar \to 0\) the position and momentum wave-function should
  approach Dirac delta functions, centered around their classical
  values.
\item
  The overlap between the wave-function and its conjugate should be
  nearly full, since they represent the same particle classically.
\end{enumerate}

Consider for example a non-relativistic wave-function for a particle of
mass \(\mass\):

\[
f(\tv{\emom})=\Exp[\Big]{-\frac{\abs{\tv{\emom}}}{2 \hbar m \comptlen/\wfwidth^2}}\stackrel{\hbar=\comptlen m}{=}\Exp[\Big]{-\frac{\abs{\tv{\emom}}}{2 m^2 \comptlen^2 /\wfwidth^2}},
\]

where \(\comptlen=\frac{\hbar}{m}\) is the compton wavelength of the
particle and \(\wfwidth\) is a characteristic width. This wave-function,
with the proper normalization, grows sharper in the \(\hbar \to 0\)
limit. If we now take the Fourier transform of \(f(\tv{\emom})\) to
obtain the position ``probability density'', we have:\sidenote{\footnotesize \(A\)
  absorbs the various constants, with
  \(A=\sqrt{2}m\frac{\comptlen}{\wfwidth}\) and \(\tv[0]{x}\)} \[
\begin{aligned}
\invFT[\tv{\emom}]{f}{\tv{x}}(\tv{x})   &=\int \frac{\dd{\tv{\emom}}}{2 \pi} \Exp[\Big]{-\pa[\big]{\frac{\tv{\emom}}{A}}^2}\Exp[\Big]{-\frac{\im}{\hbar} \tv{\emom}\cdot \tv{x}}\\
            &=\frac{1}{2\pi}\underbracket{\int \dd{\tv{\emom}} \Exp[\Big]{-\pa[\Big]{\frac{\tv{\emom}}{A}-\frac{\im\tv{x}A}{2 \hbar}}^2}}_{\sqrt{\pi}A}\Exp[\Big]{- \frac{\tv{x}^2A^2}{4 \hbar^2}}\\
      &=\frac{\sqrt{2}A}{2 \pi}\Exp[\Big]{-\frac{\tv{x}^2}{2 \wfwidth^2}}.
\end{aligned}
\]

This elucidates more clearly the meaning of characteristic width, as
\(\wfwidth\) is the standard deviation of the wave-function in position
space. Thus, the position-space wave-function grows sharper in the
\(\wfwidth^2 \to 0\) limit. For both wave-functions to simultaneously
grow sharper in the classical limit, we must then have that
\(\xi=\pa{\frac{\comptlen}{\wfwidth}}^2\to0\) remembering that the
\(\hbar \to 0\) limit is just given by the \(\comptlen\to0\) one.
Finally the meaning of classical limit in this context is the
\(\xi \to 0\) limit.

Going back to the general conditions, we want a wave-function
\(\wf[i](\emom[i])\) such that in the classical limit the momentum
reaches its classical value: \(\cls{\emom[i]}=\mass[i]\cls{\vel[i]}\),
with \(\cls{\vel[i]}\) the classical four-velocity of particle \(i\),
normalized to \(\cls{\vel[i]}^2=1\). In other words,

\[
\av{\ct{\emom[i]}}=\int \ddP{\emom[i]} \ct{\emom[i]} \abs{\wf[i](\emom[i])}^2\stackrel{!}{=}m_i \breve{u}_i^\mu (1+\order[\beta']{\xi}),
\]

where \(\beta'\) encodes the speed at which the classical value is
reached in the \(\xi\to0\) limit. The velocity normalization convergence
is controlled by \(\beta''\)
\[\breve{u}_i \cdot u_i = 1+ \order[\beta'']{\xi},\]

Finally wave-function's spread is controlled by \(\beta\), and must
converge to 0:
\[\begin{aligned} \sigma^2(\emom[i])/m_i^2&=\inv{m_i^2}\av{(\emom[i]-\av{\emom[i]})^2}\\&=\inv{m_i^2}(\av{\emom[i]^2}-\av{\emom[i]}^2)\\&=\inv{\mass[i]^2}(\mass[i]^2-(\mass[i]\cls{\vel[i]}(1+\order[\beta']{\xi}))^2)
\\&\propto\xi^\beta,\end{aligned}\]

where \(\av{\emom[i]^2}=m_i^2\) is enforced by the measure
\(\ddP{\emom}\).

Additionally, the wave-function should be Lorentz invariant, and naively
we would have that \(\wf(\emom[i]^\mu)=\wf'(\emom[i]^2)\). However the
integration measure enforces an on-shell condition:
\(m_i^2=\emom[i]^2\). Thus the wave-function cannot depend on
\(\emom[i]^2\), and we need to introduce at least one additional four
vector parameter \(u\). The simplest dimensionless combination of
parameters it then \(\frac{\emom \cdot u }{m}\). Of course the
wave-function must also depend on \(\xi\) and the simplest form of
argument will thus be \(\frac{\emom \cdot u }{m \xi}\) so that any
\(\emom\) not aligned with \(u\) will be strongly suppressed in the
\(\xi \to0\) limit.

We now have control over most of the conditions:

\begin{itemize}
\tightlist
\item
  The classical limit is well-defined
\item
  The wave-function spread is controlled
\item
  The arguments of the wave-function are clear
\end{itemize}

We can write a general wave-function that satisfies the above as:

\[
f(\frac{\emom \cdot u }{m}\vert\cls{\vel[i]};\mass[i] ;\beta^{(i)}).
\]

This function can take the form of a Gaussian, or something similar to
eq.~\ref{eq-peak}. Now there is one final requirement, that concerns the
overlap of \(\wf\) and \(\cwf\) must be \(\mathcal{O}(1)\), equivalently
and more precisely:

\[
\cwf(\emom+\tm)\sim \cwf(\emom) \implies \cwf(\emom+\tm)- \cwf(\emom)\ll 1 \implies \ct{\tm}\pdv{}{\ct{p}}\cwf(\emom)\ll1.
\] Making explicit the \(\frac{\emom \cdot u }{m \xi}\) dependence:
\(\wf(\emom)=\varphi(\frac{\emom \cdot u }{m \xi})\) for \(\varphi(x)\)
a scalar function.
\[\implies \frac{\ct{\tm} u_\mu}{m \xi}\odv{\varphi^*(x)}{x}\Bigr|_{\frac{\emom \cdot u }{m \xi}}\ll  1.\]

Thus we require that for a characteristic value of \(\tm=\co[0]{\tm}\)
we have:

\[
\frac{\co[0]{\tm}\cdot u}{m \xi}=\co[0]{\tw} \cdot u\frac{\wfwidth^2}{\comptlen}\ll1\iff \co[0]{\tw} \cdot u\,\wfwidth\ll \sqrt{ \xi},
\]

having we denoted by a bar any quantity that has been rescaled by
\(\hbar\). Thus, a momentum \(\emom\), when divided by \(\hbar\) will be
written \(\bar{\emom}\) and called wave-number. We will combine this
inequality with ones we obtain from the specific cases of integrations
required above.

We now want to examine the classical limit of the integrands of the form
eq.~\ref{eq-DeltaOv}. If we consider just the integration over the
initial momenta \(\emom[i]\) and the initial wave-functions with
\(\ndeltafn{2 \emom[i] \cdot \tm+\tm^2}\), the delta function will smear
out to a sharply peaked function whose scale is of the same order as the
original wave-functions. As \(\xi\) gets smaller, this function will
turn back into a Dirac delta function imposed on the \(\tm\)
integration. Let us examine this statement more closely. We are
interested in the classical limit of the integrals such as:

\begin{equation}\protect\hypertarget{eq-dfunct}{}{
d(m,\xi,u,\tm)=\int \ddP{\emom} \ndeltafn{2 \emom \cdot \tm+\tm^2} \thetafn{\emom^0+\tm^0}\varphi \pa[\Big]{\frac{\emom \cdot u }{m \xi}}\varphi^*\pa[\Big]{\frac{(\emom+\tm) \cdot u }{m \xi}}.
}\label{eq-dfunct}\end{equation}

This integral must be Lorentz invariant and depends on \(m,\xi, u,\tm\)
thus it must manifestly only depend on the following Lorentz invariants:
\(u^2,\tm^2,u \cdot \tm, \xi\). One of these is not actually a variable
as we will normalise \(u^2=1\). The rest are not fully dimensionless,
but we can render them dimensionless:

\[
\begin{aligned}
\brc{\tm^2} &=[\hbar \tw]^2=[M]^2\implies[\comptlen \sqrt{-\tw^2}]=[\frac{\hbar}{m}\sqrt{-\tw^2}]=\frac{[M]}{[M]}=1,\\
[u \cdot \tm]&=[M]\implies [\frac{u \cdot\tw}{\sqrt{-\tw^2}}]= [\frac{u \cdot{\tm}}{\sqrt{-{\tm}^2}}]=\frac{[M]}{[M]}=1,\\
[\xi]&=1.
\end{aligned}
\]

If we call \(\frac{1}{\sqrt{-\tw^2}}=\scatlen\) a scattering
length\sidenote{\footnotesize \([\frac{1}{\sqrt{-\tw^2}}]=[T]=[L]=[\scatlen]\)} then
our dimensionless ratios become :

\[\frac{\comptlen}{\scatlen} \quad \text{and}\quad \scatlen\,\tw \cdot u .\]

The Dirac delta function can then be rewritten as: \[
\ndeltafn{2 \emom \cdot \tm+\tm^2}=\ndeltafn{2\hbar m\, u\cdot \tw+\hbar^2 \tw^2}=\frac{1}{\hbar m}\ndeltafn{2 \tw \cdot u-\frac{\comptlen}{\scatlen^2}}=\frac{\scatlen}{\hbar m}\ndeltafn{2\scatlen\, \tw \cdot u-\frac{\comptlen}{\scatlen}}.
\]

Performing the integration over \(\emom\) in eq.~\ref{eq-dfunct} we
obtain symbolically:

\[
d(m,\xi,u,\tm)=\text{peaked function imposing that } {2\scatlen\, \tw \cdot u=\frac{\comptlen}{\scatlen}}\text{ with width } \xi^\beta.
\]

\begin{marginfigure}

\sidecaption{\label{fig-gaussian}Sharpening gaussian}

{\centering \includegraphics{./scattering_files/figure-pdf/fig-gaussian-output-1.pdf}

}

\end{marginfigure}

Let us disucss the wave-function and the scales from a physical
perspective. The characteristic width \(\wfwidth\) is the particle's
position uncertainty, \(\frac{\hbar}{\wfwidth}\) is the associated
momentum uncertainty. In the classical limit the position uncertainty is
neglible with respect to minimum distance between the particles
\(\scatlen\):

\[
\wfwidth\ll \scatlen,
\]

and the momentum uncertainty is neglible with respect to the masses of
the particles:

\[
\frac{\hbar}{\wfwidth}\ll m \implies \comptlen\ll \wfwidth.
\]

Putting these together we obtain the goldilocks inequality:

\[
\comptlen\ll\wfwidth\ll\scatlen.
\]

Looking back at the arguments of \(d\) we see that

\[
\scatlen\, \tw \cdot u\gg\wfwidth \tw \cdot u \sim \sqrt{\xi} =   \frac{\comptlen}{\wfwidth}\gg\frac{\comptlen}{\scatlen}.
\]

Thus in the classical limit we have that \(d\) collapses to:

\[
d(m,\xi,u,\tm)\propto\ndeltafn{ \tw \cdot u}.
\]

Thus, the wave-function-weighted on-shell phase-space integration
disappears in the classical limit. The resulting condition is that the
integration momenta take on their physical values. The sequence that we
have gone through should be done for all the integrands of type \(d\).
We will not do this explicitly every time but instead apply the
following rules:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Just as for the massless transfer momentum any messenger momentum, be
  it transfer, virtual-loop or real emmission, shall become a
  wave-number: \(k\to \hbar \bar{k}\).
\item
  Replace all couplings with their dimensionless counterparts:
  \(\coupling\to \frac{\coupling}{\sqrt{\hbar} }\) (this is only
  precisely true for \gls{sqed} and gravity, which are the applications
  we are interested in).
\item
  Eliminate all on-shell integrations by approximating
  \(\wf(\emom+\hbar\tw)\) by \(\wf(\emom)\).
\item
  Laurent expand all the integrands in \(\hbar\).
\item
  Make the integration momenta take on their physical values:
  \(\emom[i]\to \mass[i]\cls{\vel[i]}\).
\end{enumerate}

To make this idea explicit we introduce the following notation, meaning
that the steps above have been applied

\[
\AAngle{g(\emom[1],\emom[2],\dots)}\defeq \int\limits \ddP{\emom[1]}\ddP{\emom[2]} \abs{\wf[1](\emom[1])}^2\abs{\wf[2](\emom[2])}^2\,g(\emom[1],\emom[2],\dots)
\]

We can now rewrite eq.~\ref{eq-DeltaO}

\begin{equation}\protect\hypertarget{eq-DeltaOclas}{}{
\changeob = \AAngle{\int \overbracket{\dn[4]{\tm} \ndeltafn{2\emom[1]\cdot \tm +\tm^2}\thetafn{\ct[0]{\emom[1]}+\tm^0}  
                                          \ndeltafn{2\emom[2]\cdot \tm -\tm^2}\thetafn{\ct[0]{\emom[2]}+\tm^0}}^{\dPs{\tm}}
                  \exp{{-\frac{\im}{\hbar}}\tm^\mu b_\mu}\pa[\Big]{\vIntp+\rIntp} },
}\label{eq-DeltaOclas}\end{equation}

where \[
\begin{aligned}
\vIntp      &=\im\,  \obschange{\tm} \amp{\emom[1],\emom[2] }{\emom[1]+\tm,\emom[2]-\tm}\\
\rIntp      &=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}\obschange{rX-\emom} 
                  \ndeltafn[(4)]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}} \\
            &\times   \amp{\emom[1], \emom[2] }{ r_{1}, r_{2}, r_{X}} \aamp{\emom[1]+\tm, \emom[2]-\tm }{ r_{1}, r_{2}, r_{X}}.
\end{aligned}
\]

Additionally, we make clear the dependence on \(\hbar\) since we want to
eventually take the \(\hbar \to0\) limit. We apply step 1. above, and
change integration variables to \(\tw=\frac{\tm}{\hbar}\) and absorb the
\(\hbar\) dependence into the redefinition of the integrands and the
measure:

\[
\begin{aligned}
\dPs{\tm}
&=\hbar^2\dPsb{\tw}
=\hbar^{\cancelto{2}{4}}\dn[4]{\tw} 
\cancel{\frac{1}{\hbar}}\ndeltafn{2\emom[1]\cdot\tw+\hbar\tw^2}
\thetafn{\ct[0]{\emom[1]}+\tm^0}
\cancel{\frac{1}{\hbar}}\ndeltafn{2\emom[1]\cdot \tw +\hbar\tw^2}
\thetafn{\ct[0]{\emom[2]}+\tm^0},
\end{aligned}
\]

\[
\begin{aligned}
\vIntb&=\hbar^2\vIntp,\\
\rIntb&=\hbar^2\rIntp.
\end{aligned}\]

We can finally neatly write:

\[\Delta O=\AAngle{\int \dPsb{\tw}\exp{-\im\tw^\mu b_\mu}\pa[\Big]{\vIntb+\rIntb}}  .\]

The \(\hbar\) dependence is now entirely contained in the integrands
(ignoring the \(\hbar \tw^2\) factors in the delta function). The
classical limit of this observable is then simply,

\[
\Delta O_{\text{classical}}=\lim_{\hbar\to0}\hbar^{\beta_{LO}}\brc[\Big]{\int \dPsb{\tw}\pa[\Big]{\vIntb+\rIntb}},
\]

dropping the angle brackets, since these dissappear in the classical
limit. Here \(\beta_{LO}\) is the \gls{lo} \(\hbar\)-dependence of the
observable. This is so that \(\Delta O_{\text{classical}}\sim\hbar^0\)
i.e.~classical scaling.

\hypertarget{impulse-in-kmoc}{%
\section{\texorpdfstring{Impulse in
\gls{kmoc}}{Impulse in }}\label{impulse-in-kmoc}}

We can now explore the integrands for a specific observable. Consider
the change in momentum, or impulse of particle 1. The \gls{kmoc}
formalisms gives us a way to write this as:

\[\Delta \ct{\emom[1]}=\AAngle{\int \dPsb{\tw}\Exp[\Big]{-\im\tw^\mu b_\mu}\pa[\Big]{\vIntb[\ct{\emom[1]}]+\rIntb[\ct{\emom[1]}]}}  .\]

We then have:

\[
\begin{aligned}
\vIntb[\ct{\emom[1]}]&=\hbar^2\im\,  \tm\, \amp{\emom[1],\emom[2] }{ \emom[1]+\hbar \tw,\emom[2]-\hbar \tw}\\
\rIntb[\ct{\emom[1]}]&=\hbar^2\sumint\ddP[2+\abs{X}]{r_1,r_2,r_X}(r_1^\mu-\emom[1]^\mu)\,\ndeltafn[(4)]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}} \\
&\times   \amp{\emom[1], \emom[2] }{ r_{1}, r_{2}, r_{X}} \aamp{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{ r_{1}, r_{2}, r_{X}}.
\end{aligned}
\]

We can extract \(\hbar\) from \(\tm\) and from the amplitude. In order
to determine the \(\hbar\) scaling of \(\ampl\) we extract each coupling
constant \(\kappa\) along with an \(\frac{1}{\sqrt{\hbar}}\), so that
quartic vertices yield a factor of \(\frac{\coupling^2}{\hbar}\) whereas
cubic ones yield \(\frac{\kappa}{\sqrt{\hbar}}\)\sidenote{\footnotesize as mentioned
  in the last section, this is true for gravity and \gls{sqed} and we
  will extend this fact to schematically rescale the vertex coupling by
  \(\hbar^-\Half[d-2]\), for \(d\) the degree of the vertex in question.}.
If we count the number \(V_3\) of all cubic vertices, \(V_4\) the number
of quartic vertices, and so on, we have that the number of internal
lines is \(I=\frac{1}{2}(\sum_{d=3}dV_d-E)\). This is because we have
\(\sum_{d=3}dV_d\) lines to start with, out of which \(E\) are chosen to
be external. The remaining \((\sum_{d=3}dV_d-E)\) ones are contracted in
pairs among themselves to form \(I\) internal lines, yielding the factor
of \(\half\). In our case we have \(E=4+M\) where \(M=\abs{X}\) is the
number of messenger particles. Using the argument from loop counting we
have that the number of loops of our graph \(L\) is given by: \[
\begin{aligned}
        L=I-V+N=&\frac{1}{2}(\sum_{d=3}d\cdot V_d-4-M)-\sum_{d=3}V_d+1\\
=&\frac{1}{2}(\sum_{d=3}(d-2)V_d)-1-\frac{M}{2},
\end{aligned}
\]

where \(N\) is the number of connected components (\(=1\) in our case) .
Thus, we see that the amount of extracted \(\hbar\)s corresponds
directly to the number of loops plus one plus the number of additional
messenger particles. \sidenote{\footnotesize The number of extracted couplings being
  twice that.} We can thus write the amplitude \(\ampl\) as a sum over
reduced \(L\)-loop amplitudes \(\redampl[(L)]\):

\[\amp{\emom[1],\emom[2]}{ r_1,r_2,X}=\sum\limits_{L=0}^\infty\pa[\Big]{\frac{\coupling^{2}}{\hbar}}^{(L+1+\frac{\abs{X}}{2})}\redamp[(L)]{\emom[1],\emom[2]}{r_1,r_2,X}.\]

Going back to the integrands we have:

\begin{equation}\protect\hypertarget{eq-impulseIv}{}{
\begin{aligned}
\vIntb[\ct{\emom[1]}]&=\hbar^3\im\,  \tw\, \sum\limits_{L=0}^\infty\pa[\Big]{\frac{\coupling^{2}}{\hbar}}^{(L+1)}\redamp[(L)]{\emom[1],\emom[2]}{\emom[1]+\hbar \tw,\emom[2]-\hbar\tw}\\
&=\im\, \hbar  \tw\, \sum\limits_{L=0}^\infty \coupling^{2(L+1)}{\hbar}^{(1-L)}\redamp[(L)]{\emom[1],\emom[2]}{\emom[1]+\hbar \tw,\emom[2]-\hbar\tw},
\end{aligned}
}\label{eq-impulseIv}\end{equation}

as well as the real kernel:\sidenote{\footnotesize We changed the integration variable
  from \(r_i\) to \(w_i=r_i-\emom[i]\) thus the measure
  changes:\[\ddP[2+\abs{X}]{r_1,r_2,X}=\ddP[\abs {X}]{r_X}\prod\limits_{i=1,2}\dn[4]{w_i}\ndeltafn{2\emom[i] \cdot w_i+w_i^2}\thetafn{\emom[i]^0+w_i^0}\]
  where we used the same reasoning as for the \(q_i\) variable change.}

\[
\begin{aligned}
\rIntb[\ct{\emom[1]}]&=\hbar^2\sumint\ddP[\abs {X}]{r_X}\brc[\Big]{\prod\limits_{i=1,2}\dn[4]{w_i}\ndeltafn{2\emom[i] \cdot w_i+w_i^2}\thetafn{\emom[i]^0+w_i^0}} \\
&\times w_1^\mu\,\ndeltafn[(4)]{w_1+w_2+r_{X}}
\\
&\times\amp{\emom[1], \emom[2] }{ \emom[1]+w_{1}, \emom[2]+w_{2}, r_{X}} 
\aamp{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{ \emom[1]+w_{1}, \emom[2]+w_{2}, r_{X}}\\
\end{aligned}
\]

\[
\begin{aligned}
=\hbar^2\sumint&\ddP[\abs {X}]{{r}_X}\brc[\Big]{\prod\limits_{i=1,2}\hbar^3\dn[4]{\bar{w}_i}\ndeltafn{2\emom[i] \cdot \bar{w}_i+\hbar\bar{w}_i^2}\thetafn{\emom[i]^0+\hbar \bar{w}_i^0}} \\
&\times   \hbar \bar{w}_1^\mu\,\hbar^{-4}\ndeltafn[(4)]{\bar{w}_1+\bar{w}_2+\bar{r}_{X}}
\\
&\times\sum\limits_{L=0}^\infty\pa[\Big]{\frac{\coupling^{2}}{\hbar}}^{(2L+2+\abs{X})}\redamp[(L)]{\emom[1], \emom[2] }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}} \\
&\times\aredamp[(L)]{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}}
\end{aligned}
\]

\begin{equation}\protect\hypertarget{eq-impulseIr}{}{
\begin{aligned}
=\sumint&\ddP[\abs {X}]{{r}_X}\brc[\Big]{\prod\limits_{i=1,2}\dn[4]{\bar{w}_i}\ndeltafn{2\emom[i] \cdot \bar{w}_i+\hbar\bar{w}_i^2}\thetafn{\emom[i]^0+\hbar \bar{w}_i^0}} \\
&\times    \hbar\bar{w}_1^\mu\,\ndeltafn[(4)]{\bar{w}_1+\bar{w}_2+\bar{r}_{X}}
\\
&\times\sum\limits_{L=0}^\infty \coupling^{2(2L+2+\abs{X})}{\hbar}^{2-2L-\abs{X}}\redamp[(L)]{\emom[1], \emom[2] }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}} \\
&\times\aredamp[(L)]{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}}.\\
\end{aligned}
}\label{eq-impulseIr}\end{equation}

Schematically we have

\[
\begin{aligned}
\vIntb[\ct{\emom[1]}]&=\sum\limits_{L=0}^\infty \order[{2(L+1)}]{\coupling},\\
\rIntb[\ct{\emom[1]}]&=\sum\limits_{L=0}^\infty \order[{4(L+1)+2\abs{X}}]{\coupling}
\end{aligned}
\]

The contributions from the virtual kernel are lower order in the
coupling \(\coupling\) for a given loop order. Both kernels contribute
together provided that the following equation is verified:

\begin{equation}\protect\hypertarget{eq-rvloopmatch}{}{L-1=2L'+\abs{X}.}\label{eq-rvloopmatch}\end{equation}

where \(L\) is the loop count for the virtual kernel and \(L'\),
\(\abs{X}\) are the real kernel loop count and messenger particle count
respectively. Note that for a tree level virtual kernel, the real-kernel
match does not exist. The real kernel is only present for \(L>0\). When
taking the classical limit we will only retain contributions from graphs
that cancel the \(\hbar\) divergences in each corresponding kernel.
Thus, at the \(L\)-loop level, the amplitude in the virtual kernel must
cancel with terms of order

\begin{equation}\protect\hypertarget{eq-hbarvirt}{}{
\hbar^{1-L+O},
}\label{eq-hbarvirt}\end{equation}

where the \(O\) term is the order of \(\hbar\) that is present as a
result of the observable. In the case of particle 1's momentum, \(O=1\).
Similarly, the amplitudes in the real kernel must cancel with:

\begin{equation}\protect\hypertarget{eq-hbarreal}{}{
\hbar^{2-2L'-\abs{X}+O}.
}\label{eq-hbarreal}\end{equation}

Now we see that the \gls{lo} contribution \sidenote{\footnotesize Here the expansion
  is in powers of the coupling constant, so even though we want
  \(\hbar\)s to cancel, the loop order will still affect the order of
  the contribution through the coupling constant \(\coupling\) and the
  \gls{lo} corresponds to \(\coupling\)}to the impulse, which we denote
\(\Delta \emom[1]^{\mu,(0)}\) can only be from the virtual kernel at
tree level. Thus, we have the following equation,

\begin{equation}\protect\hypertarget{eq-impulseLO}{}{
\Delta \emom[1]^{\mu,(0)}=\AAngle{\int \dPsb{\tw}\Exp[\big]{-\im\tw^\mu b_\mu}\ \vIntb[\ct{\emom[1]}]^{(L=0)}}.
}\label{eq-impulseLO}\end{equation}

And the integrand is given by the tree level 4 point amplitude.

\[
\vIntb[\ct{\emom[1]}]^{L=0}=\im\,  \tw^\mu\,  \coupling^{2}{\hbar}^{2}\bar{\mathcal{A}}^{(0)}(\emom[1],\emom[2]\to \emom[1]+\hbar \tw,\emom[2]-\hbar\tw).
\]

At \gls{nlo}, i.e.~\(\kappa^4\) order, both integrands contribute, as
eq.~\ref{eq-rvloopmatch} can be satisfied for \(L=1\), \(L'=0\) and
\(\abs{X}=2\). Thus we have the following equation:

\begin{equation}\protect\hypertarget{eq-impulseNLO}{}{
\Delta \emom[1]^{\mu,(1)}=\AAngle{\int \dPsb{\tw}\Exp[\big]{-\im\tw^\mu b_\mu} \pa[\Big]{\vIntb[\ct{\emom[1]}]^{(L=1)}+\rIntb[\ct{\emom[1]}]^{(L'=0)}}}.
}\label{eq-impulseNLO}\end{equation}

The virtual integrand is now given by the 1-loop level amplitude, and
the real integrand is given by the square of a the tree level amplitude.
This process can go on indefinitely, and is independent of the type of
observable and the theory. Here we considered the change of momentum a
particle, which for a black hole very far away would be very difficult
to measure. However, we can also consider an observable such as the
four-momentum of the radiated particles, or more precisely its
expectation value. Of course, the operator corresponding to this
observable gives zero when acting on the initial momentum states, and
only gives a non-zero result when acting on the messenger states. Thus,
for this observable only the real integrand, starting with \(\abs{X}=1\)
will contribute, the \gls{lo} contribution being given by what is
essentially the unitarity cut of a two loop amplitude. We see that
regardless of observable, the objects that are needed are the
amplitudes.

For each loop level, many diagrams can contribute, but the classical
limit enforces that they must cancel the \(\hbar\) orders given by
eq.~\ref{eq-hbarreal} and eq.~\ref{eq-hbarvirt}. The cancellation order
is dependent on the considered observable and filters the contributing
diagrams. It can also be reformulated in the language of the method of
regions.

To see the whole machinery in action, let us take \gls{sqed} as an
example theory, that shows the relevant subtleties of the formalism.

\hypertarget{sqed-amplitudes}{%
\section{\texorpdfstring{\gls{sqed}
amplitudes}{ amplitudes}}\label{sqed-amplitudes}}

We want to couple a set of massive scalar fields to electromagnetism. We
will use the minimal coupling prescription to ensure that the resulting
Lagrangian exhibits the required gauge symmetry. The minimal coupling
prescription works provided that our free mass Lagrangian admits a
conserved current. Our free mass Lagrangian for two complex scalar
fields with different masses is:

\[
\mathcal{L}_m=\sum\limits_{i=1}^2 \partial_\mu \phi_i^\dagger\,\partial^\mu \phi_i - m_i^2 \phi^\dagger_i \phi_i.
\]

Notice that under the following transformation:

\[
\begin{aligned}
\phi_i(x) &\rightarrow \exp{-\im \charge[i] \lambda} \phi_i(x), \\
\phi_i^{\dagger}(x) &\rightarrow \exp{\im \charge[i] \lambda} \phi_i^\dagger(x) ,\\
\end{aligned}
\]

or infinitesimally:

\[
\begin{aligned}
\delta\phi_i &= -\im  \phi_i \charge[i] \delta\lambda ,\\
\delta\phi_i^{\dagger} &= \im  \phi_i^\dagger \charge[i]\delta \lambda,\\
\end{aligned}
\]

the above Lagrangian is unchanged. We will identitfy \(\charge[i]\) with
the charge, in units of \(\elch\), of each particle. If we upgrade the
parameter \(\lambda\) to a spacetime function \(\lambda(x)\), the
Lagrangian is not invariant anymore and invariance is restored if we
replace all the derivatives \(\partial_\mu\) with the gauge-covariant
derivatives \(D_\mu\):

\[D_\mu=\partial_\mu+\im \,\elch\,\charge[i]\,A_\mu,\]

i.e., if along with the transformation above, we perform a gauge
transformation of the photon field:

\[A_\mu\rightarrow A_\mu + \frac{1}{\elch} \partial_\mu \lambda\]

or infinitesimally

\[\delta A_\mu = \frac{1}{\elch} \partial_\mu \delta \lambda,\]

then the whole Lagrangian:

\[\mathcal{L}_{ED}+\mathcal{L}_{m}(\phi_i,\partial_\mu \phi_i)\rightarrow \mathcal{L}_{ED}+\mathcal{L}_{m}(\phi_i,D_\mu \phi_i),\]

is invariant under the above defined gauge transformation. The final
Lagrangian is:

\[\mathcal{L}=-\frac{1}{4} F_{\mu \nu} F^{\mu \nu}+\sum_{i=1}^{2}\left[\left(D_{\mu} \phi_{i}\right)^{\dagger}\left(D^{\mu} \phi_{i}\right)-m_{i}^{2} \phi_{i}^{\dagger} \phi_{i}\right],\]

with
\(F_{\mu \nu} \equiv \partial_{\mu} A_{\nu}-\partial_{\nu} A_{\mu}\).
Expanding and then integrating by parts:

\[
\begin{aligned}
\mathcal{L} &=-\frac{1}{4}\left(\partial_{\mu} A_{\nu}-\partial_{\nu} A_{\mu}\right)\left(\partial^{\mu} A^{\nu}-\partial^{\nu} A^{\mu}\right)
+\sum_{i=1}^{2}\left[
    \left(\partial_{\mu}-\im\, \elch\,\charge[i]\, A_{\mu} \right)\phi_{i}^{\dagger}
    \left(\partial_{\mu}+\im\, \elch\,\charge[i]\, A_{\mu}\right)\phi_{i}
    -m_{i}^{2} \phi_{i}^{\dagger} \phi_{i}
    \right]
 \\
&=\underbrace{
    \frac{1}{2} A_{\mu}\left[\eta^{\mu \nu}\partial^{2}-\partial^{\mu} \partial^{\nu}\right] A_{\nu}
    +\sum\limits_{i=1}^2-\phi_i^{\dagger}\left(\partial^{2}+m_i^{2}\right) \phi_i
    }_{\mathcal{L}_{0}}
+\underbrace{
    \sum\limits_{i=1}^2q_i^2\,\elch^{2} A_{\mu} A^{\mu} \,\phi^{\dagger}_i \phi_i
    -\im\, \elch\,\charge[i]\, A_{\mu}\left(\phi^{\dagger}_i \partial^{\mu} \phi_i-\left(\partial^{\mu} \phi^{\dagger}_i\right) \phi_i\right)
    }_{\mathcal{L}^{\prime}}.
\end{aligned}
\]

Since we have a massless photon, and still have gauge freedom we have to
implement gauge fixing in the usual way:

\[
\begin{aligned}\mathcal{L}_{\text{eff}}
      &=\mathcal{L}+\overbracket{\frac{-1}{2 \xi}(\partial_\mu A^\mu)^2}^{\mathcal{L_\text{GF}}}\\
      &=
    \frac{1}{2} A_{\mu}\underbracket{\brc[\Bigg]{g^{\mu \nu}\partial^{2}-\pa[\Big]{1-\frac{1}{\xi}}\partial^{\mu} \partial^{\nu}}}_{\rightarrow \phprop_\xi(k)=\frac{-\im}{k^{2}+\im \varepsilon}\left[g_{\mu \nu}-(1-\xi) \frac{k_{\mu} k_{\nu}}{k^{2}}\right]} A_{\nu}
    +\sum\limits_{i=1}^2-\phi_i^{\dagger}\underbracket{\pa{\partial^{2}+m_i^{2}}}_{\feynprop(q^2)=\frac{\im}{p^{2}-m^{2}+\im \varepsilon}} \phi_i\\
&+
    \sum\limits_{i=1}^2\underbracket{\charge[i]^2\,\elch^{2}\,\eta^{\mu \nu}}_{\times 2\im\rightarrow \mathrm{4-vertex} } A_{\mu} A_{\nu} \,\phi^{\dagger}_i \phi_i
    \underbracket{-\im\, \elch\,\charge[i]\, A_{\mu}\left(\phi^{\dagger}_i \partial^{\mu} \phi_i-\left(\partial^{\mu} \phi^{\dagger}_i\right) \phi_i\right)}_{\times \im\rightarrow \mathrm{3-vertex}}.
\end{aligned}
\]

In the last lines we identify the terms contributing to the Feynman
rules. They are given in Table~\ref{tbl-sqedfrules}

\hypertarget{tbl-sqedfrules}{}
\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2500}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2500}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.5000}}@{}}
\caption{\label{tbl-sqedfrules}Feynman rules for
\gls{sqed}}\tabularnewline
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
For every
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Write
\end{minipage} \\
\midrule()
\endfirsthead
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
For every
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Write
\end{minipage} \\
\midrule()
\endhead
\begin{minipage}[t]{\linewidth}\raggedright
\includegraphics{././tikz/photonprop.pdf}
\end{minipage} & internal photon line &
\(\phprop_\xi( \ell)=\frac{-\im}{ \ell^{2}+ \im \varepsilon}\left[\eta_{\mu \nu}-(1-\xi) \frac{\ell_{\mu} \ell_{\nu}}{ ell^{2}}\right]\) \\
\begin{minipage}[t]{\linewidth}\raggedright
\includegraphics{././tikz/scalarprop.pdf}
\end{minipage} & internal scalar &
\(\feynprop(k^2)=\frac{\im}{k^{2}-m^{2} +\im \varepsilon}\) \\
\begin{minipage}[t]{\linewidth}\raggedright
\includegraphics{././tikz/seagull.pdf}
\end{minipage} & \(\phi_i \phi_i^\dagger  A_\mu A_\nu\) vertex &
\(2 \im \charge[i]^2\,\elch^2\,\eta^{\mu \nu}\) \\
\begin{minipage}[t]{\linewidth}\raggedright
\includegraphics{././tikz/cubic.pdf}
\end{minipage} & \(\phi_i(k_i) \phi_i^\dagger(k'_i)  A_\mu\) vertex &
\(\im \elch\,\charge[i]\,(k_i^\mu-  k_i^{\prime\mu})\) \\
\begin{minipage}[t]{\linewidth}\raggedright
\includegraphics{././tikz/extscalar.pdf}
\end{minipage} & External scalar & \(\times 1\) \\
\begin{minipage}[t]{\linewidth}\raggedright
\includegraphics{././tikz/extphoton.pdf}
\end{minipage} &
\(\left\{\begin{array}{c}  \text { incoming } \\  \text { outgoing }  \end{array}\right\}\)
photon &
\(\times \left\{\begin{array}{c}\varepsilon_{\mu}  \\ \varepsilon_{\mu}^{* \prime}  \end{array}\right\}\),
with
\(\varepsilon \cdot k=0,  \varepsilon^{\prime} \cdot k^{\prime}=0\) \\
\bottomrule()
\end{longtable}

where we consider only incoming momenta and the arrows denote incoming
or outgoing particles. For the photon, we will take the Feynamn gauge,
setting \(\xi=1\) and thus
\(\phprop_1(\ell)=\phprop(\ell)=\frac{-\im \eta^{\mu \nu}}{\ell^{2}+\im \varepsilon}\).

\hypertarget{expansions-and-simplifications}{%
\subsection{Expansions and
simplifications}\label{expansions-and-simplifications}}

Notice that if we rescale all photon momenta (taking them to be the loop
momenta) by \(\hbar\) or equivalently take them to be in the soft
region: \(\abs{k}\sim\abs{q}\ll \abs{p}\), where \(p\) is the external
momenta, then the photon propagator scales homogeneously in \(\hbar\),
typically:

\begin{equation}\protect\hypertarget{eq-photonscale}{}{
\inv{(\ell-\tm)^2}=\inv{\hbar^2}\inv{(\bar{\ell}-\tw)^2},
}\label{eq-photonscale}\end{equation}

thus contributes \(\order[-2]{\hbar}\) to the overall diagram. The
matter propagator on the other hand, has inhomogeneous \(\hbar\)
scaling, as we do not rescale the external momenta, (or equivalently the
external momenta are not restricted by the regions). Note that we will
not consider internal mass loops as the soft limit means that massive
pair production is forbidden, thus massive propagators necessarily route
an external momentum. We can nonetheless expand a generic massive
propagator in the soft limit:

\begin{equation}\protect\hypertarget{eq-massiveScale}{}{
\begin{aligned}
\inv{(\ell-\emom[i])^2-\mass[i]^2}&=\inv{\ell^2-2\ell\cdot\emom[i] +\cancel{\emom[i]^2}-\cancel{\mass[i]^2}}= \inv{\hbar^2\bar{\ell}^2-2\hbar \bar{\ell}\cdot \emom[i]}\\
&=-\inv{\hbar} \inv{2\bar{\ell}\cdot\emom[i]}\pa{1+\hbar\frac{ \bar{\ell}^2}{2\bar{\ell}\cdot\emom[i]}+\hbar^2\frac{ \bar{\ell}^4}{(2\bar{\ell}\cdot\emom[i])^2}+\dots}.\\
\end{aligned}
}\label{eq-massiveScale}\end{equation}

In other contexts one may say that the matter propagator has eikonalized
(it is now linear in \(\ell\)). Before we compute the amplitudes let us
set up some useful kinematic identities and variables. If we consider
the two-to-two particle scattering, taking an all outgoing momentum
convention we have the following masses:

\begin{equation}\protect\hypertarget{eq-masses}{}{
 \mass[1]^2=\emom[4]^2 =\emom[1]^2,\quad \mass[2]^2=\emom[2]^2 =\emom[3]^2,
}\label{eq-masses}\end{equation}

and Mandelstahm variables:

\[
 \mands=(\emom[1]+\emom[2])^2,\quad \mandt=\tm^2=(\emom[1]+\emom[4])^2,\quad \mandu=(\emom[1]+\emom[3])^2   ,
\]

subject to the usual equation:

\[
\mands+\mandt+\mandu=2(\mass[1]^2+\mass[2]^2).
\]

We can also change the external momentum variables to ones more amenable
to the soft limit, namely:

\begin{equation}\protect\hypertarget{eq-newmom}{}{
\emom[1]=-\pa[\big]{\semom[1]-\Half[\tm]}, \emom[2]=-\pa[\big]{\semom[2]+\Half[\tm]}, \emom[3]=\pa[\big]{\semom[2]-\Half[\tm]}, \emom[4]=\pa[\big]{\semom[1]+\Half[\tm]} .
}\label{eq-newmom}\end{equation}

The new momentum variables \(\semom[i]\) are crucially orthogonal to
momentum transfer \(\tm\) :\sidenote{\footnotesize we use eq.~\ref{eq-masses}}

\begin{equation}\protect\hypertarget{eq-orthog}{}{
\semom[i]\cdot\tm=0,
}\label{eq-orthog}\end{equation}

and the physical scattering region, given by
\(\mands>(\mass[1]+\mass[2])^2\) and \(\tm^2<0\) is the given by the
same formulas:

\[
\mands=\pa[\Big]{-\pa[\big]{\semom[1]-\Half[\tm]}-\pa[\big]{\semom[2]+\Half[\tm]}}^2=(\semom[1]+\semom[2])^2
\]

and

\[
\mandt=\pa[\Big]{-\pa[\big]{\semom[1]-\Half[\tm]}+\semom[1]+\Half[\tm]}^2 = \tm^2.
\]

With all the ingredients in place, we can now go on to compute the
amplitudes.

\hypertarget{tree-level}{%
\subsection{Tree level}\label{tree-level}}

We start with the tree level amplitude, the only \gls{lo} contribution
in for example eq.~\ref{eq-impulseLO}. The only possible diagram we can
build with four external scalar legs, and vertices as defined in
Table~\ref{tbl-sqedfrules}, is the following tree:

{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\input{././tikz/treelevelsqed.tex}

Tree

}

The amplitude is read off diagram and using Feynman rules for SQED we
have:

\[
\redampl[(0)] = \im\phprop(q)\cdot \,\elch^2\charge[1] \charge[2]2 \ct{\semom[1]} 2\ct[\nu]{\semom[2]}=\frac{4\elch^2\charge[1] \charge[2]\semom[1]\cdot\semom[2]}{\tm^2} ,
\]

using the Mandelstahm invariants described above we can write this as:

\begin{equation}\protect\hypertarget{eq-treeampl}{}{
\redampl[(0)] =\elch^2\charge[1] \charge[2] \frac{4\mass[1]\mass[2]\relfact}{\hbar^2\tw^2},
}\label{eq-treeampl}\end{equation}

where \(\relfact\) is the relativistic factor of particle 1 in the rest
frame of particle 2:

\begin{equation}\protect\hypertarget{eq-relfact}{}{
\relfact=\frac{\mands-\mass[1]^2-\mass[2]^2}{2\mass[1]\mass[2]}=\frac{\emom[1]\cdot\emom[2]}{\mass[1]\mass[2]}=\frac{\semom[1]\cdot\semom[2]}{\mass[1]\mass[2]}+ \order{\hbar}.
}\label{eq-relfact}\end{equation}

We now input the reduced version \(\redampl[(0)]\elch^2=\ampl[(0)]\) of
the amplitude, and take the \(\hbar\to0\) limit of
eq.~\ref{eq-impulseLO}. We can safely take the \(\hbar \to 0\) limit as
the integrand contains no terms singular in \(\hbar\) (the
\(\frac{1}{\hbar^2}\) is cancelled by the \(\hbar^2\) pre-factor).
Notice that the integration measure eq.~\ref{eq-DeltaOclas} simplifies
in the classical limit:\sidenote{\footnotesize Compare to
  \[\begin{aligned}\dPsb{\tw}&=\dn[4]{\tw} \ndeltafn{2\emom[1]\cdot\tw+\hbar\tw^2}\thetafn{\ct[0]{\emom[1]}+\tm^0}\\& \ndeltafn{2\emom[1]\cdot \tw +\hbar\tw^2}\thetafn{\ct[0]{\emom[2]}+\tm^0}\end{aligned}\]
  The theta functions cancel as \(\tm^0\to0\) and \(\emom[i]\) becomes
  classical.}

\[
\lim\limits_{\hbar \to0} \dPsb{\tw}=\dn[4]{\tw} {\ndeltafn{2\mass[1]\cls{\vel[1]}\cdot\tw}}{\ndeltafn{2\mass[2]\cls{\vel[2]}\cdot \tw }}.
\]

The integrand corresponding to the \gls{lo} contribution to the impulse
is then:

\[
\Delta \emom[1]^{\mu,(0)}=4e^2Q_1Q_2\mass[1]\mass[2]\relfact\int\dn[4]{\tw}\exp{-\im\tw\cdot b}\tw^\mu \frac{\cancel{\hbar^2}}{\cancel{\hbar^2}\tw^2}{\ndeltafn{2\mass[1]\cls{\vel[1]}\cdot\tw}}{\ndeltafn{2\mass[2]\cls{\vel[2]}\cdot \tw }}.
\]

This can be analytically computed to find a closed form for the \gls{lo}
impulse.

\[
\Delta \emom[1]^{\mu,(0)}=-\frac{e^{2} Q_{1} Q_{2}}{2 \pi} \frac{\gamma}{\sqrt{\gamma^{2}-1}} \frac{b^{\mu}}{b^{2}}
\]

\hypertarget{one-loop}{%
\subsection{One loop}\label{one-loop}}

Already at one loop the number of possible diagrams increases
dramatically from 1 to 13. One can nonetheless enumerate them. As we
increase loop count, the number of diagrams increases exponentially. It
is therefore useful to have a systematic, programmatic way to handle
these diagrams, and while we are at it, also to compute the amplitudes.
Note that all the code needed to do these computations can be found on
the repository for this book:
\url{https://github.com/lcnhb/GWAmplitudes}.

The first tool we will use is \texttt{QGRAF} Nogueira
(\protect\hyperlink{ref-Nogueira:1993a}{1993}), a Fortran based program
that can generate Feynman diagrams for a given set of vertices and
external legs. The first step is to define the theory we want to derive
the diagrams from. This is essentially writing down the Feynman rules,
without actually specifying what the graphical objects are. For
\gls{sqed} the model file is short:

\textbf{SQEDmodel}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{* propagators}
\NormalTok{ [Phi1,Phi1c,+]}
\NormalTok{ [Phi2,Phi2c,+]}
\NormalTok{ [Photon,Photon,+]}

\NormalTok{* vertices}
\NormalTok{ [Phi1c,Photon,Phi1]}
\NormalTok{ [Phi2c,Photon,Phi2]}
\NormalTok{ [Phi1c,Photon,Photon,Phi1]}
\NormalTok{ [Phi2c,Photon,Photon,Phi2]}
\end{Highlighting}
\end{Shaded}

This file also defines the names of the fields in question. We can then
give \texttt{QGRAF} additional options, such as the number of external
legs, and the number of loops, written in a \texttt{qgraf.dat} file that
can look like this:

\textbf{qgraf.dat}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{output= \textquotesingle{}\{\{output filename\}\}\textquotesingle{} ;}
\NormalTok{style= \textquotesingle{}./styles/julia.sty\textquotesingle{} ; }

\NormalTok{model= \textquotesingle{}./qgraf/SQEDmodel\textquotesingle{};}

\NormalTok{in= Phi1,  Phi2;}
\NormalTok{out= Phi1,Phi2;}
\NormalTok{loops= 1;}
\NormalTok{loop\_momentum= k;}

\NormalTok{options=  notadpole,nosnail,onshell ;}
\end{Highlighting}
\end{Shaded}

where we specify what process we are interested in (two-to-two
scattering). We also specify that we want to compute the one loop
amplitude, and that we want to use the \texttt{julia.sty} style file.
The \texttt{julia.sty} file is a style file that is used to generate the
output in a format that can be read by a \texttt{Julia}
(\protect\hyperlink{ref-Bezanson:2015}{Bezanson et al. 2015}) package
built to process and visualise the outputted graphs. This package is
called (maybe too broadly) \texttt{QFT.jl}, and is hosted on
\href{https://github.com/lcnhb/QFT.jl}{github} . Let us see it in
action. We can run \texttt{QGRAF} from the command line, and it will
generate a file called \texttt{\{\{output\ filename\}\}} that contains
the output of the program. We can then use this in a \texttt{Julia} file
to visualize the diagrams.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{Images}
\ImportTok{using} \BuiltInTok{QFT}
\ImportTok{using} \BuiltInTok{QFT.Diagrams}
\ImportTok{using} \BuiltInTok{QFT.FieldGraphs}
\ImportTok{using} \BuiltInTok{QFT.Fields}
\ImportTok{import}  \BuiltInTok{Catlab.Graphics.Graphviz}\NormalTok{: pprint}
\FunctionTok{include}\NormalTok{(}\StringTok{"SQED.jl"}\NormalTok{)}
\NormalTok{diags}\OperatorTok{=}\FunctionTok{include}\NormalTok{(}\StringTok{"QGRAFout/julia/1lSQED.jl"}\NormalTok{)}


\NormalTok{qDiags}\OperatorTok{=}\NormalTok{[}\FunctionTok{qDiagram}\NormalTok{(;diag}\OperatorTok{...}\NormalTok{) for diag }\KeywordTok{in}\NormalTok{ diags]}
\NormalTok{grafs}\OperatorTok{=}\NormalTok{(x }\OperatorTok{{-}\textgreater{}}\NormalTok{ x.g).(qDiags)}
\FunctionTok{println}\NormalTok{(}\StringTok{"::: \{\#fig{-}oneloopsqed  layout{-}ncol=4 .column{-}body{-}right \}"}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ (i,graf) }\KeywordTok{in} \FunctionTok{enumerate}\NormalTok{(grafs)}
\FunctionTok{println}\NormalTok{(}\StringTok{"\textasciigrave{}\textasciigrave{}\textasciigrave{}\{dot\}"}\NormalTok{)}
\FunctionTok{println}\NormalTok{(}\StringTok{"//| fig{-}width: 1.5"}\NormalTok{)}
    \FunctionTok{pprint}\NormalTok{(}\ConstantTok{stdout}\NormalTok{,}\FunctionTok{to\_graphviz}\NormalTok{(graf,graph\_attrs}\OperatorTok{=}\FunctionTok{Dict}\NormalTok{(}\StringTok{"layout"}\OperatorTok{=\textgreater{}}\StringTok{"neato"}\NormalTok{)))}
    \FunctionTok{println}\NormalTok{(}\StringTok{"\textasciigrave{}\textasciigrave{}\textasciigrave{}"}\NormalTok{)}
\ControlFlowTok{end}
\FunctionTok{println}\NormalTok{(}\StringTok{"all one loop graphs in (?:sqed)"}\NormalTok{)}
\FunctionTok{println}\NormalTok{(}\StringTok{":::"}\NormalTok{)}
\ConstantTok{nothing}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-1.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-21.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-20.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-19.png}

}

\end{figure}

}

\end{minipage}%
\newline
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-18.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-17.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-16.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-15.png}

}

\end{figure}

}

\end{minipage}%
\newline
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-14.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-13.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-12.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-11.png}

}

\end{figure}

}

\end{minipage}%
\newline
\begin{minipage}[t]{0.25\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1.5in,height=3.5in]{./scattering_files/figure-latex/dot-figure-10.png}

}

\end{figure}

}

\end{minipage}%

\end{figure}

We notice a few things about the diagrams in
Figure~\ref{fig-oneloopsqed} above. Not all the diagrams contribute to
the classical limit. Clearly the diagrams with internal matter loops
cannot be allowed when the momenta incoming to the loop is soft
\sidenote{\footnotesize scales like \(\hbar\)}. In the classical limit this momentum
will go to 0, and since the scalars are massive, they need momentum
greater than their mass to be pair-produced, thus these diagrams do not
contribute. Another class of diagrams that does not contribute to the
classical limit are the ones with photon loops that start and end on the
same matter line. These do not contribute because they are scaleless. An
integral is scaleless when its integrand
\(\mathcal{I}_\text{scaleless}(\brk{\ell_i})\) scales homogeneously
under any rescaling of the loop momentum \(\ell_i\):

\[
\mathcal{I}_\text{scaleless}(\brk{\ell_i})\stackrel{\ell_j\to\lambda \ell_j}{\longrightarrow}\lambda^\eta \mathcal{I}_\text{scaleless}(\brk{\ell_i})
\]

Thus, any diagram that has a basis of loops that does not contain both
scalar fields (i.e.~does not cross over) cannot have its scale set by
the momentum transfer, and is thus scaleless. Dimensionally regularized
scaleless integrals vanish, thus we can also discard these diagrams. We
can easily implement such a filter programmatically, by checking that if
cycles are present they touch either both types of scalars, or neither.
To compute the cycle basis we use an algorithm derived from Paton
(\protect\hyperlink{ref-Paton:1969}{1969}), implemented in the
\href{https://github.com/lcnhb/DirectedHalfEdgeGraphs.jl}{DirectedHalfEdgeGraphs.jl}
package.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{Logging}
\BuiltInTok{Logging}\NormalTok{.}\FunctionTok{disable\_logging}\NormalTok{(}\BuiltInTok{Logging}\NormalTok{.Info)}
\KeywordTok{function} \FunctionTok{scaleless}\NormalTok{(g}\OperatorTok{::}\DataTypeTok{AbstractFieldGraph}\NormalTok{)}
\NormalTok{  cycles }\OperatorTok{=}\FunctionTok{cycle\_basis}\NormalTok{(g)}
\NormalTok{  isscaleless}\OperatorTok{=}\ConstantTok{false}
  \ControlFlowTok{for}\NormalTok{ c }\KeywordTok{in}\NormalTok{ cycles}
\NormalTok{    hs}\OperatorTok{=} \FunctionTok{collect}\NormalTok{(}\BuiltInTok{Iterators}\NormalTok{.}\FunctionTok{flatten}\NormalTok{(}\FunctionTok{half\_edges}\NormalTok{.(}\FunctionTok{Ref}\NormalTok{(g),c)))}
\NormalTok{    fields}\OperatorTok{=}\FunctionTok{unique!}\NormalTok{(}\FunctionTok{typeof}\NormalTok{.(}\FunctionTok{field}\NormalTok{.(}\FunctionTok{Ref}\NormalTok{(g),hs)))}
    \ControlFlowTok{if} \FunctionTok{Bool}\NormalTok{(Phi1 }\KeywordTok{in}\NormalTok{ fields) }\OperatorTok{⊻}  \FunctionTok{Bool}\NormalTok{(Phi2 }\KeywordTok{in}\NormalTok{ fields)}
\NormalTok{      isscaleless}\OperatorTok{=}\ConstantTok{true}
    \ControlFlowTok{end}
  \ControlFlowTok{end}
  \ControlFlowTok{return}\NormalTok{ isscaleless}
\KeywordTok{end}

\NormalTok{noscalelessdiags}\OperatorTok{=}\NormalTok{qDiags[.!}\FunctionTok{scaleless}\NormalTok{.(grafs)]}
\NormalTok{classicaldiags}\OperatorTok{=}\NormalTok{noscalelessdiags[}\FloatTok{2}\OperatorTok{:}\KeywordTok{end}\NormalTok{]}
\ControlFlowTok{for}\NormalTok{ (i,d) }\KeywordTok{in} \FunctionTok{enumerate}\NormalTok{(classicaldiags)}
\NormalTok{  d.ID}\OperatorTok{=}\NormalTok{i}
\ControlFlowTok{end}

\FunctionTok{println}\NormalTok{(}\StringTok{"::: \{\#fig{-}onefilterloopsqed  layout{-}ncol=5 .column{-}body{-}right \}"}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ (i,graf) }\KeywordTok{in} \FunctionTok{enumerate}\NormalTok{(grafs[.!}\FunctionTok{scaleless}\NormalTok{.(grafs)])}
\FunctionTok{println}\NormalTok{(}\StringTok{"\textasciigrave{}\textasciigrave{}\textasciigrave{}\{dot\}"}\NormalTok{)}
\FunctionTok{println}\NormalTok{(}\StringTok{"//| fig{-}width: 1"}\NormalTok{)}
    \FunctionTok{pprint}\NormalTok{(}\ConstantTok{stdout}\NormalTok{,}\FunctionTok{to\_graphviz}\NormalTok{(graf,graph\_attrs}\OperatorTok{=}\FunctionTok{Dict}\NormalTok{(}\StringTok{"layout"}\OperatorTok{=\textgreater{}}\StringTok{"neato"}\NormalTok{)))}
    \FunctionTok{println}\NormalTok{(}\StringTok{"\textasciigrave{}\textasciigrave{}\textasciigrave{}"}\NormalTok{)}
\ControlFlowTok{end}
\FunctionTok{println}\NormalTok{(}\StringTok{"one loop graphs that contribute to the classical limit in (?:sqed)"}\NormalTok{)}
\FunctionTok{println}\NormalTok{(}\StringTok{":::"}\NormalTok{)}
\ConstantTok{nothing}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}[t]{0.20\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1in,height=3.5in]{./scattering_files/figure-latex/dot-figure-9.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1in,height=3.5in]{./scattering_files/figure-latex/dot-figure-8.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1in,height=3.5in]{./scattering_files/figure-latex/dot-figure-7.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1in,height=3.5in]{./scattering_files/figure-latex/dot-figure-6.png}

}

\end{figure}

}

\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\begin{figure}[H]

{\centering \includegraphics[width=1in,height=3.5in]{./scattering_files/figure-latex/dot-figure-5.png}

}

\end{figure}

}

\end{minipage}%

\end{figure}

There is one final simplification we can do. The first diagram in
Figure~\ref{fig-onefilterloopsqed} has two photon propagators, and two
quartic vertices, which give it the name: ``double-seagull''. The photon
propagators have homogeneous \(\hbar^{-2}\) scaling (see
eq.~\ref{eq-photonscale}), the vertices only bring constants, and the
loop integration has \(\hbar^4\) scaling. Collecting all scalings this
means that the reduced amplitude has \(\hbar^0\) scaling. However, in
the virtual integrand the reduced amplitude has to cancel with the
transfer momentum's \(\hbar\) scale (see eq.~\ref{eq-impulseIr}). Thus,
the double seagull diagram vanishes in the classical limit.

We are left with only 4 diagrams, the two triangle diagrams, the box,
and cross box, which we can now compute. At this point, we can do this
manually, but again, putting in place a programmatic framework means
that subsequent loops can be treated systematically \sidenote{\footnotesize at least
  at the un-integrated level}. We will also extract one of these
integrands by hand, for completeness and comparison.

The first step is to define the Feynman rules in a computer readable
format. We will use \texttt{Julia} to apply these rules at every vertex
and every edge, but for the actual computation we will use \texttt{FORM}
(\protect\hyperlink{ref-Vermaseren:2000nd}{Vermaseren 2000};
\protect\hyperlink{ref-Kuipers:2012rf}{Kuipers et al. 2013}), which can
automatically contract indices and performs expression manipulations in
an optimized way. The Feynman rules implementation in the package
developed for this thesis make use of \texttt{Julia}s defining paradigm
of multiple dispatch. This allows us to define the rules for each vertex
and each edge in a very compact way. We can define the rules for
\gls{sqed} as follows:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{function} \FunctionTok{feynmanRule}\NormalTok{(mime}\OperatorTok{::}\DataTypeTok{MIME"text/FORM"}\NormalTok{,p,f1}\OperatorTok{::}\DataTypeTok{Photon}\NormalTok{,f2}\OperatorTok{::}\DataTypeTok{Photon}\NormalTok{)}
\NormalTok{  momen }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,p.symbol)}
\NormalTok{  indx1 }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{index}\NormalTok{(f1))}
\NormalTok{  indx2 }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{index}\NormalTok{(f2))}
  \StringTok{"\_i* prop({-}1,0,}\SpecialCharTok{$}\NormalTok{momen}\StringTok{)*d\_(}\SpecialCharTok{$}\NormalTok{indx1}\StringTok{,}\SpecialCharTok{$}\NormalTok{indx2}\StringTok{)"}
\KeywordTok{end}

\PreprocessorTok{@symmetric} \KeywordTok{function} \FunctionTok{feynmanRule}\NormalTok{(mime}\OperatorTok{::}\DataTypeTok{MIME"text/FORM"}\NormalTok{,p,[f1}\OperatorTok{::}\DataTypeTok{Phi1}\NormalTok{,f2}\OperatorTok{::}\DataTypeTok{Phi1c}\NormalTok{])}
\NormalTok{  momen }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,p.symbol)}
  \StringTok{"\_i* prop({-}1,1,}\SpecialCharTok{$}\NormalTok{momen}\StringTok{)"}
\KeywordTok{end}

\PreprocessorTok{@symmetric}\NormalTok{ function }\FunctionTok{feynmanRule}\NormalTok{(mime}\OperatorTok{::}\DataTypeTok{MIME"text/FORM"}\NormalTok{,p,[f1}\OperatorTok{::}\DataTypeTok{Phi2}\NormalTok{,f2}\OperatorTok{::}\DataTypeTok{Phi2c}\NormalTok{])}
\NormalTok{  momen }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,p.symbol)}

  \StringTok{"\_i* prop({-}1,2,}\SpecialCharTok{$}\NormalTok{momen}\StringTok{)"}
\KeywordTok{end}

\PreprocessorTok{@symmetric}\NormalTok{ function }\FunctionTok{feynmanRule}\NormalTok{(mime}\OperatorTok{::}\DataTypeTok{MIME"text/FORM"}\NormalTok{,[(pᵩ₁,a)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,ScalarField\{S\}\}}\NormalTok{,}
\NormalTok{            (pᵩ₂,b)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,AdjointField\{ScalarField\{S\}\}\}}\NormalTok{,}
\NormalTok{            (pᵧ,γ)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,Photon\}}\NormalTok{]) }\KeywordTok{where}\NormalTok{ \{S\}}
\NormalTok{  p1 }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{pᵩ₁}\NormalTok{(}\FunctionTok{index}\NormalTok{(γ)))}
\NormalTok{  p2 }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{pᵩ₂}\NormalTok{(}\FunctionTok{index}\NormalTok{(γ)))}
\NormalTok{  q }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{charge}\NormalTok{(a))}
  \StringTok{"\_i*e*}\SpecialCharTok{$}\NormalTok{q}\StringTok{*(}\SpecialCharTok{$}\NormalTok{p2}\StringTok{{-}}\SpecialCharTok{$}\NormalTok{p1}\StringTok{)"}
\KeywordTok{end}

\PreprocessorTok{@symmetric}\NormalTok{ function }\FunctionTok{feynmanRule}\NormalTok{(mime}\OperatorTok{::}\DataTypeTok{MIME"text/FORM"}\NormalTok{,[(pᵧ₁,γ₁)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,Photon\}}\NormalTok{,}
\NormalTok{            (pᵧ₂,γ₂)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,Photon\}}\NormalTok{,(pᵩ₂,b)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,AdjointField\{ScalarField\{S\}\}\}}\NormalTok{,}
\NormalTok{            (pᵩ₁,a)}\OperatorTok{::}\DataTypeTok{Tuple\{Any,ScalarField\{S\}\}}\NormalTok{]) }\KeywordTok{where}\NormalTok{ \{S\}    }
\NormalTok{  mu }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{index}\NormalTok{(γ₁))}
\NormalTok{  nu }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{index}\NormalTok{(γ₂)) }
\NormalTok{  q }\OperatorTok{=} \FunctionTok{repr}\NormalTok{(mime,}\FunctionTok{charge}\NormalTok{(a))}
  \StringTok{"2*\_i*}\SpecialCharTok{$}\NormalTok{q}\StringTok{\^{}2*e\^{}2*d\_(}\SpecialCharTok{$}\NormalTok{mu}\StringTok{,}\SpecialCharTok{$}\NormalTok{nu}\StringTok{)"}
\KeywordTok{end} 
\end{Highlighting}
\end{Shaded}

where we define \texttt{prop(n,i,p)} as representing a generic Feynman
propagator, which we will denote:

\[
 D_{-}(n,i,p)=\mathtt{prop(n,i,p)}=\pa{p^2-m_i^2+i\epsilon}^{n} \quad \text{thus} \quad \mathtt{prop(-1,i,p)}=\frac{1}{p^2-m_i^2+i\epsilon}.
\]

We can now apply these Feynman rules to the graphs we have left,
obtaining \texttt{FORM} readable integrands. For example, the box
diagram gives:

\begin{Shaded}
\begin{Highlighting}[]
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}\{julia\}}
\NormalTok{toform(stdout,classicaldiags[}\DecValTok{3}\NormalTok{])}
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
*--#[d3l1:
\end{verbatim}

\begin{verbatim}
L [d3l1|o.3.4|i.3.4|i|o|] = 1*i_* prop(-1,0,q1)*d_(nu1,nu2)*i_* prop(-1,1,q2)*i_* prop(-1,2,q3)*i_* prop(-1,0,q4)*d_(nu7,nu8)*i_*e*qch1*(q2(nu1)-p4(nu1))*i_*e*qch2*(q3(nu2)-p2(nu2))*i_*e*qch1*(p3(nu7)-q2(nu7))*i_*e*qch2*(p1(nu8)-q3(nu8));
#procedure momentumRouting
\end{verbatim}

\begin{verbatim}
Id q2 = p3 + -q4;
Id p1 = p2 + p4 + -p3;
Id q1 = p3 + -p4 + -q4;
Id q3 = p2 + p4 + q4 + -p3;

Id q4= l1;
#endprocedure
*--#]d3l1:
\end{verbatim}

Notice that we also define the momentum routing by imposing the
replacement rules, one per vertex. This can be done in many ways but to
ensure proper scaling we set the loop momenta to be homogeneous on the
massless lines. This is done by the \texttt{Julia} program, using
Kruskal's algorithm (\protect\hyperlink{ref-Kruskal:1956}{Kruskal 1956})
to find the maximal-mass spanning tree of the graph, and then setting
the loop momenta to be those internal edges that are missing from the
tree. The maximal mass spanning tree of the box is visualised in
Figure~\ref{fig-kruskalbox} .Using \texttt{FORM}, we can contract
indices and apply the momentum conservation rules. Finally, we also
apply the relabeling rules described in eq.~\ref{eq-newmom}. The
\texttt{FORM} version of the box integrand is then given in
Listing~\ref{lst-formBox}.

\begin{figure}

\sidecaption{\label{fig-kruskalbox}The maximal mass spanning tree of the
box diagram in blue. The loop momenta are the edges that are missing
from the tree.}

{\centering \includegraphics{./kruskalbox.png}

}

\end{figure}

\begin{codelisting}

\caption{Box integrand in FORM}

\hypertarget{lst-formBox}{%
\label{lst-formBox}}%
\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{   [d3l1|o.3.4|i.3.4|i|o|] =}
\NormalTok{         ( prop({-}1,0,q {-} l1) )}
\NormalTok{       * ( prop({-}1,0,l1) )}
\NormalTok{       * ( prop({-}1,1,1/2*q {-} l1 + pb1) )}
\NormalTok{       * ( prop({-}1,2, {-} 1/2*q + l1 + pb2) )}
\NormalTok{       * ( dot(q,q) {-} 2*dot(q,l1) {-} 2*dot(q,pb2) + 2*dot(q,pb1) + dot(l1,l1)}
\NormalTok{          + 2*dot(l1,pb2) {-} 2*dot(l1,pb1) {-} 4*dot(pb2,pb1) )}
\NormalTok{       * ( dot(l1,l1) + 2*dot(l1,pb2) {-} 2*dot(l1,pb1) {-} 4*dot(pb2,pb1) )}
\NormalTok{       * ( qch2 ) * ( qch2 ) * ( qch1 ) * ( qch1 )}
\NormalTok{       * ( e ) * ( e ) * ( e ) * ( e );}
\end{Highlighting}
\end{Shaded}

\end{codelisting}

When applied to all 4 diagrams, we obtain precisely the same integrands
as those in Kosower, Maybee, and O'Connell
(\protect\hyperlink{ref-Kosower:2018adc}{2019}). Additionally, we notice
that the two triangles and the box diagram have overlapping propagators.
In fact the denominators of the integrands for all three can be written
as:

\begin{equation}\protect\hypertarget{eq-boxfam}{}{
\Box_{i_1,i_2,i_3,i_4}=\inv{\rho_1^{i_1}\rho_2^{i_2}\rho_3^{i_3}\rho_4^{i_4}},
}\label{eq-boxfam}\end{equation}

for powers \(\brk{i}\in\brk{0,1}^4\), where the inverse propagators
\(\rho_i\) are:

\[
\rho_1=\ell^2+\im \epsilon,\quad \rho_2=(\ell-q)^2+\im \epsilon,\quad \rho_3=(\Half[q]-\ell+\semom[1])^2-\mass[1]^2+\im \epsilon,\quad \rho_4=(-  \Half[q]+\ell+\semom[2])^2-\mass[2]^2+\im \epsilon
\]

Note that in the classical limit we can expand the massive propagators
as shown in eq.~\ref{eq-massiveScale} and obtain, to first order in
\(\hbar\),

\[
\rho_3=2\ell\cdot\semom[1]+\im \epsilon,\quad \rho_4= -2\ell\cdot\semom[2]+\im \epsilon,
\]

where we used eq.~\ref{eq-orthog}. The cross box can in fact extend this
family, by adding just one more inverse propagator. We now have the
complete description of the denominators of all 1-loop contributing
diagrams. The numerators in fact do not complicate things much. They are
all composed of scalar products of momenta. If these do not contain
loop-momenta they are just constant factors in front of the integral.
The scalar products that do contain loop momenta can be written as
inverse powers of the propagators. This is the case for any Feynman like
integrand. Consider the following general integrand:

\[
\mathcal{I}= \frac{\mathcal{N}}{\mathcal{D}}=\frac{\prod\limits_{S'}N_{S'}}{\prod\limits_{S}D_S}=\frac{\prod\limits_{S'}\sum\limits_{i\geq j} S'_{ij}p_i\cdot p_j}{\prod\limits_{S}\sum\limits_{i\geq j} S_{ij}p_i\cdot p_j},
\]

where \({S}\) and \({S'}\) are sets of coefficient matrices for all
possible dot products. If we have a quadruplet \(\brk{A,B,a,b}\) such
that \(A_{a,b}\neq0\) and \(B_{a,b}neq0\) and \(p_{a}\)or \(p_{b}\) is a
loop momentum \(\ell\), say \(p_a=\ell\),then it is useful to write this
component of the integrand as:

\begin{equation}\protect\hypertarget{eq-scalarred}{}{
\frac{N_{B}}{D_{A}}=\frac{\tilde{N}_B+B_{ab}\ell\cdot p_b}{A_{ab}\ell\cdot p_b +\sum\limits_{\substack{i\geq j \\ i,j\neq a,b}}A_{ij}p_i\cdot p_j}=\frac{\tilde{N}_B}{D_A}+\frac{B_{ab}}{A_{ab}}\pa[\Big]{1-\frac{\tilde{D}_A}{D_A}},
}\label{eq-scalarred}\end{equation}

where the tilde means that we have remove the \(ab\) contribution. Thus,
we see that we obtain a sum of objects in the numerator, none of which
contains the dot product: \(\ell\cdot p_b\). We can do this for every
quadruplet \(\brk{A,B,a,b}\), after every replacement, and obtain an
integrand containing only so called \emph{irreducible} loop-momenta
scalar products. In the cases we have here, they all disappear, leaving
us truly with a family of integrands like eq.~\ref{eq-boxfam}. This can
be readily fed into a IBP solver, such as \texttt{AIR}
(\protect\hyperlink{ref-Anastasiou:2004}{C. Anastasiou and Lazopoulos
2004}), \texttt{FIRE} (\protect\hyperlink{ref-Smirnov:2020}{Smirnov and
Chukharev 2020}) or \texttt{Kira}
(\protect\hyperlink{ref-Maierhofer:2018}{Maierhöfer and Usovitsch
2018}).

With such a solver we can obtain a complete family of integrals, which
can be evaluated. We are thus able to obtain the integrated integrands
at \gls{nlo} that are then used in eq.~\ref{eq-impulseIr} and
eq.~\ref{eq-impulseIv}. The algorithm described above was implemented in
\texttt{FORM} and is able to rapidly process the 1-loop diagrams. The
code is available in the repository for this thesis.

Importantly, we still need to take the classical limit. At this point a
problem shows up. The box and cross box integrals are divergent in the
classical limit (some authors call this super classical). Let us see
this for the box integral. We have from Listing~\ref{lst-formBox} that
the integral for the box diagram \(B\) is:

\[
\im B = \elch^4 Q_{1} Q_{2} \int \dn[D]{\ell} \\pa{4 \semom[1]\cdot \semom[2]  + 2\ell\cdot\pa{\semom[2] -\semom[1]} -\pa{\tm-\ell}^2}\pa{4 \semom[1]\cdot \semom[2]  + 2\ell\cdot\pa{\semom[2] -\semom[1]} -\pa{\ell}^2}Box_{1,1,1,1}
\]

we can apply the procedure described above, turning messenger momenta
into wave-numbers:

\[
\im B = \elch^4 Q_{1} Q_{2} \int \dn[D]{\bar{\ell}}\frac{\hbar^D}{\hbar^6} \pa{4 \semom[1]\cdot \semom[2]  + \hbar2\bar{\ell}\cdot\pa{\semom[2] -\semom[1]} -\hbar^2\pa{\tw-\bar{\ell}}^2}\pa{4 \semom[1]\cdot \semom[2]  + \hbar2\bar{\ell}\cdot\pa{\semom[2] -\semom[1]} -\hbar^2\pa{\bar{\ell}}^2}\Box_{\bar{1},\bar{1},\bar{1},\bar{1}},
\]

where
\(\Box_{\bar{i}_1,\bar{i}_2,\bar{i}_3,\bar{i}_4} =\inv{\hbar^{2(i_1+i_2)+i_3+i_4}} \Box_{i_1,i_2,i_3,i_4}\)
is the box family with wave-number instead of messenger momenta, and
\(\hbar\)s extracted. We notice that if we apply the scalar product
reduction eq.~\ref{eq-scalarred}, we will necessarily still have an
integral of the form \sidenote{\footnotesize along with ones that are of the form
  \(\Box_{1,1,1,0}\) and other permutations. These are not divergent in
  the classical limit, as they have one less propagator, thus one less
  \(\hbar\), just enough to cancel what is left of the \(\hbar\) in the
  numerator, and have an overall \(\order[0]{\hbar}\) scaling.}:

\[
\elch^4 Q_{1} Q_{2} 16 (\semom[1]\cdot \semom[2])^2 \int \dn[D]{{\ell}}\Box_{1,1,1,1}=\order[D-6]{\hbar}.
\]

We need to cancel with the \(\hbar\) in the classical limit
(eq.~\ref{eq-hbarvirt}), here we have one too many orders in the
denominator (if D=4). Thus, we would get a divergent (\(\inv{\hbar}\))
contribution when taking the classical \(\hbar\to 0\) limit. If we
consider now the cross box, which is the same family as above but with
an extra minus sign:

\[
\tilde{\rho}_4=( \Half[q] -\ell+\semom[2])^2-\mass[2]^2+\im \epsilon\simeq  2\ell\cdot\semom[2]+\im \epsilon.
\]

If we write that
\(\Box_{i_1^+,i_2^+,i_3^+,i_4^+}=\Box_{i_1,i_2,i_3,i_4}\) where the sign
is the sign of the \(\im\epsilon\) prescription, then we can write the
cross box integral as: \[
\int \dn[D]{\ell} -\Box_{1,1,1,1^-}
\]

thus summing up the two divergent contributions from the box and cross
box we have:

\begin{equation}\protect\hypertarget{eq-boxcross}{}{
\Box_{1,1,1,1}-\Box_{1,1,1,1^-}=\Box_{1,1,1,0}\pa[\Big]{\inv{-2\ell\cdot\semom[2]+\im \epsilon}-\inv{    2\ell\cdot\semom[2]+\im \epsilon}}=-\im\Box_{1,1,1,0}\ndeltafn{2\ell\cdot\semom[2]},
}\label{eq-boxcross}\end{equation}

where in the equation line we used \emph{reverse unitarity}
(\protect\hyperlink{ref-Anastasiou:2002yz}{Charalampos Anastasiou and
Melnikov 2002}; \protect\hyperlink{ref-Anastasiou:2002qz}{Charalampos
Anastasiou, Dixon, and Melnikov 2003};
\protect\hyperlink{ref-Anastasiou:2003yy}{Charalampos Anastasiou et al.
2003}). This idea was developed in the context of cross-section
calculations in the for collider physics. It enables to set on equal
footing real contributions \sidenote{\footnotesize such as ones in the real integrand
  eq.~\ref{eq-rInt}} where we integrate over on shell momenta
\sidenote{\footnotesize thus three dimensional momentum space} and virtual integrals,
where the integration is over all possible four-momentum \sidenote{\footnotesize as
  virtual particles can be off shell}. The idea is to trade the on-shell
delta functions and their \(n\)-th derivatives for differences of
(powers of) propagators with alternating \(\im \epsilon\):

\begin{equation}\protect\hypertarget{eq-reverseunitarity}{}{
\frac{\im}{(-1)^ nn!} \odv[n]{}{z} \ndeltafn{z}   = \inv{\pa{z  -\im \epsilon}^{(n+1)}}  - \inv{\pa{z+\im \epsilon}^{(n+1)}}.
}\label{eq-reverseunitarity}\end{equation}

In our case eq.~\ref{eq-reverseunitarity} implies the following
identities:

\begin{equation}\protect\hypertarget{eq-revone}{}{
\ndeltafn{-2\ell\cdot\semom[2]}=\im\pa{\Box_{0,0,0,1}-\Box_{0,0,0,1^-}}
}\label{eq-revone}\end{equation}

\begin{equation}\protect\hypertarget{eq-revtwo}{}{
\ndeltafn{2\ell\cdot\semom[1]}=\im\pa{\Box_{0,0,1,0}-\Box_{0,0,1^-,0}}
}\label{eq-revtwo}\end{equation}

Since we were able to write this difference of propagators as a sort of
cut, we could further compare the divergent part of the box and cross
box with the corresponding real contribution, which is at tree level,
with no cut messengers: \(L'=0\) and \(\abs{X}=0\) such that
eq.~\ref{eq-rvloopmatch} is satisfied. We have:

\[
\begin{aligned}
\int &\dn[4]{\bar{w}}\ndeltafn{2\semom[1]\cdot \bar{w}-\hbar\Half[\tw] \cdot \bar{w}  +\hbar\bar{w}^2}\ndeltafn{-2\semom[2] \cdot \bar{w}+\hbar\Half[\tw] \cdot \bar{w}+\hbar\bar{w}^2} \\
&\times    \hbar\bar{w}^\mu\\
&\times\coupling^{4}{\hbar}^{2}\redamp[(0)]{\semom[1]-\hbar\Half[\tw],\semom[2]+\hbar\Half[\tw] }{\semom[1]+\hbar\Half[\tw]+\hbar\bar{w}, \semom[2]-\hbar\Half[\tw]-\hbar\bar{w}_2} \\
&\times\aredamp[(0)]{\semom[1]+\hbar\Half[\tw],\semom[2]+\hbar\Half[\tw]-\hbar \tw}{\semom[1]-\hbar\Half[\tw]+\hbar\bar{w}, \semom[2]+\hbar\Half[\tw]-   \hbar\bar{w}_2}.
\end{aligned}
\]

where the \(\redampl[(0)]\) we already computed in
eq.~\ref{eq-treeampl}, and we have eliminated the theta functions in
preparation of taking the classical limit. Thus, it is essentially a cut
of a one-loop box. Notice that in the classical limit we must cancel
with \(\hbar^3\) (eq.~\ref{eq-hbarreal}) which at leading order is again
overdone. The \(\semom[1]\cdot \semom[2]\) contribution from each tree
scales like \(\inv{\hbar^4}\), and is thus classically divergent as the
box and cross box before it. We also notice it has the following form:

\[
\elch^4 Q_{1} Q_{2} 16 (\semom[1]\cdot \semom[2])^2\inv{\hbar}\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\ndeltafn{2\semom[1] \cdot \bar{\ell}}\ndeltafn{-2\semom[2] \cdot \bar{\ell}}\Box_{\bar{1},\bar{1},\bar{0},\bar{0}},
\]

where we have changed variables from \(\bar{w}\) to \(\bar{\ell}\) and
removed the \(\hbar(\Half[\tw] \cdot \bar{\ell}\pm\bar{ \ell}^2)\) term
in the delta functions, in preparation for the classical limit. We can
now apply reverse unitarity (eq.~\ref{eq-revone},eq.~\ref{eq-revtwo})
and focus on the integral without the pre-factors:

\[
\begin{aligned}
\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu&\ndeltafn{2\semom[1] \cdot \bar{\ell}}\ndeltafn{-2\semom[2] \cdot \bar{\ell}}\Box_{\bar{1},\bar{1},\bar{0},\bar{0}}  =    \int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\ndeltafn{2\semom[1] \cdot \bar{\ell}}\im\pa{\Box_{0,0,0,1}-\Box_{0,0,0,1^-}}\Box_{\bar{1},\bar{1},\bar{0},\bar{0}}  \\  
&=-\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\pa{\Box_{0,0,1,0}-\Box_{0,0,1^-,0}}\pa{\Box_{1,1,0,1}-\Box_{1,1,0,1^-}} ,\\
&=\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\brc{\pa{\Box_{1,1,1,1^-}-\Box_{1,1,1,1}}+\pa{\Box_{1,1,1^-,1}-\Box_{1,1,1^-,1^-}}} .
\end{aligned}
\]

We now notice something interesting, this cut integral has a sort of
horizontal flip symmetry, i.e., if we average over the existing `loop'
momentum labelling and a new \(\ell'=q-\ell\) we eliminate the
\(\ct{\ell}\) dependence in the numerator:

\[
\Half\brc{\ct{\ell}+\pa{\ct{q}-\ct{\ell}}}=\ct{q}
\]

since the box families transform as:

\begin{equation}\protect\hypertarget{eq-boxtrans}{}{
\Box'_{i,j,m,n}=(-1)^m(-1 )^n\Box_{j,i,-m,-n}.
}\label{eq-boxtrans}\end{equation}

Thus we have that the cut integral with the \(\ct{\tw}\) factored out:

\[
\int \dn[4]{\bar{\ell}}\Half\brc{\pa{\Box_{1,1,1,1^-}-\Box_{1,1,1,1}}+\pa{\Box_{1,1,1^-,1}-\Box_{1,1,1^-,1^-}}} .
\]

We can apply the relabeling only this time only for the last two
integrands, and the integral becomes, applying eq.~\ref{eq-boxtrans}:

\[
\int \dn[4]{\bar{\ell}}\Half\brc{\pa{\Box_{1,1,1,1^-}-\Box_{1,1,1,1}}+\pa{\Box'_{1,1,1^-,1}-\Box'_{1,1,1^-,1^-}}}= \int \dn[4]{\bar{\ell}}\pa{\Box_{1,1,1,1^-}-\Box_{1,1,1,1}}  .
\]

If we now add the box and cross box contributions from
eq.~\ref{eq-boxcross} we get:

\[
\int \dn[4]{\bar{\ell}}\pa{\bcancel{\Box_{1,1,1,1^-}}-\cancel{\Box_{1,1,1,1}}}+\cancel{\Box_{1,1,1,1}}-\bcancel{\Box_{1,1,1,1^-}}  =  0.
\]

The classically divergent terms have cancelled leaving us with only the
finite terms. We now have full control over the classical limit of the
one loop contribution to the real and virtual parts of the amplitude.

\hypertarget{higher-order-and-gravity}{%
\subsection{Higher order and gravity}\label{higher-order-and-gravity}}

The code provided is fully general in loop number and can be extended
readily to higher loops, at the un-integrated level. The number of
contributing diagrams quickly increases however. At two loops, we go
from 5 non-scaleless diagrams to 34 (see
Figure~\ref{fig-2lSQEDclassical}), and at three loops we have 470
diagrams (see Figure~\ref{fig-3lSQEDclassical}).

\hypertarget{fig-2lSQEDclassical}{}
{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\begin{figure}[H]

{\centering \includegraphics[width=8in,height=3.5in]{./scattering_files/figure-latex/dot-figure-4.png}

}

\end{figure}

\label{fig-2lSQEDclassical}All scaleful diagrams, in the classical limit
at two loops in SQED

}

\begin{figure}

\sidecaption{\label{fig-3lSQEDclassical}All scaleful diagrams, in the
classical limit at three loops in SQED}

{\centering \includegraphics{./3lSQEDclass.png}

}

\end{figure}

The classically divergent term cancelations, have been explicitly
derived above for the one loop case, however it is not immediately
extendable to higher loops. Arguments using Cutkosky rules have been
used in (Herrmann et al.
\protect\hyperlink{ref-Herrmann:2021tct}{Herrmann et al. 2021}) to show
this at two loops.

We have up to now only considered the toy model of scalar QED, however
the same techniques can be applied to gravity. In this case one
considers the same scalars minimally coupled to gravity, using the
Einstein-Hilbert action. Going through the same procedures as above,
with more algebra, one can also obtain Feynman rules. One key difference
is that the gravitons self interact, and do so for any vertex degree.
Additionally, the graviton-scalar vertex can also involve any number of
gravitons. Of course the highest degree vertex is always limited by the
number of loops, such that in practice, one only needs to consider
truncated Feynman rules. We implemented these rules in \texttt{QGRAF}
and \texttt{Julia}, and we can see the resulting diagrams at one loop in
Figure~\ref{fig-1lGRclassical} only contains one new diagram, and two
loops Figure~\ref{fig-2lGRclassical}, there are substantially more new
diagrams.

\hypertarget{fig-1lGRclassical}{}
{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\begin{figure}[H]

{\centering \includegraphics[width=8in,height=3.5in]{./scattering_files/figure-latex/dot-figure-3.png}

}

\end{figure}

\label{fig-1lGRclassical}All scaleful diagrams, in the classical limit
at 1 loop in GR

}

\hypertarget{fig-2lGRclassical}{}
{
\makeatletter
\def\LT@makecaption#1#2#3{%
  \noalign{\smash{\hbox{\kern\textwidth\rlap{\kern\marginparsep
  \parbox[t]{\marginparwidth}{%
    \footnotesize{%
      \vspace{(1.1\baselineskip)}
    #1{#2: }\ignorespaces #3}}}}}}%
    }
\makeatother

\begin{figure}[H]

{\centering \includegraphics[width=8in,height=3.5in]{./scattering_files/figure-latex/dot-figure-2.png}

}

\end{figure}

\label{fig-2lGRclassical}All scaleful diagrams, in the classical limit
at 2 loops in GR

}

\bookmarksetup{startatroot}

\hypertarget{sec-conclusion}{%
\chapter{Conclusion}\label{sec-conclusion}}

In this thesis, we explored the landscape of theoretical research that
surrounds gravitational wave detection. We showed the existence of
gravitational waves theoretically. We motivated waveform generation
techniques grounded in first principles' physics. It is only through
such precise frameworks that we can hope to elucidate the nature of the
objects that emit gravitational radiation. We looked at \gls{nr} and
\gls{eob} two complementary approaches to waveform generation that
enabled \gls{ligo} to make the field changing detection in 2016. Both
approaches have their challenges, \gls{nr} with stability and
computational cost, and \gls{eob} with higher order perturbative
calculations. Each increase in precision enables a more precise match of
the signal, enabling a much richer analysis of the incoming wave. Purely
analytical tools have recently come into the crosshairs of particle
physicists as well.

We then went on to understand these nascent formalisms built on
techniques from particle physics. The \gls{eft} matching approach
enables a simple map from \gls{eob} to amplitudes computed in the
potential kinematic region. \gls{eft}, and \gls{eob} in general,
struggle to use and implement dissipation however. The Hamiltonian
framework has to be somehow augmented with the dissipative forces. This
motivates frameworks that sidestep the \gls{eob} framework. We explored
the most developed one currently: \gls{kmoc} . We were able to express
classical observables such as the impulse in terms of the classical
limit amplitudes and their unitarity cuts. We then went on to implement
a programmatic framework for expressing the necessary integrals that the
amplitudes yield. We used custom code to apply Feynman rules, manipulate
and filter the graphs. We matched the results from Kosower, Maybee, and
O'Connell (\protect\hyperlink{ref-Kosower:2018adc}{2019}), and then
implemented a scalar product reduction for preparing the input to IBP
reduction programs.

The results and formalisms explored here show that amplitude techniques
in gravitational wave theory are a very promising and powerful tool.
Much of the recent \gls{hep} techniques can directly be put to use in
this context, and can already outperform traditional methods. The higher
perturbative order frontier however is increasingly difficult. At some
point in the near future, these computations will have exhausted the
techniques currently in use for particle physics. The next step is to
develop new techniques that can be applied to both fields. Important
work needs to be done to have a fully amplitude based
waveform-generation framework. This might be the next revolution in
gravitational wave theory.

\bookmarksetup{startatroot}

\hypertarget{references}{%
\chapter*{References}\label{references}}
\addcontentsline{toc}{chapter}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\begin{figure*}

\end{figure*}

\leavevmode\vadjust pre{\hypertarget{ref-LIGOScientific:2016aoc}{}}%
Abbott, B. P., R. Abbott, T. D. Abbott, et al. 2016. {``Observation of
{Gravitational Waves} from a {Binary Black Hole Merger}.''}
\emph{Physical Review Letters} 116 (6): 061102.
\url{https://doi.org/10.1103/PhysRevLett.116.061102}.

\leavevmode\vadjust pre{\hypertarget{ref-LIGOScientific:2017vwq}{}}%
Abbott, B. P., Rich Abbott, Thomas D. Abbott, et al. 2017.
{``{GW170817}: {Observation} of {Gravitational Waves} from a {Binary
Neutron Star Inspiral}.''} \emph{Physical Review Letters} 119 (16):
161101. \url{https://doi.org/10.1103/PhysRevLett.119.161101}.

\leavevmode\vadjust pre{\hypertarget{ref-LIGOScientific:2021qlt}{}}%
Abbott, R., T. D. Abbott, S. Abraham, F. Acernese, K. Ackley, A. Adams,
C. Adams, et al. 2021. {``Observation of {Gravitational Waves} from {Two
Neutron Star}\textendash{{Black Hole Coalescences}}.''} \emph{The
Astrophysical Journal Letters} 915 (1): L5.
\url{https://doi.org/10.3847/2041-8213/ac082e}.

\leavevmode\vadjust pre{\hypertarget{ref-Anastasiou:2006jv}{}}%
Anastasiou, Charalampos, Ruth Britto, Bo Feng, Zoltan Kunszt, and
Pierpaolo Mastrolia. 2007. {``D-Dimensional Unitarity Cut Method.''}
\emph{Physics Letters B} 645 (2-3): 213--16.
\url{https://doi.org/10.1016/j.physletb.2006.12.022}.

\leavevmode\vadjust pre{\hypertarget{ref-Anastasiou:2002qz}{}}%
Anastasiou, Charalampos, Lance Dixon, and Kirill Melnikov. 2003. {``{NLO
Higgs} Boson Rapidity Distributions at Hadron Colliders.''}
\emph{Nuclear Physics B - Proceedings Supplements}, Proceedings of the
6th {International Symposium} on {Radiative Corrections} and the 6th
{Zeuthen Workshop} on {Elementary Particle Theory}, 116: 193--97.
\url{https://doi.org/10.1016/S0920-5632(03)80168-8}.

\leavevmode\vadjust pre{\hypertarget{ref-Anastasiou:2003yy}{}}%
Anastasiou, Charalampos, Lance Dixon, Kirill Melnikov, and Frank
Petriello. 2003. {``Dilepton {Rapidity Distribution} in the {Drell-Yan
Process} at {Next-to-Next-to-Leading Order} in {QCD}.''} \emph{Physical
Review Letters} 91 (18): 182002.
\url{https://doi.org/10.1103/PhysRevLett.91.182002}.

\leavevmode\vadjust pre{\hypertarget{ref-Anastasiou:2002yz}{}}%
Anastasiou, Charalampos, and Kirill Melnikov. 2002. {``Higgs Boson
Production at Hadron Colliders in {NNLO QCD}.''} \emph{Nuclear Physics
B} 646 (1): 220--56.
\url{https://doi.org/10.1016/S0550-3213(02)00837-4}.

\leavevmode\vadjust pre{\hypertarget{ref-Anastasiou:2004}{}}%
Anastasiou, C., and A. Lazopoulos. 2004. {``Automatic {Integral
Reduction} for {Higher Order Perturbative Calculations}.''}
\emph{Journal of High Energy Physics} 2004 (07): 046--46.
\url{https://doi.org/10.1088/1126-6708/2004/07/046}.

\leavevmode\vadjust pre{\hypertarget{ref-Bern:2019crd}{}}%
Bern, Z., C. Cheung, R. Roiban, Chia-Hsien Shen, M. P. Solon, and M.
Zeng. 2019. {``Black Hole Binary Dynamics from the Double Copy and
Effective Theory.''} \emph{Journal of High Energy Physics} 10 (October):
206. \url{https://doi.org/10.1007/JHEP10(2019)206}.

\leavevmode\vadjust pre{\hypertarget{ref-Bern:1994cg}{}}%
Bern, Z., L. Dixon, D. C. Dunbar, and D. A. Kosower. 1995. {``Fusing
{Gauge Theory Tree Amplitudes Into Loop Amplitudes}.''} \emph{Nuclear
Physics B} 435 (1-2): 59--101.
\url{https://doi.org/10.1016/0550-3213(94)00488-Z}.

\leavevmode\vadjust pre{\hypertarget{ref-Bern:2004ky}{}}%
Bern, Zvi, Vittorio Del Duca, Lance J. Dixon, and David A. Kosower.
2005. {``All {Non-Maximally-Helicity-Violating One-Loop Seven-Gluon
Amplitudes} in {N}=4 {Super-Yang-Mills Theory}.''} \emph{Physical Review
D} 71 (4): 045006. \url{https://doi.org/10.1103/PhysRevD.71.045006}.

\leavevmode\vadjust pre{\hypertarget{ref-Bern:1993kr}{}}%
Bern, Zvi, Lance Dixon, and David A. Kosower. 1994.
{``Dimensionally-Regulated Pentagon Integrals.''} \emph{Nuclear Physics
B} 412 (3): 751--816.
\url{https://doi.org/10.1016/0550-3213(94)90398-0}.

\leavevmode\vadjust pre{\hypertarget{ref-Bern:2021xze}{}}%
Bern, Zvi, Juan Pablo Gatica, Enrico Herrmann, Andres Luna, and Mao
Zeng. 2022. {``Scalar {QED} as a Toy Model for Higher-Order Effects in
Classical Gravitational Scattering.''} \emph{arXiv:2112.12243 {[}Gr-Qc,
Physics:hep-Th{]}} 08 (August): 131.
\url{https://doi.org/10.1007/JHEP08(2022)131}.

\leavevmode\vadjust pre{\hypertarget{ref-Bezanson:2015}{}}%
Bezanson, Jeff, Alan Edelman, Stefan Karpinski, and Viral B. Shah. 2015.
{``Julia: {A Fresh Approach} to {Numerical Computing}.''} {arXiv}.
\url{https://arxiv.org/abs/1411.1607}.

\leavevmode\vadjust pre{\hypertarget{ref-Birkhoff:1923}{}}%
Birkhoff, George David, and Rudolph Ernest Langer. 1923.
\emph{Relativity and Modern Physics}. {Cambridge}: {Harvard University
Press; {[}etc., etc.{]}}.

\leavevmode\vadjust pre{\hypertarget{ref-Bjerrum-Bohr:2013bxa}{}}%
Bjerrum-Bohr, N. E. J., John F. Donoghue, and Pierre Vanhove. 2014.
{``On-Shell Techniques and Universal Results in Quantum Gravity.''}
\emph{Journal of High Energy Physics} 02 (2): 111.
\url{https://doi.org/10.1007/JHEP02(2014)111}.

\leavevmode\vadjust pre{\hypertarget{ref-Blanchet:1986}{}}%
Blanchet, L., and T. Damour. 1986. {``Radiative {Gravitational Fields}
in {General Relativity I}. {General Structure} of the {Field} Outside
the {Source}.''} \emph{Philosophical Transactions of the Royal Society
of London. Series A, Mathematical and Physical Sciences} 320 (1555):
379--430.

\leavevmode\vadjust pre{\hypertarget{ref-Blanchet:2013haa}{}}%
Blanchet, Luc. 2014. {``Gravitational {Radiation} from {Post-Newtonian
Sources} and {Inspiralling Compact Binaries}.''} \emph{Living Reviews in
Relativity} 17 (1): 2. \url{https://doi.org/10.12942/lrr-2014-2}.

\leavevmode\vadjust pre{\hypertarget{ref-Blanchet:1995fg}{}}%
Blanchet, Luc, Thibault Damour, and Bala R. Iyer. 1995. {``Gravitational
Waves from Inspiralling Compact Binaries: {Energy} Loss and Waveform to
Second-Post-{Newtonian} Order.''} \emph{Physical Review D} 51 (10):
5360. \url{https://doi.org/10.1103/PhysRevD.51.5360}.

\leavevmode\vadjust pre{\hypertarget{ref-Bonnor:1959}{}}%
Bonnor, W. B., and Louis Rosenhead. 1959. {``Spherical Gravitational
Waves.''} \emph{Philosophical Transactions of the Royal Society of
London. Series A, Mathematical and Physical Sciences} 251 (994):
233--71. \url{https://doi.org/10.1098/rsta.1959.0003}.

\leavevmode\vadjust pre{\hypertarget{ref-Brezin:1970zr}{}}%
Brezin, E., C. Itzykson, and J. Zinn-Justin. 1970. {``Relativistic
{Balmer Formula Including Recoil Effects}.''} \emph{Physical Review D} 1
(8): 2349--55. \url{https://doi.org/10.1103/PhysRevD.1.2349}.

\leavevmode\vadjust pre{\hypertarget{ref-Buchbinder:2005wp}{}}%
Buchbinder, Evgeny I., and Freddy Cachazo. 2005. {``Two-{Loop
Amplitudes} of {Gluons} and {Octa-Cuts} in {N}=4 {Super Yang-Mills}.''}
\emph{Journal of High Energy Physics} 11 (11): 036.
\url{https://doi.org/10.1088/1126-6708/2005/11/036}.

\leavevmode\vadjust pre{\hypertarget{ref-Buonanno:1998gg}{}}%
Buonanno, A., and T. Damour. 1999. {``Effective One-Body Approach to
General Relativistic Two-Body Dynamics.''} \emph{Physical Review D} 59
(8): 084006. \url{https://doi.org/10.1103/PhysRevD.59.084006}.

\leavevmode\vadjust pre{\hypertarget{ref-Buonanno:2000ef}{}}%
Buonanno, Alessandra, and Thibault Damour. 2000. {``Transition from
Inspiral to Plunge in Binary Black Hole Coalescences.''} \emph{Physical
Review D} 62 (6): 064015.
\url{https://doi.org/10.1103/PhysRevD.62.064015}.

\leavevmode\vadjust pre{\hypertarget{ref-Cachazo:2017jef}{}}%
Cachazo, Freddy, and Alfredo Guevara. 2020. {``Leading {Singularities}
and {Classical Gravitational Scattering}''} 02 (February): 181.
\url{https://doi.org/10.1007/JHEP02(2020)181}.

\leavevmode\vadjust pre{\hypertarget{ref-Campanelli:2005dd}{}}%
Campanelli, M., C. O. Lousto, P. Marronetti, and Y. Zlochower. 2006.
{``Accurate {Evolutions} of {Orbiting Black-Hole Binaries} Without
{Excision}.''} \emph{Physical Review Letters} 96 (11): 111101.
\url{https://doi.org/10.1103/PhysRevLett.96.111101}.

\leavevmode\vadjust pre{\hypertarget{ref-Carroll:2019}{}}%
Carroll, Sean M. 2019. {``Spacetime and {Geometry}: {An Introduction} to
{General Relativity}.''} \emph{Higher Education from Cambridge
University Press}.
https://www.cambridge.org/highereducation/books/spacetime-and-geometry/38EDABF9E2BADCE6FBCF2B22DC12BFFE;
{Cambridge University Press}.
\url{https://doi.org/10.1017/9781108770385}.

\leavevmode\vadjust pre{\hypertarget{ref-Cheung:2018wkq}{}}%
Cheung, Clifford, Ira Z. Rothstein, and Mikhail P. Solon. 2018. {``From
{Scattering Amplitudes} to {Classical Potentials} in the
{Post-Minkowskian Expansion}.''} \emph{Physical Review Letters} 121
(25): 251101. \url{https://doi.org/10.1103/PhysRevLett.121.251101}.

\leavevmode\vadjust pre{\hypertarget{ref-Coleman:2018a}{}}%
Coleman, Sidney. 2018. \emph{Lectures of {Sidney Coleman} on {Quantum
Field Theory}}. Edited by Bryan Gin-ge Chen, David Derbes, David
Griffiths, Brian Hill, Richard Sohn, and Yuan-Sen Ting. {Hackensack}:
{WSP}. \url{https://doi.org/10.1142/9371}.

\leavevmode\vadjust pre{\hypertarget{ref-Collins:2019ozc}{}}%
Collins, John. 2019. {``A New Approach to the {LSZ} Reduction
Formula,''} April. \url{https://arxiv.org/abs/1904.10923}.

\leavevmode\vadjust pre{\hypertarget{ref-Cristofoli:2021vyo}{}}%
Cristofoli, Andrea, Riccardo Gonzo, David A. Kosower, and Donal
O'Connell. 2022. {``Waveforms from Amplitudes.''} \emph{Phys. Rev. D}
106 (5): 056007. \url{https://doi.org/10.1103/PhysRevD.106.056007}.

\leavevmode\vadjust pre{\hypertarget{ref-Damour:2016gwp}{}}%
Damour, Thibault. 2016. {``Gravitational Scattering, Post-{Minkowskian}
Approximation and {Effective One-Body} Theory.''} \emph{Physical Review
D} 94 (10): 104015. \url{https://doi.org/10.1103/PhysRevD.94.104015}.

\leavevmode\vadjust pre{\hypertarget{ref-Detweiler:1979wn}{}}%
Detweiler, S. 1979. {``Pulsar Timing Measurements and the Search for
Gravitational Waves.''} \emph{The Astrophysical Journal} 234:
1100--1104. \url{https://doi.org/10.1086/157593}.

\leavevmode\vadjust pre{\hypertarget{ref-Goldberger:2004jt}{}}%
Goldberger, Walter D., and Ira Z. Rothstein. 2006. {``Effective Field
Theory of Gravity for Extended Objects.''} \emph{Physical Review D} 73
(10): 104029. \url{https://doi.org/10.1103/PhysRevD.73.104029}.

\leavevmode\vadjust pre{\hypertarget{ref-Goldstein:2002}{}}%
Goldstein, Herbert, Charles P. Poole, and John L. Safko. 2002.
\emph{Classical {Mechanics}}. {Addison Wesley}.

\leavevmode\vadjust pre{\hypertarget{ref-Guevara:2017csg}{}}%
Guevara, Alfredo. 2019. {``Holomorphic {Classical Limit} for {Spin
Effects} in {Gravitational} and {Electromagnetic Scattering}.''}
\emph{Journal of High Energy Physics} 04 (4): 033.
\url{https://doi.org/10.1007/JHEP04(2019)033}.

\leavevmode\vadjust pre{\hypertarget{ref-hahn:1964}{}}%
Hahn, Susan G., and Richard W. Lindquist. 1964. {``The Two-Body Problem
in Geometrodynamics.''} \emph{Annals of Physics} 29 (September):
304--31. \url{https://doi.org/10.1016/0003-4916(64)90223-4}.

\leavevmode\vadjust pre{\hypertarget{ref-Herrmann:2021tct}{}}%
Herrmann, Enrico, Julio Parra-Martinez, Michael S. Ruf, and Mao Zeng.
2021. {``Radiative Classical Gravitational Observables at
\$\textbackslash Mathcal\{\vphantom\}{O}\vphantom\{\}({G}3̂)\$ from
Scattering Amplitudes.''} \emph{Journal of High Energy Physics} 10 (10):
148. \url{https://doi.org/10.1007/JHEP10(2021)148}.

\leavevmode\vadjust pre{\hypertarget{ref-Hiida:1972xs}{}}%
Hiida, Kichiro, and Hiroshi Okamura. 1972. {``Gauge {Transformation} and
{Gravitational Potentials}.''} \emph{Progress of Theoretical Physics} 47
(5): 1743--57. \url{https://doi.org/10.1143/PTP.47.1743}.

\leavevmode\vadjust pre{\hypertarget{ref-Hobbs:2009yy}{}}%
Hobbs, G., A. Archibald, Z. Arzoumanian, D. Backer, M. Bailes, N. D. R.
Bhat, M. Burgay, et al. 2010. {``The International Pulsar Timing Array
Project: Using Pulsars as a Gravitational Wave Detector.''}
\emph{Classical and Quantum Gravity} 27 (8): 084013.
\url{https://doi.org/10.1088/0264-9381/27/8/084013}.

\leavevmode\vadjust pre{\hypertarget{ref-Iwasaki:1971vb}{}}%
Iwasaki, Yoichi. 1971. {``Quantum {Theory} of {Gravitation} Vs.
{Classical Theory}*): {Fourth-Order Potential}.''} \emph{Progress of
Theoretical Physics} 46 (5): 1587--1609.
\url{https://doi.org/10.1143/PTP.46.1587}.

\leavevmode\vadjust pre{\hypertarget{ref-Kalin:2019rwq}{}}%
Kalin, Gregor, and Rafael A. Porto. 2020a. {``From Boundary Data to
Bound States.''} \emph{Journal of High Energy Physics} 01 (January):
072. \url{https://doi.org/10.1007/JHEP01(2020)072}.

\leavevmode\vadjust pre{\hypertarget{ref-Kalin:2019inp}{}}%
---------. 2020b. {``From Boundary Data to Bound States. {Part II}.
{Scattering} Angle to Dynamical Invariants (with Twist).''}
\emph{Journal of High Energy Physics} 02 (February): 120.
\url{https://doi.org/10.1007/JHEP02(2020)120}.

\leavevmode\vadjust pre{\hypertarget{ref-Kalin:2022hph}{}}%
Kälin, Gregor, Jakob Neef, and Rafael A. Porto. 2022.
{``Radiation-{Reaction} in the {Effective Field Theory Approach} to
{Post-Minkowskian Dynamics},''} July.
\url{https://arxiv.org/abs/2207.00580}.

\leavevmode\vadjust pre{\hypertarget{ref-Kalin:2020mvi}{}}%
Kälin, Gregor, and Rafael A. Porto. 2020. {``Post-{Minkowskian Effective
Field Theory} for {Conservative Binary Dynamics}.''} \emph{Journal of
High Energy Physics} 11 (11): 106.
\url{https://doi.org/10.1007/JHEP11(2020)106}.

\leavevmode\vadjust pre{\hypertarget{ref-Kosower:2018adc}{}}%
Kosower, David A., Ben Maybee, and Donal O'Connell. 2019. {``Amplitudes,
Observables, and Classical Scattering.''} \emph{Journal of High Energy
Physics} 02 (2): 137. \url{https://doi.org/10.1007/JHEP02(2019)137}.

\leavevmode\vadjust pre{\hypertarget{ref-Kotikov:1990kg}{}}%
Kotikov, A. V. 1991. {``Differential Equations Method. {New} Technique
for Massive {Feynman} Diagram Calculation.''} \emph{Physics Letters B}
254 (1): 158--64. \url{https://doi.org/10.1016/0370-2693(91)90413-K}.

\leavevmode\vadjust pre{\hypertarget{ref-Kruskal:1956}{}}%
Kruskal, Joseph B. 1956. {``On the Shortest Spanning Subtree of a Graph
and the Traveling Salesman Problem.''} \emph{Proceedings of the American
Mathematical Society} 7 (1): 48--50.
\url{https://doi.org/10.1090/S0002-9939-1956-0078686-7}.

\leavevmode\vadjust pre{\hypertarget{ref-Kuipers:2012rf}{}}%
Kuipers, J., T. Ueda, J. A. M. Vermaseren, and J. Vollinga. 2013.
{``{FORM} Version 4.0.''} \emph{Comput. Phys. Commun.} 184: 1453--67.
\url{https://doi.org/10.1016/j.cpc.2012.12.028}.

\leavevmode\vadjust pre{\hypertarget{ref-Lehmann:1954rq}{}}%
Lehmann, H., K. Symanzik, and W. Zimmermann. 1955. {``{Zur Formulierung
quantisierter Feldtheorien}.''} \emph{Il Nuovo Cimento (1955-1965)} 1
(1): 205--25. \url{https://doi.org/10.1007/BF02731765}.

\leavevmode\vadjust pre{\hypertarget{ref-Maierhofer:2018}{}}%
Maierhöfer, Philipp, and Johann Usovitsch. 2018. {``Kira 1.2 {Release
Notes}.''} \emph{arXiv:1812.01491 {[}Hep-Ph{]}}, December.
\url{https://arxiv.org/abs/1812.01491}.

\leavevmode\vadjust pre{\hypertarget{ref-Maiorano:2021}{}}%
Maiorano, Michele, Francesco De Paolis, and Achille A. Nucita. 2021.
{``Principles of {Gravitational-Wave Detection} with {Pulsar Timing
Arrays}.''} \emph{Symmetry} 13 (12): 2418.
\url{https://doi.org/10.3390/sym13122418}.

\leavevmode\vadjust pre{\hypertarget{ref-Mukherjee:2020hnm}{}}%
Mukherjee, Sajal, Sanjit Mitra, and Sourav Chatterjee. 2021.
{``Gravitational {Wave} Observatories May Be Able to Detect Hyperbolic
Encounters of {Black Holes}.''} \emph{Monthly Notices of the Royal
Astronomical Society} 508 (4): 5064--73.
\url{https://doi.org/10.1093/mnras/stab2721}.

\leavevmode\vadjust pre{\hypertarget{ref-Neill:2013wsa}{}}%
Neill, Duff, and Ira Z. Rothstein. 2013. {``Classical
Space\textendash times from the {S-matrix}.''} \emph{Nuclear Physics B}
877 (2): 177--89. \url{https://doi.org/10.1016/j.nuclphysb.2013.09.007}.

\leavevmode\vadjust pre{\hypertarget{ref-Nogueira:1993a}{}}%
Nogueira, P. 1993. {``Automatic {Feynman Graph Generation}.''}
\emph{Journal of Computational Physics} 105 (2): 279--89.
\url{https://doi.org/10.1006/jcph.1993.1074}.

\leavevmode\vadjust pre{\hypertarget{ref-Paton:1969}{}}%
Paton, Keith. 1969. {``An Algorithm for Finding a Fundamental Set of
Cycles of a Graph.''} \emph{Communications of the ACM} 12 (9): 514--18.
\url{https://doi.org/10.1145/363219.363232}.

\leavevmode\vadjust pre{\hypertarget{ref-Porto:2016pyg}{}}%
Porto, Rafael A. 2016. {``The {Effective Field Theorist}'s {Approach} to
{Gravitational Dynamics}.''} \emph{Physics Reports} 633 (May): 1--104.
\url{https://doi.org/10.1016/j.physrep.2016.04.003}.

\leavevmode\vadjust pre{\hypertarget{ref-Pretorius:2005gq}{}}%
Pretorius, Frans. 2005. {``Evolution of {Binary Black-Hole
Spacetimes}.''} \emph{Physical Review Letters} 95 (12): 121101.
\url{https://doi.org/10.1103/PhysRevLett.95.121101}.

\leavevmode\vadjust pre{\hypertarget{ref-Remiddi:1997ny}{}}%
Remiddi, E. 1997. {``Differential Equations for {Feynman} Graph
Amplitudes.''} \emph{Il Nuovo Cimento A (1971-1996)} 110 (12): 1435--52.
\url{https://doi.org/10.1007/BF03185566}.

\leavevmode\vadjust pre{\hypertarget{ref-Shomer:2007vq}{}}%
Shomer, Assaf. 2007. {``A Pedagogical Explanation for the
Non-Renormalizability of Gravity,''} December.
\url{https://arxiv.org/abs/0709.3555}.

\leavevmode\vadjust pre{\hypertarget{ref-Smirnov:2020}{}}%
Smirnov, A. V., and F. S. Chukharev. 2020. {``{FIRE6}: {Feynman Integral
REduction} with {Modular Arithmetic}.''} \emph{Computer Physics
Communications} 247 (February): 106877.
\url{https://doi.org/10.1016/j.cpc.2019.106877}.

\leavevmode\vadjust pre{\hypertarget{ref-Srednicki:2007}{}}%
Srednicki, Mark Allen. 2007. \emph{Quantum Field Theory}. {Cambridge ;
New York}: {Cambridge University Press}.

\leavevmode\vadjust pre{\hypertarget{ref-Sturani:2021xpq}{}}%
Sturani, Riccardo. 2021. {``Effective {Field Theory Methods} to {Model
Compact Binaries}.''} In \emph{Handbook of {Gravitational Wave
Astronomy}}, edited by Cosimo Bambi, Stavros Katsanevas, and
Konstantinos D. Kokkotas, 1--33. {Singapore}: {Springer}.
\url{https://doi.org/10.1007/978-981-15-4702-7_32-1}.

\leavevmode\vadjust pre{\hypertarget{ref-tHooft:1972tcz}{}}%
't Hooft, G., and M. Veltman. 1972. {``Regularization and
Renormalization of Gauge Fields.''} \emph{Nuclear Physics B} 44 (1):
189--213. \url{https://doi.org/10.1016/0550-3213(72)90279-9}.

\leavevmode\vadjust pre{\hypertarget{ref-Thorne:1980ru}{}}%
Thorne, Kip S. 1980. {``Multipole Expansions of Gravitational
Radiation.''} \emph{Reviews of Modern Physics} 52 (2): 299--339.
\url{https://doi.org/10.1103/RevModPhys.52.299}.

\leavevmode\vadjust pre{\hypertarget{ref-Vaidya:2014kza}{}}%
Vaidya, Varun. 2015. {``Gravitational Spin {Hamiltonians} from the {S}
Matrix.''} \emph{Physical Review D} 91 (2): 024017.
\url{https://doi.org/10.1103/PhysRevD.91.024017}.

\leavevmode\vadjust pre{\hypertarget{ref-Vermaseren:2000nd}{}}%
Vermaseren, J. A. M. 2000. {``New Features of {FORM},''} October.
\url{https://arxiv.org/abs/math-ph/0010025}.

\leavevmode\vadjust pre{\hypertarget{ref-Weinberg:1972}{}}%
Weinberg, Steven. 1972. \emph{Gravitation and Cosmology: Principles and
Applications of the General Theory of Relativity}. {New York}: {Wiley}.

\end{CSLReferences}



\end{document}
