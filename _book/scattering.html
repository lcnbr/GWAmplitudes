<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Gravitational Waves from Feynman Diagrams - 5&nbsp; Scattering amplitudes and GW</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conclusion.html" rel="next">
<link href="./gwwfframeworks.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Scattering amplitudes and Gravitational Wave (<abbr title="Gravitational Wave">GW</abbr>)</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Gravitational Waves from Feynman Diagrams</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lcnhb/GWAmplitudes" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="./Gravitational-Waves-from-Feynman-Diagrams.pdf" title="Download PDF" class="sidebar-tool px-1"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">Acknowledgements</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gwsources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Gravitational Wave Generation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gwdetect.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Gravitational Wave Detection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gwwfframeworks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Waveform Generation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scattering.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Scattering amplitudes and <abbr title="Gravitational Wave">GW</abbr></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-scatamp" id="toc-sec-scatamp" class="nav-link active" data-scroll-target="#sec-scatamp"><span class="toc-section-number">5.1</span>  Scattering amplitudes</a></li>
  <li><a href="#sec-amp2pot" id="toc-sec-amp2pot" class="nav-link" data-scroll-target="#sec-amp2pot"><span class="toc-section-number">5.2</span>  From amplitude to potential</a>
  <ul class="collapse">
  <li><a href="#eft-amplitude" id="toc-eft-amplitude" class="nav-link" data-scroll-target="#eft-amplitude"><span class="toc-section-number">5.2.1</span>  EFT amplitude</a></li>
  </ul></li>
  <li><a href="#sec-kmoc" id="toc-sec-kmoc" class="nav-link" data-scroll-target="#sec-kmoc"><span class="toc-section-number">5.3</span>  <abbr title="Kosower Maybee and O’Connell">KMOC</abbr> framework</a>
  <ul class="collapse">
  <li><a href="#conventions" id="toc-conventions" class="nav-link" data-scroll-target="#conventions"><span class="toc-section-number">5.3.1</span>  Conventions</a></li>
  <li><a href="#intital-state" id="toc-intital-state" class="nav-link" data-scroll-target="#intital-state"><span class="toc-section-number">5.3.2</span>  Intital State</a></li>
  <li><a href="#change-in-observable" id="toc-change-in-observable" class="nav-link" data-scroll-target="#change-in-observable"><span class="toc-section-number">5.3.3</span>  Change in observable</a></li>
  <li><a href="#classical-limit" id="toc-classical-limit" class="nav-link" data-scroll-target="#classical-limit"><span class="toc-section-number">5.3.4</span>  Classical limit</a></li>
  </ul></li>
  <li><a href="#impulse-in-kmoc" id="toc-impulse-in-kmoc" class="nav-link" data-scroll-target="#impulse-in-kmoc"><span class="toc-section-number">5.4</span>  Impulse in <abbr title="Kosower Maybee and O’Connell">KMOC</abbr></a></li>
  <li><a href="#sqed-amplitudes" id="toc-sqed-amplitudes" class="nav-link" data-scroll-target="#sqed-amplitudes"><span class="toc-section-number">5.5</span>  <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> amplitudes</a>
  <ul class="collapse">
  <li><a href="#expansions-and-simplifications" id="toc-expansions-and-simplifications" class="nav-link" data-scroll-target="#expansions-and-simplifications"><span class="toc-section-number">5.5.1</span>  Expansions and simplifications</a></li>
  <li><a href="#tree-level" id="toc-tree-level" class="nav-link" data-scroll-target="#tree-level"><span class="toc-section-number">5.5.2</span>  Tree level</a></li>
  <li><a href="#one-loop" id="toc-one-loop" class="nav-link" data-scroll-target="#one-loop"><span class="toc-section-number">5.5.3</span>  One loop</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lcnhb/GWAmplitudes/edit/main/scattering.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-scat" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Scattering amplitudes and Gravitational Wave (<abbr title="Gravitational Wave">GW</abbr>)</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div>

</div>
<p>Whilst we have almost no hope to detect any <abbr title="Gravitational Wave">GW</abbr> scattering events with current experimental apparatuses, the scattering formalism can still be very useful in the quest for orbital waveforms. Most importantly, while experimental data has not been driving <em>gravitational</em> scattering theory, the interplay between <em>particle</em> scattering experiment and theory have been an enormously fruitful endeavor for the understanding of fundamental interactions in High Energy Physics (<abbr title="High Energy Physics">HEP</abbr>) The back and forth between precise measurements (such as those conducted at the Large Hadron Collider (<abbr title="Large Hadron Collider">LHC</abbr>) ) and precise predictions for particle scattering, has pushed the boundaries of the calculations possible. It would be therefore very beneficial if one could apply the large knowledge acquired for small non-gravitationally interacting particles, to large compact orbiting bodies. We will see that it is indeed the case.</p>
<p>Such techniques including <abbr title="Effective Field Theory">EFT</abbr> double copy, generalized unitarity, Integration by Parts (<abbr title="Integration by Parts">IBP</abbr>) reduction, differential equations methods, developed in the context of perturbative computations of collider observables now find an application to the scattering problem in gravity. A key part of applying tools originally developed for quantum systems to problems in gravity is controlling the classical limit, a historically difficult endeavor. Once scattering data is obtained one needs to extract the relevant observables. This may be in an effort to compare results from the different methods, in which case gauge and diffeomorphism, and lorentz invariance are key, since different methods make different gauge and frame choices. It can also be to extract the relevant information for detection and data extraction, in which case the <abbr title="Gravitational Wave">GW</abbr> waveform is the relevant observable. In the latter case one is mostly interested in the orbital waveform, and thus a map from unbound to bound orbits is necessary.</p>
<p>Multiple formalisms have arisen to map the scattering problem to an orbital one, and the quantum formalism to a classical one. One key way is to map scattering data to a potential (as present in a Hamiltonian for example). In fact this has been developped as early as the 1970s in <span class="citation" data-cites="Hiida:1972xs Iwasaki:1971vb">&nbsp;[<a href="references.html#ref-Hiida:1972xs" role="doc-biblioref">1</a>,<a href="references.html#ref-Iwasaki:1971vb" role="doc-biblioref">2</a>]</span>. Further developments happened in <span class="citation" data-cites="Neill:2013wsa Bjerrum-Bohr:2013bxa Vaidya:2014kza Cachazo:2017jef Guevara:2017csg Damour:2016gwp">&nbsp;[<a href="references.html#ref-Neill:2013wsa" role="doc-biblioref">3</a>–<a href="references.html#ref-Damour:2016gwp" role="doc-biblioref">8</a>]</span>. Here we will follow the treatment in <span class="citation" data-cites="Cheung:2018wkq">&nbsp;[Cheung, Rothstein, and Solon <a href="references.html#ref-Cheung:2018wkq" role="doc-biblioref">9</a>]</span>, where the conservative part of such scattering amplitudes is matched to an <abbr title="Effective Field Theory">EFT</abbr> and subsequently to mapped to a potential. Recent efforts to add dissipative effects have also been successful <span class="citation" data-cites="Kalin:2022hph">&nbsp;[see <a href="references.html#ref-Kalin:2022hph" role="doc-biblioref">10</a>]</span>. This potential can then be used as input to the <abbr title="Effective One-Body">EOB</abbr> formalism. Furthermore, <span class="citation" data-cites="Kalin:2019rwq Kalin:2019inp">&nbsp;[Kalin and Porto <a href="references.html#ref-Kalin:2019rwq" role="doc-biblioref">11</a>,<a href="references.html#ref-Kalin:2019inp" role="doc-biblioref">12</a>]</span>, have shown a path forward in directly extending unbound data to bound orbits, obviating the need to use a potential and <abbr title="Effective One-Body">EOB</abbr> at all.</p>
<div class="page-columns page-full"><p>Finally, as mentioned in the last chapter, scattering can stand on its own and still be usefull without being extended to the orbital case. The <abbr title="Post-Minkowski">PM</abbr> approximation can be computed from scattering amplitudes in an <abbr title="Effective Field Theory">EFT</abbr> framework <span class="citation" data-cites="Kalin:2020mvi">&nbsp;[<a href="references.html#ref-Kalin:2020mvi" role="doc-biblioref">13</a>]</span>. We can also explore the classical observables possible in scattering scenarios. This has been developped in <span class="citation" data-cites="Kosower:2018adc">&nbsp;[<a href="references.html#ref-Kosower:2018adc" role="doc-biblioref">14</a>]</span> and was extended to local observables<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> such as waveforms in <span class="citation" data-cites="Cristofoli:2021vyo">&nbsp;[<a href="references.html#ref-Cristofoli:2021vyo" role="doc-biblioref">15</a>]</span>.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;local as in not time integrated and thus presenting time dependent dynamics</p></li></div></div>
<p>In this chapter we will first look at how to use amplitude data to extract orbital and scattering waveforms. We will then look at the <abbr title="Kosower Maybee and O’Connell">KMOC</abbr> formalism to directly extract observables. Finally we will look at how to compute amplitudes, and comparing to results such as those in <span class="citation" data-cites="Kosower:2018adc Bern:2021xze">&nbsp;[<a href="references.html#ref-Kosower:2018adc" role="doc-biblioref">14</a>,<a href="references.html#ref-Bern:2021xze" role="doc-biblioref">16</a>]</span>.</p>
<section id="sec-scatamp" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-scatamp"><span class="header-section-number">5.1</span> Scattering amplitudes</h2>
<p>In Quantum Field Theory (<abbr title="Quantum Field Theory">QFT</abbr>) to date the only way to encode scattering data is through a scattering amplitude. Consider a process where one starts out with a set of particles described by a state <span class="math inline">\(\vert i \rangle_{\text{}}\)</span>, that interact, and yield a final state <span class="math inline">\(\vert f \rangle_{\text{}}\)</span>. The scattering amplitude is then defined as the probability amplitude for this process to occur. It is simply given by <span class="math display">\[\langle i \vert S-1 \vert f \rangle=(2\pi)^4 \delta^{{(4)}}(p_f-p_i)\mathring{\imath}\mathcal{A}^{}_{fi},\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the S-matrix, encoding asymptotic time evolution, <span class="math inline">\(S=U_t(-\infty,+\infty)\)</span>. We subtract the identity from it, forming what some call the transfer matrix <span class="math inline">\(T\)</span>, as we only are interested in processes where something happens (i.e.&nbsp;not everything stays the same). In the above equation we also define the <em>scattering matrix element</em> <span class="math inline">\(\mathcal{A}^{}_{fi}\)</span> <span class="citation" data-cites="Srednicki:2007">&nbsp;[see <a href="references.html#ref-Srednicki:2007" role="doc-biblioref">17</a>]</span> or <em>invariant Feynman amplitude</em> <span class="citation" data-cites="Coleman:2018a">&nbsp;[see <a href="references.html#ref-Coleman:2018a" role="doc-biblioref">18</a>]</span>, by factoring out a normalised spacetime delta-function that impose the conservation of momentum on the external particles, and a complex unit. The computation of <span class="math inline">\(\mathcal{A}^{}\)</span> is made possible by the Lehmann Symanzik and Zimmermann (<abbr title="Lehmann Symanzik and Zimmermann">LSZ</abbr>) <span class="citation" data-cites="Lehmann:1954rq Collins:2019ozc">&nbsp;[<a href="references.html#ref-Lehmann:1954rq" role="doc-biblioref">19</a>,<a href="references.html#ref-Collins:2019ozc" role="doc-biblioref">20</a>]</span> formalism, which relates <span class="math inline">\(\mathcal{A}^{}_{fi}\)</span> to time-ordered correlation functions (also known as Green’s functions) of the given QFT. Green’s functions, can be expanded as an infinite sum of diagrams, weighted by a small coupling. The diagrams encode integrals that are obtained by applying Feynman rules which can be readily extracted from an action describing the theory.</p>
</section>
<section id="sec-amp2pot" class="level2 page-columns page-full" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-amp2pot"><span class="header-section-number">5.2</span> From amplitude to potential</h2>
<p>Let us now look at how to map the amplitude to the gravitational potential within the <abbr title="Effective One-Body">EOB</abbr> formalism. We will follow the treatment in <span class="citation" data-cites="Cheung:2018wkq">&nbsp;[<a href="references.html#ref-Cheung:2018wkq" role="doc-biblioref">9</a>]</span>. We start by defining the effective theory that describes our problem: thi orbiting bodies are described by two scalar fields <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> with masses <span class="math inline">\(m_{1}\)</span> and <span class="math inline">\(m_{2}\)</span> interacting through a long range potential <span class="math inline">\(V(r)\)</span>. It is the <abbr title="Effective Field Theory">EFT</abbr> for non-relativistic fields. This <abbr title="Effective Field Theory">EFT</abbr> is described by the following action</p>
<p><span class="math display">\[
S=\int \,\mathrm{d}^{}t\, \mathcal{L}_\text{kin}+\mathcal{L}_\text{int},
\]</span></p>
<p>where the kinetic term is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{L}_\text{kin}=&amp;\int \,\tilde{\mathrm{d}}^{\small D-1}\mathbf{{k}}_{}\, {f{}^\ast}_{1}(-\mathbf{{k}}_{}) \Big(\mathring{\imath}\partial_{t}-\sqrt{\mathbf{{k}}_{}^2+m_{1}}  \Big)f_{1}(\mathbf{{k}}_{}),
\\
&amp;+\int \,\tilde{\mathrm{d}}^{\small D-1}\mathbf{{k}}_{}\, {f{}^\ast}_{2}(-\mathbf{{k}}_{}) \Big(\mathring{\imath}\partial_{t}-\sqrt{\mathbf{{k}}_{}^2+m_{2}}  \Big)f_{2}(\mathbf{{k}}_{}),
\end{aligned}
\]</span></p>
<p>and the interaction term is given by</p>
<p><span class="math display">\[
\mathcal{L}_\text{int}=  -\int \,\tilde{\mathrm{d}}^{\small D-1}\mathbf{{k}}_{}\, \,\tilde{\mathrm{d}}^{\small D-1}\mathbf{{k'}}_{}\, V(\mathbf{{k}}_{},\mathbf{{k'}}_{}) {f{}^\ast}_{1}(\mathbf{{k'}}_{}) {f{}^\ast}_{2}(-\mathbf{{k'}}_{}) f_{1}(\mathbf{{k}}_{}) f_{2}(- \mathbf{{k}}_{}).
\]</span></p>
<div class="page-columns page-full"><p>This theory is obtained from the full one by integrating out all the massless force carriers , which are consequently encoded in the potential <span class="math inline">\(V(\mathbf{{k}}_{},\mathbf{{k'}}_{})\)</span> and taking the non-relativistic limit <span class="math inline">\(\vert\mathbf{{k}}_{} \vert,\vert\mathbf{{k'}}_{} \vert\ll m_{1,2}\)</span>. In a classical system we assume the particles to be separated by a minimum distance, called impact parameter <span class="math inline">\(\vert\mathbf{{b}}_{} \vert\)</span>, and consider that their Compton wavelength <span class="math inline">\(\ell_c\sim\frac{1}{\vert\mathbf{{k}}_{} \vert},\frac{1}{\vert\mathbf{{k'}}_{} \vert}\)</span><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> is much smaller than this separation,</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;Note the use of natural units.</p></li></div></div>
<p><span class="math display">\[
\vert\mathbf{{b}}_{} \vert\ll \ell_c\simeq \frac{1}{\vert\mathbf{{k}}_{} \vert},\frac{1}{\vert\mathbf{{k'}}_{} \vert}.
\]</span></p>
<p>This ensures that the particles are not interacting quantum mechanically in any significant way. Interestingly this hierarchy of scales can be rewritten as:</p>
<p><span class="math display">\[
\mathbf{{J}}_{}\sim\vert\mathbf{{k}}_{}\times\mathbf{{b}}_{} \vert\gg 1.
\]</span></p>
<p>Thus, any two body classical system has large angular momentum. We can extract the classical part of any quantity by taking the Leading Order (<abbr title="Leading Order">LO</abbr>) contribution in the inverse of the angular momentum, or equivalently:</p>
<p><span id="eq-invang"><span class="math display">\[
  \frac{1}{J} \propto \frac{1}{\vert b \vert} \sim \vert\mathbf{{k}}_{}-\mathbf{{k'}}_{} \vert\propto \frac{1}{\kappa},
\tag{5.1}\]</span></span></p>
<p>where <span class="math inline">\(\kappa\)</span> is the coupling constant, which in the case of gravity is <span class="math inline">\(\kappa=4\pi G\)</span>. For the first relation we used that angular momentum is proportional to separation. We then applied the fact that in scattering scenarios the impact parameter is proportional to the inverse of the momentum transfer <span class="math inline">\(\sim\frac{1}{\vert\mathbf{{q}}_{} \vert}\)</span> where :</p>
<p><span class="math display">\[
q=(0,\mathbf{{q}}_{})=(0,\mathbf{{k}}_{}-\mathbf{{k'}}_{}).
\]</span></p>
<p>The last relation in <a href="#eq-invang">eq.&nbsp;<span>5.1</span></a> holds due to the virial theorem. Since the potential must encode the coulomb potential <span class="math inline">\(\kappa/\vert\mathbf{{k}}_{}-\mathbf{{k'}}_{} \vert^2\propto J^3\)</span>, it must scale similarly. We thus formulate the following ansatz for the potential: <span id="eq-ansatzpot"><span class="math display">\[
V(\mathbf{{k}}_{},\mathbf{{k'}}_{})=\sum_{n=1}^\infty \frac{\kappa^n}{\vert\mathbf{{k}}_{}-\mathbf{{k'}}_{} \vert^{D-1-n}} c_n\Big(\frac{\mathbf{{k}}_{}^2+\mathbf{{k'}}_{}^2}{2} \Big)
\tag{5.2}\]</span></span></p>
<div class="page-columns page-full"><p>Note that higher order terms in the potential could be formed by any polynomial of momentum invariants <span class="math inline">\(\mathbf{{k}}_{}^2\)</span>, <span class="math inline">\(\mathbf{{k'}}_{}^2\)</span>, and <span class="math inline">\(\mathbf{{k}}_{}\cdot\mathbf{{k'}}_{}\)</span>. However, not all combinations of these are independent. The ansatz is chosen such that only the variables <span class="math inline">\(\vert\mathbf{{k}}_{}-\mathbf{{k'}}_{} \vert\)</span> and <span class="math inline">\(\mathbf{{k}}_{}^2+\mathbf{{k'}}_{}^2\)</span> are present, as the others can be reabsorbed by field redefinitions, or vanish on-shell, such as <span class="math inline">\(\mathbf{{k}}_{}^2-\mathbf{{k'}}_{}^2\)</span>. Note as-well that we work in <span class="math inline">\(D=4-2\epsilon\)</span> dimensions such that the integrals are dimensionally regulated <span class="citation" data-cites="tHooft:1972tcz">&nbsp;[see <a href="references.html#ref-tHooft:1972tcz" role="doc-biblioref">21</a>]</span>. In particular an <span class="math inline">\(\epsilon\)</span>-power corresponds to a logarithm<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Finally, note that in gravity this is precisely a <abbr title="Post-Minkowski">PM</abbr> expansion!</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;The third term in the sum is given by <span class="math inline">\(\kappa^3\ln({\mathbf{{k}}_{}-\mathbf{{k'}}_{}})^2 c_3\Big(\frac{1}{2}{\mathbf{{k}}_{}^2+\mathbf{{k'}}_{}^2} \Big)\)</span>.</p></li></div></div>
<section id="eft-amplitude" class="level3 page-columns page-full" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="eft-amplitude"><span class="header-section-number">5.2.1</span> EFT amplitude</h3>
<p>The first step in establishing determining the potential from a generic scattering amplitude computed in the full theory is to compute the amplitude in the <abbr title="Effective Field Theory">EFT</abbr> We first identify the Feynman rules from the action. The kinetic term encodes the propagator:</p>
<div id="fig-propagator" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="tikz/propagator.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption margin-caption">Fig&nbsp;5.1: Propagator rule</figcaption><p></p>
</figure>
</div>
<p>where the <span class="math inline">\(\mathring{\imath}0\)</span> is the Feynman prescription for avoiding the poles. The interaction term is encoded in the vertex</p>
<div id="fig-vertex" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="tikz/vertex.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption margin-caption">Fig&nbsp;5.2: Vertex rule</figcaption><p></p>
</figure>
</div>
<div class="page-columns page-full"><p>The expression for the <abbr title="Effective Field Theory">EFT</abbr> amplitude will contain the coefficient functions from <a href="#eq-ansatzpot">eq.&nbsp;<span>5.2</span></a> since they will be present as vertex terms. Particle number must be conserved in the non-relativistic limit <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, so the amplitude is a sum of bubble diagrams:</p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;As pair production is kinematically forbidden.</p></li></div></div>
<div id="fig-eftampl" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="./tikz/eftampl.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption margin-caption">Fig&nbsp;5.3: EFT amplitude</figcaption><p></p>
</figure>
</div>
<p>We can consequently neatly organise the amplitude into a sum of terms with specific loop counts. We can also equivalently organise it into a sum of terms with specific <span class="math inline">\(\kappa\)</span> powers. We write,</p>
<p><span class="math display">\[\mathcal{A}^{}_\text{EFT}=\sum\limits_{L=0}^\infty\mathcal{A}^{L\text{loop}}_\text{EFT}=\sum\limits_{i=1}^\infty \mathcal{A}^{(i)}_\text{EFT}.\]</span></p>
<p>Notably, these partitions do not line up for the <abbr title="Effective Field Theory">EFT</abbr> since the vertex contains all powers of the coupling. This is in contrast to the full theory where in fact they yield the same partition. We will eventually want to partition over the coupling power to compare the full theory.</p>
<div class="page-columns page-full"><p>Since every cut of the diagrams contributing to <span class="math inline">\(\mathcal{A}^{}_\text{EFT}\)</span> contains two propagators it is useful to define a 2-body propagator. We can integrate over the energy components of the loop momentum, since the vertex does not have an energy dependence:<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn5"><p><sup>5</sup>&nbsp;The 4-momentum conservation at each vertex means that the energy components of the two propagating momenta must carry along the energy component of the initial state <span class="math inline">\(E_{}=E_{1}+E_{2}\)</span>. This can be encoded by demanding that <span class="math inline">\(\omega_1+\omega_2=E_{}\)</span>. Taking the Center of Momentum (<abbr title="Center of Momentum">COM</abbr>) frame for the intial momenta means that the 3 momenta of each propagator must cancel i.e.&nbsp;<span class="math inline">\(\mathbf{{k}}_{1}+\mathbf{{k}}_{2}=0\)</span></p></li></div></div>
<p><span class="math display">\[\mathring{\imath}\Delta_2(\mathbf{{k}}_{} )=\int \,\tilde{\mathrm{d}}^{}\omega\, \frac{\mathring{\imath}}{\omega-\sqrt{\mathbf{{k}}_{}^2+m_1^2}}\frac{\mathring{\imath}}{E_{}-\omega-\sqrt{\mathbf{{k}}_{}^2+m_2^2}}=\frac{\mathring{\imath}}{E_{}-\sqrt{\mathbf{{k}}_{}^2+m_{1}^2}-\sqrt{\mathbf{{k}}_{}^2+m_{2}^2}},\]</span></p>
<div class="page-columns page-full"><p>where the integral is performed using the residue theorem, closing the contour in either half plane, where in either case a pole is present. We have define <span class="math inline">\(E_{}=E_{1}+E_{2}\)</span> to be the <abbr title="Center of Momentum">COM</abbr> energy of the two inital states:<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;which is equal to the outgoing energy</p></li></div></div>
<p><span class="math display">\[
E_{i}=\sqrt{\mathbf{{p}}_{}^2+m_{i}^2}=\sqrt{\mathbf{{p'}}_{}^2+m_{i}^2},
\]</span></p>
<div class="page-columns page-full"><p>where <span class="math inline">\(\mathbf{{p}}_{}\)</span> and <span class="math inline">\(\mathbf{{p'}}_{}\)</span> are the initial and final three-momenta of the two states <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> in the <abbr title="Center of Momentum">COM</abbr> frame. Finally, we can write the diagram at loop level <span class="math inline">\(L&gt;0\)</span> encodes:</p><div class="no-row-height column-margin column-container"><li id="fn7"><p><sup>7</sup>&nbsp;For example in the initial state one scalar field will have 3-momentum <span class="math inline">\(\mathbf{{p}}_{}\)</span>, and the other <span class="math inline">\(-\mathbf{{p}}_{}\)</span></p></li></div></div>
<p><span class="math display">\[
\mathcal{A}^{L\text{loop}}_\text{EFT}= \int\prod\limits_{i=1}^L  \,\tilde{\mathrm{d}}^{\small D-1}\mathbf{{k}}_{i}\, V(\mathbf{{p}}_{},\mathbf{{k}}_{1})\Delta_2(\mathbf{{k}}_{1} )\cdots\Delta_2(\mathbf{{k}}_{L} )V(\mathbf{{k}}_{L},\mathbf{{p'}}_{}).
\]</span></p>
<div class="page-columns page-full"><p>This integral can be performed in the non-relativistic limit, as done by <span class="citation" data-cites="Bern:2019crd">&nbsp;[Bern et al. <a href="references.html#ref-Bern:2019crd" role="doc-biblioref">22</a>]</span> up to <abbr title="Post-Minkowski">PM</abbr> Up to <abbr title="Post-Minkowski">PM</abbr> the amplitudes of the <abbr title="Effective Field Theory">EFT</abbr> is:<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn8"><p><sup>8</sup>&nbsp;Here the repartioning mentioned above has been applied and a change in loop momenta: <span class="math inline">\(\mathbf{{k}}_{i}\to\mathbf{{p}}_{}+\mathbf{{\ell}}_{i}\)</span>.</p></li></div></div>
<p><span class="math display">\[
\begin{aligned}
\mathcal{A}^{(1)}_\text{EFT}&amp;=-\frac{4\pi Gc_1}{\mathbf{{q}}_{}^2},\\
\mathcal{A}^{(2)}_\text{EFT}&amp;= \pi^2G^2 \Big(-\frac{2 c_2}{\vert\mathbf{{q}}_{} \vert}+\frac{1}{E_{}\xi\vert\mathbf{{q}}_{} \vert}\Big[(1-3\xi)c_1^2+4\xi^2E_{}^2c_1 c'_1 \Big]\\
                  &amp; \int \,\tilde{\mathrm{d}}^{D-1}\mathbf{{\ell}}_{}\,\frac{32E_{}\xi c_1^2}{\mathbf{{\ell}}_{}^2(\mathbf{{q}}_{}+\mathbf{{\ell}}_{})^2(\mathbf{{\ell}}_{}^2+2\mathbf{{p}}_{}\mathbf{{\ell}}_{})}\Big),
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\xi=\frac{E_{1}E_{2}}{(E_{1}+E_{2} )^2}\)</span> is the reduced energy ratio. The arguments of the coefficient functions <span class="math inline">\(c_1\)</span> are kept implicit and a prime denotes a derivative with respect to <span class="math inline">\(\mathbf{{p_{}}}_{}\)</span>. Additionally, we defined <span class="math inline">\(\mathbf{{q}}_{}=\mathbf{{p'}}_{}-\mathbf{{p}}_{}\)</span> to be the 3-momentum transfer.</p>
<p>The key point is that the matching procedure requires the EFT amplitude for two-to-two scattering to be equal to the full amplitude at every order in the coupling constant <span class="math inline">\(\kappa\)</span>, i.e.&nbsp;provided we obtain the amplitude of the full theory, and carefully apply the same limiting procedures, we impose that</p>
<p><span class="math display">\[
\mathcal{A}^{(i)}_\text{EFT}=\mathcal{A}^{(i)}_\text{full} \quad \forall i.
\]</span></p>
<p>which fixes the coefficients in the potential ansatz <a href="#eq-ansatzpot">eq.&nbsp;<span>5.2</span></a>, and fullfils the promised map from amplitude to potential. Importantly, we must apply the limiting procedure applied above, i.e.&nbsp;the classical and non relativistic limit, which is summarised by the following heirarchy of scales:</p>
<p><span class="math display">\[
m_{1},m_{2}\ll J \vert\mathbf{{q}}_{} \vert \ll \vert\mathbf{{q}}_{} \vert.
\]</span></p>
<p>In the full theory this hierarchy is equivalent to restricting to a specific kinematic regime, following the method of regions. We consider all the possible loop-momentum scalings, first due to the classical limit:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">Region</th>
<th style="text-align: center;">Momentum <span class="math inline">\(\ell = (\omega,\mathbf{{\ell}}_{})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">hard</td>
<td style="text-align: center;"><span class="math inline">\((m,m)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">soft</td>
<td style="text-align: center;"><span class="math inline">\((\vert\mathbf{{q_{}}}_{} \vert,\vert\mathbf{{q_{}}}_{} \vert)\)</span></td>
</tr>
</tbody>
</table>
<p>In this language, the soft region is responsible for the classical limit, since we consider a small <span class="math inline">\(\vert\mathbf{{q_{}}}_{} \vert\)</span> expansion. We will infact explore this expansion in a different light in <a href="#sec-kmoc"><span>Section&nbsp;5.3</span></a>. Taking the <abbr title="Numerical Relativity">NR</abbr> limit corresponds to a subregion of the soft region, the so-called potential region:</p>
<p><span class="math display">\[ (\omega,\mathbf{{\ell}}_{})\sim (\vert\mathbf{{u_{}}}_{} \vert\vert\mathbf{{q_{}}}_{} \vert,\vert\mathbf{{q_{}}}_{} \vert),\]</span></p>
<div class="page-columns page-full"><p>where we use that the <abbr title="Numerical Relativity">NR</abbr> expansion is a given by <span class="math display">\[\vert\mathbf{{p_{}}}_{} \vert\ll m\]</span> and thus equivalently<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> by a small relative velocity:</p><div class="no-row-height column-margin column-container"><li id="fn9"><p><sup>9</sup>&nbsp;dividing by mass</p></li></div></div>
<p><span class="math display">\[ \vert\mathbf{{u_{}}}_{} \vert\ll1.\]</span></p>
<p>To summarise, in order to obtain the form of the potential, we first compute the amplitude in an <abbr title="Effective Field Theory">EFT</abbr> absorbing all force carrying particles into an effective vertex. Making an ansatz for the potential we can compute the amplitude in the non-relativistic limit in terms of unknown coefficients. This same amplitude can be computed in the full theory, which, as a consequence of the limiting procedure, has simplified kinematic dependence. The coefficients of the <abbr title="Effective Field Theory">EFT</abbr> amplitude are then determined by matching it order by order with the full amplitude.</p>
<p>Unfortunately, the procedure described above, and in fact <em>any</em> procedure trying to make contact with <abbr title="Effective One-Body">EOB</abbr> by expanding the gravitiational potential, intrinsically does not capture the full physics. The crucial point that makes compact binaries interesting is that they are not isolated, energy conserving systems. The energy of the system is lost to the gravitational waves that enable us to detect them. Any conservative dynamics, by construction, cannot capture this loss of energy. In the context of <abbr title="Effective One-Body">EOB</abbr> this radiation reaction was added after the fact, through direct modifications of the Equation of Motion (<abbr title="Equation of Motion">EOM</abbr>) obtained from Hamilton’s equations. It is not clear how to incorporate dissipative data from the amplitude in the <abbr title="Effective One-Body">EOB</abbr> framework.</p>
<p>One way to not encounter this difficulty is to fully bypass the <abbr title="Effective One-Body">EOB</abbr> framework and try to obtain observables directly from the amplitude. This is the subject of the following sections.</p>
</section>
</section>
<section id="sec-kmoc" class="level2 page-columns page-full" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-kmoc"><span class="header-section-number">5.3</span> <abbr title="Kosower Maybee and O’Connell">KMOC</abbr> framework</h2>
<p>The <abbr title="Kosower Maybee and O’Connell">KMOC</abbr> framework (<span class="citation" data-cites="Kosower:2018adc">&nbsp;[<a href="references.html#ref-Kosower:2018adc" role="doc-biblioref">14</a>]</span>) is very general, and is aimed at taking the classical limit of a scattering event in an unspecified theory. We will apply it later on to <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> and gravity.</p>
<section id="conventions" class="level3 page-columns page-full" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="conventions"><span class="header-section-number">5.3.1</span> Conventions</h3>
<p>First let us define our conventions. Throughout this section we use relativistically natural units, i.e.&nbsp;we do <em>not</em> set <span class="math inline">\(\hbar=1\)</span>. This will essentially be the small parameter that multiplies the soft momenta that defined the region in <a href="#sec-amp2pot"><span>Section&nbsp;5.2</span></a>. In this section we will further motivate this classical limit in more detail by taking the generally accepted limit that makes quantum physics collapse to classical physics</p>
<p><span class="math display">\[\hbar\to0.\]</span></p>
<p>We still retain <span class="math inline">\(c=1\)</span>, meaning that, using dimensional analysis we have that <span class="math inline">\([L][T]^{-1}=1\)</span> i.e.&nbsp;<span class="math inline">\([L]=[T]\)</span>, length and time are measured in the same units. Correspondingly, energy is measured in units of mass <span class="math display">\[
E_{}=mc^2\implies[E_{}]=[m]=[M],
\]</span></p>
<p>and <span class="math inline">\(\hbar\)</span> has the following units</p>
<p><span class="math display">\[
E_{}=\hbar \omega\implies [M]=[\hbar][T]^{-1}\implies [\hbar]=[T][M]
.\]</span></p>
<div class="page-columns page-full"><p>Thus momentum <span class="math inline">\(p_{}\)</span> has units of <span class="math inline">\([p_{}]=[M]\)</span> mass and Wavenumber <span class="math inline">\([\bar{p_{}}]=[\frac{p_{}}{\hbar}]=[T]^{-1}\)</span> has units of inverse time. We will denote the Lorentz-invariant phase space measure by <span class="math inline">\(\,\mathrm{d}\Phi_{}(p)\,\)</span><a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>:</p><div class="no-row-height column-margin column-container"><li id="fn10"><p><sup>10</sup>&nbsp;Repeated integration will be denoted <span class="math inline">\(\,\mathrm{d}\Phi_{n}(p_1,\dots,p_n)\,\)</span></p></li></div></div>
<p><span class="math display">\[
\int \,\mathrm{d}\Phi_{}(p)\, \dots      = \int \frac{\,\mathrm{d}^{3}\mathbf{{p}}_{}\,}{2\hbar\omega_{\mathbf{{p}}_{}}(2\pi)^3} \dots = \int \,\tilde{\mathrm{d}}^{4}p\,\tilde{\delta}^{(+)}(p^2-m^2) \dots,
\]</span></p>
<p>where quantities denoted by bars absorb the relevant factors of <span class="math inline">\(2\pi\)</span>, such that <span class="math inline">\(\,\tilde{\mathrm{d}}^{n}p\,=\frac{\,\mathrm{d}^{n}p\,}{(2\pi)^n}\)</span>. Additionally, we have defined <span class="math inline">\(\hbar\omega_{\mathbf{{p}}_{}}=\sqrt{\mathbf{{p}}_{}^2+m^2}\)</span> to be the on-shell energy and <span class="math inline">\(\delta^{(+)}\)</span> is the normalised positive energy on-shell delta function:</p>
<p><span class="math display">\[
\tilde{\delta}^{(+)}(p^2-m^2)=(2\pi)\delta^{{}}({p}_{}^2-m^2)\Theta^{{}}(p{}^{0})=\tilde{\delta}^{}({p}_{}^2-m^2)\Theta^{{}}(p{}^{0})
\]</span></p>
</section>
<section id="intital-state" class="level3 page-columns page-full" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="intital-state"><span class="header-section-number">5.3.2</span> Intital State</h3>
<p>With our conventions at hand, let us set the stage for the problem. Imagine we want to scatter two particles, be they massive black holes, or tiny electrons, into each other, with a constant particle number (i.e.&nbsp;a classical two in two out scattering). As mentioned in <a href="#sec-scatamp"><span>Section&nbsp;5.1</span></a>, in <abbr title="Quantum Field Theory">QFT</abbr> the framework that formalizes scattering of definite particle number states is based on the <abbr title="Lehmann Symanzik and Zimmermann">LSZ</abbr> reduction formula.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="aside">we work in the Heisenberg picture here</span></div></div>
<p>Let us look at it in more detail. The first step is to define the states we want to scatter. Suppose our theory has single particle states <span class="math inline">\(\vert p \rangle_{\text{}}\)</span>, with mass <span class="math inline">\(m_{}\)</span>, eigenstates of the momentum:</p>
<p><span class="math display">\[\mathbb{P}{}^{\mu}\vert p \rangle_{\text{}}=p_{}{}^{\mu}\vert p \rangle_{\text{}}\quad \text{with} \quad p^0=\hbar\omega_{\mathbf{{p}}_{}}=\sqrt{\mathbf{{p_{}}}_{}^2+m_{}^2}.\]</span></p>
<div class="page-columns page-full"><p>These states can be seen as special cases (the plane wave states) of wavepacket states:<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn11"><p><sup>11</sup>&nbsp;A plane wave state <span class="math inline">\(\vert f \rangle_{\text{}}=\vert p \rangle_{\text{}}\)</span> would be given by <span class="math inline">\(\breve{f}(k)=2 \hbar\omega_{\mathbf{{k}}_{}} \tilde{\delta}^{(3)}(\mathbf{{k}}_{}-\mathbf{{p}}_{})\)</span></p></li></div></div>
<p><span class="math display">\[\vert f \rangle_{\text{}}=\int \,\mathrm{d}\Phi_{}(k)\, \breve{f}(k) \vert k \rangle_{\text{}},\]</span></p>
<div class="page-columns page-full"><p>where <span class="math inline">\(\breve{f}(k)\)</span> is the momentum space wavefunction or, more mathematically, the momentum distribution function. Note that it is almost a Fourier transform, but not quite, as it is performed on the mass shell. If the spacetime ‘wavefunction’ <a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> is given by</p><div class="no-row-height column-margin column-container"><li id="fn12"><p><sup>12</sup>&nbsp;Note that the concept of coordinate space wavefunction is ill defined in interacting theories. However for such asymptotic states, the wavefunction outside the bulk (on the infinte time boundary) is that of a free wavefunction.</p></li></div></div>
<p><span id="eq-spacetimewf"><span class="math display">\[f(x)=\int \,\mathrm{d}\Phi_{}(k)\, \breve{f}(k) \mathrm{e}^{-\mathring{\imath}{k}_{}\cdot{x}_{}}, \tag{5.3}\]</span></span></p>
<p>so that <span class="math inline">\(\breve{f}(k)\)</span> is consequently given by</p>
<p><span id="eq-momdist"><span class="math display">\[\langle k \vert f \rangle=\breve{f}(k)= 2 \hbar\omega_{\mathbf{{p}}_{}}\int \,\mathrm{d}^{3}\mathbf{{x}}_{}\,f(x) \mathrm{e}^{\mathring{\imath}k\cdot x}. \tag{5.4}\]</span></span></p>
<div class="page-columns page-full"><p>If we now define the following operators<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> ^[ Note that if we replace <span class="math inline">\(f(x)\)</span> by a plane wave state <span class="math inline">\(\mathrm{e}^{-\mathring{\imath}k\cdot x}\)</span> we obtain and define the following:</p><div class="no-row-height column-margin column-container"><li id="fn13"><p><sup>13</sup>&nbsp;<span class="math inline">\(f\overleftrightarrow{\partial_{\mu}}g=f(\partial_{\mu}g )-(\partial_{\mu}f )g\)</span></p></li></div></div>
<p><span class="math display">\[
a_{\mathbf{{k}}_{}}^{\dagger}(t)=  \int \,\mathrm{d}^{3}\mathbf{{x}}_{}\, \mathrm{e}^{-\mathring{\imath}k\cdot x} \Big[\hbar\omega_{\mathbf{{k}}_{}}f_{}(x)-\mathring{\imath}\partial_{0}f_{}(x) \Big],
\]</span></p>
<p><span class="math display">\[
a_{\mathbf{{k}}_{}}(t)=   \int \,\mathrm{d}^{3}\mathbf{{x}}_{}\, \mathrm{e}^{\mathring{\imath}k\cdot x} \Big[\hbar\omega_{\mathbf{{k}}_{}}f_{}(x)+\mathring{\imath}\partial_{0}f_{}(x) \Big],
\]</span></p>
<p>]</p>
<p><span class="math display">\[
a_{f}^{\dagger}(t)= -  \mathring{\imath}\int \,\mathrm{d}^{3}\mathbf{{x}}_{}\,f(x) \overleftrightarrow{\partial_{0}} \phi_{}(x),
\]</span></p>
<p><span class="math display">\[
a_{f}(t)=   \mathring{\imath}\int \,\mathrm{d}^{3}\mathbf{{x}}_{}\,{f{}^\ast}(x) \overleftrightarrow{\partial_{0}} \phi_{}(x),
\]</span></p>
<div class="page-columns page-full"><p>where <span class="math inline">\(\phi_{}(x)\)</span> is the Heisenberg field operator of our theory. While these operators are time dependent, this dependence is not obtained from applying the Heisenberg <abbr title="Equation of Motion">EOM</abbr> <a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>, instead it is present through the time dependence of the wavefunction <span class="math inline">\(f(x)\)</span>. It turns out that these operators, suggestively written are the true creation and annilihation operators in the interacting theory.</p><div class="no-row-height column-margin column-container"><li id="fn14"><p><sup>14</sup>&nbsp;<span class="math inline">\(\frac{\mathrm{d}^{} A_H(t)}{\mathrm{d}{t}^{}}=\mathring{\imath}[H_H,A_H(t)]\)</span></p></li></div></div>
<div class="page-columns page-full"><p>We can now define a general one particle state <span class="math inline">\(\vert f \rangle_{\text{}}\)</span> as the result of a creation operator acting on the physical vacuum. Crucially, this only makes sense in the boundary of the bulk, i.e.&nbsp;at asymptotic times <span class="math inline">\(t\to\pm\infty\)</span><a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>. Inside the bulk, any thusly created state would infact not have definite particle number. This definitely makes sense in the scattering problem because if you consider the whole system as a state, it only has definite particle number at asymptotic times, and inside the bulk the scattering happens, and the particle number is not conserved (at least quantum mechanically).</p><div class="no-row-height column-margin column-container"><li id="fn15"><p><sup>15</sup>&nbsp;See <span class="citation" data-cites="Coleman:2018a">&nbsp;[<a href="references.html#ref-Coleman:2018a" role="doc-biblioref">18</a>]</span> or <span class="citation" data-cites="Collins:2019ozc">&nbsp;[<a href="references.html#ref-Collins:2019ozc" role="doc-biblioref">20</a>]</span> for a more in depth discussion of this point</p></li></div></div>
<p>Consequently, we only define asymptotic states, denoting them by an <span class="math inline">\(\text{in}\)</span> subscript if they were created at <span class="math inline">\(t\to-\infty\)</span> and <span class="math inline">\(\text{out}\)</span> if they were created at <span class="math inline">\(t\to+\infty\)</span>:</p>
<p><span class="math display">\[
\vert f \rangle_{\text{in}}\stackrel{\text{def}}{=}\lim_{t\to-\infty}a_{f}^{\dagger}(t)\vert \Omega \rangle_{\text{}}=a_{f;\text{in}}^{\dagger}\vert \Omega \rangle_{\text{}}=\int \,\mathrm{d}\Phi_{}(k)\, \breve{f}(k) \underbracket{a_{\mathbf{{k}}_{}}^{\dagger}\vert \Omega \rangle_{\text{}}}_{\vert k \rangle_{\text{}}}
\]</span></p>
<p>and the corresponding <span class="math inline">\(t \to +\infty\)</span> state where in is replaced with out. It turns out that the extension to multiparticle states is not much more complicated. The one thing to demand is that the momentum distributions say <span class="math inline">\(\breve{f_1},\breve{f_2},\dots\)</span> have no common support, i.e.&nbsp;they are not overlapping. In this case an n-particle in state is defined as:</p>
<p><span class="math display">\[
\vert f_1,\dots,f_n \rangle_{\text{in}}\stackrel{\text{def}}{=}a_{f_1;\text{in}}^{\dagger}a_{f_2;\text{in}}^{\dagger}\dots a_{f_n;\text{in}}^{\dagger}\vert \Omega \rangle_{\text{}}=\int \,\mathrm{d}\Phi_{n}(k_1,\dots,k_n)\, \breve{f_1}(k_1)\dots\breve{f_n}(k_n) \vert k_1,\dots,k_n \rangle_{\text{}}.
\]</span></p>
<p>We now have the definitions for asymptotic in and out states for any number of particles. Before defining the setup to scatter two particles, let us look at the meaning of the position space wavefunction <span class="math inline">\(f(x)\)</span> as defined in <a href="#eq-spacetimewf">eq.&nbsp;<span>5.3</span></a>. Consider a sharply peaked, compactly supported momentum distribution <span class="math inline">\(\breve{f}(k)\)</span> around a value <span class="math inline">\(\mathbf{{p}}_{0}\)</span> and a characteristic width <span class="math inline">\(\Delta p\)</span>. One such function could be:</p>
<p><span id="eq-peak"><span class="math display">\[
f(\mathbf{{p}}_{} ; \mathbf{{p}}_{0}, \Delta p )=\left\{\begin{array}{ll}
N \mathrm{e}^{-1 /(1-\vert\mathbf{{p}}_{}-\mathbf{{p}}_{0} \vert^2 / \Delta p^2 )} &amp; \text { if }\vert\mathbf{{p}}_{0}-\mathbf{{p}}_{} \vert&lt;\Delta p \\
0 &amp; \text { if }\vert\mathbf{{p}}_{0}-\mathbf{{p}}_{} \vert \geq \Delta p
\end{array}\right.,
\tag{5.5}\]</span></span></p>
<div class="page-columns page-full"><p>where <span class="math inline">\(N\)</span> is a normalization constant. The integrand in <a href="#eq-spacetimewf">eq.&nbsp;<span>5.3</span></a>, at large <span class="math inline">\(t\)</span> or <span class="math inline">\(\mathbf{{x}}_{}\)</span>, will be dominated by the stationary phase point <span class="math inline">\(\mathbf{{p}}_{s}\)</span> which is given by:<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn16"><p><sup>16</sup>&nbsp;This then means that <span class="math display">\[\mathbf{{p}}_{s}=\frac{m_{}\mathbf{{x}}_{}\text{sign}(t)}{\sqrt{t^2-\mathbf{{x}}_{}^2}}\]</span> thus <span class="math display">\[\hbar\omega_{{\mathbf{{p}}_{s}}}=\frac{m_{}\vert t \vert}{\sqrt{t^2-\mathbf{{x}}_{}^2}}\]</span></p></li></div></div>
<p><span id="eq-stationaryphase"><span class="math display">\[0=-\frac{\partial_{}^{} }{\partial_{}{\mathbf{{p}}_{s}}^{}}(\hbar\omega_{{\mathbf{{p}}_{s}}}t+\mathbf{{p}}_{s}\cdot\mathbf{{x}}_{} )=-\frac{\mathbf{{p}}_{s}t}{\hbar\omega_{{\mathbf{{p}}_{s}}}}+\mathbf{{x}}_{}.
\tag{5.6}\]</span></span></p>
<p>In the case of a sharply peaked momentum distribution, the coordinate space wavefunction will be largest when the stationary phase point is the same as the peak of the momentum distribution, i.e.&nbsp;<span class="math inline">\(\mathbf{{p}}_{s}=\mathbf{{p}}_{0}\)</span> i.e.&nbsp;substituting <span class="math inline">\(\mathbf{{p}}_{s}\)</span> into <a href="#eq-stationaryphase">eq.&nbsp;<span>5.6</span></a> gives: <span class="math display">\[
\mathbf{{x}}_{}\simeq \frac{\mathbf{{p}}_{0}t}{\hbar\omega_{{\mathbf{{p}}_{0}}}}=\mathbf{{v}}_{0}t.
\]</span></p>
<div class="page-columns page-full"><p>This is precisely the trajectory of the classical relativistic particle. Now consider the case of two particles with different peaked momentum distributions their trajectories will have different velocities, but the same positions at time <span class="math inline">\(0\)</span>. Thus we will shift one of these trajectories by a so called impact parameter <span class="math inline">\(b{}^{\mu}\)</span><a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>, parametrising the relative separtation of the two particles/wavepackets. This can be simply done by multiplying the momentum distribution <span class="math inline">\(\breve{f_{1}}(p)\)</span> by a factor of <span class="math inline">\(\mathrm{e}^{\frac{\mathring{\imath}}{\hbar} b\cdot p}\)</span>. We take it to be perpendicular to the initial momenta <span class="math inline">\(p_{1},p_{2}\)</span>. We now can write down the initial state that we are going to study:</p><div class="no-row-height column-margin column-container"><li id="fn17"><p><sup>17</sup>&nbsp;<span class="math inline">\(f(x)=\int \,\mathrm{d}\Phi_{}(p_{})\, \breve{f}({p_{}})\mathrm{e}^{-\frac{\mathring{\imath}}{\hbar} p_{}^\mu x_\mu}\)</span>. Then a shifted, i.e.&nbsp;translated version of <span class="math inline">\(f(x)\)</span> can be written:<span class="math display">\[\begin{aligned}f(x-x_0)&amp;=\int \,\mathrm{d}\Phi_{}(p_{})\, \breve{f}({p_{}})\,\mathrm{e}^{-\frac{\mathring{\imath}}{\hbar} p_\mu (x^\mu-x_0^\mu)}\\&amp;=\int \,\mathrm{d}\Phi_{}(p_{})\, \breve{f}({p_{}})\,\mathrm{e}^{\frac{\mathring{\imath}}{\hbar}p_\mu x^\mu_0}\,\mathrm{e}^{-\frac{\mathring{\imath}}{\hbar} p_\mu x^\mu}\end{aligned}\]</span> Thus the associated, translated state is:<span class="math display">\[\vert f \rangle_{\text{}}=\int \,\mathrm{d}\Phi_{}(p_{})\, \breve{f}({p_{}})\,\mathrm{e}^{\frac{\mathring{\imath}}{\hbar}p_\mu x^\mu_0}\,\vert p_{} \rangle_{\text{}}\]</span></p></li></div></div>
<p><span id="eq-instate"><span class="math display">\[
\vert \text{in} \rangle_{\text{}}=\int \,\mathrm{d}\Phi_{2}(p_{1},p_{2})\, \breve{f_{1}}(p_{1}) \breve{f_{2}}(p_{2}) \mathrm{e}^{\frac{\mathring{\imath}}{\hbar} b{}_{\mu} p_{1}{}^{\mu}}\vert p_{1},p_{2} \rangle_{\text{in}}.
\tag{5.7}\]</span></span></p>
<p>From now on we will drop the breve and infer from the arguments the type of <span class="math inline">\(f_{}\)</span> we are dealing with. Observe that by extracting the impact parameter in this way, the wavefunctions can be identitcal in form, and will still be separated as required.</p>
</section>
<section id="change-in-observable" class="level3 page-columns page-full" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="change-in-observable"><span class="header-section-number">5.3.3</span> Change in observable</h3>
<p>The <abbr title="Kosower Maybee and O’Connell">KMOC</abbr> framework concerns itself with the change of an observable quantity during a scattering event encoded in an operator <span class="math inline">\(\mathbb{O}\)</span>. For such an observable quantitiy <span class="math inline">\(O\)</span> , its change is obtained by evaluating the difference of the expectation value of <span class="math inline">\(\mathbb{O}\)</span>, between in and out states <span class="math display">\[
\Delta O=\langle\text{out} \vert  \mathbb{O} \vert \text{out} \rangle-\langle\text{in} \vert  \mathbb{O} \vert \text{in} \rangle.
\]</span></p>
<p>In quantum mechanics, the out states are related to the in states by the time evolution operator, i.e.&nbsp;the S-matrix, <span class="math inline">\(\vert \text{out} \rangle_{\text{}}=S\vert \text{in} \rangle_{\text{}}\)</span>. Thus:</p>
<div class="aside">
<p>In order, we use the unitarity of the S-matrix, then express the S-matrex as the identity (no actual interaction) and the transfer matrix <span class="math inline">\(T\)</span>. The commutators are then expanded and the part with the identity vanish (as <span class="math inline">\(\mathbb{1}\)</span> commutes with everything).</p>
</div>
<p><span id="eq-DeltaO"><span class="math display">\[
\begin{aligned}
\Delta O    &amp;=\langle\text{in} \vert  S^\dagger\mathbb{O}S \vert \text{in} \rangle-\langle\text{in} \vert  \mathbb{O} \vert \text{in} \rangle\\
            &amp;\stackrel{S^\dagger S=\mathbb{1}}{=}      \langle\text{in} \vert  S^\dagger [\mathbb{O},S] \vert \text{in} \rangle\\
            &amp;\stackrel{S=\mathbb{1}+\mathring{\imath}T}{=}          \langle\text{in} \vert  [\mathbb{O},\mathbb{1}+\mathring{\imath}T] \vert \text{in} \rangle
                                                      -\langle\text{in} \vert  \mathring{\imath}T^\dagger [\mathbb{O},\mathbb{1}+\mathring{\imath}T] \vert \text{in} \rangle\\
            &amp;=    \langle\text{in} \vert  \mathring{\imath}[\mathbb{O},T] \vert \text{in} \rangle
                  +\langle\text{in} \vert   T^\dagger [\mathbb{O},T] \vert \text{in} \rangle\\
            &amp;=\Delta O_\text{v}\,+\Delta O_\text{r}.
\end{aligned}
\tag{5.8}\]</span></span></p>
<p>If we put in the definition of our in state (<a href="#eq-instate">eq.&nbsp;<span>5.7</span></a>), we have</p>
<p><span class="math display">\[
\Delta O = \int \,\mathrm{d}\Phi_{4}(p_{1},p_{2},p_{1}',p_{2}')\,
                  f_{1}(p_{1}) f_{2}(p_{2}) {f{}^\ast}_{1}(p_{1}') {f{}^\ast}_{2}(p_{2}')
                  \,\mathrm{e}^{\mathring{\imath}b{}_{\mu} \frac{p_{1}{}^{\mu}-p_{1}'{}^{\mu}}{\hbar}}
                  \big[\mathcal{I}_{\text{v}}(O)-\mathcal{I}_{\text{r}}(O) \big],
\]</span></p>
<div class="page-columns page-full"><p>where we defined the real integrand <span class="math inline">\(\mathcal{I}_{\text{r}}(O)\)</span> and the virtual integrand <span class="math inline">\(\mathcal{I}_{\text{v}}(O)\)</span> as the following matrix elements <a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn18"><p><sup>18</sup>&nbsp;NB: the notation is slightly different in the <span class="citation" data-cites="Bern:2021xze">&nbsp;[<a href="references.html#ref-Bern:2021xze" role="doc-biblioref">16</a>]</span> paper</p></li></div></div>
<p><span class="math display">\[
\begin{aligned}
\mathcal{I}_{\text{v}}(O)&amp;={}_{\text{in}}\langle p_{1}'p_{2}' \vert{\mathring{\imath}[\mathbb{O},T]           }\vert p_{1}p_{2} \rangle_{\text{in}}\\
\mathcal{I}_{\text{r}}(O)&amp;={}_{\text{in}}\langle p_{1}'p_{2}' \vert{T^\dagger[\mathbb{O},T]   }\vert p_{1}p_{2} \rangle_{\text{in}}.
\end{aligned}
\]</span></p>
<div class="page-columns page-full"><p>Let us first look at the virtual integrand <span class="math inline">\(\mathcal{I}_{\text{v}}(O)\)</span>:<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn19"><p><sup>19</sup>&nbsp;Here we define <span class="math display">\[O_{\text{in}}\vert p_{1}p_{2} \rangle_{\text{}}=\mathbb{O}\vert p_{1}p_{2} \rangle_{\text{}}\]</span> aswell as, <span class="math display">\[O_{\text{in}}'{}_{\text{}}\langle p_{1}'p_{2}' \vert={}_{\text{}}\langle p_{1}'p_{2}' \vert\mathbb{O}\]</span> and finally <span class="math display">\[\underset{\mathclap{p_{}'-p_{}}}{\Delta}O\,=O_{\text{in}}'-O_{\text{in}}\]</span></p></li></div></div>
<p><span id="eq-vInt"><span class="math display">\[
\begin{aligned}
\mathcal{I}_{\text{v}}(O)&amp;={}_{\text{in}}\langle p_{1}'p_{2}' \vert{\mathring{\imath}[\mathbb{O},T]     }\vert p_{1}p_{2} \rangle_{\text{in}}  \\
      &amp;={}_{\text{in}}\langle p_{1}'p_{2}' \vert{\mathring{\imath}\mathbb{O}T}\vert p_{1}p_{2} \rangle_{\text{in}}   
      - {}_{\text{in}}\langle p_{1}'p_{2}' \vert{\mathring{\imath}T\mathbb{O}            }\vert p_{1}p_{2} \rangle_{\text{in}}\\
      &amp;=\mathring{\imath}O_{\text{in}'}  \; {}_{\text{in}}\langle p_{1}'p_{2}' \vert{T}\vert p_{1}p_{2} \rangle_{\text{in}}
      - \mathring{\imath}O_{\text{in}} \;    {}_{\text{in}}\langle p_{1}'p_{2}' \vert{T}\vert p_{1}p_{2} \rangle_{\text{in}}\\
      &amp;=\mathring{\imath}\underset{\mathclap{p_{}'-p_{}}}{\Delta}O\, \,    {}_{\text{in}}\langle p_{1}'p_{2}' \vert{T}\vert p_{1}p_{2} \rangle_{\text{in}}\\
      &amp;=\mathring{\imath}\underset{\mathclap{p_{}'-p_{}}}{\Delta}O\,\,\tilde{\delta}^{4}(p_{1}+p_{2}-p_{1}'-p_{2}')
                                    \mathcal{A}^{}(p_{1},p_{2}\to p_{1}',p_{2}').
\end{aligned}
\tag{5.9}\]</span></span></p>
<div class="page-columns page-full"><p>Note that the amplitude is from in states to in states. In order to obtain the real integrand <span class="math inline">\(\mathcal{I}_{\text{r}}(O)\)</span>, we insert a complete set of states :<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn20"><p><sup>20</sup>&nbsp;<span class="math inline">\(1=\sum\limits_X \int \,\mathrm{d}\Phi_{2+\vert X \vert}(r_1,r_2,X)\,\vert r_1 r_2 X \rangle \langle r_1 r_2 X \vert\)</span> Where we could consider the states <span class="math inline">\({r_1,r_2,X}\)</span> to be the final states after the scattering. Note that we always impose having two Black Hole (<abbr title="Black Hole">BH</abbr>) at all times, as we have no pair annihilation, which is why the sum always has a two particle dyad. The additional states encoded in <span class="math inline">\(X\)</span> are all possible additional messenger states (we also have no <abbr title="Black Hole">BH</abbr> pair production).</p></li></div></div>
<p><span id="eq-rInt"><span class="math display">\[
\begin{aligned}
\mathcal{I}_{\text{r}}(O)&amp;={}_{\text{in}}\langle p_{1}'p_{2}' \vert{T^\dagger[\mathbb{O},T]}\vert p_{1}p_{2} \rangle_{\text{in}}\\
      &amp;=\sum\limits_X \int \,\mathrm{d}\Phi_{2+\vert X \vert}(r_1,r_2,X)\,   {}_{\text{in}}\langle p_{1}'p_{2}' \vert T^\dagger\vert{r_1 r_2 X}\rangle\langle {r_1 r_2 X} \vert
                        [\mathbb{O},T]\vert p_{1}p_{2} \rangle_{\text{in}}\\
      &amp;=\sum\limits_X \int \,\mathrm{d}\Phi_{2+\vert X \vert}(r_1,r_2,X)\,  \tilde{\delta}^{4}(p_{1}+p_{2}-r_{1}-r_{2}-r_{X})\,
      \mathcal{A}^{}(p_{1}, p_{2}\to r_{1}, r_{2}, r_{X}) \\
      &amp;\qquad \underset{\mathclap{rX-p_{}}}{\Delta}O\,\,\tilde{\delta}^{4}(p_{1}'+p_{2}'-r_{1}-r_{2}-r_{X})\,
      \mathcal{{A{}^\ast}}^{}(p_{1}', p_{2}'\to r_{1}, r_{2}, r_{X}),
\end{aligned}
\tag{5.10}\]</span></span></p>
<div class="page-columns page-full"><p>where the <span class="math inline">\(X\)</span> encodes any number of additional messenger states, and <span class="math inline">\(r_{X}\)</span> is the sum of their momenta. For both integrands we can preform some variable changes and eliminate certain Dirac delta functions. We introduce momentum shifts <span class="math inline">\(q_i=p_{i}'-p_{i}\)</span> and then integrate over <span class="math inline">\(q_2\)</span>, and finally relabel <span class="math inline">\(q_1 \to q_{}\)</span> <a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>. Thus we have</p><div class="no-row-height column-margin column-container"><li id="fn21"><p><sup>21</sup>&nbsp;Introducing the momentum shifts modifies the measure in the following way: <span class="math display">\[\begin{aligned}\,\mathrm{d}\Phi_{}(p_{i}')\,&amp;=\,\mathrm{d}\Phi_{}(p_{i}+q_i)\,\\=&amp;\,\tilde{\mathrm{d}}^{4}q_i\,\,\tilde{\delta}^{}({(p_{i}+q_i)^2-m_i^2}) \Theta^{{}}({p_{i}^0+q_i^0})\end{aligned}\]</span> Now since we also have the on-shell enforcing delta function from <span class="math inline">\(\,\mathrm{d}\Phi_{}(p_{i})\,\)</span> we can rewrite the delta functions: <span class="math display">\[\begin{aligned}\,\mathrm{d}\Phi_{}(p_{i})\,&amp;\,\tilde{\delta}^{}((p_{i}+q_i)^2-m_i^2)\\&amp;=\,\mathrm{d}\Phi_{}(p_{i})\,\tilde{\delta}^{}(\underbracket{(p_{i}^2-m_i^2)}_{\text{redundant}}+2 p_{i} \cdot q_i+q_i^2)\\&amp;=\,\mathrm{d}\Phi_{}(p_{i})\,\tilde{\delta}^{}(2 p_{i} \cdot q_i+q_i^2)\end{aligned}\]</span> Finally we integrate <span class="math inline">\(q_2\)</span> by solving <span class="math inline">\(\tilde{\delta}^{(4)}(p_{1}+p_{2}-p_{1}'-p_{2}')=\tilde{\delta}^{(4)}(q_1+q_2)\)</span> and thus we just set <span class="math inline">\(q_2=-q_1\)</span></p></li></div></div>
<p><span id="eq-DeltaOv"><span class="math display">\[
\begin{aligned}
\Delta O_\text{v}\,=\int &amp;\,\mathrm{d}\Phi_{2}(p_{1},p_{2})\, \,\tilde{\mathrm{d}}^{4}q_{}\,
      \tilde{\delta}^{}(2 p_{1} \cdot q_{}+q_{}^2) \Theta^{{}}(p_{1}{}^{0}+q_{}^0)\, \tilde{\delta}^{}(2 p_{2} \cdot q_{}-q_{}^2) \Theta^{{}}(p_{2}{}^{0}-q_{}^0)\\
      &amp;\times f_{1}(p_{1})f_{2}(p_{2}){f{}^\ast}_{1}(p_{1}+q_{}){f{}^\ast}_{2}(p_{2}-q_{})\,\mathrm{e}^{-\frac{\mathring{\imath}}{\hbar} b{}_{\mu} q_{}^\mu}\\
      &amp;\times \mathring{\imath}\underset{\mathclap{q_{}}}{\Delta}O\, \mathcal{A}^{}(p_{1},p_{2} \to p_{1}+q_{},p_{2}-q_{}),
\end{aligned}
\tag{5.11}\]</span></span></p>
<p><span id="eq-DeltaOr"><span class="math display">\[
\begin{aligned}
\Delta O_\text{r}\,=\sum\limits_X \int &amp;\,\mathrm{d}\Phi_{2+\vert X \vert}(r_1, r_2,X)\,
      \,\mathrm{d}\Phi_{2}(p_{1},p_{2})\, \,\tilde{\mathrm{d}}^{4}q_{}\, \tilde{\delta}^{}(2 p_{1} \cdot q_{}+q_{}^2) \Theta^{{}}(p_{1}{}^{0}+q_{}^0)\\
            &amp;\times \tilde{\delta}^{}(2 p_{2} \cdot q_{}-q_{}^2) \Theta^{{}}(p_{2}{}^{0}-q_{}^0)\\
            &amp;\times f_{1}(p_{1})f_{2}(p_{2}){f{}^\ast}_{1}(p_{1}+q_{}){f{}^\ast}_{2}(p_{2}-q_{})\,\mathrm{e}^{-\frac{\mathring{\imath}}{\hbar} b_\mu q_{}^\mu}\\
            &amp;\times\underset{\mathclap{rX-p_{}}}{\Delta}O\,\tilde{\delta}^{(4)}(p_{1}+p_{2}-r_{1}-r_{2}-r_{X}) \\
            &amp;\times   \mathcal{A}^{}(p_{1}, p_{2} \to r_{1}, r_{2}, r_{X})\mathcal{{A{}^\ast}}^{}(p_{1}+q_{}, p_{2}-q_{}\to r_{1}, r_{2}, r_{X}).
\end{aligned}
\tag{5.12}\]</span></span></p>
<p>We have arrived at an integral expression for the change in observable <span class="math inline">\(\Delta O\)</span>. Luckily for us, we will not need to perform these integrals in the classical limit. We will just have carefully chosen replacement rules for the integrated variables! Let us look at this in more detail now.</p>
</section>
<section id="classical-limit" class="level3 page-columns page-full" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="classical-limit"><span class="header-section-number">5.3.4</span> Classical limit</h3>
<p>Since we are concerned with classical observables we need to explore the classical limit of <a href="#eq-DeltaO">eq.&nbsp;<span>5.8</span></a>, i.e.&nbsp;the limit of <span class="math inline">\(\hbar \to 0\)</span>. We first discuss the classical limit of wavefunctions. We impose multiple conditions on the wavefunctions. The first are those imposed by <abbr title="Lehmann Symanzik and Zimmermann">LSZ</abbr> reduction. That is,</p>
<ul>
<li>Compact support momentum space wavefunction</li>
<li>Peaked around one value of momenta</li>
</ul>
<p>Furthermore the classical limit of the wavefunctions should make sense, i.e.&nbsp;</p>
<ol type="1">
<li>as <span class="math inline">\(\hbar \to 0\)</span> the position and momentum wavefunction should approach Dirac delta functions, centered around their classical values.</li>
<li>The overlap between the wavefunction and its conjugate should be nearly full, since they represent the same particle classically.</li>
</ol>
<p>Consider for example a nonrelativistic wavefunction for a particle of mass <span class="math inline">\(m_{}\)</span>:</p>
<p><span class="math display">\[
f(\mathbf{{p_{}}}_{})=\exp\Big({-\frac{\vert\mathbf{{p_{}}}_{} \vert}{2 \hbar m \ell_c/\ell_\omega^2}}\Big)\stackrel{\hbar=\ell_cm}{=}\exp\Big({-\frac{\vert\mathbf{{p_{}}}_{} \vert}{2 m^2 \ell_c^2 /\ell_\omega^2}}\Big),
\]</span></p>
<div class="page-columns page-full"><p>where <span class="math inline">\(\ell_c=\frac{\hbar}{m}\)</span> is the compton wavelength of the particle and <span class="math inline">\(\ell_\omega\)</span> is a characteristic width. This wavefunction, with the proper normalization, grows sharper in the <span class="math inline">\(\hbar \to 0\)</span> limit. If we now take the Fourier transform of <span class="math inline">\(f(\mathbf{{p_{}}}_{})\)</span> to obtain the position “probability density”, we have:<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a> <span class="math display">\[
\begin{aligned}
\mathcal{F}^{-1}_{\mathbf{{p_{}}}_{}}\left[f\right](\mathbf{{x}}_{})   &amp;=\int \frac{\,\mathrm{d}^{}\mathbf{{p_{}}}_{}\,}{2 \pi} \exp\Big({-\big(\frac{\mathbf{{p_{}}}_{}}{A} \big)^2}\Big)\exp\Big({-\frac{\mathring{\imath}}{\hbar} \mathbf{{p_{}}}_{}\cdot \mathbf{{x}}_{}}\Big)\\
            &amp;=\frac{1}{2\pi}\underbracket{\int \,\mathrm{d}^{}\mathbf{{p_{}}}_{}\, \exp\Big({-\Big(\frac{\mathbf{{p_{}}}_{}}{A}-\frac{\mathring{\imath}\mathbf{{x}}_{}A}{2 \hbar} \Big)^2}\Big)}_{\sqrt{\pi}A}\exp\Big({- \frac{\mathbf{{x}}_{}^2A^2}{4 \hbar^2}}\Big)\\
      &amp;=\frac{\sqrt{2}A}{2 \pi}\exp\Big({-\frac{\mathbf{{x}}_{}^2}{2 \ell_\omega^2}}\Big).
\end{aligned}
\]</span></p><div class="no-row-height column-margin column-container"><li id="fn22"><p><sup>22</sup>&nbsp;<span class="math inline">\(A\)</span> absorbs the various constants, with <span class="math inline">\(A=\sqrt{2}m\frac{\ell_c}{\ell_\omega}\)</span> and <span class="math inline">\(\mathbf{{x}}_{0}\)</span></p></li></div></div>
<p>This elucidates more clearly the meaning of characteristic width, as <span class="math inline">\(\ell_\omega\)</span> is the standard deviation of the wavefunction in position space. Thus, the position-space wavefunction grows sharper in the <span class="math inline">\(\ell_\omega^2 \to 0\)</span> limit. For both wavefunctions to simultaneously grow sharper in the classical limit, we must then have that <span class="math inline">\(\xi=(\frac{\ell_c}{\ell_\omega} )^2\to0\)</span> remembering that the <span class="math inline">\(\hbar \to 0\)</span> limit is just given by the <span class="math inline">\(\ell_c\to0\)</span> one. Finally the meaning of classical limit in this context is the <span class="math inline">\(\xi \to 0\)</span> limit.</p>
<p>Going back to the general conditions, we want a wavefunction <span class="math inline">\(f_{i}(p_{i})\)</span> such that in the classical limit the momentum reaches its classical value: <span class="math inline">\(\breve{p_{i}}=m_{i}\breve{u_{i}}\)</span>, with <span class="math inline">\(\breve{u_{i}}\)</span> the classical four-velocity of particle <span class="math inline">\(i\)</span>, normalized to <span class="math inline">\(\breve{u_{i}}^2=1\)</span>. In other words,</p>
<p><span class="math display">\[
\langle p_{i}{}^{\mu}\rangle=\int \,\mathrm{d}\Phi_{}(p_{i})\, p_{i}{}^{\mu} \vert f_{i}(p_{i}) \vert^2\stackrel{!}{=}m_i \breve{u}_i^\mu (1+\mathcal{O}(\xi^{\beta'})),
\]</span></p>
<p>where <span class="math inline">\(\beta'\)</span> encodes the speed at which the classical value is reached in the <span class="math inline">\(\xi\to0\)</span> limit. The velocity normalization convergence is controlled by <span class="math inline">\(\beta''\)</span> <span class="math display">\[\breve{u}_i \cdot u_i = 1+ \mathcal{O}(\xi^{\beta''}),\]</span></p>
<p>Finally wavefunction’s spread is controlled by <span class="math inline">\(\beta\)</span>, and must converge to 0: <span class="math display">\[\begin{aligned} \sigma^2(p_{i})/m_i^2&amp;=\frac{1}{m_i^2}\langle(p_{i}-\langle p_{i}\rangle)^2\rangle\\&amp;=\frac{1}{m_i^2}(\langle p_{i}^2\rangle-\langle p_{i}\rangle^2)\\&amp;=\frac{1}{m_{i}^2}(m_{i}^2-(m_{i}\breve{u_{i}}(1+\mathcal{O}(\xi^{\beta'})))^2)
\\&amp;\propto\xi^\beta,\end{aligned}\]</span></p>
<p>where <span class="math inline">\(\langle p_{i}^2\rangle=m_i^2\)</span> is enforced by the measure <span class="math inline">\(\,\mathrm{d}\Phi_{}(p_{})\,\)</span>.</p>
<p>Additionally, the wavefunction should be Lorentz invariant, and naively we would have that <span class="math inline">\(f_{}(p_{i}^\mu)=f_{}'(p_{i}^2)\)</span>. However the integration measure enforces an on-shell condition: <span class="math inline">\(m_i^2=p_{i}^2\)</span>. Thus the wavefunction cannot depend on <span class="math inline">\(p_{i}^2\)</span>, and we need to introduce at least one additional four vector parameter <span class="math inline">\(u\)</span>. The simplest dimensionless combination of parameters it then <span class="math inline">\(\frac{p_{}\cdot u }{m}\)</span>. Of course the wavefunction must also depend on <span class="math inline">\(\xi\)</span> and the simplest form of argument will thus be <span class="math inline">\(\frac{p_{}\cdot u }{m \xi}\)</span> so that any <span class="math inline">\(p_{}\)</span> not aligned with <span class="math inline">\(u\)</span> will be strongly suppressed in the <span class="math inline">\(\xi \to0\)</span> limit.</p>
<p>We now have control over most of the conditions:</p>
<ul>
<li>The classical limit is well defined</li>
<li>The wavefunction spread is controlled</li>
<li>The arguments of the wavefunction are clear</li>
</ul>
<p>We can write a general wavefunction that satisfies the above as:</p>
<p><span class="math display">\[
f(\frac{p_{}\cdot u }{m}\vert\breve{u_{i}};m_{i} ;\beta^{(i)}).
\]</span></p>
<p>This function can take the form of a gaussian, or something similar to <a href="#eq-peak">eq.&nbsp;<span>5.5</span></a>. Now there is one final requirement, that concerns the overlap of <span class="math inline">\(f_{}\)</span> and <span class="math inline">\({f{}^\ast}_{}\)</span> must be <span class="math inline">\(\mathcal{O}(1)\)</span>, equivalently and more precisely:</p>
<p><span class="math display">\[
{f{}^\ast}_{}(p_{}+q_{})\sim {f{}^\ast}_{}(p_{}) \implies {f{}^\ast}_{}(p_{}+q_{})- {f{}^\ast}_{}(p_{})\ll 1 \implies q_{}{}^{\mu}\frac{\partial_{}^{} }{\partial_{}{p{}^{\mu}}^{}}{f{}^\ast}_{}(p_{})\ll1.
\]</span> Making explicit the <span class="math inline">\(\frac{p_{}\cdot u }{m \xi}\)</span> dependence: <span class="math inline">\(f_{}(p_{})=\varphi(\frac{p_{}\cdot u }{m \xi})\)</span> for <span class="math inline">\(\varphi(x)\)</span> a scalar function. <span class="math display">\[\implies \frac{q_{}{}^{\mu} u_\mu}{m \xi}\frac{\mathrm{d}^{} \varphi^*(x)}{\mathrm{d}{x}^{}}\Bigr|_{\frac{p_{}\cdot u }{m \xi}}\ll  1.\]</span></p>
<p>Thus we require that for a characteristic value of <span class="math inline">\(q_{}=q_{}{}_{0}\)</span> we have:</p>
<p><span class="math display">\[
\frac{q_{}{}_{0}\cdot u}{m \xi}=\bar{q}_{}{}_{0} \cdot u\frac{\ell_\omega^2}{\ell_c}\ll1\iff \bar{q}_{}{}_{0} \cdot u\,\ell_\omega\ll \sqrt{ \xi},
\]</span></p>
<p>having we denoted by a bar any quantity that has been rescaled by <span class="math inline">\(\hbar\)</span>. Thus, a momentum <span class="math inline">\(p_{}\)</span>, when divided by <span class="math inline">\(\hbar\)</span> will be written <span class="math inline">\(\bar{p_{}}\)</span> and called wavenumber. We will combine this inequality with ones we obtain from the specific cases of integrations required above.</p>
<p>We now want to examine the classical limit of the integrands of the form <a href="#eq-DeltaOv">eq.&nbsp;<span>5.11</span></a>. If we consider just the integration over the initial momenta <span class="math inline">\(p_{i}\)</span> and the initial wavefunctions with <span class="math inline">\(\tilde{\delta}^{}(2 p_{i} \cdot q_{}+q_{}^2)\)</span>, the delta function will smear out to a sharply peaked function whose scale is of the same order as the original wavefunctions. As <span class="math inline">\(\xi\)</span> gets smaller, this function will turn back into a Dirac delta function imposed on the <span class="math inline">\(q_{}\)</span> integration. Let us examine this statement more closely. We are interested in the classical limit of the integrals such as:</p>
<p><span id="eq-dfunct"><span class="math display">\[
d(m,\xi,u,q_{})=\int \,\mathrm{d}\Phi_{}(p_{})\, \tilde{\delta}^{}(2 p_{}\cdot q_{}+q_{}^2) \Theta^{{}}(p_{}^0+q_{}^0)\varphi \Big(\frac{p_{}\cdot u }{m \xi} \Big)\varphi^*\Big(\frac{(p_{}+q_{}) \cdot u }{m \xi} \Big).
\tag{5.13}\]</span></span></p>
<p>This integral must be Lorentz invariant and depends on <span class="math inline">\(m,\xi, u,q_{}\)</span> thus it must manifestly only depend on the following Lorentz invariants: <span class="math inline">\(u^2,q_{}^2,u \cdot q_{}, \xi\)</span>. One of these is not actually a variable as we will normalise <span class="math inline">\(u^2=1\)</span>. The rest are not fully dimensionless, but we can render them dimensionless:</p>
<p><span class="math display">\[
\begin{aligned}
[q_{}^2 ] &amp;=[\hbar \bar{q}_{}]^2=[M]^2\implies[\ell_c\sqrt{-\bar{q}_{}^2}]=[\frac{\hbar}{m}\sqrt{-\bar{q}_{}^2}]=\frac{[M]}{[M]}=1,\\
[u \cdot q_{}]&amp;=[M]\implies [\frac{u \cdot\bar{q}_{}}{\sqrt{-\bar{q}_{}^2}}]= [\frac{u \cdot{q_{}}}{\sqrt{-{q_{}}^2}}]=\frac{[M]}{[M]}=1,\\
[\xi]&amp;=1.
\end{aligned}
\]</span></p>
<div class="page-columns page-full"><p>If we call <span class="math inline">\(\frac{1}{\sqrt{-\bar{q}_{}^2}}=\ell_s\)</span> a scattering length<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a> then our dimensionless ratios become :</p><div class="no-row-height column-margin column-container"><li id="fn23"><p><sup>23</sup>&nbsp;t <span class="math inline">\([\frac{1}{\sqrt{-\bar{q}_{}^2}}]=[T]=[L]=[\ell_s]\)</span></p></li></div></div>
<p><span class="math display">\[\frac{\ell_c}{\ell_s} \quad \text{and}\quad \ell_s\,\bar{q}_{}\cdot u .\]</span></p>
<p>The Dirac delta function can then be rewritten as: <span class="math display">\[
\tilde{\delta}^{}(2 p_{}\cdot q_{}+q_{}^2)=\tilde{\delta}^{}(2\hbar m\, u\cdot \bar{q}_{}+\hbar^2 \bar{q}_{}^2)=\frac{1}{\hbar m}\tilde{\delta}^{}(2 \bar{q}_{}\cdot u-\frac{\ell_c}{\ell_s^2})=\frac{\ell_s}{\hbar m}\tilde{\delta}^{}(2\ell_s\, \bar{q}_{}\cdot u-\frac{\ell_c}{\ell_s}).
\]</span></p>
<p>Performing the integration over <span class="math inline">\(p_{}\)</span> in <a href="#eq-dfunct">eq.&nbsp;<span>5.13</span></a> we obtain symbolically:</p>
<p><span class="math display">\[
d(m,\xi,u,q_{})=\text{peaked function imposing that } {2\ell_s\, \bar{q}_{}\cdot u=\frac{\ell_c}{\ell_s}}\text{ with width } \xi^\beta.
\]</span></p>
<div class="cell page-columns page-full" data-execution_count="5">

<div class="no-row-height column-margin column-container page-columns page-full"><div class="cell-output cell-output-display page-columns page-full" data-execution_count="2">
<div id="fig-gaussian" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="scattering_files/figure-html/fig-gaussian-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption margin-caption">Fig&nbsp;5.4: Sharpening gaussian</figcaption><p></p>
</figure>
</div>
</div></div></div>
<p>Let us disucss the wavefunction and the scales from a physical perspective. The characteristic width <span class="math inline">\(\ell_\omega\)</span> is the particle’s position uncertainty, <span class="math inline">\(\frac{\hbar}{\ell_\omega}\)</span> is the associated momentum uncertainty. In the classical limit the position uncertainty is neglible with respect to minimum distance between the particles <span class="math inline">\(\ell_s\)</span>:</p>
<p><span class="math display">\[
\ell_\omega\ll \ell_s,
\]</span></p>
<p>and the momentum uncertainty is neglible with respect to the masses of the particles:</p>
<p><span class="math display">\[
\frac{\hbar}{\ell_\omega}\ll m \implies \ell_c\ll \ell_\omega.
\]</span></p>
<p>Putting these together we obtain the goldilocks inequality:</p>
<p><span class="math display">\[
\ell_c\ll\ell_\omega\ll\ell_s.
\]</span></p>
<p>Looking back at the arguments of <span class="math inline">\(d\)</span> we see that</p>
<p><span class="math display">\[
\ell_s\, \bar{q}_{}\cdot u\gg\ell_\omega\bar{q}_{}\cdot u \sim \sqrt{\xi} =   \frac{\ell_c}{\ell_\omega}\gg\frac{\ell_c}{\ell_s}.
\]</span></p>
<p>Thus in the classical limit we have that <span class="math inline">\(d\)</span> collapses to:</p>
<p><span class="math display">\[
d(m,\xi,u,q_{})\propto\tilde{\delta}^{}( \bar{q}_{}\cdot u).
\]</span></p>
<p>Thus, the wavefunction-weighted on-shell phase-space integration disappears in the classical limit. The resulting condition is that the integration momenta take on their physical values. The sequence that we have gone through should be done for all the integrands of type <span class="math inline">\(d\)</span>. We will not do this explicitly every time but instead apply the following rules:</p>
<ol type="1">
<li>Just as for the massless transfer momentum any messenger momentum, be it transfer, virtual-loop or real emmission, shall become a wavenumber: <span class="math inline">\(k\to \hbar \bar{k}\)</span>.</li>
<li>Replace all couplings with their dimensionless counterparts: <span class="math inline">\(\kappa\to \frac{\kappa}{\sqrt{\hbar} }\)</span> (this is only precisely true for <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> and gravity, which are the applications we are interested in).</li>
<li>Eliminate all on-shell integrations by approximating <span class="math inline">\(f_{}(p_{}+\hbar\bar{q}_{})\)</span> by <span class="math inline">\(f_{}(p_{})\)</span>.</li>
<li>Laurent expand all the integrands in <span class="math inline">\(\hbar\)</span>.</li>
<li>Make the integration momenta take on their physical values: <span class="math inline">\(p_{i}\to m_{i}\breve{u_{i}}\)</span>.</li>
</ol>
<p>To make this idea explicit we introduce the following notation, meaning that the steps above have been applied</p>
<p><span class="math display">\[
\Bigg\langle\hspace{-0.6em}\Bigg\langle g(p_{1},p_{2},\dots)\Bigg\rangle\hspace{-0.6em}\Bigg\rangle\stackrel{\text{def}}{=}\int\limits \,\mathrm{d}\Phi_{}(p_{1})\,\,\mathrm{d}\Phi_{}(p_{2})\, \vert f_{1}(p_{1}) \vert^2\vert f_{2}(p_{2}) \vert^2\,g(p_{1},p_{2},\dots)
\]</span></p>
<p>We can now rewrite <a href="#eq-DeltaO">eq.&nbsp;<span>5.8</span></a></p>
<p><span id="eq-DeltaOclas"><span class="math display">\[
\Delta O\,= \Bigg\langle\hspace{-0.6em}\Bigg\langle \int \overbracket{\,\tilde{\mathrm{d}}^{4}q_{}\, \tilde{\delta}^{}(2p_{1}\cdot q_{}+q_{}^2)\Theta^{{}}(p_{1}{}^{0}+q_{}^0)  
                                          \tilde{\delta}^{}(2p_{2}\cdot q_{}-q_{}^2)\Theta^{{}}(p_{2}{}^{0}+q_{}^0)}^{\,\mathrm{d}\Psi_{}(q_{})\,}
                  \mathrm{e}^{{-\frac{\mathring{\imath}}{\hbar}}q_{}^\mu b_\mu}\Big(\mathcal{I'}_{\text{v}}(O)+\mathcal{I'}_{\text{r}}(O) \Big) \Bigg\rangle\hspace{-0.6em}\Bigg\rangle,
\tag{5.14}\]</span></span></p>
<p>where <span class="math display">\[
\begin{aligned}
\mathcal{I'}_{\text{v}}(O)&amp;=\mathring{\imath}\,  \underset{\mathclap{q_{}}}{\Delta}O\, \mathcal{A}^{}(p_{1},p_{2} \to p_{1}+q_{},p_{2}-q_{})\\
\mathcal{I'}_{\text{r}}(O)&amp;=\sum\limits_X \int \,\mathrm{d}\Phi_{2+\vert X \vert}(r_1,r_2,X)\,\underset{\mathclap{rX-p_{}}}{\Delta}O\,
                  \tilde{\delta}^{(4)}(p_{1}+p_{2}-r_{1}-r_{2}-r_{X}) \\
            &amp;\times   \mathcal{A}^{}(p_{1}, p_{2} \to r_{1}, r_{2}, r_{X}) \mathcal{{A{}^\ast}}^{}(p_{1}+q_{}, p_{2}-q_{}\to r_{1}, r_{2}, r_{X}).
\end{aligned}
\]</span></p>
<p>Additionally, we make clear the dependence on <span class="math inline">\(\hbar\)</span> since we want to eventually take the <span class="math inline">\(\hbar \to0\)</span> limit. We apply step 1. above, and change integration variables to <span class="math inline">\(\bar{q}_{}=\frac{q_{}}{\hbar}\)</span> and absorb the <span class="math inline">\(\hbar\)</span> dependence into the redefinition of the integrands and the measure:</p>
<p><span class="math display">\[
\begin{aligned}
\,\mathrm{d}\Psi_{}(q_{})\,
&amp;=\hbar^2\,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,
=\hbar^{\cancelto{2}{4}}\,\tilde{\mathrm{d}}^{4}\bar{q}_{}\,
\cancel{\frac{1}{\hbar}}\tilde{\delta}^{}(2p_{1}\cdot\bar{q}_{}+\hbar\bar{q}_{}^2)
\Theta^{{}}(p_{1}{}^{0}+q_{}^0)
\cancel{\frac{1}{\hbar}}\tilde{\delta}^{}(2p_{1}\cdot \bar{q}_{}+\hbar\bar{q}_{}^2)
\Theta^{{}}(p_{2}{}^{0}+q_{}^0),
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\overline{\mathcal{I}_{\text{v}}'}(O)&amp;=\hbar^2\mathcal{I'}_{\text{v}}(O),\\
\overline{\mathcal{{I}}_{\text{r}}'}(O)&amp;=\hbar^2\mathcal{I'}_{\text{r}}(O).
\end{aligned}\]</span></p>
<p>We can finally neatly write:</p>
<p><span class="math display">\[\Delta O=\Bigg\langle\hspace{-0.6em}\Bigg\langle \int \,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,\mathrm{e}^{-\mathring{\imath}\bar{q}_{}^\mu b_\mu}\Big(\overline{\mathcal{I}_{\text{v}}'}(O)+\overline{\mathcal{{I}}_{\text{r}}'}(O) \Big)\Bigg\rangle\hspace{-0.6em}\Bigg\rangle  .\]</span></p>
<p>The <span class="math inline">\(\hbar\)</span> dependence is now entirely contained in the integrands (ignoring the <span class="math inline">\(\hbar \bar{q}_{}^2\)</span> factors in the delta function). The classical limit of this observable is then simply,</p>
<p><span class="math display">\[
\Delta O_{\text{classical}}=\lim_{\hbar\to0}\hbar^{\beta_{LO}}\Big[\int \,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,\Big(\overline{\mathcal{I}_{\text{v}}'}(O)+\overline{\mathcal{{I}}_{\text{r}}'}(O) \Big) \Big],
\]</span></p>
<p>dropping the angle brackets, since these dissappear in the classical limit. Here <span class="math inline">\(\beta_{LO}\)</span> is the <abbr title="Leading Order">LO</abbr> <span class="math inline">\(\hbar\)</span>-dependence of the observable. This is so that <span class="math inline">\(\Delta O_{\text{classical}}\sim\hbar^0\)</span> i.e.&nbsp;classical scaling.</p>
</section>
</section>
<section id="impulse-in-kmoc" class="level2 page-columns page-full" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="impulse-in-kmoc"><span class="header-section-number">5.4</span> Impulse in <abbr title="Kosower Maybee and O’Connell">KMOC</abbr></h2>
<p>We can now explore the integrands for a specific observable. Consider the change in momentum, or impulse of particle 1. The <abbr title="Kosower Maybee and O’Connell">KMOC</abbr> formalisms gives us a way to write this as:</p>
<p><span class="math display">\[\Delta p_{1}{}^{\mu}=\Bigg\langle\hspace{-0.6em}\Bigg\langle \int \,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,\exp\Big({-\mathring{\imath}\bar{q}_{}^\mu b_\mu}\Big)\Big(\overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})+\overline{\mathcal{{I}}_{\text{r}}'}(p_{1}{}^{\mu}) \Big)\Bigg\rangle\hspace{-0.6em}\Bigg\rangle  .\]</span></p>
<p>We then have:</p>
<p><span class="math display">\[
\begin{aligned}
\overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})&amp;=\hbar^2\mathring{\imath}\,  q_{}\, \mathcal{A}^{}(p_{1},p_{2} \to p_{1}+\hbar \bar{q}_{},p_{2}-\hbar \bar{q}_{})\\
\overline{\mathcal{{I}}_{\text{r}}'}(p_{1}{}^{\mu})&amp;=\hbar^2\int\mathllap{\sum}\,\mathrm{d}\Phi_{2+\vert X \vert}(r_1,r_2,r_X)\,(r_1^\mu-p_{1}^\mu)\,\tilde{\delta}^{(4)}(p_{1}+p_{2}-r_{1}-r_{2}-r_{X}) \\
&amp;\times   \mathcal{A}^{}(p_{1}, p_{2} \to r_{1}, r_{2}, r_{X}) \mathcal{{A{}^\ast}}^{}(p_{1}+\hbar \bar{q}_{},p_{2}-\hbar \bar{q}_{}\to r_{1}, r_{2}, r_{X}).
\end{aligned}
\]</span></p>
<div class="page-columns page-full"><p>We can extract <span class="math inline">\(\hbar\)</span> from <span class="math inline">\(q_{}\)</span> and from the amplitude. In order to determine the <span class="math inline">\(\hbar\)</span> scalin of <span class="math inline">\(\mathcal{A}^{}\)</span> we extract each coupling constant <span class="math inline">\(\kappa\)</span> along with an <span class="math inline">\(\frac{1}{\sqrt{\hbar}}\)</span>, so that quartic vertices yield a factor of <span class="math inline">\(\frac{\kappa^2}{\hbar}\)</span> whereas cubic ones yield <span class="math inline">\(\frac{\kappa}{\sqrt{\hbar}}\)</span><a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a>. If we count the number <span class="math inline">\(V_3\)</span> of all cubic vertices, <span class="math inline">\(V_4\)</span> the number of quartic vertices, and so on, we have that the number of internal lines is <span class="math inline">\(I=\frac{1}{2}(\sum_{d=3}dV_d-E)\)</span>. This is because we have <span class="math inline">\(\sum_{d=3}dV_d\)</span> lines to start with, out of which <span class="math inline">\(E\)</span> are chosen to be external. The remaining <span class="math inline">\((\sum_{d=3}dV_d-E)\)</span> ones are contracted in pairs among themselves to form <span class="math inline">\(I\)</span> internal lines, yielding the factor of <span class="math inline">\(\tfrac{1}{2}\)</span>. In our case we have <span class="math inline">\(E=4+M\)</span> where <span class="math inline">\(M=\vert X \vert\)</span> is the number of messenger particles. Using the argument from loop counting we have that the number of loops of our graph <span class="math inline">\(L\)</span> is given by: <span class="math display">\[
\begin{aligned}
        L=I-V+N=&amp;\frac{1}{2}(\sum_{d=3}d\cdot V_d-4-M)-\sum_{d=3}V_d+1\\
=&amp;\frac{1}{2}(\sum_{d=3}(d-2)V_d)-1-\frac{M}{2},
\end{aligned}
\]</span></p><div class="no-row-height column-margin column-container"><li id="fn24"><p><sup>24</sup>&nbsp;as mentioned in the last section, this is true for gravity and <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> and we will extend this fact to schematically rescale the vertex coupling by <span class="math inline">\(\hbar^-\frac{d-2}{2}\)</span>, for <span class="math inline">\(d\)</span> the degree of the vertex in question.</p></li></div></div>
<div class="page-columns page-full"><p>where <span class="math inline">\(N\)</span> is the number of connected components (<span class="math inline">\(=1\)</span> in our case) . Thus we see that the amount of extracted <span class="math inline">\(\hbar\)</span>s corresponds directly to the number of loops plus one plus the number of additonal messenger particles. <a href="#fn25" class="footnote-ref" id="fnref25" role="doc-noteref"><sup>25</sup></a> We can thus write the amplitude <span class="math inline">\(\mathcal{A}^{}\)</span> as a sum over reduced <span class="math inline">\(L\)</span>-loop amplitudes <span class="math inline">\(\mathcal{\bar{A}}^{(L)}\)</span>:</p><div class="no-row-height column-margin column-container"><li id="fn25"><p><sup>25</sup>&nbsp;The number of extracted couplings being twice that.</p></li></div></div>
<p><span class="math display">\[\mathcal{A}^{}(p_{1},p_{2}\to r_1,r_2,X)=\sum\limits_{L=0}^\infty\Big(\frac{\kappa^{2}}{\hbar} \Big)^{(L+1+\frac{\vert X \vert}{2})}\mathcal{\bar{A}}^{(L)}(p_{1},p_{2}\to r_1,r_2,X).\]</span></p>
<p>Going back to the integrands we have:</p>
<p><span id="eq-impulseIv"><span class="math display">\[
\begin{aligned}
\overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})&amp;=\hbar^3\mathring{\imath}\,  \bar{q}_{}\, \sum\limits_{L=0}^\infty\Big(\frac{\kappa^{2}}{\hbar} \Big)^{(L+1)}\mathcal{\bar{A}}^{(L)}(p_{1},p_{2}\to p_{1}+\hbar \bar{q}_{},p_{2}-\hbar\bar{q}_{})\\
&amp;=\mathring{\imath}\, \hbar  \bar{q}_{}\, \sum\limits_{L=0}^\infty \kappa^{2(L+1)}{\hbar}^{(1-L)}\mathcal{\bar{A}}^{(L)}(p_{1},p_{2}\to p_{1}+\hbar \bar{q}_{},p_{2}-\hbar\bar{q}_{}),
\end{aligned}
\tag{5.15}\]</span></span></p>
<div class="page-columns page-full"><p>as well as the real kernel:<a href="#fn26" class="footnote-ref" id="fnref26" role="doc-noteref"><sup>26</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn26"><p><sup>26</sup>&nbsp;We changed the integration variable from <span class="math inline">\(r_i\)</span> to <span class="math inline">\(w_i=r_i-p_{i}\)</span> thus the measure changes:<span class="math display">\[\,\mathrm{d}\Phi_{2+\vert X \vert}(r_1,r_2,X)\,=\,\mathrm{d}\Phi_{\vert X \vert}(r_X)\,\prod\limits_{i=1,2}\,\tilde{\mathrm{d}}^{4}w_i\,\tilde{\delta}^{}(2p_{i} \cdot w_i+w_i^2)\Theta^{{}}(p_{i}^0+w_i^0)\]</span> where we used the same reasoning as for the <span class="math inline">\(q_i\)</span> variable change.</p></li></div></div>
<p><span class="math display">\[
\begin{aligned}
\overline{\mathcal{{I}}_{\text{r}}'}(p_{1}{}^{\mu})&amp;=\hbar^2\int\mathllap{\sum}\,\mathrm{d}\Phi_{\vert X \vert}(r_X)\,\Big[\prod\limits_{i=1,2}\,\tilde{\mathrm{d}}^{4}w_i\,\tilde{\delta}^{}(2p_{i} \cdot w_i+w_i^2)\Theta^{{}}(p_{i}^0+w_i^0) \Big] \\
&amp;\times w_1^\mu\,\tilde{\delta}^{(4)}(w_1+w_2+r_{X})
\\
&amp;\times\mathcal{A}^{}(p_{1}, p_{2} \to p_{1}+w_{1}, p_{2}+w_{2}, r_{X})
\mathcal{{A{}^\ast}}^{}(p_{1}+\hbar \bar{q}_{},p_{2}-\hbar \bar{q}_{}\to p_{1}+w_{1}, p_{2}+w_{2}, r_{X})\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
=\hbar^2\int\mathllap{\sum}&amp;\,\mathrm{d}\Phi_{\vert X \vert}({r}_X)\,\Big[\prod\limits_{i=1,2}\hbar^3\,\tilde{\mathrm{d}}^{4}\bar{w}_i\,\tilde{\delta}^{}(2p_{i} \cdot \bar{w}_i+\hbar\bar{w}_i^2)\Theta^{{}}(p_{i}^0+\hbar \bar{w}_i^0) \Big] \\
&amp;\times   \hbar \bar{w}_1^\mu\,\hbar^{-4}\tilde{\delta}^{(4)}(\bar{w}_1+\bar{w}_2+\bar{r}_{X})
\\
&amp;\times\sum\limits_{L=0}^\infty\Big(\frac{\kappa^{2}}{\hbar} \Big)^{(2L+2+\vert X \vert)}\mathcal{\bar{A}}^{(L)}(p_{1}, p_{2} \to p_{1}+\hbar\bar{w}_{1}, p_{2}+\hbar\bar{w}_2, r_{X}) \\
&amp;\times\mathcal{{\bar{A}{}^\ast}}^{(L)}(p_{1}+\hbar \bar{q}_{},p_{2}-\hbar \bar{q}_{}\to p_{1}+\hbar\bar{w}_{1}, p_{2}+\hbar\bar{w}_2, r_{X})
\end{aligned}
\]</span></p>
<p><span id="eq-impulseIr"><span class="math display">\[
\begin{aligned}
=\int\mathllap{\sum}&amp;\,\mathrm{d}\Phi_{\vert X \vert}({r}_X)\,\Big[\prod\limits_{i=1,2}\,\tilde{\mathrm{d}}^{4}\bar{w}_i\,\tilde{\delta}^{}(2p_{i} \cdot \bar{w}_i+\hbar\bar{w}_i^2)\Theta^{{}}(p_{i}^0+\hbar \bar{w}_i^0) \Big] \\
&amp;\times    \hbar\bar{w}_1^\mu\,\tilde{\delta}^{(4)}(\bar{w}_1+\bar{w}_2+\bar{r}_{X})
\\
&amp;\times\sum\limits_{L=0}^\infty \kappa^{2(2L+2+\vert X \vert)}{\hbar}^{2-2L-\vert X \vert}\mathcal{\bar{A}}^{(L)}(p_{1}, p_{2} \to p_{1}+\hbar\bar{w}_{1}, p_{2}+\hbar\bar{w}_2, r_{X}) \\
&amp;\times\mathcal{{\bar{A}{}^\ast}}^{(L)}(p_{1}+\hbar \bar{q}_{},p_{2}-\hbar \bar{q}_{}\to p_{1}+\hbar\bar{w}_{1}, p_{2}+\hbar\bar{w}_2, r_{X}).\\
\end{aligned}
\tag{5.16}\]</span></span></p>
<p>Schematically we have</p>
<p><span class="math display">\[
\begin{aligned}
\overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})&amp;=\sum\limits_{L=0}^\infty \mathcal{O}(\kappa^{{2(L+1)}}),\\
\overline{\mathcal{{I}}_{\text{r}}'}(p_{1}{}^{\mu})&amp;=\sum\limits_{L=0}^\infty \mathcal{O}(\kappa^{{4(L+1)+2\vert X \vert}})
\end{aligned}
\]</span></p>
<p>The contributions from the virtual kernel are lower order in the coupling <span class="math inline">\(\kappa\)</span> for a given loop order. Both kernels contribute together provided that the following equation is verified:</p>
<p><span id="eq-rvloopmatch"><span class="math display">\[L-1=2L'+\vert X \vert. \tag{5.17}\]</span></span></p>
<p>where <span class="math inline">\(L\)</span> is the loop count for the virtual kernel and <span class="math inline">\(L'\)</span>, <span class="math inline">\(\vert X \vert\)</span> are the real kernel loop count and messenger particle count respectively. Note that for a tree level virtual kernel, the real-kernel match does not exist. The real kernel is only present for <span class="math inline">\(L&gt;0\)</span>. When taking the classical limit we will only retain contributions from graphs that cancel the <span class="math inline">\(\hbar\)</span> divergences in each corresponding kernel. Thus at the <span class="math inline">\(L\)</span>-loop level, the amplitude in the virtual kernel must cancel with terms of order</p>
<p><span id="eq-hbarvirt"><span class="math display">\[
\hbar^{1-L+O},
\tag{5.18}\]</span></span></p>
<p>where the <span class="math inline">\(O\)</span> term is the order of <span class="math inline">\(\hbar\)</span> that is present as a result of the observable. In the case of particle 1’s momentum, <span class="math inline">\(O=1\)</span>. Similarly, the amplitudes in the real kernel must cancel with:</p>
<p><span id="eq-hbarreal"><span class="math display">\[
\hbar^{2-2L'-\vert X \vert+O}.
\tag{5.19}\]</span></span></p>
<div class="page-columns page-full"><p>Now we see that the <abbr title="Leading Order">LO</abbr> contribution <a href="#fn27" class="footnote-ref" id="fnref27" role="doc-noteref"><sup>27</sup></a>to the impulse, which we denote <span class="math inline">\(\Delta p_{1}^{\mu,(0)}\)</span> can only be from the virtual kernel at tree level. Thus, we have the following equation,</p><div class="no-row-height column-margin column-container"><li id="fn27"><p><sup>27</sup>&nbsp;Here the expansion is in powers of the coupling constant, so even though we want <span class="math inline">\(\hbar\)</span>s to cancel, the loop order will still affect the order of the contribution through the coupling constant <span class="math inline">\(\kappa\)</span> and the <abbr title="Leading Order">LO</abbr> corresponds to <span class="math inline">\(\kappa\)</span></p></li></div></div>
<p><span id="eq-impulseLO"><span class="math display">\[
\Delta p_{1}^{\mu,(0)}=\Bigg\langle\hspace{-0.6em}\Bigg\langle \int \,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,\exp\big({-\mathring{\imath}\bar{q}_{}^\mu b_\mu}\big)\ \overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})^{(L=0)}\Bigg\rangle\hspace{-0.6em}\Bigg\rangle.
\tag{5.20}\]</span></span></p>
<p>And the integrand is given by the tree level 4 point amplitude.</p>
<p><span class="math display">\[
\overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})^{L=0}=\mathring{\imath}\,  \bar{q}_{}^\mu\,  \kappa^{2}{\hbar}^{2}\bar{\mathcal{A}}^{(0)}(p_{1},p_{2}\to p_{1}+\hbar \bar{q}_{},p_{2}-\hbar\bar{q}_{}).
\]</span></p>
<p>At Next-to-Leading Order (<abbr title="Next-to-Leading Order">NLO</abbr>) i.e.&nbsp;<span class="math inline">\(\kappa^4\)</span> order, both integrands contribute, as <a href="#eq-rvloopmatch">eq.&nbsp;<span>5.17</span></a> can be satisfied for <span class="math inline">\(L=1\)</span>, <span class="math inline">\(L'=0\)</span> and <span class="math inline">\(\vert X \vert=2\)</span>. Thus we have the following equation:</p>
<p><span id="eq-impulseNLO"><span class="math display">\[
\Delta p_{1}^{\mu,(1)}=\Bigg\langle\hspace{-0.6em}\Bigg\langle \int \,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,\exp\big({-\mathring{\imath}\bar{q}_{}^\mu b_\mu}\big) \Big(\overline{\mathcal{I}_{\text{v}}'}(p_{1}{}^{\mu})^{(L=1)}+\overline{\mathcal{{I}}_{\text{r}}'}(p_{1}{}^{\mu})^{(L'=0)} \Big)\Bigg\rangle\hspace{-0.6em}\Bigg\rangle.
\tag{5.21}\]</span></span></p>
<p>The virtual integrand is now given by the 1-loop level amplitude, and the real integrand is given by the square of a the tree level amplitude. This process can go on indefinetely, and is independent of the type of observable and the theory. Here we considered the change of momentum a particle, which for a black hole very far away would be very difficult to measure. However, we can also consider an observable such as the four-momentum of the radiated particles, or more precisely its expection value. Of course, the operator corresponding to this observable gives zero when acting on the initial momentum states, and only gives a non-zero result when acting on the messenger states. Thus, for this observable only the real integrand, starting with <span class="math inline">\(\vert X \vert=1\)</span> will contribute, the <abbr title="Leading Order">LO</abbr> contribution being given by what is essentially the unitarity cut of a two loop amplitude. We see that regardless of observable, the objects that are needed are the amplitudes.</p>
<p>For each loop level, many diagrams can contribute, but the classical limit enforces that they must cancel the <span class="math inline">\(\hbar\)</span> orders given by <a href="#eq-hbarreal">eq.&nbsp;<span>5.19</span></a> and <a href="#eq-hbarvirt">eq.&nbsp;<span>5.18</span></a>. The cancellation order is dependent on the considered observable and filters the contributing diagrams. It can also be reformulated in the language of the method of regions.</p>
<p>To see the whole machinery in action, let us take <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> as an example theory, that shows the relevant subleties of the formalism.</p>
</section>
<section id="sqed-amplitudes" class="level2 page-columns page-full" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sqed-amplitudes"><span class="header-section-number">5.5</span> <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> amplitudes</h2>
<p>We want to couple a set of massive scalar fields to electromagnetism. We will use the minimal coupling prescription to ensure that the resulting lagrangian exhibits the required gauge symmetry. The minimal coupling prescription works provided that our free mass lagrangian admits a conserved current. Our free mass lagrangian for two complex scalar fields with different masses is:</p>
<p><span class="math display">\[
\mathcal{L}_m=\sum\limits_{i=1}^2 \partial_\mu \phi_i^\dagger\,\partial^\mu \phi_i - m_i^2 \phi^\dagger_i \phi_i.
\]</span></p>
<p>Notice that under the following transformation:</p>
<p><span class="math display">\[
\begin{aligned}
\phi_i(x) &amp;\rightarrow \mathrm{e}^{-\mathring{\imath}Q_{i} \lambda} \phi_i(x), \\
\phi_i^{\dagger}(x) &amp;\rightarrow \mathrm{e}^{\mathring{\imath}Q_{i} \lambda} \phi_i^\dagger(x) ,\\
\end{aligned}
\]</span></p>
<p>or infinitesimally:</p>
<p><span class="math display">\[
\begin{aligned}
\delta\phi_i &amp;= -\mathring{\imath}\phi_i Q_{i} \delta\lambda ,\\
\delta\phi_i^{\dagger} &amp;= \mathring{\imath}\phi_i^\dagger Q_{i}\delta \lambda,\\
\end{aligned}
\]</span></p>
<p>the above Lagrangian is unchanged. We will identitfy <span class="math inline">\(Q_{i}\)</span> with the charge, in units of <span class="math inline">\(e\)</span>, of each particle. If we upgrade the parameter <span class="math inline">\(\lambda\)</span> to a spacetime function <span class="math inline">\(\lambda(x)\)</span>, the Lagrangian is not invariant anymore and invariance is restored if we replace all the derivatives <span class="math inline">\(\partial_\mu\)</span> with the gauge-covariant derivatives <span class="math inline">\(D_\mu\)</span>:</p>
<p><span class="math display">\[D_\mu=\partial_\mu+\mathring{\imath}\,e\,Q_{i}\,A_\mu,\]</span></p>
<p>i.e.&nbsp;if along with the transformation above, we perform a gauge transformation of the photon field:</p>
<p><span class="math display">\[A_\mu\rightarrow A_\mu + \frac{1}{e} \partial_\mu \lambda\]</span></p>
<p>or infinitesimally</p>
<p><span class="math display">\[\delta A_\mu = \frac{1}{e} \partial_\mu \delta \lambda,\]</span></p>
<p>then the whole lagrangian:</p>
<p><span class="math display">\[\mathcal{L}_{ED}+\mathcal{L}_{m}(\phi_i,\partial_\mu \phi_i)\rightarrow \mathcal{L}_{ED}+\mathcal{L}_{m}(\phi_i,D_\mu \phi_i),\]</span></p>
<p>is invariant under the above defined gauge transformation. The final lagrangian is:</p>
<p><span class="math display">\[\mathcal{L}=-\frac{1}{4} F_{\mu \nu} F^{\mu \nu}+\sum_{i=1}^{2}\left[\left(D_{\mu} \phi_{i}\right)^{\dagger}\left(D^{\mu} \phi_{i}\right)-m_{i}^{2} \phi_{i}^{\dagger} \phi_{i}\right],\]</span></p>
<p>with <span class="math inline">\(F_{\mu \nu} \equiv \partial_{\mu} A_{\nu}-\partial_{\nu} A_{\mu}\)</span>. Expanding and then integrating by parts:</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{L} &amp;=-\frac{1}{4}\left(\partial_{\mu} A_{\nu}-\partial_{\nu} A_{\mu}\right)\left(\partial^{\mu} A^{\nu}-\partial^{\nu} A^{\mu}\right)
+\sum_{i=1}^{2}\left[
    \left(\partial_{\mu}-\mathring{\imath}\, e\,Q_{i}\, A_{\mu} \right)\phi_{i}^{\dagger}
    \left(\partial_{\mu}+\mathring{\imath}\, e\,Q_{i}\, A_{\mu}\right)\phi_{i}
    -m_{i}^{2} \phi_{i}^{\dagger} \phi_{i}
    \right]
\\
&amp;=\underbrace{
    \frac{1}{2} A_{\mu}\left[\eta^{\mu \nu}\partial^{2}-\partial^{\mu} \partial^{\nu}\right] A_{\nu}
    +\sum\limits_{i=1}^2-\phi_i^{\dagger}\left(\partial^{2}+m_i^{2}\right) \phi_i
    }_{\mathcal{L}_{0}}
+\underbrace{
    \sum\limits_{i=1}^2q_i^2\,e^{2} A_{\mu} A^{\mu} \,\phi^{\dagger}_i \phi_i
    -\mathring{\imath}\, e\,Q_{i}\, A_{\mu}\left(\phi^{\dagger}_i \partial^{\mu} \phi_i-\left(\partial^{\mu} \phi^{\dagger}_i\right) \phi_i\right)
    }_{\mathcal{L}^{\prime}}.
\end{aligned}
\]</span></p>
<p>Since we have a massless photon, and still have gauge freedom we have to implement gauge fixing in the usual way:</p>
<p><span class="math display">\[
\begin{aligned}\mathcal{L}_{\text{eff}}
      &amp;=\mathcal{L}+\overbracket{\frac{-1}{2 \xi}(\partial_\mu A^\mu)^2}^{\mathcal{L_\text{GF}}}\\
      &amp;=
    \frac{1}{2} A_{\mu}\underbracket{\Bigg[g^{\mu \nu}\partial^{2}-\Big(1-\frac{1}{\xi} \Big)\partial^{\mu} \partial^{\nu} \Bigg]}_{\rightarrow \tilde{D}^{{\mu \nu}}_\xi(k)=\frac{-\mathring{\imath}}{k^{2}+\mathring{\imath}\varepsilon}\left[g_{\mu \nu}-(1-\xi) \frac{k_{\mu} k_{\nu}}{k^{2}}\right]} A_{\nu}
    +\sum\limits_{i=1}^2-\phi_i^{\dagger}\underbracket{(\partial^{2}+m_i^{2} )}_{\tilde{\Delta}_F(q^2)=\frac{\mathring{\imath}}{p^{2}-m^{2}+\mathring{\imath}\varepsilon}} \phi_i\\
&amp;+
    \sum\limits_{i=1}^2\underbracket{Q_{i}^2\,e^{2}\,\eta^{\mu \nu}}_{\times 2\mathring{\imath}\rightarrow \mathrm{4-vertex} } A_{\mu} A_{\nu} \,\phi^{\dagger}_i \phi_i
    \underbracket{-\mathring{\imath}\, e\,Q_{i}\, A_{\mu}\left(\phi^{\dagger}_i \partial^{\mu} \phi_i-\left(\partial^{\mu} \phi^{\dagger}_i\right) \phi_i\right)}_{\times \mathring{\imath}\rightarrow \mathrm{3-vertex}}.
\end{aligned}
\]</span></p>
<p>In the last lines we identify the terms contributing to the Feynman rules. They are given in <a href="#tbl-sqedfrules">Table&nbsp;<span>5.1</span></a></p>
<div class="fullwidth">
<div id="tbl-sqedfrules" class="anchored">
<table class="table">
<caption>Tbl&nbsp;5.1: Feynman rules for <abbr title="Scalar Quantum Electrodynamics">SQED</abbr></caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">For every</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Write</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><div>
<p><img src="./tikz/photonprop.svg" class="img-fluid"></p>
</div></td>
<td style="text-align: left;">internal photon line</td>
<td style="text-align: left;"><span class="math inline">\(\tilde{D}^{{\mu \nu}}_\xi( \ell)=\frac{-\mathring{\imath}}{ \ell^{2}+ \mathring{\imath}\varepsilon}\left[\eta_{\mu \nu}-(1-\xi) \frac{\ell_{\mu} \ell_{\nu}}{ ell^{2}}\right]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><div>
<p><img src="./tikz/scalarprop.svg" class="img-fluid"></p>
</div></td>
<td style="text-align: left;">internal scalar</td>
<td style="text-align: left;"><span class="math inline">\(\tilde{\Delta}_F(k^2)=\frac{\mathring{\imath}}{k^{2}-m^{2} +\mathring{\imath}\varepsilon}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><div>
<p><img src="./tikz/seagull.svg" class="img-fluid"></p>
</div></td>
<td style="text-align: left;"><span class="math inline">\(\phi_i \phi_i^\dagger  A_\mu A_\nu\)</span> vertex</td>
<td style="text-align: left;"><span class="math inline">\(2 \mathring{\imath}Q_{i}^2\,e^2\,\eta^{\mu \nu}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><div>
<p><img src="./tikz/cubic.svg" class="img-fluid"></p>
</div></td>
<td style="text-align: left;"><span class="math inline">\(\phi_i(k_i) \phi_i^\dagger(k'_i)  A_\mu\)</span> vertex</td>
<td style="text-align: left;"><span class="math inline">\(\mathring{\imath}e\,Q_{i}\,(k_i^\mu-  k_i^{\prime\mu})\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><div>
<p><img src="./tikz/extscalar.svg" class="img-fluid"></p>
</div></td>
<td style="text-align: left;">External scalar</td>
<td style="text-align: left;"><span class="math inline">\(\times 1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><div>
<p><img src="./tikz/extphoton.svg" class="img-fluid"></p>
</div></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{c}  \text { incoming } \\  \text { outgoing }  \end{array}\right\}\)</span> photon</td>
<td style="text-align: left;"><span class="math inline">\(\times \left\{\begin{array}{c}\varepsilon_{\mu}  \\ \varepsilon_{\mu}^{* \prime}  \end{array}\right\}\)</span>, with <span class="math inline">\(\varepsilon \cdot k=0,  \varepsilon^{\prime} \cdot k^{\prime}=0\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>where we consider only incoming momenta and the arrows denote incoming or outgoing particles. For the photon, we will take the Feynamn gauge, setting <span class="math inline">\(\xi=1\)</span> and thus <span class="math inline">\(\tilde{D}^{{\mu \nu}}_1(\ell)=\tilde{D}^{{\mu \nu}}(\ell)=\frac{-\mathring{\imath}\eta^{\mu \nu}}{\ell^{2}+\mathring{\imath}\varepsilon}\)</span>.</p>
<section id="expansions-and-simplifications" class="level3 page-columns page-full" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="expansions-and-simplifications"><span class="header-section-number">5.5.1</span> Expansions and simplifications</h3>
<p>Notice that if we rescale all photon momenta (taking them to be the loop momenta) by <span class="math inline">\(\hbar\)</span> or equivalently take them to be in the soft region: <span class="math inline">\(\vert k \vert\sim\vert q \vert\ll \vert p \vert\)</span>, where <span class="math inline">\(p\)</span> is the external momenta, then the photon propagator scales homgeneously in <span class="math inline">\(\hbar\)</span>, typically:</p>
<p><span id="eq-photonscale"><span class="math display">\[
\frac{1}{(\ell-q_{})^2}=\frac{1}{\hbar^2}\frac{1}{(\bar{\ell}-\bar{q}_{})^2},
\tag{5.22}\]</span></span></p>
<p>thus contributes <span class="math inline">\(\mathcal{O}(\hbar^{-2})\)</span> to the overall diagram. The matter propagator on the other hand, has inhomgeneous <span class="math inline">\(\hbar\)</span> scaling, as we do not rescale the external momenta, (or equivalently the external momenta are not restricted by the regions). Note that we will not consider internal mass loops as the soft limit means that massive pair production is forbidden, thus massive propagators necessarily route an external momentum. We can nonetheless expand a generic massive propagator in the soft limit:</p>
<p><span id="eq-massiveScale"><span class="math display">\[
\begin{aligned}
\frac{1}{(\ell-p_{i})^2-m_{i}^2}&amp;=\frac{1}{\ell^2-2\ell\cdot p_{i} +\cancel{p_{i}^2}-\cancel{m_{i}^2}}= \frac{1}{\hbar^2\bar{\ell}^2-2\hbar \bar{\ell}\cdot p_{i}}\\
&amp;=-\frac{1}{\hbar} \frac{1}{2\bar{\ell}\cdot p_{i}}(1+\hbar\frac{ \bar{\ell}^2}{2\bar{\ell}\cdot p_{i}}+\hbar^2\frac{ \bar{\ell}^4}{(2\bar{\ell}\cdot p_{i})^2}+\dots ).\\
\end{aligned}
\tag{5.23}\]</span></span></p>
<p>In other contexts one may say that the matter propagator has eikonalized (it is now linear in <span class="math inline">\(\ell\)</span>). Before we compute the amplitudes let us set up some useful kinematic identities and variables. If we consider the two-to-two particle scattering, taking an all outgoing momentum convention we have the following masses:</p>
<p><span id="eq-masses"><span class="math display">\[
m_{1}^2=p_{4}^2 =p_{1}^2,\quad m_{2}^2=p_{2}^2 =p_{3}^2,
\tag{5.24}\]</span></span></p>
<p>and Mandelstahm variables:</p>
<p><span class="math display">\[
s=(p_{1}+p_{2})^2,\quad t=q_{}^2=(p_{1}+p_{4})^2,\quad u=(p_{1}+p_{3})^2   ,
\]</span></p>
<p>subject to the usual equation:</p>
<p><span class="math display">\[
s+t+u=2(m_{1}^2+m_{2}^2).
\]</span></p>
<p>We can also change the external momentum variables to ones more amenable to the soft limit, namely:</p>
<p><span id="eq-newmom"><span class="math display">\[
p_{1}=-\big(\tilde{p}_{1}-\frac{q_{}}{2} \big), p_{2}=-\big(\tilde{p}_{2}+\frac{q_{}}{2} \big), p_{3}=\big(\tilde{p}_{2}-\frac{q_{}}{2} \big), p_{4}=\big(\tilde{p}_{1}+\frac{q_{}}{2} \big) .
\tag{5.25}\]</span></span></p>
<div class="page-columns page-full"><p>The new momentum variables <span class="math inline">\(\tilde{p}_{i}\)</span> are crucially orthogonal to momentum transfer <span class="math inline">\(q_{}\)</span> :<a href="#fn28" class="footnote-ref" id="fnref28" role="doc-noteref"><sup>28</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn28"><p><sup>28</sup>&nbsp;we use <a href="#eq-masses">eq.&nbsp;<span>5.24</span></a> </p></li></div></div>
<p><span id="eq-orthog"><span class="math display">\[
\tilde{p}_{i}\cdot q_{}=0,
\tag{5.26}\]</span></span></p>
<p>and the physical scattering region, given by <span class="math inline">\(s&gt;(m_{1}+m_{2})^2\)</span> and <span class="math inline">\(q_{}^2&lt;0\)</span> is the given by the same formulas:</p>
<p><span class="math display">\[
s=\Big(-\big(\tilde{p}_{1}-\frac{q_{}}{2} \big)-\big(\tilde{p}_{2}+\frac{q_{}}{2} \big) \Big)^2=(\tilde{p}_{1}+\tilde{p}_{2})^2
\]</span></p>
<p>and</p>
<p><span class="math display">\[
t=\Big(-\big(\tilde{p}_{1}-\frac{q_{}}{2} \big)+\tilde{p}_{1}+\frac{q_{}}{2} \Big)^2 = q_{}^2.
\]</span></p>
<p>With all the ingredients in place, we can now go on to compute the amplitudes.</p>
</section>
<section id="tree-level" class="level3 page-columns page-full" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="tree-level"><span class="header-section-number">5.5.2</span> Tree level</h3>
<p>We start with the tree level amplitude, the only <abbr title="Leading Order">LO</abbr> contribution in for example <a href="#eq-impulseLO">eq.&nbsp;<span>5.20</span></a>. The only possible diagram we can build with four external scalar legs, and vertices as defined in <a href="#tbl-sqedfrules">Table&nbsp;<span>5.1</span></a>, is the following tree:</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="./tikz/treelevelsqed.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption margin-caption">Tree</figcaption><p></p>
</figure>
</div>
<p>The amplitude is read off diagram and using Feynman rules for SQED we have:</p>
<p><span class="math display">\[
\mathcal{\bar{A}}^{(0)} = \mathring{\imath}\tilde{D}^{{\mu \nu}}(q)\cdot \,e^2Q_{1} Q_{2}2 \tilde{p}_{1}{}^{\mu} 2\tilde{p}_{2}{}^{\nu}=\frac{4e^2Q_{1} Q_{2}\tilde{p}_{1}\cdot\tilde{p}_{2}}{q_{}^2} ,
\]</span></p>
<p>using the Mandelstahm invariants described above we can infact write this as:</p>
<p><span id="eq-treeampl"><span class="math display">\[
\mathcal{\bar{A}}^{(0)} =e^2Q_{1} Q_{2} \frac{4m_{1}m_{2}\sigma}{\hbar^2\bar{q}_{}^2},
\tag{5.27}\]</span></span></p>
<p>where <span class="math inline">\(\sigma\)</span> is the relativistic factor of particle 1 in the rest frame of particle 2:</p>
<p><span id="eq-relfact"><span class="math display">\[
\sigma=\frac{s-m_{1}^2-m_{2}^2}{2m_{1}m_{2}}=\frac{p_{1}\cdot p_{2}}{m_{1}m_{2}}=\frac{\tilde{p}_{1}\cdot\tilde{p}_{2}}{m_{1}m_{2}}+ \mathcal{O}(\hbar^{}).
\tag{5.28}\]</span></span></p>
<div class="page-columns page-full"><p>We now input the reduced version <span class="math inline">\(\mathcal{\bar{A}}^{(0)}e^2=\mathcal{A}^{(0)}\)</span> of the amplitude, and take the <span class="math inline">\(\hbar\to0\)</span> limit of <a href="#eq-impulseLO">eq.&nbsp;<span>5.20</span></a>. We can safely take the <span class="math inline">\(\hbar \to 0\)</span> limit as the integrand contains no terms singular in <span class="math inline">\(\hbar\)</span> (the <span class="math inline">\(\frac{1}{\hbar^2}\)</span> is cancelled by the <span class="math inline">\(\hbar^2\)</span> pre-factor). Notice that the integration measure <a href="#eq-DeltaOclas">eq.&nbsp;<span>5.14</span></a> simplifies in the classical limit:<a href="#fn29" class="footnote-ref" id="fnref29" role="doc-noteref"><sup>29</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn29"><p><sup>29</sup>&nbsp;Compare to <span class="math display">\[\begin{aligned}\,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,&amp;=\,\tilde{\mathrm{d}}^{4}\bar{q}_{}\, \tilde{\delta}^{}(2p_{1}\cdot\bar{q}_{}+\hbar\bar{q}_{}^2)\Theta^{{}}(p_{1}{}^{0}+q_{}^0)\\&amp; \tilde{\delta}^{}(2p_{1}\cdot \bar{q}_{}+\hbar\bar{q}_{}^2)\Theta^{{}}(p_{2}{}^{0}+q_{}^0)\end{aligned}\]</span> The theta functions cancel as <span class="math inline">\(q_{}^0\to0\)</span> and <span class="math inline">\(p_{i}\)</span> becomes classical. Changing to the special kinematic variables <a href="#eq-newmom">eq.&nbsp;<span>5.25</span></a> we can even eliminate the delta functions, since by constuction <span class="math inline">\(\tilde{p}_{1}\cdot\bar{q}_{}=0\)</span>.</p></li></div></div>
<p><span class="math display">\[
\lim\limits_{\hbar \to0} \,\mathrm{d}\overline{\Psi}_{}(\bar{q}_{})\,=\,\tilde{\mathrm{d}}^{4}\bar{q}_{}\, \cancel{\tilde{\delta}^{}(2\tilde{p}_{1}\cdot\bar{q}_{})}\cancel{\tilde{\delta}^{}(2\tilde{p}_{1}\cdot \bar{q}_{})}.
\]</span></p>
<p>The integrand corresponding to the <abbr title="Leading Order">LO</abbr> contribution to the impulse is then:</p>
<p><span class="math display">\[
\Delta p_{1}^{\mu,(0)}=4e^2Q_1Q_2m_{1}m_{2}\sigma\int\,\tilde{\mathrm{d}}^{4}\bar{q}_{}\,\mathrm{e}^{-\mathring{\imath}\bar{q}_{}\cdot b}\bar{q}_{}^\mu \frac{\cancel{\hbar^2}}{\cancel{\hbar^2}\bar{q}_{}^2}.
\]</span></p>
<p>This can be analytically computed (see LO impulse SQED) to find a closed form for the <abbr title="Leading Order">LO</abbr> impulse.</p>
<p><span class="math display">\[
\Delta p_{1}^{\mu,(0)}=-\frac{e^{2} Q_{1} Q_{2}}{2 \pi} \frac{\gamma}{\sqrt{\gamma^{2}-1}} \frac{b^{\mu}}{b^{2}}
\]</span></p>
</section>
<section id="one-loop" class="level3 page-columns page-full" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="one-loop"><span class="header-section-number">5.5.3</span> One loop</h3>
<p>Already at one loop the number of possible diagrams one can for increases dramatically from 1 to 13. One can nonetheless relatively easily enumerate them. As we increase loop count, the number of diagrams increases exponentially. It is therefore very useful to have a systematic, programmatic way to handle these diagrams, and while we are at it, also to compute the amplitudes. Note that all the code needed to do these computations can be found on the repository for this book.</p>
<p>The first tool we will use is <code>QGRAF</code> <span class="citation" data-cites="Nogueira:1993a">&nbsp;[<a href="references.html#ref-Nogueira:1993a" role="doc-biblioref">23</a>]</span>, a fortran program that can generate Feynman diagrams for a given set of vertices and external legs. The first step to is to define the theory we are working in. This is essentially writing down the Feynman rules, without actually specifying what the graphical objects are. For <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> the model file is short:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQEDmodel</strong></pre>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>* propagators</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a> [Phi1,Phi1c,+]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a> [Phi2,Phi2c,+]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> [Photon,Photon,+]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>* vertices</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> [Phi1c,Photon,Phi1]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> [Phi2c,Photon,Phi2]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> [Phi1c,Photon,Photon,Phi1]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a> [Phi2c,Photon,Photon,Phi2]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This file also defines the names of the fields in question. We can then give <code>QGRAF</code> additional options, such as the number of external legs, and the number of loops, written in a <code>qgraf.dat</code> file that can look like this:</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>qgraf.dat</strong></pre>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>output= '{{output filename}}' ;</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>style= './styles/julia.sty' ; </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>model= './qgraf/SQEDmodel';</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>in= Phi1,  Phi2;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>out= Phi1,Phi2;</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>loops= 1;</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>loop_momentum= k;</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>options=  notadpole,nosnail,onshell ;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where we specify what process we are interested in (two-to-two scattering). We also specify that we want to compute the one loop amplitude, and that we want to use the <code>julia.sty</code> style file. The <code>julia.sty</code> file is a style file that is used to generate the output in a format that can be read by a <code>Julia</code> <span class="citation" data-cites="Bezanson:2015">&nbsp;[<a href="references.html#ref-Bezanson:2015" role="doc-biblioref">24</a>]</span> package built to process and visualise the outputted graphs. This package is called (maybe too broadly) <code>QFT.jl</code> is hosted on <a href="https://github.com/lcnhb/QFT.jl">github</a> . Let us see it in action. We can run <code>QGRAF</code> from the command line, and it will generate a file called <code>{{output filename}}</code> that contains the output of the program. We can then use this in a <code>Julia</code> file to visualise the diagrams.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Images</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QFT</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QFT.Diagrams</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QFT.FieldGraphs</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QFT.Fields</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span>  <span class="bu">Catlab.Graphics.Graphviz</span>: pprint</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">include</span>(<span class="st">"SQED.jl"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>diags<span class="op">=</span><span class="fu">include</span>(<span class="st">"QGRAFout/julia/1lSQED.jl"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>qDiags<span class="op">=</span>[<span class="fu">qDiagram</span>(;diag<span class="op">...</span>) for diag <span class="kw">in</span> diags]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>grafs<span class="op">=</span>(x <span class="op">-&gt;</span> x.g).(qDiags)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"::: {#fig-oneloopsqed  layout-ncol=3}"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i,graf) <span class="kw">in</span> <span class="fu">enumerate</span>(grafs)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"```{dot}"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"//| fig-width: 1.5"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pprint</span>(<span class="cn">stdout</span>,<span class="fu">to_graphviz</span>(graf,graph_attrs<span class="op">=</span><span class="fu">Dict</span>(<span class="st">"layout"</span><span class="op">=&gt;</span><span class="st">"neato"</span>)))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"```"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"all one loop graphs in (?:sqed)"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">":::"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="cn">nothing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-oneloopsqed" class="quarto-layout-panel">
<p></p><figcaption>Fig&nbsp;5.5: all one loop graphs in <abbr title="Scalar Quantum Electrodynamics">SQED</abbr></figcaption><p></p>
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 202.72 153.41" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 149.41)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-149.41 198.72,-149.41 198.72,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="57.6" cy="-68.72" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="137.72" cy="-77.28" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n2 --> <g id="edge5" class="edge">
<title>
n1-&gt;n2
</title>
<path fill="none" stroke="grey" d="M58.33,-70.39C61.65,-73.82 75.67,-77.03 91.03,-79.01"></path> <path fill="none" stroke="grey" d="M91.03,-79.01C106.39,-81 123.09,-81.77 131.75,-80.31"></path> <polygon fill="grey" stroke="grey" points="132.29,-81.98 136.54,-78.83 131.25,-78.64 132.29,-81.98"></polygon> <text text-anchor="middle" x="86.29" y="-79.55" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n1&#45;&gt;n2 --> <g id="edge6" class="edge">
<title>
n1-&gt;n2
</title>
<path fill="none" stroke="grey" d="M58.67,-67.24C62.6,-64.62 76.78,-64.42 92.07,-65.69"></path> <path fill="none" stroke="grey" d="M92.07,-65.69C107.35,-66.95 123.74,-69.68 132.11,-72.89"></path> <polygon fill="grey" stroke="grey" points="131.45,-74.52 136.69,-75.33 133.1,-71.43 131.45,-74.52"></polygon> <text text-anchor="middle" x="86.64" y="-57.47" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n6 --> <!-- n1&#45;&gt;n6 --> <g id="edge4" class="edge">
<title>
n1-&gt;n6
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M56.23,-70.09C49.55,-76.77 20.36,-105.97 7.79,-118.55"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="6.52,-117.35 4.22,-122.12 9,-119.82 6.52,-117.35"></polygon> <text text-anchor="middle" x="23.26" y="-98.52" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n4 --> <!-- n2&#45;&gt;n4 --> <g id="edge2" class="edge">
<title>
n2-&gt;n4
</title>
<path fill="none" stroke="red" stroke-width="2" d="M138.77,-78.91C143.88,-86.85 166.23,-121.59 175.85,-136.53"></path> <polygon fill="red" stroke="red" stroke-width="2" points="174.59,-137.8 178.77,-141.06 177.53,-135.91 174.59,-137.8"></polygon> <text text-anchor="middle" x="148.56" y="-111.92" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3 --> <!-- n3&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n3-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M190.36,-23.35C182.08,-31.83 154.28,-60.31 142.77,-72.1"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="141.37,-71.03 139.13,-75.83 143.88,-73.47 141.37,-71.03"></polygon> <text text-anchor="middle" x="157.81" y="-51.93" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n5-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M17.16,-4.22C22.87,-13.32 44.6,-47.98 53.63,-62.39"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="52.35,-63.64 56.49,-66.94 55.31,-61.78 52.35,-63.64"></polygon> <text text-anchor="middle" x="26.64" y="-37.5" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 219.72 230.52" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 226.52)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-226.52 215.72,-226.52 215.72,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="70.36" cy="-69.51" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="75.79" cy="-146.17" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M70.49,-71.4C70.82,-76.09 71.72,-88.81 72.69,-102.47"></path> <path fill="none" stroke="grey" d="M72.69,-102.47C73.66,-116.12 74.69,-130.7 75.29,-139.1"></path> <polygon fill="grey" stroke="grey" points="73.56,-139.47 75.66,-144.34 77.05,-139.23 73.56,-139.47"></polygon> <text text-anchor="middle" x="64.14" y="-109.45" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n7 --> <!-- n1&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n1-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M69.49,-67.84C65.31,-59.74 47.02,-24.28 39.15,-9.02"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="40.61,-8.04 36.76,-4.4 37.5,-9.65 40.61,-8.04"></polygon> <text text-anchor="middle" x="45.57" y="-42.63" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="135.94" cy="-98.26" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n1 --> <g id="edge5" class="edge">
<title>
n2-&gt;n1
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M134.05,-97.43C129.86,-95.59 119.26,-90.95 107.89,-85.96"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M107.89,-85.96C96.52,-80.98 84.37,-75.65 77.07,-72.45"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="77.41,-70.69 72.13,-70.29 76.01,-73.9 77.41,-70.69"></polygon> <text text-anchor="middle" x="96.81" y="-89.14" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M134.45,-99.45C130.81,-102.35 120.96,-110.19 110.36,-118.63"></path> <path fill="none" stroke="grey" d="M110.36,-118.63C99.75,-127.08 88.38,-136.14 81.68,-141.47"></path> <polygon fill="grey" stroke="grey" points="80.26,-140.36 77.44,-144.85 82.44,-143.1 80.26,-140.36"></polygon> <text text-anchor="middle" x="99.32" y="-124.66" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n3&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n3-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M76.49,-148C79.95,-157.09 95.31,-197.38 101.52,-213.66"></path> <polygon fill="red" stroke="red" stroke-width="2" points="99.94,-214.42 103.35,-218.47 103.21,-213.18 99.94,-214.42"></polygon> <text text-anchor="middle" x="80.25" y="-185.03" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n3 --> <g id="edge1" class="edge">
<title>
n4-&gt;n3
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M4.13,-174.95C13.72,-171.1 53.18,-155.25 69.09,-148.86"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="70.07,-150.35 74.06,-146.86 68.76,-147.1 70.07,-150.35"></polygon> <text text-anchor="middle" x="27.86" y="-166.1" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n2 --> <g id="edge3" class="edge">
<title>
n6-&gt;n2
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M207.59,-80.55C198.08,-82.9 159.23,-92.5 143.06,-96.5"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="142.37,-94.87 137.94,-97.77 143.21,-98.27 142.37,-94.87"></polygon> <text text-anchor="middle" x="166.58" y="-92.72" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 230.14 219.87" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 215.87)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-215.87 226.14,-215.87 226.14,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="124.9" cy="-145" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="80.15" cy="-81.59" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M123.79,-143.43C121.06,-139.56 113.63,-129.03 105.66,-117.73"></path> <path fill="none" stroke="grey" d="M105.66,-117.73C97.69,-106.44 89.18,-94.37 84.28,-87.43"></path> <polygon fill="grey" stroke="grey" points="85.7,-86.41 81.38,-83.33 82.84,-88.42 85.7,-86.41"></polygon> <text text-anchor="middle" x="95.28" y="-119.63" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n5 --> <!-- n1&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n1-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M126.89,-144.91C138.02,-144.44 192.85,-142.11 212.83,-141.26"></path> <polygon fill="red" stroke="red" stroke-width="2" points="212.91,-143.01 217.83,-141.05 212.76,-139.51 212.91,-143.01"></polygon> <text text-anchor="middle" x="161.11" y="-147.29" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="148.93" cy="-109.46" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n1 --> <g id="edge5" class="edge">
<title>
n2-&gt;n1
</title>
<path fill="none" stroke="red" stroke-width="2" d="M147.9,-110.98C146.29,-113.36 143,-118.23 139.39,-123.55"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M139.39,-123.55C135.79,-128.88 131.88,-134.67 129.03,-138.89"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="127.47,-138.06 126.12,-143.18 130.37,-140.02 127.47,-138.06"></polygon> <text text-anchor="middle" x="129.71" y="-129.14" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M147.23,-108.77C143.06,-107.08 131.81,-102.52 119.68,-97.6"></path> <path fill="none" stroke="grey" d="M119.68,-97.6C107.55,-92.69 94.55,-87.42 86.9,-84.32"></path> <polygon fill="grey" stroke="grey" points="87.34,-82.61 82.05,-82.35 86.02,-85.85 87.34,-82.61"></polygon> <text text-anchor="middle" x="108.31" y="-100.74" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n7 --> <!-- n3&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n3-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M80.16,-79.62C80.2,-69.9 80.36,-26.76 80.42,-9.34"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="82.17,-9.2 80.44,-4.19 78.67,-9.18 82.17,-9.2"></polygon> <text text-anchor="middle" x="71.54" y="-48.68" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M146.55,-207.77C146.84,-195.93 148.26,-137.22 148.75,-116.62"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="150.51,-116.58 148.88,-111.54 147.01,-116.5 150.51,-116.58"></polygon> <text text-anchor="middle" x="138.9" y="-166.4" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n3 --> <g id="edge3" class="edge">
<title>
n6-&gt;n3
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.25,-95.34C14.42,-93.5 56.21,-85.92 73.06,-82.87"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="73.71,-84.53 78.32,-81.92 73.09,-81.09 73.71,-84.53"></polygon> <text text-anchor="middle" x="29.91" y="-93.31" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 302.93 210.13" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 206.13)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-206.13 298.93,-206.13 298.93,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="75.1" cy="-78.67" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="145.24" cy="-119.91" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge5" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M76.84,-79.68C81.12,-82.2 92.77,-89.05 105.26,-96.4"></path> <path fill="none" stroke="grey" d="M105.26,-96.4C117.76,-103.74 131.1,-111.59 138.78,-116.1"></path> <polygon fill="grey" stroke="grey" points="138.12,-117.74 143.31,-118.77 139.89,-114.73 138.12,-117.74"></polygon> <text text-anchor="middle" x="99.06" y="-102.09" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n7 --> <!-- n1&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n1-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M74.63,-76.77C72.32,-67.41 62.05,-25.85 57.9,-9.07"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="59.57,-8.54 56.67,-4.11 56.17,-9.38 59.57,-8.54"></polygon> <text text-anchor="middle" x="57.51" y="-47.12" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="219.78" cy="-94.39" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M218.44,-93.18C214.09,-91.46 200.52,-94.32 186.22,-98.83"></path> <path fill="none" stroke="grey" d="M186.22,-98.83C171.91,-103.34 156.88,-109.51 149.61,-114.43"></path> <polygon fill="grey" stroke="grey" points="148.39,-113.17 145.79,-117.78 150.7,-115.8 148.39,-113.17"></polygon> <text text-anchor="middle" x="175.27" y="-91.2" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n2&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n2-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M221.59,-94.08C230.45,-92.57 269.48,-85.91 285.76,-83.13"></path> <polygon fill="red" stroke="red" stroke-width="2" points="286.28,-84.81 290.91,-82.25 285.69,-81.36 286.28,-84.81"></polygon> <text text-anchor="middle" x="244.93" y="-92.8" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3&#45;&gt;n2 --> <g id="edge6" class="edge">
<title>
n3-&gt;n2
</title>
<path fill="none" stroke="red" stroke-width="2" d="M146.59,-121.12C150.94,-122.83 164.51,-119.98 178.81,-115.47"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M178.81,-115.47C193.12,-110.96 208.15,-104.79 215.42,-99.87"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="216.63,-101.13 219.24,-96.52 214.33,-98.5 216.63,-101.13"></polygon> <text text-anchor="middle" x="172.25" y="-114.69" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n3 --> <g id="edge1" class="edge">
<title>
n4-&gt;n3
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M146.13,-197.81C146.01,-187.38 145.52,-144.49 145.33,-127.19"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="147.07,-126.77 145.27,-121.79 143.57,-126.81 147.07,-126.77"></polygon> <text text-anchor="middle" x="136.98" y="-166.7" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n6-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.11,-108C13.62,-104.07 52.7,-87.92 68.47,-81.41"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="69.44,-82.9 73.39,-79.37 68.1,-79.67 69.44,-82.9"></polygon> <text text-anchor="middle" x="27.54" y="-98.9" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 239.92 222.10" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 218.1)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-218.1 235.92,-218.1 235.92,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="65.38" cy="-71.61" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="145.73" cy="-84.51" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge5" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M67.36,-71.93C72.31,-72.72 85.85,-74.89 100.31,-77.22"></path> <path fill="none" stroke="grey" d="M100.31,-77.22C114.76,-79.54 130.14,-82.01 138.78,-83.39"></path> <polygon fill="grey" stroke="grey" points="138.6,-85.14 143.82,-84.2 139.16,-81.68 138.6,-85.14"></polygon> <text text-anchor="middle" x="94.32" y="-81.86" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n7 --> <!-- n1&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n1-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M64.45,-69.89C59.95,-61.53 40.27,-24.97 31.8,-9.24"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="33.15,-8.05 29.24,-4.48 30.07,-9.71 33.15,-8.05"></polygon> <text text-anchor="middle" x="39.38" y="-43.76" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="187.47" cy="-151.26" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="red" stroke-width="2" d="M188.35,-149.67C189.03,-145.05 183.19,-132.5 175.56,-119.61"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M175.56,-119.61C167.93,-106.72 158.51,-93.49 152.08,-87.53"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="152.77,-85.88 147.66,-84.46 150.77,-88.75 152.77,-85.88"></polygon> <text text-anchor="middle" x="161.46" y="-106" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M185.66,-151.35C181.21,-149.94 172.49,-139.19 164.24,-126.69"></path> <path fill="none" stroke="grey" d="M164.24,-126.69C155.99,-114.18 148.22,-99.93 145.67,-91.53"></path> <polygon fill="grey" stroke="grey" points="147.35,-90.89 144.85,-86.22 143.89,-91.43 147.35,-90.89"></polygon> <text text-anchor="middle" x="156.92" y="-125.64" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n3&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n3-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M147.02,-83C153.32,-75.61 181.1,-43.05 192.69,-29.46"></path> <polygon fill="red" stroke="red" stroke-width="2" points="194.03,-30.58 195.94,-25.64 191.37,-28.31 194.03,-30.58"></polygon> <text text-anchor="middle" x="161.1" y="-60.43" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M228.51,-210.07C222.72,-201.77 200.67,-170.16 191.5,-157.03"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="192.9,-155.97 188.6,-152.88 190.03,-157.98 192.9,-155.97"></polygon> <text text-anchor="middle" x="201.26" y="-187.75" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n6-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.11,-117.21C12.76,-110.77 45.68,-86.27 59.36,-76.08"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="60.72,-77.25 63.69,-72.86 58.63,-74.44 60.72,-77.25"></polygon> <text text-anchor="middle" x="22.99" y="-100.85" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 211.18 302.58" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 298.58)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-298.58 207.18,-298.58 207.18,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="78.8" cy="-219.19" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="120.92" cy="-149.58" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge5" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M79.84,-217.47C82.41,-213.22 89.4,-201.66 96.91,-189.26"></path> <path fill="none" stroke="grey" d="M96.91,-189.26C104.41,-176.86 112.42,-163.62 117.03,-156"></path> <polygon fill="grey" stroke="grey" points="118.67,-156.68 119.76,-151.5 115.67,-154.87 118.67,-156.68"></polygon> <text text-anchor="middle" x="89.69" y="-190.94" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n5 --> <!-- n1&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n1-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M79.53,-221C83.14,-229.97 99.17,-269.74 105.64,-285.81"></path> <polygon fill="red" stroke="red" stroke-width="2" points="104.06,-286.57 107.55,-290.56 107.31,-285.26 104.06,-286.57"></polygon> <text text-anchor="middle" x="83.83" y="-257.61" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="97.38" cy="-74.5" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M96.14,-75.82C94.31,-80.11 96.8,-93.74 100.93,-108.13"></path> <path fill="none" stroke="grey" d="M100.93,-108.13C105.06,-122.53 110.83,-137.7 115.56,-145.08"></path> <polygon fill="grey" stroke="grey" points="114.26,-146.26 118.81,-148.98 116.95,-144.02 114.26,-146.26"></polygon> <text text-anchor="middle" x="97.1" y="-114.65" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n7 --> <!-- n2&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n2-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M97,-72.71C95.12,-64.01 86.89,-25.92 83.35,-9.54"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="84.98,-8.8 82.22,-4.28 81.56,-9.54 84.98,-8.8"></polygon> <text text-anchor="middle" x="81.43" y="-45.32" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n3&#45;&gt;n2 --> <g id="edge6" class="edge">
<title>
n3-&gt;n2
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M122.16,-148.27C123.99,-143.97 121.5,-130.35 117.37,-115.95"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M117.37,-115.95C113.24,-101.56 107.47,-86.39 102.75,-79.01"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="104.04,-77.82 99.49,-75.1 101.35,-80.07 104.04,-77.82"></polygon> <text text-anchor="middle" x="121.21" y="-117.84" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n1 --> <g id="edge1" class="edge">
<title>
n4-&gt;n1
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M4.22,-236.96C14.2,-234.58 55.26,-224.8 71.83,-220.85"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="72.54,-222.48 76.99,-219.62 71.73,-219.08 72.54,-222.48"></polygon> <text text-anchor="middle" x="29.27" y="-233.11" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n3 --> <g id="edge3" class="edge">
<title>
n6-&gt;n3
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M198.86,-149.81C188.42,-149.78 145.51,-149.66 128.2,-149.61"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="127.81,-147.85 122.8,-149.59 127.8,-151.35 127.81,-147.85"></polygon> <text text-anchor="middle" x="154.78" y="-153.91" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 289.98 229.74" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 225.74)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-225.74 285.98,-225.74 285.98,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="81.01" cy="-141.99" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="128.31" cy="-75.79" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge5" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M82.18,-140.35C85.07,-136.31 92.92,-125.32 101.35,-113.52"></path> <path fill="none" stroke="grey" d="M101.35,-113.52C109.78,-101.73 118.77,-89.14 123.95,-81.89"></path> <polygon fill="grey" stroke="grey" points="125.53,-82.7 127.01,-77.61 122.68,-80.66 125.53,-82.7"></polygon> <text text-anchor="middle" x="94.32" y="-115.32" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n5 --> <!-- n1&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n1-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M81.36,-143.91C83.07,-153.41 90.69,-195.55 93.77,-212.57"></path> <polygon fill="red" stroke="red" stroke-width="2" points="92.07,-212.99 94.68,-217.6 95.51,-212.37 92.07,-212.99"></polygon> <text text-anchor="middle" x="78.81" y="-182.44" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="206.66" cy="-68.03" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M205.62,-66.54C201.79,-63.87 187.94,-63.54 172.99,-64.65"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M172.99,-64.65C158.05,-65.77 142.01,-68.33 133.82,-71.45"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="132.92,-69.95 129.33,-73.85 134.57,-73.04 132.92,-69.95"></polygon> <text text-anchor="middle" x="160.97" y="-73.2" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M205.94,-69.69C202.7,-73.05 189.19,-76.1 174.32,-77.94"></path> <path fill="none" stroke="grey" d="M174.32,-77.94C159.46,-79.78 143.24,-80.41 134.58,-78.96"></path> <polygon fill="grey" stroke="grey" points="134.75,-77.18 129.45,-77.35 133.7,-80.52 134.75,-77.18"></polygon> <text text-anchor="middle" x="179.01" y="-78.52" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n7 --> <!-- n3&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n3-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M127.53,-73.96C123.68,-64.95 106.59,-24.96 99.68,-8.8"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="101.22,-7.94 97.64,-4.03 98,-9.32 101.22,-7.94"></polygon> <text text-anchor="middle" x="104.86" y="-45.58" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n1 --> <g id="edge1" class="edge">
<title>
n4-&gt;n1
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M4.28,-144.48C14.55,-144.14 56.8,-142.77 73.84,-142.22"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="74.21,-143.96 79.16,-142.05 74.1,-140.46 74.21,-143.96"></polygon> <text text-anchor="middle" x="30.31" y="-147.55" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n2 --> <g id="edge3" class="edge">
<title>
n6-&gt;n2
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M277.87,-57.13C268.41,-58.58 229.81,-64.49 213.73,-66.94"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="213.32,-65.24 208.64,-67.72 213.85,-68.7 213.32,-65.24"></polygon> <text text-anchor="middle" x="237.05" y="-66.24" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 253.21 358.95" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 354.95)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-354.95 249.21,-354.95 249.21,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="78.12" cy="-69.17" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="106.35" cy="-141.04" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge5" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M78.82,-70.94C80.54,-75.33 85.23,-87.26 90.26,-100.07"></path> <path fill="none" stroke="grey" d="M90.26,-100.07C95.29,-112.87 100.66,-126.54 103.75,-134.41"></path> <polygon fill="grey" stroke="grey" points="102.22,-135.31 105.68,-139.32 105.48,-134.03 102.22,-135.31"></polygon> <text text-anchor="middle" x="82.53" y="-106.88" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M79.14,-67.51C84.08,-59.45 105.71,-24.17 115.02,-8.99"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="116.72,-9.57 117.84,-4.39 113.73,-7.74 116.72,-9.57"></polygon> <text text-anchor="middle" x="88.33" y="-42.45" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="166.46" cy="-280.56" rx="1.8" ry="1.8"></ellipse> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="134.96" cy="-210.06" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n4 --> <g id="edge6" class="edge">
<title>
n2-&gt;n4
</title>
<path fill="none" stroke="grey" d="M165.68,-278.82C163.76,-274.51 158.53,-262.81 152.92,-250.25"></path> <path fill="none" stroke="grey" d="M152.92,-250.25C147.31,-237.69 141.31,-224.28 137.87,-216.56"></path> <polygon fill="grey" stroke="grey" points="139.35,-215.59 135.71,-211.74 136.15,-217.02 139.35,-215.59"></polygon> <text text-anchor="middle" x="143.02" y="-251.89" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n6 --> <!-- n2&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n2-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M165.5,-282.25C160.81,-290.46 140.32,-326.38 131.5,-341.84"></path> <polygon fill="red" stroke="red" stroke-width="2" points="129.78,-341.31 128.83,-346.52 132.82,-343.04 129.78,-341.31"></polygon> <text text-anchor="middle" x="139.75" y="-316.25" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3&#45;&gt;n4 --> <g id="edge7" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M105.12,-142.69C103.84,-147.22 107.26,-159.75 112.29,-172.81"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M112.29,-172.81C117.32,-185.86 123.96,-199.43 129.12,-206.05"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="128.05,-207.46 132.85,-209.72 130.51,-204.96 128.05,-207.46"></polygon> <text text-anchor="middle" x="108.37" y="-178.57" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n4&#45;&gt;n3 --> <g id="edge8" class="edge">
<title>
n4-&gt;n3
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M136.19,-208.41C137.47,-203.87 134.05,-191.34 129.02,-178.29"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M129.02,-178.29C123.99,-165.24 117.35,-151.67 112.19,-145.05"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="113.25,-143.64 108.46,-141.38 110.8,-146.13 113.25,-143.64"></polygon> <text text-anchor="middle" x="132.94" y="-180.93" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n5-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M241,-297.84C231.02,-295.53 189.98,-286.01 173.43,-282.18"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="173.53,-280.4 168.26,-280.98 172.74,-283.81 173.53,-280.4"></polygon> <text text-anchor="middle" x="198.46" y="-294.21" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n7-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.2,-49.59C14.1,-52.21 54.8,-62.99 71.21,-67.34"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="71.06,-69.11 76.34,-68.69 71.95,-65.72 71.06,-69.11"></polygon> <text text-anchor="middle" x="28.95" y="-62.66" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 253.21 358.95" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 354.95)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-354.95 249.21,-354.95 249.21,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="78.12" cy="-69.17" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="106.35" cy="-141.04" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge5" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M78.82,-70.94C80.54,-75.33 85.23,-87.26 90.26,-100.07"></path> <path fill="none" stroke="grey" d="M90.26,-100.07C95.29,-112.87 100.66,-126.54 103.75,-134.41"></path> <polygon fill="grey" stroke="grey" points="102.22,-135.31 105.68,-139.32 105.48,-134.03 102.22,-135.31"></polygon> <text text-anchor="middle" x="82.53" y="-106.88" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M79.14,-67.51C84.08,-59.45 105.71,-24.17 115.02,-8.99"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="116.72,-9.57 117.84,-4.39 113.73,-7.74 116.72,-9.57"></polygon> <text text-anchor="middle" x="88.33" y="-42.45" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="166.46" cy="-280.56" rx="1.8" ry="1.8"></ellipse> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="134.96" cy="-210.06" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n4 --> <g id="edge6" class="edge">
<title>
n2-&gt;n4
</title>
<path fill="none" stroke="grey" d="M165.68,-278.82C163.76,-274.51 158.53,-262.81 152.92,-250.25"></path> <path fill="none" stroke="grey" d="M152.92,-250.25C147.31,-237.69 141.31,-224.28 137.87,-216.56"></path> <polygon fill="grey" stroke="grey" points="139.35,-215.59 135.71,-211.74 136.15,-217.02 139.35,-215.59"></polygon> <text text-anchor="middle" x="143.02" y="-251.89" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n6 --> <!-- n2&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n2-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M165.5,-282.25C160.81,-290.46 140.32,-326.38 131.5,-341.84"></path> <polygon fill="red" stroke="red" stroke-width="2" points="129.78,-341.31 128.83,-346.52 132.82,-343.04 129.78,-341.31"></polygon> <text text-anchor="middle" x="139.75" y="-316.25" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3&#45;&gt;n4 --> <g id="edge7" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="red" stroke-width="2" d="M105.12,-142.69C103.84,-147.22 107.26,-159.75 112.29,-172.81"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M112.29,-172.81C117.32,-185.86 123.96,-199.43 129.12,-206.05"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="128.05,-207.46 132.85,-209.72 130.51,-204.96 128.05,-207.46"></polygon> <text text-anchor="middle" x="108.37" y="-178.57" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n4&#45;&gt;n3 --> <g id="edge8" class="edge">
<title>
n4-&gt;n3
</title>
<path fill="none" stroke="red" stroke-width="2" d="M136.19,-208.41C137.47,-203.87 134.05,-191.34 129.02,-178.29"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M129.02,-178.29C123.99,-165.24 117.35,-151.67 112.19,-145.05"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="113.25,-143.64 108.46,-141.38 110.8,-146.13 113.25,-143.64"></polygon> <text text-anchor="middle" x="132.94" y="-180.93" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n5-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M241,-297.84C231.02,-295.53 189.98,-286.01 173.43,-282.18"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="173.53,-280.4 168.26,-280.98 172.74,-283.81 173.53,-280.4"></polygon> <text text-anchor="middle" x="198.46" y="-294.21" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n7-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.2,-49.59C14.1,-52.21 54.8,-62.99 71.21,-67.34"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="71.06,-69.11 76.34,-68.69 71.95,-65.72 71.06,-69.11"></polygon> <text text-anchor="middle" x="28.95" y="-62.66" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 280.58 300.54" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 296.54)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-296.54 276.58,-296.54 276.58,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="80.84" cy="-78.61" rx="1.8" ry="1.8"></ellipse> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="126.53" cy="-143.18" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n4 --> <g id="edge5" class="edge">
<title>
n1-&gt;n4
</title>
<path fill="none" stroke="grey" d="M81.97,-80.21C84.76,-84.15 92.35,-94.87 100.49,-106.38"></path> <path fill="none" stroke="grey" d="M100.49,-106.38C108.62,-117.88 117.31,-130.16 122.31,-137.23"></path> <polygon fill="grey" stroke="grey" points="120.95,-138.34 125.27,-141.41 123.81,-136.31 120.95,-138.34"></polygon> <text text-anchor="middle" x="93.39" y="-112.92" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M81.34,-76.72C83.8,-67.36 94.69,-25.84 99.09,-9.06"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="100.82,-9.39 100.39,-4.11 97.43,-8.5 100.82,-9.39"></polygon> <text text-anchor="middle" x="81.47" y="-47.09" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="135.33" cy="-217.71" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="194.79" cy="-174.56" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M136.8,-216.64C140.4,-214.03 150.13,-206.97 160.62,-199.36"></path> <path fill="none" stroke="grey" d="M160.62,-199.36C171.11,-191.75 182.35,-183.59 188.97,-178.79"></path> <polygon fill="grey" stroke="grey" points="190.14,-180.1 193.16,-175.75 188.08,-177.27 190.14,-180.1"></polygon> <text text-anchor="middle" x="154.13" y="-201.91" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n6 --> <!-- n2&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n2-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M134.81,-219.51C132.27,-228.33 121.08,-267.19 116.42,-283.4"></path> <polygon fill="red" stroke="red" stroke-width="2" points="114.64,-283.25 114.94,-288.53 118,-284.21 114.64,-283.25"></polygon> <text text-anchor="middle" x="116.86" y="-255.65" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3&#45;&gt;n4 --> <g id="edge8" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="red" stroke-width="2" d="M193.11,-173.78C188.97,-171.88 177.8,-166.75 165.76,-161.22"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M165.76,-161.22C153.72,-155.68 140.82,-149.75 133.22,-146.26"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="133.68,-144.55 128.41,-144.05 132.22,-147.73 133.68,-144.55"></polygon> <text text-anchor="middle" x="154.41" y="-164.22" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n4&#45;&gt;n2 --> <g id="edge7" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="red" stroke-width="2" d="M126.74,-145.03C127.28,-149.54 128.72,-161.74 130.27,-174.88"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M130.27,-174.88C131.82,-188.02 133.49,-202.11 134.47,-210.4"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="132.76,-210.9 135.09,-215.66 136.24,-210.48 132.76,-210.9"></polygon> <text text-anchor="middle" x="121.85" y="-181.91" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n3 --> <g id="edge1" class="edge">
<title>
n5-&gt;n3
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M268.4,-177.02C258.63,-176.69 218.72,-175.36 202.11,-174.8"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="201.9,-173.05 196.85,-174.63 201.79,-176.54 201.9,-173.05"></polygon> <text text-anchor="middle" x="226.5" y="-180.11" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n7-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.27,-72.09C14.53,-72.96 56.69,-76.56 73.69,-78"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="73.86,-79.78 78.99,-78.46 74.16,-76.29 73.86,-79.78"></polygon> <text text-anchor="middle" x="30.23" y="-79.25" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 230.51 288.41" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 284.41)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-284.41 226.51,-284.41 226.51,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="74.1" cy="-212.85" rx="1.8" ry="1.8"></ellipse> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="95.75" cy="-136.78" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n4 --> <g id="edge5" class="edge">
<title>
n1-&gt;n4
</title>
<path fill="none" stroke="grey" d="M74.64,-210.97C75.96,-206.33 79.55,-193.7 83.41,-180.15"></path> <path fill="none" stroke="grey" d="M83.41,-180.15C87.27,-166.6 91.38,-152.13 93.75,-143.8"></path> <polygon fill="grey" stroke="grey" points="95.55,-143.88 95.23,-138.59 92.18,-142.92 95.55,-143.88"></polygon> <text text-anchor="middle" x="75.45" y="-181.59" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n6 --> <!-- n1&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n1-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M72.32,-213.66C63.59,-217.6 25.12,-234.97 9.07,-242.21"></path> <polygon fill="red" stroke="red" stroke-width="2" points="8.1,-240.73 4.27,-244.38 9.54,-243.92 8.1,-240.73"></polygon> <text text-anchor="middle" x="31.94" y="-232.14" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="149.78" cy="-84.51" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="79.39" cy="-63.55" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M148.04,-84C143.78,-82.73 132.26,-79.3 119.84,-75.6"></path> <path fill="none" stroke="grey" d="M119.84,-75.6C107.43,-71.9 94.12,-67.94 86.29,-65.61"></path> <polygon fill="grey" stroke="grey" points="86.62,-63.88 81.33,-64.13 85.62,-67.23 86.62,-63.88"></polygon> <text text-anchor="middle" x="108.41" y="-79" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n8 --> <!-- n2&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n2-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M151.53,-83.84C160.09,-80.53 197.83,-65.94 213.58,-59.85"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="214.25,-61.47 218.29,-58.03 212.99,-58.2 214.25,-61.47"></polygon> <text text-anchor="middle" x="173.8" y="-76.05" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n3&#45;&gt;n4 --> <g id="edge8" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M79.8,-65.36C80.79,-69.79 83.46,-81.78 86.35,-94.69"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M86.35,-94.69C89.23,-107.61 92.33,-121.45 94.15,-129.6"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="92.5,-130.26 95.3,-134.76 95.92,-129.5 92.5,-130.26"></polygon> <text text-anchor="middle" x="78.22" y="-101.68" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n4&#45;&gt;n2 --> <g id="edge7" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M97.09,-135.49C100.36,-132.32 109.2,-123.77 118.73,-114.55"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M118.73,-114.55C128.25,-105.33 138.47,-95.45 144.48,-89.64"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="145.91,-90.69 148.29,-85.95 143.48,-88.17 145.91,-90.69"></polygon> <text text-anchor="middle" x="112.03" y="-116.76" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n1 --> <g id="edge1" class="edge">
<title>
n5-&gt;n1
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M117.1,-276.23C111.04,-267.29 87.93,-233.23 78.33,-219.08"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="79.54,-217.75 75.29,-214.6 76.65,-219.72 79.54,-217.75"></polygon> <text text-anchor="middle" x="88.96" y="-251.86" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n3 --> <g id="edge3" class="edge">
<title>
n7-&gt;n3
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M36.65,-4.05C42.68,-12.45 65.65,-44.42 75.19,-57.71"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="73.88,-58.87 78.21,-61.91 76.72,-56.83 73.88,-58.87"></polygon> <text text-anchor="middle" x="47.17" y="-35.08" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 221.76 222.13" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 218.13)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-218.13 217.76,-218.13 217.76,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="143.96" cy="-61.79" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="152.11" cy="-143.52" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n2 --> <g id="edge5" class="edge">
<title>
n1-&gt;n2
</title>
<path fill="none" stroke="grey" d="M144.16,-63.81C144.66,-68.84 146.04,-82.61 147.5,-97.31"></path> <path fill="none" stroke="grey" d="M147.5,-97.31C148.97,-112.02 150.53,-127.66 151.4,-136.45"></path> <polygon fill="grey" stroke="grey" points="149.68,-136.77 151.92,-141.57 153.16,-136.42 149.68,-136.77"></polygon> <text text-anchor="middle" x="139.03" y="-104.33" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M145.18,-60.31C151.12,-53.13 177.12,-21.73 188.31,-8.22"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="189.85,-9.1 191.7,-4.13 187.16,-6.86 189.85,-9.1"></polygon> <text text-anchor="middle" x="158" y="-38.46" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n6 --> <!-- n2&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n2-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M153.58,-144.75C160.74,-150.71 192.08,-176.81 205.56,-188.05"></path> <polygon fill="red" stroke="red" stroke-width="2" points="204.68,-189.59 209.64,-191.45 206.92,-186.9 204.68,-189.59"></polygon> <text text-anchor="middle" x="170.82" y="-170.6" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="62.25" cy="-69.9" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3&#45;&gt;n1 --> <g id="edge6" class="edge">
<title>
n3-&gt;n1
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M64.27,-69.7C69.3,-69.2 83.06,-67.83 97.76,-66.37"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M97.76,-66.37C112.47,-64.91 128.1,-63.36 136.89,-62.49"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="137.21,-64.22 142.01,-61.98 136.86,-60.73 137.21,-64.22"></polygon> <text text-anchor="middle" x="91.83" y="-70.29" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="70.31" cy="-151.63" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3&#45;&gt;n4 --> <g id="edge8" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="grey" d="M62.45,-71.92C62.94,-76.95 64.3,-90.72 65.75,-105.42"></path> <path fill="none" stroke="grey" d="M65.75,-105.42C67.2,-120.13 68.74,-135.77 69.61,-144.56"></path> <polygon fill="grey" stroke="grey" points="67.88,-144.87 70.11,-149.68 71.37,-144.53 67.88,-144.87"></polygon> <text text-anchor="middle" x="57.28" y="-112.44" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n4&#45;&gt;n2 --> <g id="edge7" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="red" stroke-width="2" d="M72.33,-151.43C77.37,-150.93 91.15,-149.56 105.86,-148.1"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M105.86,-148.1C120.58,-146.64 136.24,-145.09 145.03,-144.22"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="145.36,-145.95 150.16,-143.71 145.01,-142.46 145.36,-145.95"></polygon> <text text-anchor="middle" x="99.93" y="-152.02" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n4 --> <g id="edge1" class="edge">
<title>
n5-&gt;n4
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M23.26,-210.12C29.9,-201.86 55.18,-170.43 65.69,-157.37"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="67.24,-158.23 69.01,-153.24 64.51,-156.04 67.24,-158.23"></polygon> <text text-anchor="middle" x="35.73" y="-187.95" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n3 --> <g id="edge3" class="edge">
<title>
n7-&gt;n3
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4,-22.59C12.22,-29.26 43.52,-54.69 56.53,-65.25"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="55.66,-66.8 60.64,-68.59 57.87,-64.08 55.66,-66.8"></polygon> <text text-anchor="middle" x="21.52" y="-48.12" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-width="1.5" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="144" height="480" viewbox="0.00 0.00 254.32 253.92" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 249.92)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-249.92 250.32,-249.92 250.32,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="149.14" cy="-71.27" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="174.93" cy="-149.27" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M149.78,-73.2C151.37,-78 155.71,-91.14 160.35,-105.17"></path> <path fill="none" stroke="grey" d="M160.35,-105.17C164.99,-119.21 169.93,-134.13 172.7,-142.52"></path> <polygon fill="grey" stroke="grey" points="171.09,-143.21 174.32,-147.41 174.41,-142.11 171.09,-143.21"></polygon> <text text-anchor="middle" x="152.49" y="-112.06" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M150,-69.56C154.21,-61.25 172.62,-24.86 180.54,-9.2"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="182.24,-9.72 182.93,-4.47 179.11,-8.14 182.24,-9.72"></polygon> <text text-anchor="middle" x="156.52" y="-43.58" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="71.16" cy="-97.07" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n1 --> <g id="edge5" class="edge">
<title>
n2-&gt;n1
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M73.09,-96.43C77.89,-94.84 91.03,-90.5 105.06,-85.85"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M105.06,-85.85C119.08,-81.21 134.01,-76.28 142.39,-73.5"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="143.08,-75.12 147.28,-71.89 141.98,-71.79 143.08,-75.12"></polygon> <text text-anchor="middle" x="98.99" y="-89.17" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="96.98" cy="-175.07" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n4 --> <g id="edge7" class="edge">
<title>
n2-&gt;n4
</title>
<path fill="none" stroke="grey" d="M71.8,-99C73.39,-103.8 77.74,-116.94 82.38,-130.97"></path> <path fill="none" stroke="grey" d="M82.38,-130.97C87.03,-145 91.97,-159.93 94.75,-168.32"></path> <polygon fill="grey" stroke="grey" points="93.13,-169.01 96.37,-173.2 96.46,-167.91 93.13,-169.01"></polygon> <text text-anchor="middle" x="74.52" y="-137.86" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n3&#45;&gt;n4 --> <g id="edge8" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="red" stroke-width="2" d="M173.01,-149.91C168.21,-151.5 155.08,-155.84 141.05,-160.48"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M141.05,-160.48C127.03,-165.12 112.11,-170.06 103.73,-172.83"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="103.04,-171.22 98.84,-174.45 104.14,-174.54 103.04,-171.22"></polygon> <text text-anchor="middle" x="129.62" y="-165.57" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n6 --> <!-- n4&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n4-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M96.1,-176.77C91.8,-185.03 72.97,-221.2 64.87,-236.76"></path> <polygon fill="red" stroke="red" stroke-width="2" points="63.18,-236.23 62.42,-241.47 66.28,-237.84 63.18,-236.23"></polygon> <text text-anchor="middle" x="71.74" y="-210.96" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n3 --> <g id="edge1" class="edge">
<title>
n5-&gt;n3
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M242.31,-183.06C233.37,-178.57 196.84,-160.25 181.63,-152.63"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="182.07,-150.89 176.81,-150.21 180.5,-154.02 182.07,-150.89"></polygon> <text text-anchor="middle" x="203.22" y="-172.04" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n2 --> <g id="edge3" class="edge">
<title>
n7-&gt;n2
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.3,-62.99C13.74,-67.8 49.67,-86.11 64.6,-93.72"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="64.07,-95.42 69.32,-96.13 65.66,-92.3 64.07,-95.42"></polygon> <text text-anchor="middle" x="25.7" y="-82.55" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="page-columns page-full"><p>We can notice a few things about the diagrams above. Not all the diagrams contribute to the classical limit. Clearly the diagrams with internal matter loops cannot be allowed when the momenta incoming to the loop is soft <a href="#fn30" class="footnote-ref" id="fnref30" role="doc-noteref"><sup>30</sup></a>. In the classical limit this momenta will go to 0, and since the scalars are massive, they need momentum greater than their mass to be pair produced, thus these diagrams do not contribute. Another class of diagrams that does not contribute to the classical limit are the ones with photon loops that start and end on the same matter line. These do not contribute because they are scaleless. An integral is scaleless when its integrand <span class="math inline">\(\mathcal{I}_\text{scaleless}(\{\ell_i \})\)</span> scales homegenously under any rescaling of the loop momentum <span class="math inline">\(\ell_i\)</span>:</p><div class="no-row-height column-margin column-container"><li id="fn30"><p><sup>30</sup>&nbsp;scales like <span class="math inline">\(\hbar\)</span></p></li></div></div>
<p><span class="math display">\[
\mathcal{I}_\text{scaleless}(\{\ell_i \})\stackrel{\ell_j\to\lambda \ell_j}{\longrightarrow}\lambda^\eta \mathcal{I}_\text{scaleless}(\{\ell_i \})
\]</span></p>
<p>Thus any diagram that has a basis of loops that does not contain both scalar fields (i.e.&nbsp;does not cross over) cannot have its scale set by the momentum transfer, and is thus scaleless. Dimensionally regularised scaleless integrals vanish, thus we can also discard these diagrams. We can easily implement such a filter programatically, by checking that if cycles are present they touch either both types of scalars, or neither. To compute the cycle basis we use an algorithm derived from <span class="citation" data-cites="Paton:1969">&nbsp;[<a href="references.html#ref-Paton:1969" role="doc-biblioref">25</a>]</span>, implemented in the <a href="https://github.com/lcnhb/DirectedHalfEdgeGraphs.jl">DirectedHalfEdgeGraphs.jl</a> package.</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Logging</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Logging</span>.<span class="fu">disable_logging</span>(<span class="bu">Logging</span>.Info)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">scaleless</span>(g<span class="op">::</span><span class="dt">AbstractFieldGraph</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  cycles <span class="op">=</span><span class="fu">cycle_basis</span>(g)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  isscaleless<span class="op">=</span><span class="cn">false</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> c <span class="kw">in</span> cycles</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    hs<span class="op">=</span> <span class="fu">collect</span>(<span class="bu">Iterators</span>.<span class="fu">flatten</span>(<span class="fu">half_edges</span>.(<span class="fu">Ref</span>(g),c)))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span><span class="fu">unique!</span>(<span class="fu">typeof</span>.(<span class="fu">field</span>.(<span class="fu">Ref</span>(g),hs)))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="fu">Bool</span>(Phi1 <span class="kw">in</span> fields) <span class="op">⊻</span>  <span class="fu">Bool</span>(Phi2 <span class="kw">in</span> fields)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      isscaleless<span class="op">=</span><span class="cn">true</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> isscaleless</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>noscalelessdiags<span class="op">=</span>qDiags[.!<span class="fu">scaleless</span>.(grafs)]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>classicaldiags<span class="op">=</span>noscalelessdiags[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>]</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i,d) <span class="kw">in</span> <span class="fu">enumerate</span>(classicaldiags)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  d.ID<span class="op">=</span>i</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"::: {#fig-onefilterloopsqed  layout-ncol=5 fig-cap-location=margin}"</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i,graf) <span class="kw">in</span> <span class="fu">enumerate</span>(grafs[.!<span class="fu">scaleless</span>.(grafs)])</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"```{dot}"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"//| fig-width: 1"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pprint</span>(<span class="cn">stdout</span>,<span class="fu">to_graphviz</span>(graf,graph_attrs<span class="op">=</span><span class="fu">Dict</span>(<span class="st">"layout"</span><span class="op">=&gt;</span><span class="st">"neato"</span>)))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"```"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"one loop graphs that contribute to the classical limit in (?:sqed)"</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">":::"</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="cn">nothing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-onefilterloopsqed" class="quarto-layout-panel" data-fig-cap-location="margin">
<p></p><figcaption>Fig&nbsp;5.6: one loop graphs that contribute to the classical limit in <abbr title="Scalar Quantum Electrodynamics">SQED</abbr></figcaption><p></p>
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-width="1" style="flex-basis: 20.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="96" height="480" viewbox="0.00 0.00 202.72 153.41" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 149.41)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-149.41 198.72,-149.41 198.72,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="57.6" cy="-68.72" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="137.72" cy="-77.28" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n2 --> <g id="edge5" class="edge">
<title>
n1-&gt;n2
</title>
<path fill="none" stroke="grey" d="M58.33,-70.39C61.65,-73.82 75.67,-77.03 91.03,-79.01"></path> <path fill="none" stroke="grey" d="M91.03,-79.01C106.39,-81 123.09,-81.77 131.75,-80.31"></path> <polygon fill="grey" stroke="grey" points="132.29,-81.98 136.54,-78.83 131.25,-78.64 132.29,-81.98"></polygon> <text text-anchor="middle" x="86.29" y="-79.55" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n1&#45;&gt;n2 --> <g id="edge6" class="edge">
<title>
n1-&gt;n2
</title>
<path fill="none" stroke="grey" d="M58.67,-67.24C62.6,-64.62 76.78,-64.42 92.07,-65.69"></path> <path fill="none" stroke="grey" d="M92.07,-65.69C107.35,-66.95 123.74,-69.68 132.11,-72.89"></path> <polygon fill="grey" stroke="grey" points="131.45,-74.52 136.69,-75.33 133.1,-71.43 131.45,-74.52"></polygon> <text text-anchor="middle" x="86.64" y="-57.47" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n6 --> <!-- n1&#45;&gt;n6 --> <g id="edge4" class="edge">
<title>
n1-&gt;n6
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M56.23,-70.09C49.55,-76.77 20.36,-105.97 7.79,-118.55"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="6.52,-117.35 4.22,-122.12 9,-119.82 6.52,-117.35"></polygon> <text text-anchor="middle" x="23.26" y="-98.52" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n4 --> <!-- n2&#45;&gt;n4 --> <g id="edge2" class="edge">
<title>
n2-&gt;n4
</title>
<path fill="none" stroke="red" stroke-width="2" d="M138.77,-78.91C143.88,-86.85 166.23,-121.59 175.85,-136.53"></path> <polygon fill="red" stroke="red" stroke-width="2" points="174.59,-137.8 178.77,-141.06 177.53,-135.91 174.59,-137.8"></polygon> <text text-anchor="middle" x="148.56" y="-111.92" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3 --> <!-- n3&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n3-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M190.36,-23.35C182.08,-31.83 154.28,-60.31 142.77,-72.1"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="141.37,-71.03 139.13,-75.83 143.88,-73.47 141.37,-71.03"></polygon> <text text-anchor="middle" x="157.81" y="-51.93" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n1 --> <g id="edge3" class="edge">
<title>
n5-&gt;n1
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M17.16,-4.22C22.87,-13.32 44.6,-47.98 53.63,-62.39"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="52.35,-63.64 56.49,-66.94 55.31,-61.78 52.35,-63.64"></polygon> <text text-anchor="middle" x="26.64" y="-37.5" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1" style="flex-basis: 20.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="96" height="480" viewbox="0.00 0.00 219.72 230.52" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 226.52)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-226.52 215.72,-226.52 215.72,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="70.36" cy="-69.51" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="75.79" cy="-146.17" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M70.49,-71.4C70.82,-76.09 71.72,-88.81 72.69,-102.47"></path> <path fill="none" stroke="grey" d="M72.69,-102.47C73.66,-116.12 74.69,-130.7 75.29,-139.1"></path> <polygon fill="grey" stroke="grey" points="73.56,-139.47 75.66,-144.34 77.05,-139.23 73.56,-139.47"></polygon> <text text-anchor="middle" x="64.14" y="-109.45" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n7 --> <!-- n1&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n1-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M69.49,-67.84C65.31,-59.74 47.02,-24.28 39.15,-9.02"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="40.61,-8.04 36.76,-4.4 37.5,-9.65 40.61,-8.04"></polygon> <text text-anchor="middle" x="45.57" y="-42.63" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="135.94" cy="-98.26" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n1 --> <g id="edge5" class="edge">
<title>
n2-&gt;n1
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M134.05,-97.43C129.86,-95.59 119.26,-90.95 107.89,-85.96"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M107.89,-85.96C96.52,-80.98 84.37,-75.65 77.07,-72.45"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="77.41,-70.69 72.13,-70.29 76.01,-73.9 77.41,-70.69"></polygon> <text text-anchor="middle" x="96.81" y="-89.14" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M134.45,-99.45C130.81,-102.35 120.96,-110.19 110.36,-118.63"></path> <path fill="none" stroke="grey" d="M110.36,-118.63C99.75,-127.08 88.38,-136.14 81.68,-141.47"></path> <polygon fill="grey" stroke="grey" points="80.26,-140.36 77.44,-144.85 82.44,-143.1 80.26,-140.36"></polygon> <text text-anchor="middle" x="99.32" y="-124.66" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n3&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n3-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M76.49,-148C79.95,-157.09 95.31,-197.38 101.52,-213.66"></path> <polygon fill="red" stroke="red" stroke-width="2" points="99.94,-214.42 103.35,-218.47 103.21,-213.18 99.94,-214.42"></polygon> <text text-anchor="middle" x="80.25" y="-185.03" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n3 --> <g id="edge1" class="edge">
<title>
n4-&gt;n3
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M4.13,-174.95C13.72,-171.1 53.18,-155.25 69.09,-148.86"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="70.07,-150.35 74.06,-146.86 68.76,-147.1 70.07,-150.35"></polygon> <text text-anchor="middle" x="27.86" y="-166.1" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n2 --> <g id="edge3" class="edge">
<title>
n6-&gt;n2
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M207.59,-80.55C198.08,-82.9 159.23,-92.5 143.06,-96.5"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="142.37,-94.87 137.94,-97.77 143.21,-98.27 142.37,-94.87"></polygon> <text text-anchor="middle" x="166.58" y="-92.72" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1" style="flex-basis: 20.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="96" height="480" viewbox="0.00 0.00 230.14 219.87" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 215.87)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-215.87 226.14,-215.87 226.14,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="124.9" cy="-145" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="80.15" cy="-81.59" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M123.79,-143.43C121.06,-139.56 113.63,-129.03 105.66,-117.73"></path> <path fill="none" stroke="grey" d="M105.66,-117.73C97.69,-106.44 89.18,-94.37 84.28,-87.43"></path> <polygon fill="grey" stroke="grey" points="85.7,-86.41 81.38,-83.33 82.84,-88.42 85.7,-86.41"></polygon> <text text-anchor="middle" x="95.28" y="-119.63" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n5 --> <!-- n1&#45;&gt;n5 --> <g id="edge2" class="edge">
<title>
n1-&gt;n5
</title>
<path fill="none" stroke="red" stroke-width="2" d="M126.89,-144.91C138.02,-144.44 192.85,-142.11 212.83,-141.26"></path> <polygon fill="red" stroke="red" stroke-width="2" points="212.91,-143.01 217.83,-141.05 212.76,-139.51 212.91,-143.01"></polygon> <text text-anchor="middle" x="161.11" y="-147.29" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="148.93" cy="-109.46" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n1 --> <g id="edge5" class="edge">
<title>
n2-&gt;n1
</title>
<path fill="none" stroke="red" stroke-width="2" d="M147.9,-110.98C146.29,-113.36 143,-118.23 139.39,-123.55"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M139.39,-123.55C135.79,-128.88 131.88,-134.67 129.03,-138.89"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="127.47,-138.06 126.12,-143.18 130.37,-140.02 127.47,-138.06"></polygon> <text text-anchor="middle" x="129.71" y="-129.14" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n2&#45;&gt;n3 --> <g id="edge7" class="edge">
<title>
n2-&gt;n3
</title>
<path fill="none" stroke="grey" d="M147.23,-108.77C143.06,-107.08 131.81,-102.52 119.68,-97.6"></path> <path fill="none" stroke="grey" d="M119.68,-97.6C107.55,-92.69 94.55,-87.42 86.9,-84.32"></path> <polygon fill="grey" stroke="grey" points="87.34,-82.61 82.05,-82.35 86.02,-85.85 87.34,-82.61"></polygon> <text text-anchor="middle" x="108.31" y="-100.74" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n7 --> <!-- n3&#45;&gt;n7 --> <g id="edge4" class="edge">
<title>
n3-&gt;n7
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M80.16,-79.62C80.2,-69.9 80.36,-26.76 80.42,-9.34"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="82.17,-9.2 80.44,-4.19 78.67,-9.18 82.17,-9.2"></polygon> <text text-anchor="middle" x="71.54" y="-48.68" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n4 --> <!-- n4&#45;&gt;n2 --> <g id="edge1" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M146.55,-207.77C146.84,-195.93 148.26,-137.22 148.75,-116.62"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="150.51,-116.58 148.88,-111.54 147.01,-116.5 150.51,-116.58"></polygon> <text text-anchor="middle" x="138.9" y="-166.4" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n6 --> <!-- n6&#45;&gt;n3 --> <g id="edge3" class="edge">
<title>
n6-&gt;n3
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.25,-95.34C14.42,-93.5 56.21,-85.92 73.06,-82.87"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="73.71,-84.53 78.32,-81.92 73.09,-81.09 73.71,-84.53"></polygon> <text text-anchor="middle" x="29.91" y="-93.31" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1" style="flex-basis: 20.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="96" height="480" viewbox="0.00 0.00 221.76 222.13" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 218.13)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-218.13 217.76,-218.13 217.76,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="143.96" cy="-61.79" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="152.11" cy="-143.52" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n2 --> <g id="edge5" class="edge">
<title>
n1-&gt;n2
</title>
<path fill="none" stroke="grey" d="M144.16,-63.81C144.66,-68.84 146.04,-82.61 147.5,-97.31"></path> <path fill="none" stroke="grey" d="M147.5,-97.31C148.97,-112.02 150.53,-127.66 151.4,-136.45"></path> <polygon fill="grey" stroke="grey" points="149.68,-136.77 151.92,-141.57 153.16,-136.42 149.68,-136.77"></polygon> <text text-anchor="middle" x="139.03" y="-104.33" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M145.18,-60.31C151.12,-53.13 177.12,-21.73 188.31,-8.22"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="189.85,-9.1 191.7,-4.13 187.16,-6.86 189.85,-9.1"></polygon> <text text-anchor="middle" x="158" y="-38.46" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n6 --> <!-- n2&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n2-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M153.58,-144.75C160.74,-150.71 192.08,-176.81 205.56,-188.05"></path> <polygon fill="red" stroke="red" stroke-width="2" points="204.68,-189.59 209.64,-191.45 206.92,-186.9 204.68,-189.59"></polygon> <text text-anchor="middle" x="170.82" y="-170.6" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="62.25" cy="-69.9" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3&#45;&gt;n1 --> <g id="edge6" class="edge">
<title>
n3-&gt;n1
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M64.27,-69.7C69.3,-69.2 83.06,-67.83 97.76,-66.37"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M97.76,-66.37C112.47,-64.91 128.1,-63.36 136.89,-62.49"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="137.21,-64.22 142.01,-61.98 136.86,-60.73 137.21,-64.22"></polygon> <text text-anchor="middle" x="91.83" y="-70.29" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="70.31" cy="-151.63" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3&#45;&gt;n4 --> <g id="edge8" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="grey" d="M62.45,-71.92C62.94,-76.95 64.3,-90.72 65.75,-105.42"></path> <path fill="none" stroke="grey" d="M65.75,-105.42C67.2,-120.13 68.74,-135.77 69.61,-144.56"></path> <polygon fill="grey" stroke="grey" points="67.88,-144.87 70.11,-149.68 71.37,-144.53 67.88,-144.87"></polygon> <text text-anchor="middle" x="57.28" y="-112.44" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n4&#45;&gt;n2 --> <g id="edge7" class="edge">
<title>
n4-&gt;n2
</title>
<path fill="none" stroke="red" stroke-width="2" d="M72.33,-151.43C77.37,-150.93 91.15,-149.56 105.86,-148.1"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M105.86,-148.1C120.58,-146.64 136.24,-145.09 145.03,-144.22"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="145.36,-145.95 150.16,-143.71 145.01,-142.46 145.36,-145.95"></polygon> <text text-anchor="middle" x="99.93" y="-152.02" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n4 --> <g id="edge1" class="edge">
<title>
n5-&gt;n4
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M23.26,-210.12C29.9,-201.86 55.18,-170.43 65.69,-157.37"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="67.24,-158.23 69.01,-153.24 64.51,-156.04 67.24,-158.23"></polygon> <text text-anchor="middle" x="35.73" y="-187.95" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n3 --> <g id="edge3" class="edge">
<title>
n7-&gt;n3
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4,-22.59C12.22,-29.26 43.52,-54.69 56.53,-65.25"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="55.66,-66.8 60.64,-68.59 57.87,-64.08 55.66,-66.8"></polygon> <text text-anchor="middle" x="21.52" y="-48.12" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="1" style="flex-basis: 20.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="96" height="480" viewbox="0.00 0.00 254.32 253.92" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 249.92)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-249.92 250.32,-249.92 250.32,4 -4,4"></polygon> <!-- n1 --> <g id="node1" class="node">
<title>
n1
</title>
<ellipse fill="black" stroke="black" cx="149.14" cy="-71.27" rx="1.8" ry="1.8"></ellipse> </g> <!-- n3 --> <g id="node3" class="node">
<title>
n3
</title>
<ellipse fill="black" stroke="black" cx="174.93" cy="-149.27" rx="1.8" ry="1.8"></ellipse> </g> <!-- n1&#45;&gt;n3 --> <g id="edge6" class="edge">
<title>
n1-&gt;n3
</title>
<path fill="none" stroke="grey" d="M149.78,-73.2C151.37,-78 155.71,-91.14 160.35,-105.17"></path> <path fill="none" stroke="grey" d="M160.35,-105.17C164.99,-119.21 169.93,-134.13 172.7,-142.52"></path> <polygon fill="grey" stroke="grey" points="171.09,-143.21 174.32,-147.41 174.41,-142.11 171.09,-143.21"></polygon> <text text-anchor="middle" x="152.49" y="-112.06" font-family="Times,serif" font-size="14.00">q₂</text> </g> <!-- n8 --> <!-- n1&#45;&gt;n8 --> <g id="edge4" class="edge">
<title>
n1-&gt;n8
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M150,-69.56C154.21,-61.25 172.62,-24.86 180.54,-9.2"></path> <polygon fill="blue" stroke="blue" stroke-width="2" points="182.24,-9.72 182.93,-4.47 179.11,-8.14 182.24,-9.72"></polygon> <text text-anchor="middle" x="156.52" y="-43.58" font-family="Times,serif" font-size="14.00">p₄</text> </g> <!-- n2 --> <g id="node2" class="node">
<title>
n2
</title>
<ellipse fill="black" stroke="black" cx="71.16" cy="-97.07" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n1 --> <g id="edge5" class="edge">
<title>
n2-&gt;n1
</title>
<path fill="none" stroke="blue" stroke-width="2" d="M73.09,-96.43C77.89,-94.84 91.03,-90.5 105.06,-85.85"></path> <path fill="none" stroke="deepskyblue" stroke-width="2" d="M105.06,-85.85C119.08,-81.21 134.01,-76.28 142.39,-73.5"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="143.08,-75.12 147.28,-71.89 141.98,-71.79 143.08,-75.12"></polygon> <text text-anchor="middle" x="98.99" y="-89.17" font-family="Times,serif" font-size="14.00">q₁</text> </g> <!-- n4 --> <g id="node4" class="node">
<title>
n4
</title>
<ellipse fill="black" stroke="black" cx="96.98" cy="-175.07" rx="1.8" ry="1.8"></ellipse> </g> <!-- n2&#45;&gt;n4 --> <g id="edge7" class="edge">
<title>
n2-&gt;n4
</title>
<path fill="none" stroke="grey" d="M71.8,-99C73.39,-103.8 77.74,-116.94 82.38,-130.97"></path> <path fill="none" stroke="grey" d="M82.38,-130.97C87.03,-145 91.97,-159.93 94.75,-168.32"></path> <polygon fill="grey" stroke="grey" points="93.13,-169.01 96.37,-173.2 96.46,-167.91 93.13,-169.01"></polygon> <text text-anchor="middle" x="74.52" y="-137.86" font-family="Times,serif" font-size="14.00">q₃</text> </g> <!-- n3&#45;&gt;n4 --> <g id="edge8" class="edge">
<title>
n3-&gt;n4
</title>
<path fill="none" stroke="red" stroke-width="2" d="M173.01,-149.91C168.21,-151.5 155.08,-155.84 141.05,-160.48"></path> <path fill="none" stroke="lightcoral" stroke-width="2" d="M141.05,-160.48C127.03,-165.12 112.11,-170.06 103.73,-172.83"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="103.04,-171.22 98.84,-174.45 104.14,-174.54 103.04,-171.22"></polygon> <text text-anchor="middle" x="129.62" y="-165.57" font-family="Times,serif" font-size="14.00">q₄</text> </g> <!-- n6 --> <!-- n4&#45;&gt;n6 --> <g id="edge2" class="edge">
<title>
n4-&gt;n6
</title>
<path fill="none" stroke="red" stroke-width="2" d="M96.1,-176.77C91.8,-185.03 72.97,-221.2 64.87,-236.76"></path> <polygon fill="red" stroke="red" stroke-width="2" points="63.18,-236.23 62.42,-241.47 66.28,-237.84 63.18,-236.23"></polygon> <text text-anchor="middle" x="71.74" y="-210.96" font-family="Times,serif" font-size="14.00">p₂</text> </g> <!-- n5 --> <!-- n5&#45;&gt;n3 --> <g id="edge1" class="edge">
<title>
n5-&gt;n3
</title>
<path fill="none" stroke="lightcoral" stroke-width="2" d="M242.31,-183.06C233.37,-178.57 196.84,-160.25 181.63,-152.63"></path> <polygon fill="lightcoral" stroke="lightcoral" stroke-width="2" points="182.07,-150.89 176.81,-150.21 180.5,-154.02 182.07,-150.89"></polygon> <text text-anchor="middle" x="203.22" y="-172.04" font-family="Times,serif" font-size="14.00">p₁</text> </g> <!-- n7 --> <!-- n7&#45;&gt;n2 --> <g id="edge3" class="edge">
<title>
n7-&gt;n2
</title>
<path fill="none" stroke="deepskyblue" stroke-width="2" d="M4.3,-62.99C13.74,-67.8 49.67,-86.11 64.6,-93.72"></path> <polygon fill="deepskyblue" stroke="deepskyblue" stroke-width="2" points="64.07,-95.42 69.32,-96.13 65.66,-92.3 64.07,-95.42"></polygon> <text text-anchor="middle" x="25.7" y="-82.55" font-family="Times,serif" font-size="14.00">p₃</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>There is one final simplification we can do. The first diagram above has two photon propagators, and two quartic vertices, which give it its name: the double-seagull. The photon propagators have homogeonous <span class="math inline">\(\hbar^{-2}\)</span> scaling (see <a href="#eq-photonscale">eq.&nbsp;<span>5.22</span></a>), the vertices only bring constants, and the loop integration has <span class="math inline">\(\hbar^4\)</span> scaling. Together this means that the reduced amplitude has <span class="math inline">\(\hbar^0\)</span> scaling. However in the virtual integrand the reduced amplitude has to cancel with the transfer momentum’s <span class="math inline">\(\hbar\)</span> scale (see <a href="#eq-impulseIr">eq.&nbsp;<span>5.16</span></a>). Thus the double seagull diagram dies in the classical limit.</p>
<div class="page-columns page-full"><p>We are left with only 4 diagrams, the two triangle diagrams, the box and cross box, which we can now compute. At this point we can do this manually, but again, putting in place a programattic framework means that subsequent loops can be treated systematically<a href="#fn31" class="footnote-ref" id="fnref31" role="doc-noteref"><sup>31</sup></a>. We will also extract one of these integrands by hand, for completeness and comparison.</p><div class="no-row-height column-margin column-container"><li id="fn31"><p><sup>31</sup>&nbsp;at least at the unintegrated level</p></li></div></div>
<p>The first step is to define the Feynman rules in a computer readable format. We will use <code>Julia</code> to apply these rules at every vertex and every edge, but for the actual computation we will use <code>FORM</code> <span class="citation" data-cites="Vermaseren:2000nd Kuipers:2012rf">&nbsp;[<a href="references.html#ref-Vermaseren:2000nd" role="doc-biblioref">26</a>,<a href="references.html#ref-Kuipers:2012rf" role="doc-biblioref">27</a>]</span> which can automatically contract indices and does expression manipulations in an extremely fast way. The Feynman rules implementation in the package developped for this thesis make use of <code>Julia</code>s defining paradigm of multiple dispatch. This allows us to define the rules for each vertex and each edge in a very compact way. We can define the rules for <abbr title="Scalar Quantum Electrodynamics">SQED</abbr> as follows:</p>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-overflow-wrap code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">feynmanRule</span>(mime<span class="op">::</span><span class="dt">MIME"text/FORM"</span>,p,f1<span class="op">::</span><span class="dt">Photon</span>,f2<span class="op">::</span><span class="dt">Photon</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  momen <span class="op">=</span> <span class="fu">repr</span>(mime,p.symbol)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  indx1 <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">index</span>(f1))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  indx2 <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">index</span>(f2))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"_i* prop(-1,0,</span><span class="sc">$</span>momen<span class="st">)*d_(</span><span class="sc">$</span>indx1<span class="st">,</span><span class="sc">$</span>indx2<span class="st">)"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="pp">@symmetric</span> <span class="kw">function</span> <span class="fu">feynmanRule</span>(mime<span class="op">::</span><span class="dt">MIME"text/FORM"</span>,p,[f1<span class="op">::</span><span class="dt">Phi1</span>,f2<span class="op">::</span><span class="dt">Phi1c</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  momen <span class="op">=</span> <span class="fu">repr</span>(mime,p.symbol)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"_i* prop(-1,1,</span><span class="sc">$</span>momen<span class="st">)"</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="pp">@symmetric</span> function <span class="fu">feynmanRule</span>(mime<span class="op">::</span><span class="dt">MIME"text/FORM"</span>,p,[f1<span class="op">::</span><span class="dt">Phi2</span>,f2<span class="op">::</span><span class="dt">Phi2c</span>])</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  momen <span class="op">=</span> <span class="fu">repr</span>(mime,p.symbol)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"_i* prop(-1,2,</span><span class="sc">$</span>momen<span class="st">)"</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="pp">@symmetric</span> function <span class="fu">feynmanRule</span>(mime<span class="op">::</span><span class="dt">MIME"text/FORM"</span>,[(pᵩ₁,a)<span class="op">::</span><span class="dt">Tuple{Any,ScalarField{S}}</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            (pᵩ₂,b)<span class="op">::</span><span class="dt">Tuple{Any,AdjointField{ScalarField{S}}}</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            (pᵧ,γ)<span class="op">::</span><span class="dt">Tuple{Any,Photon}</span>]) <span class="kw">where</span> {S}</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  p1 <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">pᵩ₁</span>(<span class="fu">index</span>(γ)))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  p2 <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">pᵩ₂</span>(<span class="fu">index</span>(γ)))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  q <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">charge</span>(a))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"_i*e*</span><span class="sc">$</span>q<span class="st">*(</span><span class="sc">$</span>p2<span class="st">-</span><span class="sc">$</span>p1<span class="st">)"</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="pp">@symmetric</span> function <span class="fu">feynmanRule</span>(mime<span class="op">::</span><span class="dt">MIME"text/FORM"</span>,[(pᵧ₁,γ₁)<span class="op">::</span><span class="dt">Tuple{Any,Photon}</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            (pᵧ₂,γ₂)<span class="op">::</span><span class="dt">Tuple{Any,Photon}</span>,(pᵩ₂,b)<span class="op">::</span><span class="dt">Tuple{Any,AdjointField{ScalarField{S}}}</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>            (pᵩ₁,a)<span class="op">::</span><span class="dt">Tuple{Any,ScalarField{S}}</span>]) <span class="kw">where</span> {S}    </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  mu <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">index</span>(γ₁))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  nu <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">index</span>(γ₂)) </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  q <span class="op">=</span> <span class="fu">repr</span>(mime,<span class="fu">charge</span>(a))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2*_i*</span><span class="sc">$</span>q<span class="st">^2*e^2*d_(</span><span class="sc">$</span>mu<span class="st">,</span><span class="sc">$</span>nu<span class="st">)"</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>where we define <code>prop(n,i,p)</code> as representing a generic Feynman propagator, which we will denote:</p>
<p><span class="math display">\[
D_{-}(n,i,p)=\mathtt{prop(n,i,p)}=(p^2-m_i^2+i\epsilon )^{n} \quad \text{thus} \quad \mathtt{prop(-1,i,p)}=\frac{1}{p^2-m_i^2+i\epsilon}.
\]</span></p>
<p>We can now apply these feynamn rules to the graphs we have left, obtaining <code>FORM</code> readable integrands. For example the box diagram gives:</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>toform(stdout,classicaldiags[<span class="dv">3</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>*--#[d3l1:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>L [d3l1|o.3.4|i.3.4|i|o|] = 1*i_* prop(-1,0,q1)*d_(nu1,nu2)*i_* prop(-1,1,q2)*i_* prop(-1,2,q3)*i_* prop(-1,0,q4)*d_(nu7,nu8)*i_*e*qch1*(q2(nu1)-p4(nu1))*i_*e*qch2*(q3(nu2)-p2(nu2))*i_*e*qch1*(p3(nu7)-q2(nu7))*i_*e*qch2*(p1(nu8)-q3(nu8));
#procedure momentumRouting</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Id q2 = p3 + -q4;
Id p1 = p2 + p4 + -p3;
Id q1 = p3 + -p4 + -q4;
Id q3 = p2 + p4 + q4 + -p3;

Id q4= l1;
#endprocedure</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
*--#]d3l1:</code></pre>
</div>
</div>
<p>Notice that we also define the momentum routing by imposing the replacement rules, one per vertex. This can be done in many ways but to ensure proper scaling we set the loop momenta on the massless lines. This is done by the <code>Julia</code> program, using kruskal’s algorithm <span class="citation" data-cites="Kruskal:1956">&nbsp;[<a href="references.html#ref-Kruskal:1956" role="doc-biblioref">28</a>]</span> to find the maximal-mass spanning tree of the graph, and then setting the loop momenta to be those internal edges that are missing from the tree. Using <code>FORM</code> we can contract indices and apply the momentum conservation rules. Finallly we also apply the relableing rules described in <a href="#eq-newmom">eq.&nbsp;<span>5.25</span></a>. The <code>FORM</code> version of the box integrand is then:</p>
<div id="lst-formBox" class="listing">
<p>Listing&nbsp;5.1: Box integrand in FORM</p>
<div class="sourceCode" id="lst-formBox" data-lst-cap="Box integrand in FORM"><pre class="sourceCode default sql code-with-copy"><code class="sourceCode default"><span id="lst-formBox-1"><a href="#lst-formBox-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-formBox-2"><a href="#lst-formBox-2" aria-hidden="true" tabindex="-1"></a>   [d3l1|o.3.4|i.3.4|i|o|] =</span>
<span id="lst-formBox-3"><a href="#lst-formBox-3" aria-hidden="true" tabindex="-1"></a>         ( prop(-1,0,q - l1) )</span>
<span id="lst-formBox-4"><a href="#lst-formBox-4" aria-hidden="true" tabindex="-1"></a>       * ( prop(-1,0,l1) )</span>
<span id="lst-formBox-5"><a href="#lst-formBox-5" aria-hidden="true" tabindex="-1"></a>       * ( prop(-1,1,1/2*q - l1 + pb1) )</span>
<span id="lst-formBox-6"><a href="#lst-formBox-6" aria-hidden="true" tabindex="-1"></a>       * ( prop(-1,2, - 1/2*q + l1 + pb2) )</span>
<span id="lst-formBox-7"><a href="#lst-formBox-7" aria-hidden="true" tabindex="-1"></a>       * ( dot(q,q) - 2*dot(q,l1) - 2*dot(q,pb2) + 2*dot(q,pb1) + dot(l1,l1)</span>
<span id="lst-formBox-8"><a href="#lst-formBox-8" aria-hidden="true" tabindex="-1"></a>          + 2*dot(l1,pb2) - 2*dot(l1,pb1) - 4*dot(pb2,pb1) )</span>
<span id="lst-formBox-9"><a href="#lst-formBox-9" aria-hidden="true" tabindex="-1"></a>       * ( dot(l1,l1) + 2*dot(l1,pb2) - 2*dot(l1,pb1) - 4*dot(pb2,pb1) )</span>
<span id="lst-formBox-10"><a href="#lst-formBox-10" aria-hidden="true" tabindex="-1"></a>       * ( qch2 ) * ( qch2 ) * ( qch1 ) * ( qch1 )</span>
<span id="lst-formBox-11"><a href="#lst-formBox-11" aria-hidden="true" tabindex="-1"></a>       * ( e ) * ( e ) * ( e ) * ( e );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When applied to all 4 diagrams we obtain precisely the same integrands as those in <span class="citation" data-cites="Kosower:2018adc">&nbsp;[<a href="references.html#ref-Kosower:2018adc" role="doc-biblioref">14</a>]</span>. Additionally we notice that the two triangles and the box diagram have overlapping propagators. In fact the denominators of the integrands for all three can be written as:</p>
<p><span id="eq-boxfam"><span class="math display">\[
\Box_{i_1,i_2,i_3,i_4}=\frac{1}{\rho_1^{i_1}\rho_2^{i_2}\rho_3^{i_3}\rho_4^{i_4}},
\tag{5.29}\]</span></span></p>
<p>for powers <span class="math inline">\(\{i \}\in\{0,1 \}^4\)</span>, where the inverse propagators <span class="math inline">\(\rho_i\)</span> are:</p>
<p><span class="math display">\[
\rho_1=\ell^2+\mathring{\imath}\epsilon,\quad \rho_2=(\ell-q)^2+\mathring{\imath}\epsilon,\quad \rho_3=(\frac{q}{2}-\ell+\tilde{p}_{1})^2-m_{1}^2+\mathring{\imath}\epsilon,\quad \rho_4=(-  \frac{q}{2}+\ell+\tilde{p}_{2})^2-m_{2}^2+\mathring{\imath}\epsilon
\]</span></p>
<p>Note that in the classical limit we can expand the massive propagators as shown in <a href="#eq-massiveScale">eq.&nbsp;<span>5.23</span></a> and obtain to first order in <span class="math inline">\(\hbar\)</span>:</p>
<p><span class="math display">\[
\rho_3=2\ell\cdot\tilde{p}_{1}+\mathring{\imath}\epsilon,\quad \rho_4= -2\ell\cdot\tilde{p}_{2}+\mathring{\imath}\epsilon,
\]</span></p>
<p>where we used <a href="#eq-orthog">eq.&nbsp;<span>5.26</span></a>. The cross box can in fact extend this family, by adding just one more inverse propagator. We now have the complete descripition of the denominators of all 1-loop contributing diagrams. The numerators in fact do not complicate things much. They are all composed of scalar products of momenta. If these do not contain loop-momenta they are just constant factors in front of the integral. The scalar products that do contain loop momenta can be intelligently written as inverse powers of the propagators. This is the case for any feynman like integrand. Consider the following general integrand:</p>
<p><span class="math display">\[
\mathcal{I}= \frac{\mathcal{N}}{\mathcal{D}}=\frac{\prod\limits_{S'}N_{S'}}{\prod\limits_{S}D_S}=\frac{\prod\limits_{S'}\sum\limits_{i\geq j} S'_{ij}p_i\cdot p_j}{\prod\limits_{S}\sum\limits_{i\geq j} S_{ij}p_i\cdot p_j},
\]</span></p>
<p>where <span class="math inline">\({S}\)</span> and <span class="math inline">\({S'}\)</span> are sets of coefficient matrices for all possible dot products. If we have a quadruplet <span class="math inline">\(\{A,B,a,b \}\)</span> such that <span class="math inline">\(A_{a,b}\neq0\)</span> and <span class="math inline">\(B_{a,b}neq0\)</span> and <span class="math inline">\(p_{a}\)</span>or <span class="math inline">\(p_{b}\)</span> is a loop momentum <span class="math inline">\(\ell\)</span>, say <span class="math inline">\(p_a=\ell\)</span> then it is useful to write this component of the integrand as:</p>
<p><span id="eq-scalarred"><span class="math display">\[
\frac{N_{B}}{D_{A}}=\frac{\tilde{N}_B+B_{ab}\ell\cdot p_b}{A_{ab}\ell\cdot p_b +\sum\limits_{\substack{i\geq j \\ i,j\neq a,b}}A_{ij}p_i\cdot p_j}=\frac{\tilde{N}_B}{D_A}+\frac{B_{ab}}{A_{ab}}\Big(1-\frac{\tilde{D}_A}{D_A} \Big).
\tag{5.30}\]</span></span></p>
<p>where the tilde means that we have remove the <span class="math inline">\(ab\)</span> contribution. Thus we see that we obtain in the numerator, a sum of objects, none of which contain the dot product: <span class="math inline">\(\ell\cdot p_b\)</span>. We can do this for every quadruplet <span class="math inline">\(\{A,B,a,b \}\)</span>, after every replacement and obtain an integrand containing only so called <em>irreducible</em> loop-momenta scalar products. In the cases we have here, they all dissapear, leaving us truely with a family of integrands like <a href="#eq-boxfam">eq.&nbsp;<span>5.29</span></a>. This can be readily fed into a IBP solver, such as <code>AIR</code> <span class="citation" data-cites="Anastasiou:2004">&nbsp;[<a href="references.html#ref-Anastasiou:2004" role="doc-biblioref">29</a>]</span>, <code>FIRE</code> <span class="citation" data-cites="Smirnov:2020">&nbsp;[<a href="references.html#ref-Smirnov:2020" role="doc-biblioref">30</a>]</span> or <code>Kira</code> <span class="citation" data-cites="Maierhofer:2018">&nbsp;[<a href="references.html#ref-Maierhofer:2018" role="doc-biblioref">31</a>]</span>.</p>
<p>With such a solver we can obtain a complete family of integrals, that one can then look up. We are thus able to obtain the integrated integrands at <abbr title="Next-to-Leading Order">NLO</abbr> that are then used in <a href="#eq-impulseIr">eq.&nbsp;<span>5.16</span></a> and <a href="#eq-impulseIv">eq.&nbsp;<span>5.15</span></a>. The algorithm described above was implemented in <code>FORM</code> and is able to rapibly process the 1-loop diagrams. The code is available at the repository for this document.</p>
<p>Importantly we still need to take the classical limit. At this point a problem shows up. The box and cross box integrals are divergent in the classical limit (some authors call this super classical). Let us see this for the box integral. We have from <a href="#lst-formBox">Listing&nbsp;<span>5.1</span></a> that the integral for the box diagram <span class="math inline">\(B\)</span> is:</p>
<p><span class="math display">\[
\mathring{\imath}B = e^4 Q_{1} Q_{2} \int \,\tilde{\mathrm{d}}^{D}\ell\, \Box_{1,1,1,1}(4 \tilde{p}_{1}\cdot \tilde{p}_{2}  + 2\ell\cdot(\tilde{p}_{2} -\tilde{p}_{1} ) -(q_{}-\ell )^2 )(4 \tilde{p}_{1}\cdot \tilde{p}_{2}  + 2\ell\cdot(\tilde{p}_{2} -\tilde{p}_{1} ) -(\ell )^2 )
\]</span></p>
<p>we can apply the procedure described above, turning messenger momenta into wavenumbers:</p>
<div class="page-columns page-full"><p><span class="math display">\[
\mathring{\imath}B = e^4 Q_{1} Q_{2} \int \,\tilde{\mathrm{d}}^{D}\bar{\ell}\,\frac{\hbar^D}{\hbar^6} \Box_{\bar{1},\bar{1},\bar{1},\bar{1}}(4 \tilde{p}_{1}\cdot \tilde{p}_{2}  + \hbar 2\bar{\ell}\cdot(\tilde{p}_{2} -\tilde{p}_{1} ) -\hbar^2(\bar{q}_{}-\bar{\ell} )^2 )(4 \tilde{p}_{1}\cdot \tilde{p}_{2}  + \hbar 2\bar{\ell}\cdot(\tilde{p}_{2} -\tilde{p}_{1} ) -\hbar^2(\bar{\ell} )^2 ),
\]</span> where <span class="math inline">\(\Box_{\bar{i}_1,\bar{i}_2,\bar{i}_3,\bar{i}_4} =\frac{1}{\hbar^{2(i_1+i_2)+i_3+i_4}} \Box_{i_1,i_2,i_3,i_4}\)</span> is the box family with wavenumber instead of messenger momenta, and <span class="math inline">\(\hbar\)</span>s extracted. We notice that if we apply the scalar product reduction <a href="#eq-scalarred">eq.&nbsp;<span>5.30</span></a>, we will necessarily still have an integral of the form<a href="#fn32" class="footnote-ref" id="fnref32" role="doc-noteref"><sup>32</sup></a>:</p><div class="no-row-height column-margin column-container"><li id="fn32"><p><sup>32</sup>&nbsp;along with ones that are of the form <span class="math inline">\(\Box_{1,1,1,0}\)</span> and other permutations. These are not divergent in the classical limit, as they have one less propagator, thus one less <span class="math inline">\(\hbar\)</span>, just enough to cancel what is left of the <span class="math inline">\(\hbar\)</span> in the numerator, and have an overall <span class="math inline">\(\mathcal{O}(\hbar^{0})\)</span> scaling.</p></li></div></div>
<p><span class="math display">\[
e^4 Q_{1} Q_{2} 16 (\tilde{p}_{1}\cdot \tilde{p}_{2})^2 \int \,\tilde{\mathrm{d}}^{D}{\ell}\,\Box_{1,1,1,1}=\mathcal{O}(\hbar^{D-6})
\]</span></p>
<p>whislt we need to cancel with the <span class="math inline">\(\hbar\)</span> in the classical limit (<a href="#eq-hbarvirt">eq.&nbsp;<span>5.18</span></a>), here we have one too many orders in the denominator (if D=4). Thus we would get a divergent (<span class="math inline">\(\frac{1}{\hbar}\)</span>) contribution when taking the classical <span class="math inline">\(\hbar\to 0\)</span> limit. If we consider now the cross box, which is the same family as above but with an extra minus sign:</p>
<p><span class="math display">\[
\tilde{\rho}_4=( \frac{q}{2} -\ell+\tilde{p}_{2})^2-m_{2}^2+\mathring{\imath}\epsilon\simeq  2\ell\cdot\tilde{p}_{2}+\mathring{\imath}\epsilon.
\]</span></p>
<p>If we write that <span class="math inline">\(\Box_{+i_1,+i_2,+i_3,+i_4}=\Box_{i_1,i_2,i_3,i_4}\)</span> where the sign is the sign of the <span class="math inline">\(\mathring{\imath}\epsilon\)</span> presciption, then we can write the cross box integral as: <span class="math display">\[
\int \,\tilde{\mathrm{d}}^{D}\ell\, -\Box_{1,1,1,-1}
\]</span></p>
<p>thus summing up the two divergent contributions from the box and cross box we have:</p>
<p><span id="eq-boxcross"><span class="math display">\[
\Box_{1,1,1,1}-\Box_{1,1,1,-1}=\Box_{1,1,1,0}\Big(\frac{1}{-2\ell\cdot\tilde{p}_{2}+\mathring{\imath}\epsilon}-\frac{1}{    2\ell\cdot\tilde{p}_{2}+\mathring{\imath}\epsilon} \Big)=-\mathring{\imath}\Box_{1,1,1,0}\tilde{\delta}^{}(2\ell\cdot\tilde{p}_{2}),
\tag{5.31}\]</span></span></p>
<div class="page-columns page-full"><p>where in the equation line we used <em>reverse unitarity</em> <span class="citation" data-cites="Anastasiou:2002yz Anastasiou:2002qz Anastasiou:2003yy">&nbsp;[<a href="references.html#ref-Anastasiou:2002yz" role="doc-biblioref">32</a>–<a href="references.html#ref-Anastasiou:2003yy" role="doc-biblioref">34</a>]</span>. This idea was developped in the context of cross-section calculations in the for collider physics computations. It enables to set on equal footing real contributions <a href="#fn33" class="footnote-ref" id="fnref33" role="doc-noteref"><sup>33</sup></a> where we integrate over on shell momenta <a href="#fn34" class="footnote-ref" id="fnref34" role="doc-noteref"><sup>34</sup></a> and virtual integrals, where the integration is over all possible four-momentum <a href="#fn35" class="footnote-ref" id="fnref35" role="doc-noteref"><sup>35</sup></a>. The idea is to trade the on-shell delta functions and their <span class="math inline">\(n\)</span>-th derivatives for differences of (powers of) propagators with alternating <span class="math inline">\(\mathring{\imath}\epsilon\)</span>:</p><div class="no-row-height column-margin column-container"><li id="fn33"><p><sup>33</sup>&nbsp;such as ones in the real integrand <a href="#eq-rInt">eq.&nbsp;<span>5.10</span></a></p></li><li id="fn34"><p><sup>34</sup>&nbsp;thus three dimensional momentum space</p></li><li id="fn35"><p><sup>35</sup>&nbsp;as virtual particles can be off shell</p></li></div></div>
<p><span id="eq-reverseunitarity"><span class="math display">\[
\frac{\mathring{\imath}}{(-1)^ nn!} \frac{\mathrm{d}^{n} }{\mathrm{d}{z}^{n}} \tilde{\delta}^{}(z)   = \frac{1}{(z  -\mathring{\imath}\epsilon )^{(n+1)}}  - \frac{1}{(z+\mathring{\imath}\epsilon )^{(n+1)}}.
\tag{5.32}\]</span></span></p>
<p>In our case <a href="#eq-reverseunitarity">eq.&nbsp;<span>5.32</span></a> implies the following identities:</p>
<p><span id="eq-revone"><span class="math display">\[
\tilde{\delta}^{}(-2\ell\cdot\tilde{p}_{2})=\mathring{\imath}(\Box_{0,0,0,1}-\Box_{0,0,0,-1} )
\tag{5.33}\]</span></span></p>
<p><span id="eq-revtwo"><span class="math display">\[
\tilde{\delta}^{}(2\ell\cdot\tilde{p}_{1})=\mathring{\imath}(\Box_{0,0,1,0}-\Box_{0,0,-1,0} )
\tag{5.34}\]</span></span></p>
<p>Since we where able to write this difference of propagators as a sort of cut, we could further compare the divergent part of the box and cross box with the corresponding real contribution, which is at tree level, with no cut messengers: <span class="math inline">\(L'=0\)</span> and <span class="math inline">\(\vert X \vert=0\)</span> such that <a href="#eq-rvloopmatch">eq.&nbsp;<span>5.17</span></a> is satisfied. We have:</p>
<p><span class="math display">\[
\begin{aligned}
\int &amp;\,\tilde{\mathrm{d}}^{4}\bar{w}\,\tilde{\delta}^{}(2\tilde{p}_{1}\cdot \bar{w}-\hbar\frac{\bar{q}_{}}{2} \cdot \bar{w}  +\hbar\bar{w}^2)\tilde{\delta}^{}(-2\tilde{p}_{2} \cdot \bar{w}+\hbar\frac{\bar{q}_{}}{2} \cdot \bar{w}+\hbar\bar{w}^2) \\
&amp;\times    \hbar\bar{w}^\mu\\
&amp;\times\kappa^{4}{\hbar}^{2}\mathcal{\bar{A}}^{(0)}(\tilde{p}_{1}-\hbar\frac{\bar{q}_{}}{2},\tilde{p}_{2}+\hbar\frac{\bar{q}_{}}{2} \to\tilde{p}_{1}+\hbar\frac{\bar{q}_{}}{2}+\hbar\bar{w}, \tilde{p}_{2}-\hbar\frac{\bar{q}_{}}{2}-\hbar\bar{w}_2) \\
&amp;\times\mathcal{{\bar{A}{}^\ast}}^{(0)}(\tilde{p}_{1}+\hbar\frac{\bar{q}_{}}{2},\tilde{p}_{2}+\hbar\frac{\bar{q}_{}}{2}-\hbar \bar{q}_{}\to\tilde{p}_{1}-\hbar\frac{\bar{q}_{}}{2}+\hbar\bar{w}, \tilde{p}_{2}+\hbar\frac{\bar{q}_{}}{2}-   \hbar\bar{w}_2).
\end{aligned}
\]</span></p>
<p>where the <span class="math inline">\(\mathcal{\bar{A}}^{(0)}\)</span> we already computed in <a href="#eq-treeampl">eq.&nbsp;<span>5.27</span></a>, and we have eliminated the theta functions in prepartation of taking the classical limit. Thus it is essentially a cut of a one-loop box. Notice that in the classical limit we must cancel with <span class="math inline">\(\hbar^3\)</span> (<a href="#eq-hbarreal">eq.&nbsp;<span>5.19</span></a>) which at leading order is again overdone. The <span class="math inline">\(\tilde{p}_{1}\cdot \tilde{p}_{2}\)</span> contribution from each tree scales like <span class="math inline">\(\frac{1}{\hbar^4}\)</span>, and is thus classically divergent as the box and cross box before it. We also notice it has the following form:</p>
<p><span class="math display">\[
e^4 Q_{1} Q_{2} 16 (\tilde{p}_{1}\cdot \tilde{p}_{2})^2\frac{1}{\hbar}\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\bar{\ell}^\mu\tilde{\delta}^{}(2\tilde{p}_{1} \cdot \bar{\ell})\tilde{\delta}^{}(-2\tilde{p}_{2} \cdot \bar{\ell})\Box_{\bar{1},\bar{1},\bar{0},\bar{0}},
\]</span></p>
<p>where we’ve changed variables from <span class="math inline">\(\bar{w}\)</span> to <span class="math inline">\(\bar{\ell}\)</span> and removed the <span class="math inline">\(\hbar(\frac{\bar{q}_{}}{2} \cdot \bar{\ell}\pm\bar{ \ell}^2)\)</span> term in the delta functions, in prepation for the classical limit. We can now apply reverse unitarity (<a href="#eq-revone">eq.&nbsp;<span>5.33</span></a>,<a href="#eq-revtwo">eq.&nbsp;<span>5.34</span></a>) and focus on the integral without the prefactors:</p>
<p><span class="math display">\[
\begin{aligned}
\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\bar{\ell}^\mu&amp;\tilde{\delta}^{}(2\tilde{p}_{1} \cdot \bar{\ell})\tilde{\delta}^{}(-2\tilde{p}_{2} \cdot \bar{\ell})\Box_{\bar{1},\bar{1},\bar{0},\bar{0}}  =    \int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\bar{\ell}^\mu\tilde{\delta}^{}(2\tilde{p}_{1} \cdot \bar{\ell})\mathring{\imath}(\Box_{0,0,0,1}-\Box_{0,0,0,-1} )\Box_{\bar{1},\bar{1},\bar{0},\bar{0}}  \\  
&amp;=-\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\bar{\ell}^\mu(\Box_{0,0,1,0}-\Box_{0,0,-1,0} )(\Box_{1,1,0,1}-\Box_{1,1,0,-1} ) ,\\
&amp;=\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\bar{\ell}^\mu[(\Box_{1,1,1,-1}-\Box_{1,1,1,1} )+(\Box_{1,1,-1,1}-\Box_{1,1,-1,-1} ) ] .
\end{aligned}
\]</span></p>
<p>We now notice something interesting, this cut integral has a sort of horizontal flip symmetry, i.e.&nbsp;if we average over the existing ‘loop’ momentum labelling and a new <span class="math inline">\(\ell'=q-\ell\)</span> we eliminate the <span class="math inline">\(\ell{}^{\mu}\)</span> dependence in the numerator:</p>
<p><span class="math display">\[
\frac{1}{2}[\ell{}^{\mu}+(q{}^{\mu}-\ell{}^{\mu} ) ]=q{}^{\mu}
\]</span></p>
<p>since the box families transform as:</p>
<p><span id="eq-boxtrans"><span class="math display">\[
\Box'_{i,j,m,n}=(-1)^m(-1 )^n\Box_{j,i,-m,-n}.
\tag{5.35}\]</span></span></p>
<p>Thus we have that the cut integral with the <span class="math inline">\(\bar{q}_{}{}^{\mu}\)</span> factored out:</p>
<p><span class="math display">\[
\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\frac{1}{2}[(\Box_{1,1,1,-1}-\Box_{1,1,1,1} )+(\Box_{1,1,-1,1}-\Box_{1,1,-1,-1} ) ] .
\]</span></p>
<p>We can apply the relabelling only this time only for the last two integrands, and the integral becomes, applying <a href="#eq-boxtrans">eq.&nbsp;<span>5.35</span></a>:</p>
<p><span class="math display">\[
\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,\frac{1}{2}[(\Box_{1,1,1,-1}-\Box_{1,1,1,1} )+(\Box'_{1,1,-1,1}-\Box'_{1,1,-1,-1} ) ]= \int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,(\Box_{1,1,1,-1}-\Box_{1,1,1,1} )  .
\]</span></p>
<p>If we now add the box and cross box contributions from <a href="#eq-boxcross">eq.&nbsp;<span>5.31</span></a> we get:</p>
<p><span class="math display">\[
\int \,\tilde{\mathrm{d}}^{4}\bar{\ell}\,(\bcancel{\Box_{1,1,1,-1}}-\cancel{\Box_{1,1,1,1}} )+\cancel{\Box_{1,1,1,1}}-\bcancel{\Box_{1,1,1,-1}}  =  0.
\]</span></p>
<p>The classically divergent terms have cancelled leaving us with only the finite terms!</p>
<!-- [^5]: Here $\tw=\frac{\tm}{\hbar}$ is the wavenumber -->


<!-- -->

<div id="refs" class="references csl-bib-body" role="doc-bibliography" style="display: none">
<div id="ref-Hiida:1972xs" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">K. Hiida and H. Okamura, <em><a href="https://doi.org/10.1143/PTP.47.1743">Gauge <span>Transformation</span> and <span>Gravitational Potentials</span></a></em>, Progress of Theoretical Physics <strong>47</strong>, 1743 (1972).</div>
</div>
<div id="ref-Iwasaki:1971vb" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Y. Iwasaki, <em><a href="https://doi.org/10.1143/PTP.46.1587">Quantum <span>Theory</span> of <span>Gravitation</span> Vs. <span>Classical Theory</span>*): <span>Fourth-Order Potential</span></a></em>, Progress of Theoretical Physics <strong>46</strong>, 1587 (1971).</div>
</div>
<div id="ref-Neill:2013wsa" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">D. Neill and I. Z. Rothstein, <em><a href="https://doi.org/10.1016/j.nuclphysb.2013.09.007">Classical Spacetimes from the <span class="nocase">S-matrix</span></a></em>, Nuclear Physics B <strong>877</strong>, 177 (2013).</div>
</div>
<div id="ref-Bjerrum-Bohr:2013bxa" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">N. E. J. Bjerrum-Bohr, J. F. Donoghue, and P. Vanhove, <em><a href="https://doi.org/10.1007/JHEP02(2014)111">On-Shell Techniques and Universal Results in Quantum Gravity</a></em>, Journal of High Energy Physics <strong>02</strong>, 111 (2014).</div>
</div>
<div id="ref-Vaidya:2014kza" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">V. Vaidya, <em><a href="https://doi.org/10.1103/PhysRevD.91.024017">Gravitational Spin <span>Hamiltonians</span> from the <span>S</span> Matrix</a></em>, Physical Review D <strong>91</strong>, 024017 (2015).</div>
</div>
<div id="ref-Cachazo:2017jef" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">F. Cachazo and A. Guevara, <em><a href="https://doi.org/10.1007/JHEP02(2020)181">Leading <span>Singularities</span> and <span>Classical Gravitational Scattering</span></a></em>, <strong>02</strong>, 181 (2020).</div>
</div>
<div id="ref-Guevara:2017csg" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">A. Guevara, <em><a href="https://doi.org/10.1007/JHEP04(2019)033">Holomorphic <span>Classical Limit</span> for <span>Spin Effects</span> in <span>Gravitational</span> and <span>Electromagnetic Scattering</span></a></em>, Journal of High Energy Physics <strong>04</strong>, 033 (2019).</div>
</div>
<div id="ref-Damour:2016gwp" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">T. Damour, <em><a href="https://doi.org/10.1103/PhysRevD.94.104015">Gravitational Scattering, Post-<span>Minkowskian</span> Approximation and <span>Effective One-Body</span> Theory</a></em>, Physical Review D <strong>94</strong>, 104015 (2016).</div>
</div>
<div id="ref-Cheung:2018wkq" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">C. Cheung, I. Z. Rothstein, and M. P. Solon, <em><a href="https://doi.org/10.1103/PhysRevLett.121.251101">From <span>Scattering Amplitudes</span> to <span>Classical Potentials</span> in the <span>Post-Minkowskian Expansion</span></a></em>, Physical Review Letters <strong>121</strong>, 251101 (2018).</div>
</div>
<div id="ref-Kalin:2022hph" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">G. Kälin, J. Neef, and R. A. Porto, <em><a href="https://arxiv.org/abs/2207.00580">Radiation-<span>Reaction</span> in the <span>Effective Field Theory Approach</span> to <span>Post-Minkowskian Dynamics</span></a></em>, (2022).</div>
</div>
<div id="ref-Kalin:2019rwq" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">G. Kalin and R. A. Porto, <em><a href="https://doi.org/10.1007/JHEP01(2020)072">From Boundary Data to Bound States</a></em>, Journal of High Energy Physics <strong>01</strong>, 072 (2020).</div>
</div>
<div id="ref-Kalin:2019inp" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">G. Kalin and R. A. Porto, <em><a href="https://doi.org/10.1007/JHEP02(2020)120">From Boundary Data to Bound States. <span>Part II</span>. <span>Scattering</span> Angle to Dynamical Invariants (with Twist)</a></em>, Journal of High Energy Physics <strong>02</strong>, 120 (2020).</div>
</div>
<div id="ref-Kalin:2020mvi" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">G. Kälin and R. A. Porto, <em><a href="https://doi.org/10.1007/JHEP11(2020)106">Post-<span>Minkowskian Effective Field Theory</span> for <span>Conservative Binary Dynamics</span></a></em>, Journal of High Energy Physics <strong>11</strong>, 106 (2020).</div>
</div>
<div id="ref-Kosower:2018adc" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">D. A. Kosower, B. Maybee, and D. O’Connell, <em><a href="https://doi.org/10.1007/JHEP02(2019)137">Amplitudes, Observables, and Classical Scattering</a></em>, Journal of High Energy Physics <strong>02</strong>, 137 (2019).</div>
</div>
<div id="ref-Cristofoli:2021vyo" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">A. Cristofoli, R. Gonzo, D. A. Kosower, and D. O’Connell, <em><a href="https://doi.org/10.1103/PhysRevD.106.056007">Waveforms from Amplitudes</a></em>, Phys. Rev. D <strong>106</strong>, 056007 (2022).</div>
</div>
<div id="ref-Bern:2021xze" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[16] </div><div class="csl-right-inline">Z. Bern, J. P. Gatica, E. Herrmann, A. Luna, and M. Zeng, <em><a href="https://doi.org/10.1007/JHEP08(2022)131">Scalar <span>QED</span> as a Toy Model for Higher-Order Effects in Classical Gravitational Scattering</a></em>, arXiv:2112.12243 [Gr-Qc, Physics:hep-Th] <strong>08</strong>, 131 (2022).</div>
</div>
<div id="ref-Srednicki:2007" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[17] </div><div class="csl-right-inline">M. A. Srednicki, <em>Quantum Field Theory</em> (<span>Cambridge University Press</span>, <span>Cambridge ; New York</span>, 2007).</div>
</div>
<div id="ref-Coleman:2018a" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[18] </div><div class="csl-right-inline">S. Coleman, <em><a href="https://doi.org/10.1142/9371">Lectures of <span>Sidney Coleman</span> on <span>Quantum Field Theory</span></a></em> (<span>WSP</span>, <span>Hackensack</span>, 2018).</div>
</div>
<div id="ref-Lehmann:1954rq" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[19] </div><div class="csl-right-inline">H. Lehmann, K. Symanzik, and W. Zimmermann, <em><a href="https://doi.org/10.1007/BF02731765"><span>Zur Formulierung quantisierter Feldtheorien</span></a></em>, Il Nuovo Cimento (1955-1965) <strong>1</strong>, 205 (1955).</div>
</div>
<div id="ref-Collins:2019ozc" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[20] </div><div class="csl-right-inline">J. Collins, <em><a href="https://arxiv.org/abs/1904.10923">A New Approach to the <span>LSZ</span> Reduction Formula</a></em>, (2019).</div>
</div>
<div id="ref-tHooft:1972tcz" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[21] </div><div class="csl-right-inline">G. ’t Hooft and M. Veltman, <em><a href="https://doi.org/10.1016/0550-3213(72)90279-9">Regularization and Renormalization of Gauge Fields</a></em>, Nuclear Physics B <strong>44</strong>, 189 (1972).</div>
</div>
<div id="ref-Bern:2019crd" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[22] </div><div class="csl-right-inline">Z. Bern, C. Cheung, R. Roiban, C.-H. Shen, M. P. Solon, and M. Zeng, <em><a href="https://doi.org/10.1007/JHEP10(2019)206">Black Hole Binary Dynamics from the Double Copy and Effective Theory</a></em>, Journal of High Energy Physics <strong>10</strong>, 206 (2019).</div>
</div>
<div id="ref-Nogueira:1993a" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[23] </div><div class="csl-right-inline">P. Nogueira, <em><a href="https://doi.org/10.1006/jcph.1993.1074">Automatic <span>Feynman Graph Generation</span></a></em>, Journal of Computational Physics <strong>105</strong>, 279 (1993).</div>
</div>
<div id="ref-Bezanson:2015" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[24] </div><div class="csl-right-inline">J. Bezanson, A. Edelman, S. Karpinski, and V. B. Shah, <em><a href="https://arxiv.org/abs/1411.1607">Julia: <span>A Fresh Approach</span> to <span>Numerical Computing</span></a></em>, arXiv:1411.1607 (2015).</div>
</div>
<div id="ref-Paton:1969" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[25] </div><div class="csl-right-inline">K. Paton, <em><a href="https://doi.org/10.1145/363219.363232">An Algorithm for Finding a Fundamental Set of Cycles of a Graph</a></em>, Communications of the ACM <strong>12</strong>, 514 (1969).</div>
</div>
<div id="ref-Vermaseren:2000nd" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[26] </div><div class="csl-right-inline">J. A. M. Vermaseren, <em><a href="https://arxiv.org/abs/math-ph/0010025">New Features of <span>FORM</span></a></em>, (2000).</div>
</div>
<div id="ref-Kuipers:2012rf" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[27] </div><div class="csl-right-inline">J. Kuipers, T. Ueda, J. A. M. Vermaseren, and J. Vollinga, <em><a href="https://doi.org/10.1016/j.cpc.2012.12.028"><span>FORM</span> Version 4.0</a></em>, Comput. Phys. Commun. <strong>184</strong>, 1453 (2013).</div>
</div>
<div id="ref-Kruskal:1956" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[28] </div><div class="csl-right-inline">J. B. Kruskal, <em><a href="https://doi.org/10.1090/S0002-9939-1956-0078686-7">On the Shortest Spanning Subtree of a Graph and the Traveling Salesman Problem</a></em>, Proceedings of the American Mathematical Society <strong>7</strong>, 48 (1956).</div>
</div>
<div id="ref-Anastasiou:2004" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[29] </div><div class="csl-right-inline">C. Anastasiou and A. Lazopoulos, <em><a href="https://doi.org/10.1088/1126-6708/2004/07/046">Automatic <span>Integral Reduction</span> for <span>Higher Order Perturbative Calculations</span></a></em>, Journal of High Energy Physics <strong>2004</strong>, 046 (2004).</div>
</div>
<div id="ref-Smirnov:2020" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[30] </div><div class="csl-right-inline">A. V. Smirnov and F. S. Chukharev, <em><a href="https://doi.org/10.1016/j.cpc.2019.106877"><span>FIRE6</span>: <span>Feynman Integral REduction</span> with <span>Modular Arithmetic</span></a></em>, Computer Physics Communications <strong>247</strong>, 106877 (2020).</div>
</div>
<div id="ref-Maierhofer:2018" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[31] </div><div class="csl-right-inline">P. Maierhöfer and J. Usovitsch, <em><a href="https://arxiv.org/abs/1812.01491">Kira 1.2 <span>Release Notes</span></a></em>, arXiv:1812.01491 [Hep-Ph] (2018).</div>
</div>
<div id="ref-Anastasiou:2002yz" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[32] </div><div class="csl-right-inline">C. Anastasiou and K. Melnikov, <em><a href="https://doi.org/10.1016/S0550-3213(02)00837-4">Higgs Boson Production at Hadron Colliders in <span>NNLO QCD</span></a></em>, Nuclear Physics B <strong>646</strong>, 220 (2002).</div>
</div>
<div id="ref-Anastasiou:2002qz" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[33] </div><div class="csl-right-inline">C. Anastasiou, L. Dixon, and K. Melnikov, <em><a href="https://doi.org/10.1016/S0920-5632(03)80168-8"><span>NLO Higgs</span> Boson Rapidity Distributions at Hadron Colliders</a></em>, Nuclear Physics B - Proceedings Supplements <strong>116</strong>, 193 (2003).</div>
</div>
<div id="ref-Anastasiou:2003yy" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[34] </div><div class="csl-right-inline">C. Anastasiou, L. Dixon, K. Melnikov, and F. Petriello, <em><a href="https://doi.org/10.1103/PhysRevLett.91.182002">Dilepton <span>Rapidity Distribution</span> in the <span>Drell-Yan Process</span> at <span class="nocase">Next-to-Next-to-Leading Order</span> in <span>QCD</span></a></em>, Physical Review Letters <strong>91</strong>, 182002 (2003).</div>
</div>
</div>
</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./gwwfframeworks.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Waveform Generation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conclusion.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<pre class="markdown" data-shortcodes="false"><code>---
editor:
      render-on-save: true
---
# Scattering amplitudes and (?:gw)s {#sec-scat}


::: {.content-hidden unless-format="html"}


{{&lt; include latexmacros.tex &gt;}}
\newcommand{\sumint}{\int\mathllap{\sum}}

:::



Whilst we have almost no hope to detect any (?:gw) scattering events with current experimental apparatuses, the scattering formalism can still be very useful in the quest for orbital waveforms. Most importantly, while experimental data has not been driving *gravitational* scattering theory, the interplay between *particle* scattering experiment and theory have been an enormously fruitful endeavor for the understanding of fundamental interactions in (?:hep). The back and forth between precise measurements (such as those conducted at the (?:lhc) ) and precise predictions for particle scattering, has pushed the boundaries of the calculations possible. It would be therefore very beneficial if one could apply the large knowledge acquired for small non-gravitationally interacting particles, to large compact orbiting bodies. We will see that it is indeed the case.

Such techniques including (?:eft), double copy, generalized unitarity, (?:ibp) reduction, differential equations methods, developed in the context of perturbative computations of collider observables now find an application to the scattering problem in gravity. A key part of applying tools originally developed for quantum systems to problems in gravity is controlling the classical limit, a historically difficult endeavor. Once scattering data is obtained one needs to extract the relevant observables. This may be in an effort to compare results from the different methods, in which case gauge and diffeomorphism, and lorentz invariance are key, since different methods make different gauge and frame choices. It can also be to extract the relevant information for detection and data extraction, in which case the (?:gw) waveform is the relevant observable. In the latter case one is mostly interested in the orbital waveform, and thus a map from unbound to bound orbits is necessary. 

Multiple formalisms have arisen to map the scattering problem to an orbital one, and the quantum formalism to a classical one. One key way is to map scattering data to a potential (as present in a Hamiltonian for example). In fact this has been developped as early as the 1970s in [@Hiida:1972xs;@Iwasaki:1971vb]. Further developments happened in [@Neill:2013wsa;@Bjerrum-Bohr:2013bxa;@Vaidya:2014kza;@Cachazo:2017jef;@Guevara:2017csg;@Damour:2016gwp]. Here we will follow the treatment in [Cheung, Rothstein, and Solon @Cheung:2018wkq], where the conservative part of such scattering amplitudes is matched to an (?:eft) and subsequently to mapped to a potential. Recent efforts to add dissipative effects have also been successful [see @Kalin:2022hph]. This potential can then be used as input to the (?:eob) formalism. Furthermore, [Kalin and Porto @Kalin:2019rwq; @Kalin:2019inp], have shown a path forward in directly extending unbound data to bound orbits, obviating the need to use a potential and (?:eob) at all. 

Finally, as mentioned in the last chapter, scattering can stand on its own and still be usefull without being extended to the orbital case. The (?:pm) approximation can be computed from scattering amplitudes in an (?:eft) framework [@Kalin:2020mvi]. We can also explore the classical observables possible in scattering scenarios. This has been developped in @Kosower:2018adc and was extended to local observables^[local as in not time integrated and thus presenting time dependent dynamics] such as waveforms  in @Cristofoli:2021vyo.


In this chapter we will first look at how to use amplitude data to extract orbital and scattering waveforms. We will then look at the (?:kmoc) formalism to directly extract observables. Finally we will look at how to compute amplitudes, and comparing to results such as those in [@Kosower:2018adc; @Bern:2021xze].

## Scattering amplitudes {#sec-scatamp}     

In (?:qft), to date the only way to encode scattering data is through a scattering amplitude. Consider a process where one starts out with a set of particles described by a state $\ket{i}$, that interact, and yield a final state $\ket{f}$. The scattering amplitude is then defined as the probability amplitude for this process to occur. It is simply given by 
$$\mel{i}{\Smat-1}{f}=(2\pi)^4 \deltafn[(4)]{p_f-p_i}\im \ampl_{fi},$$

where $\Smat$ is the S-matrix, encoding asymptotic time evolution, $\Smat=U_t(-\infty,+\infty)$. We subtract the identity from it, forming what some call the transfer matrix $\Tmat$, as we only are interested in processes where something happens (i.e. not everything stays the same). In the above equation we also define the *scattering matrix element* $\ampl_{fi}$ [see @Srednicki:2007, p. 76] or *invariant Feynman amplitude* [see @Coleman:2018a, p.214], by factoring out a normalised spacetime delta-function that impose the conservation of momentum on the external particles, and a complex unit. The computation of $\ampl$ is made possible by the (?:lsz) [@Lehmann:1954rq;@Collins:2019ozc] formalism, which relates $\ampl_{fi}$ to time-ordered correlation functions (also known as Green's functions) of the given QFT. Green's functions, can be expanded as an infinite sum of diagrams, weighted by a small coupling. The diagrams encode integrals that are obtained by applying Feynman rules which can be readily extracted from an action describing the theory. 

## From amplitude to potential {#sec-amp2pot}

Let us now look at how to map the amplitude to the gravitational potential within the (?:eob) formalism. We will follow the treatment in @Cheung:2018wkq. We start by defining the effective theory that describes our problem: thi orbiting bodies are described by two scalar fields $\wf[1]$ and $\wf[2]$ with masses $\mass[1]$ and $\mass[2]$ interacting through a long range potential $V(r)$. It is the (?:eft) for  non-relativistic fields. This (?:eft) is described by the following action

$$
\action=\int \dd{t} \lag[kin]+\lag[int],
$$

where the kinetic term is given by:

$$
\begin{aligned}
\lag[kin]=&amp;\int \dn[\small \Dim-1]{\tv{k}} \cwf[1](-\tv{k}) \pa[\Big]{\im \partialder[t]-\sqrt{\tv{k}^2+\mass[1]} }\wf[1](\tv{k}),
\\
&amp;+\int \dn[\small \Dim-1]{\tv{k}} \cwf[2](-\tv{k}) \pa[\Big]{\im \partialder[t]-\sqrt{\tv{k}^2+\mass[2]} }\wf[2](\tv{k}),
\end{aligned}
$$

and the interaction term is given by

$$
\lag[int]=  -\int \dn[\small \Dim-1]{\tv{k}} \dn[\small \Dim-1]{\tv{k'}} \pot(\tv{k},\tv{k'}) \cwf[1](\tv{k'}) \cwf[2](-\tv{k'}) \wf[1](\tv{k}) \wf[2](- \tv{k}).
$$

This theory is obtained from the full one by integrating out all the massless force carriers , which are consequently encoded in the potential $\pot(\tv{k},\tv{k'})$ and taking the non-relativistic limit $\abs{\tv{k}},\abs{\tv{k'}}\ll \mass[1,2]$. In a classical system we assume the particles to be separated by a minimum distance, called impact parameter $\abs{\tv{\impactParameter}}$, and consider that their Compton wavelength $\comptlen\sim\inv{\abs{\tv{k}}},\inv{\abs{\tv{k'}}}$^[Note the use of natural units.] is much smaller than this separation,

$$
\abs{\tv{\impactParameter}}\ll \comptlen \simeq \inv{\abs{\tv{k}}},\inv{\abs{\tv{k'}}}.
$$
 
This ensures that the particles are not interacting quantum mechanically in any significant way. Interestingly this hierarchy of scales can be rewritten as:

$$
\tv{J}\sim\abs{\tv{k}\times\tv{\impactParameter}}\gg 1.
$$

Thus, any two body classical system has large angular momentum. We can extract the classical part of any quantity by taking the (?:lo) contribution in the inverse of the angular momentum, or equivalently:

$$
  \inv{J} \propto \inv{\abs{\impactParameter}} \sim \abs{\tv{k}-\tv{k'}}\propto \inv{\kappa},
$$ {#eq-invang}

where $\kappa$ is the coupling constant, which in the case of gravity is $\kappa=4\pi\grav$. For the first relation we used that angular momentum is proportional to separation. We then applied the fact that in scattering scenarios the impact parameter is proportional to the inverse of the momentum transfer  $\sim\inv{\abs{\tv{q}}}$ where :

$$
q=(0,\tv{q})=(0,\tv{k}-\tv{k'}).
$$

The last relation in @eq-invang holds due to the virial theorem. Since the potential must encode the coulomb potential $\kappa/\abs{\tv{k}-\tv{k'}}^2\propto J^3$, it must scale similarly. We thus formulate the following ansatz for the potential:
$$
\pot(\tv{k},\tv{k'})=\sum_{n=1}^\infty \frac{\kappa^n}{\abs{\tv{k}-\tv{k'}}^{\Dim-1-n}} c_n\pa[\Big]{\frac{\tv{k}^2+\tv{k'}^2}{2}}
$${#eq-ansatzpot}

Note that higher order terms in the potential could be formed by any polynomial of momentum invariants $\tv{k}^2$, $\tv{k'}^2$, and $\tv{k}\cdot\tv{k'}$. However, not all combinations of these are independent. The ansatz is chosen such that only the variables $\abs{\tv{k}-\tv{k'}}$ and $\tv{k}^2+\tv{k'}^2$ are present, as the others can be reabsorbed by field redefinitions, or vanish on-shell, such as $\tv{k}^2-\tv{k'}^2$. Note as-well that we work in $\Dim=4-2\dimreg$ dimensions such that the integrals are dimensionally regulated [see @tHooft:1972tcz]. In particular an $\dimreg$-power corresponds to a logarithm^[The third term in the sum is given by $\coupling^3\ln{\tv{k}-\tv{k'}}^2 c_3\pa[\Big]{\Half{\tv{k}^2+\tv{k'}^2}}$.]. Finally, note that in gravity this is precisely a (?:pm) expansion! 


### EFT amplitude 

The first step in establishing determining the potential from a generic scattering amplitude computed in the full theory is to compute the amplitude in the (?:eft). We first identify the Feynman rules from the action. The kinetic term encodes the propagator: 

quarto-executable-code-5450563D

```julia
#| echo: false
#| eval: false
#| output: false
#| fig-align: center
using TikzPictures

tp = TikzPicture(L"""
\matrix 
{    \draw[line width=.3mm,-&gt;-=.5,bicolor={red}{blue}] (-1.5,0)  --  (1.5,0) node[midway,above,color=black]{$\displaystyle(k_0,\mathbf{k})$}; &amp;
    \node{$=$}; &amp;
    \node {$\displaystyle\frac{\im}{k_0-\sqrt{\mathbf{k}^2+m_{\textcolor{red}{1}, \textcolor{blue}{2}}^2}+\im 0},$}; \\
  };"""
, options="thick, transform shape",preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings}\\input{../latexmacros.tex}\\usepackage{xcolor}")
save(PDF("./tikz/propagator.pdf"), tp)
save(TEX("./tikz/propagator"; limit_to=:picture), tp)
tp
```

![Propagator rule](tikz/propagator){#fig-propagator}




where the $\im 0$ is the Feynman prescription for avoiding the poles. The interaction term is encoded in the vertex


quarto-executable-code-5450563D

```julia
#| echo: false
#| eval: false
#| output: false 
#| fig-align: center 
using TikzPictures

tp = TikzPicture(L"""


\matrix 
{    \graph[nodes=coordinate, empty nodes,spring layout,horizontal=i1 to o1,anchor node=a] 
{
  {i1} --[-&gt;-=.5,thick,"$\displaystyle \mathbf{k}$" font=\large,red]  a[circle,fill,scale=.6] --[-&gt;-=.6,thick,"$\displaystyle \mathbf{k'}$" {font=\large},red] o1;
  i2 --[-&gt;-=.5,thick,"$\displaystyle -\mathbf{k}$" {font=\large, below,yshift=-5},blue]  a --[-&gt;-=.6,thick,"$\displaystyle  - \mathbf{k'}$"  {font=\large, below,yshift=-5,xshift=-5},blue] o2;
};
&amp;
    \node{$=$}; &amp;
    \node {$\displaystyle\im V(\mathbf{k},\mathbf{k'}).$}; \\
  };"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")
save(PDF("./tikz/vertex.pdf"), tp)
save(TEX("./tikz/vertex"; limit_to=:picture), tp)
tp
```

![Vertex rule](tikz/vertex){#fig-vertex} 

The expression for the (?:eft) amplitude will contain the coefficient functions from @eq-ansatzpot since they will be present as vertex terms. Particle number must be conserved in the non-relativistic limit ^[As pair production is kinematically forbidden.], so the amplitude is a sum of bubble diagrams:

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
\matrix{
      \node{$\ampl_\text{EFT}$};&amp;
      \node{$=$};&amp;
      \graph[nodes=coordinate, empty nodes,spring layout,horizontal=i1 to o1,anchor node=a]{
            {i1} --[-&gt;-=.5,thick,blue]  a[circle,fill,scale=.6]  --[-&gt;-=.6,thick,blue] o1;
            i2 --[-&gt;-=.5,thick,red]  a --[-&gt;-=.6,thick,red] o2;};&amp;
      \node{$+$}; &amp;
      \graph[nodes=coordinate, empty nodes,spring layout,horizontal=a to d,anchor node=a]{
            {i1} --[-&gt;-=.5,thick,blue]  a[circle,fill,scale=.6] --[-&gt;-=.6,thick,blue,bend left=90] d[circle,fill,scale=.6] --[-&gt;-=.6,thick,red] o1;
            i2 --[-&gt;-=.5,thick,red]  a --[-&gt;-=.6,thick,red,bend right=90] d --[-&gt;-=.6,thick,blue] o2;};&amp;
      \node{$+$}; &amp;
      \graph[nodes=coordinate, empty nodes,spring layout,horizontal=a to d,horizontal=i1 to o1,anchor node=a]{
            {i1} --[-&gt;-=.5,thick,blue]  a[circle,fill,scale=.6] --[-&gt;-=.6,thick,blue,bend left=90] d[circle,fill,scale=.6]--[-&gt;-=.6,thick,blue,bend left=90] c[circle,fill,scale=.6] --[-&gt;-=.6,thick,blue] o1;
            i2 --[-&gt;-=.5,thick,red]  a --[-&gt;-=.6,thick,red,bend right=90] d--[-&gt;-=.6,thick,red,bend right=90] c --[-&gt;-=.6,thick,red] o2;};&amp;
      \node{$+$}; &amp;
      \graph[nodes=coordinate, empty nodes,spring layout,horizontal=i1 to o1,horizontal=a to b,anchor node=a]{
            {i1} --[-&gt;-=.5,thick,red]  a[circle,fill,scale=.6] --[-&gt;-=.6,thick,blue,bend left=90] b[circle,fill,scale=.6] --[-&gt;-=.6,thick,blue,bend left=90] c[circle,fill,scale=.6] --[-&gt;-=.6,thick,blue,bend left=90] d[circle,fill,scale=.6] --[-&gt;-=.6,thick,red] o1;
            i2 --[-&gt;-=.5,thick,blue]  a --[-&gt;-=.6,thick,red,bend right=90] b --[-&gt;-=.6,thick,red,bend right=90] c --[-&gt;-=.6,thick,red,bend right=90] d --[-&gt;-=.6,thick,blue] o2;};&amp;
      \node{$+$};&amp;
      \node{$\cdots$};
      \\
};"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(PDF("./tikz/eftampl.pdf"), tp)
save(TEX("./tikz/eftampl"; limit_to=:picture), tp)
tp
```

![EFT amplitude](./tikz/eftampl){#fig-eftampl}


We can consequently neatly organise the amplitude into a sum of terms with specific loop counts. We can also equivalently organise it into a sum of terms with specific $\coupling$ powers. We write,

$$\ampl_\text{EFT}=\sum\limits_{L=0}^\infty\ampl[L\text{loop}]_\text{EFT}=\sum\limits_{i=1}^\infty \ampl[(i)]_\text{EFT}.$$

 Notably, these partitions do not line up for the (?:eft) since the vertex contains all powers of the coupling. This is in contrast to the full theory where in fact they yield the same partition. We will eventually want to partition over the coupling power to compare the full theory.

Since every cut of the diagrams contributing to $\ampl_\text{EFT}$ contains two propagators it is useful to define a 2-body propagator. We can integrate over the energy components of the loop momentum, since the vertex does not have an energy dependence:^[The 4-momentum conservation at each vertex means that the energy components of the two propagating momenta must carry along the energy component of the initial state $\energy=\energy[1]+\energy[2]$. This can be encoded by demanding that $\omega_1+\omega_2=\energy$.  Taking the (?:com) frame for the intial momenta means that the 3 momenta of each propagator must cancel i.e. $\tv[1]{k}+\tv[2]{k}=0$]


$$\im \proptwobody{\tv{k}}=\int \dn{\omega} \frac{\im}{\omega-\sqrt{\tv{k}^2+m_1^2}}\frac{\im}{\energy-\omega-\sqrt{\tv{k}^2+m_2^2}}=\frac{\im}{\energy-\sqrt{\tv{k}^2+\mass[1]^2}-\sqrt{\tv{k}^2+\mass[2]^2}},$$

where the integral is performed using the residue theorem, closing the contour in either half plane, where in either case a pole is present. We have define $\energy=\energy[1]+\energy[2]$ to be the (?:com) energy of the  two inital states:^[which is equal to the outgoing energy]

$$
\energy[i]=\sqrt{\tv{p}^2+\mass[i]^2}=\sqrt{\tv{p'}^2+\mass[i]^2},
$$

where $\tv{p}$ and $\tv{p'}$ are the initial and final three-momenta of the two states ^[For example in the initial state one scalar field will have 3-momentum $\tv{p}$, and the other $-\tv{p}$] in the (?:com) frame. Finally, we can write the diagram at loop level $L&gt;0$ encodes:

$$ 
\ampl[L\text{loop}]_\text{EFT}= \int\prod\limits_{i=1}^L  \dn[\small \Dim-1]{\tv[i]{k}} \pot(\tv{p},\tv[1]{k})\proptwobody{\tv[1]{k}}\cdots\proptwobody{\tv[L]{k}}\pot(\tv[L]{k},\tv{p'}).
$$

This integral can be performed in the non-relativistic limit, as done by [Bern et al. @Bern:2019crd] up to 3(?:pm). Up to 2(?:pm), the amplitudes of the (?:eft) is:^[Here the repartioning mentioned above has been applied and a change in loop momenta: $\tv[i]{k}\to\tv{p}+\tv[i]{\ell}$.] 

$$
\begin{aligned}
\ampl[(1)]_\text{EFT}&amp;=-\frac{4\pi\grav c_1}{\tv{q}^2},\\
\ampl[(2)]_\text{EFT}&amp;= \pi^2\grav^2 \Big(-\frac{2 c_2}{\abs{\tv{q}}}+\inv{\energy \redEratio \abs{\tv{q}}}\brc[\Big]{(1-3\redEratio)c_1^2+4\redEratio^2\energy^2c_1 c'_1}\\
                  &amp; \int \dn[\Dim-1]{\tv{\ell}}\frac{32\energy\redEratio c_1^2}{\tv{\ell}^2(\tv{q}+\tv{\ell})^2(\tv{\ell}^2+2\tv{p}\tv{\ell})}\Big),
\end{aligned}
$$

where $\redEratio=\frac{\energy[1]\energy[2]}{\pa{\energy[1]+\energy[2]}^2}$ is the reduced energy ratio. The arguments of the coefficient functions $c_1$ are kept implicit and a prime denotes a derivative with respect to $\tv{\emom}$. Additionally, we defined $\tv{q}=\tv{p'}-\tv{p}$ to be the 3-momentum transfer. 

The key point is that the matching procedure requires the EFT amplitude for two-to-two scattering to be equal to the full amplitude at every order in the coupling constant $\coupling$, i.e. provided we obtain the amplitude of the full theory, and carefully apply the same limiting procedures, we impose that

$$
\ampl[(i)]_\text{EFT}=\ampl[(i)]_\text{full} \quad \forall i.
$$

which fixes the coefficients in the potential ansatz @eq-ansatzpot, and fullfils the promised map from amplitude to potential. Importantly, we must apply the limiting procedure applied above, i.e. the classical and non relativistic limit, which is summarised by the following heirarchy of scales:

$$
\mass[1],\mass[2]\ll J \abs{\tv{q}} \ll \abs{\tv{q}}.
$$

In the full theory this hierarchy is equivalent to restricting to a specific kinematic regime, following the method of regions. We consider all the possible loop-momentum scalings, first due to the classical limit:


| Region | Momentum $\ell = (\omega,\tv{\ell})$ |
| -----: | :----------------------------------: |
|   hard |               $(m,m)$                |
|   soft |  $(\abs{\tv{\tm}},\abs{\tv{\tm}})$   |

In this language, the soft region is responsible for the classical limit, since we consider a small $\abs{\tv{\tm}}$ expansion. We will infact explore this expansion in a different light in @sec-kmoc. Taking the (?:nr) limit corresponds to a subregion of the soft region, the so-called potential region:

$$ (\omega,\tv{\ell})\sim (\abs{\tv{\vel}}\abs{\tv{\tm}},\abs{\tv{\tm}}),$$

where we use that the (?:nr) expansion is a given by $$\abs{\tv{\emom}}\ll m$$ and thus equivalently^[dividing by mass] by a small relative velocity:

$$ \abs{\tv{\vel}}\ll1.$$

To summarise, in order to obtain the form of the potential, we first compute the amplitude in an (?:eft), absorbing all force carrying particles into an effective vertex. Making an ansatz for the potential we can compute the amplitude in the non-relativistic limit in terms of unknown coefficients. This same amplitude can be computed in the full theory, which, as a consequence of the limiting procedure, has simplified kinematic dependence.  The coefficients of the (?:eft) amplitude are then determined by matching it order by order with the full amplitude.

Unfortunately, the procedure described above, and in fact *any* procedure trying to make contact with (?:eob) by expanding the gravitiational potential, intrinsically does not capture the full physics. The crucial point that makes compact binaries interesting is that they are not isolated, energy conserving systems. The energy of the system is lost to the gravitational waves that enable us to detect them. Any conservative dynamics, by construction, cannot capture this loss of energy. In the context of (?:eob), this radiation reaction was added after the fact, through direct modifications of the (?:eom)s obtained from Hamilton's equations. It is not clear how to incorporate dissipative data from the amplitude in the (?:eob) framework. 

One way to not encounter this difficulty is to fully bypass the (?:eob) framework and try to obtain observables directly from the amplitude. This is the subject of the following sections. 








## (&gt;:kmoc) framework {#sec-kmoc}

The (&gt;&gt;&gt;:kmoc) framework (@Kosower:2018adc) is very general, and is aimed at taking the classical limit of a scattering event in an unspecified theory. We will apply it later on  to (?:sqed) and gravity. 

### Conventions

First let us define our conventions. Throughout this section we use relativistically natural units, i.e. we do *not* set $\hbar=1$. This will essentially be the small parameter that multiplies the soft momenta that defined the region in @sec-amp2pot. In this section we will further motivate this classical limit in more detail by taking the generally accepted limit that makes quantum physics collapse to classical physics

$$\hbar\to0.$$ 

We still retain $c=1$, meaning that, using dimensional analysis we have that $[L][T]^{-1}=1$ i.e. $[L]=[T]$,  length and time are measured in the same units. Correspondingly, energy is measured in units of mass
$$
\energy=mc^2\implies[\energy]=[m]=[M],
$$ 

and $\hbar$ has the following units

$$
\energy=\hbar \omega\implies [M]=[\hbar][T]^{-1}\implies [\hbar]=[T][M]
.$$ 

Thus momentum $\emom$ has units of $[\emom]=[M]$ mass and Wavenumber $[\bar{\emom}]=[\frac{\emom}{\hbar}]=[T]^{-1}$ has units of inverse time. 
We will denote the Lorentz-invariant phase space measure by $\ddP{p}$^[Repeated integration will be denoted $\ddP[n]{p_1,\dots,p_n}$]:

$$
\int \ddP{p} \dots      = \int \frac{\dd[3]{\tv{p}}}{2\hbar\shellen (2\pi)^3} \dots = \int \dn[4]{p}\nposendelta[-m^2]{p} \dots,
$$

where quantities denoted by bars absorb the relevant factors of $2\pi$, such that $\dn[n]{p}=\frac{\dd[n]p}{(2\pi)^n}$. Additionally, we have defined $\hbar\shellen=\sqrt{\tv{p}^2+m^2}$ to be the on-shell energy and  $\delta^{(+)}$ is the normalised positive energy on-shell delta function:

$$
\nposendelta[-m^2]{p}=(2\pi)\deltafn{\lv{p}^2-m^2}\thetafn{\ct[0]{p}}=\ndeltafn{\lv{p}^2-m^2}\thetafn{\ct[0]{p}}
$$

### Intital State

With our conventions at hand, let us set the stage for the problem. Imagine we want to scatter two particles, be they massive black holes, or tiny electrons, into each other, with a constant particle number (i.e. a classical two in two out scattering). As mentioned in @sec-scatamp, in (?:qft) the framework that formalizes scattering of definite particle number states is based on the (?:lsz) reduction formula. 

[we work in the Heisenberg picture here]{.aside}

Let us look at it in more detail. The first step is to define the states we want to scatter. Suppose our theory has single particle states $\momket$, with mass $\mass$, eigenstates of the momentum:

$$\ct{\momop}\momket=\ct{\emom}\momket \quad \text{with} \quad p^0=\hbar\shellen=\sqrt{\tv{\emom}^2+\mass^2}.$$

These states can be seen as special cases (the plane wave states) of wavepacket states:^[A plane wave state $\ket{f}=\momket$ would be given by $\shellft{f}(k)=2 \hbar\shellen[\tv{k}]  \ndeltafn[(3)]{\tv{k}-\tv{p}}$]

$$\ket{f}=\int \ddP{k} \shellft{f}(k) \momket[k],$$

where $\shellft{f}(k)$ is the momentum space wavefunction or, more mathematically, the momentum distribution function. Note that it is almost a Fourier transform, but not quite, as it is performed on the mass shell. If the spacetime 'wavefunction' ^[Note that the concept of coordinate space wavefunction is ill defined in interacting theories. However for such asymptotic states, the wavefunction outside the bulk (on the infinte time boundary) is that of a free wavefunction.] is given by

$$f(x)=\int \ddP{k} \shellft{f}(k) \exp{-\im\lv{k}\cdot\lv{x}},$${#eq-spacetimewf}

so that $\shellft{f}(k)$ is consequently given by

$$\ip{k}{f}=\shellft{f}(k)= 2 \hbar\shellen \int \dd[3]{\tv{x}}f(x) \exp{\im k\cdot x}.$${#eq-momdist}


If we now define the following operators^[$f\lrder g=f\pa{\partialder[\mu]g}-\pa{\partialder[\mu]f}g$]
^[
Note that if we replace $f(x)$ by a plane wave state  $\exp{-\im k\cdot x}$ we obtain and define the following:

$$
\createop[\tv{k}](t)=  \int \dd[3]{\tv{x}} \exp{-\im k\cdot x} \brc[\Big]{\hbar\shellen[\tv{k}]\wf(x)-\im \partialder[0]\wf(x)},
$$

$$
\annihilop[\tv{k}](t)=   \int \dd[3]{\tv{x}} \exp{\im k\cdot x} \brc[\Big]{\hbar\shellen[\tv{k}]\wf(x)+\im \partialder[0]\wf(x)},
$$

]

$$
\createop[f](t)= -  \im \int \dd[3]{\tv{x}}f(x) \lrder[0] \scf(x),
$$

$$
\annihilop[f](t)=   \im \int \dd[3]{\tv{x}}\conj{f}(x) \lrder[0] \scf(x),
$$

where $\scf(x)$ is the Heisenberg field operator of our theory. While these operators are time dependent, this dependence is not obtained from applying the Heisenberg (?s:eom) ^[$\odv{A_H(t)}{t}=\im\com{H_H}{A_H(t)}$], instead it is present through the time dependence of the wavefunction $f(x)$. It turns out that these operators, suggestively written are the true creation and annilihation operators in the interacting theory. 

We can now define a general one particle state $\ket{f}$ as the result of a creation operator acting on the physical vacuum. Crucially, this only makes sense in the boundary of the bulk, i.e. at asymptotic times $t\to\pm\infty$^[See @Coleman:2018a or @Collins:2019ozc for a more in depth discussion of this point]. Inside the bulk, any thusly created state would infact not have definite particle number. This definitely makes sense in the scattering problem because if you consider the whole system as a state, it only has definite particle number at asymptotic times, and inside the bulk the scattering happens, and the particle number is not conserved (at least quantum mechanically). 

Consequently, we only define asymptotic states, denoting them by an $\text{in}$ subscript if they were created at $t\to-\infty$ and $\text{out}$ if they were created at $t\to+\infty$:

$$ 
\ket[in]{f}\defeq\lim_{t\to-\infty}\createop[f](t)\physvack=\createop[f;\text{in}]\physvack=\int \ddP{k} \shellft{f}(k) \underbracket{\createop[\tv{k}]\physvack}_{\momket[k]}
$$

and the corresponding $t \to +\infty$ state where in is replaced with out. It turns out that the extension to multiparticle states is not much more complicated. The one thing to demand is that the momentum distributions say $\shellft{f_1},\shellft{f_2},\dots$ have no common support, i.e. they are not overlapping. In this case an n-particle in state is defined as: 

$$
\ket[in]{f_1,\dots,f_n}\defeq\createop[f_1;\text{in}]\createop[f_2;\text{in}]\dots\createop[f_n;\text{in}]\physvack=\int \ddP[n]{k_1,\dots,k_n} \shellft{f_1}(k_1)\dots\shellft{f_n}(k_n) \momket[k_1,\dots,k_n]. 
$$

We now have the definitions for asymptotic in and out states for any number of particles. Before defining the setup to scatter two particles, let us look at the meaning of the position space wavefunction $f(x)$ as defined in @eq-spacetimewf. Consider a sharply peaked, compactly supported momentum distribution $\shellft{f}(k)$ around a value $\tv[0]{p}$ and a characteristic width $\Delta p$. One such function could be:

$$
f\pa{\tv{p} ; \tv[0]{p}, \Delta p}=\left\{\begin{array}{ll}
N \exp{-1 /\pa{1-\abs{\tv{p}-\tv[0]{p}}^2 / \Delta p^2}} &amp; \text { if }\abs{\tv[0]{p}-\tv{p}}&lt;\Delta p \\
0 &amp; \text { if }\abs{\tv[0]{p}-\tv{p}} \geq \Delta p
\end{array}\right.,
$${#eq-peak}



where $N$ is a normalization constant. The integrand in @eq-spacetimewf, at large $t$ or $\tv{x}$, will be dominated by the stationary phase point $\tv[s]{p}$ which is given by:^[This then means that $$\tv[s]{p}=\frac{\mass\tv{x}\sign{t}}{\sqrt{t^2-\tv{x}^2}}$$ thus $$\hbar\shellen[{\tv[s]{p}}]=\frac{\mass\abs{t}}{\sqrt{t^2-\tv{x}^2}}$$]

$$0=-\pdv{}{\tv[s]{p}}\pa{\hbar\shellen[{\tv[s]{p}}]t+\tv[s]{p}\cdot\tv{x}}=-\frac{\tv[s]{p}t}{\hbar\shellen[{\tv[s]{p}}]}+\tv{x}.
$${#eq-stationaryphase}

In the case of a sharply peaked momentum distribution, the coordinate space wavefunction will be largest when the stationary phase point is the same as the peak of the momentum distribution, i.e. $\tv[s]{p}=\tv[0]{p}$ i.e. substituting $\tv[s]{p}$ into  @eq-stationaryphase gives:
$$
\tv{x}\simeq \frac{\tv[0]{p}t}{\hbar\shellen[{\tv[0]{p}}]}=\tv[0]{v}t.
$$

This is precisely the trajectory of the classical relativistic particle. Now consider the case of two particles with different peaked momentum distributions their trajectories will have different velocities, but the same positions at time $0$. Thus we will shift one of these trajectories by a so called impact parameter $\ct{\impactParameter}$[^shift], parametrising the relative separtation of the two particles/wavepackets. This can be simply done by multiplying the momentum distribution $\shellft{\wf[1]}(p)$ by a factor of $\exp{\frac{\im}{\hbar} \impactParameter \cdot p}$. We take it to be perpendicular to the initial momenta $\emom[1],\emom[2]$. We now can write down the initial state that we are going to study:

$$
\ket{\text{in}}=\int \ddP[2]{\emom[1],\emom[2]} \shellft{\wf[1]}(\emom[1]) \shellft{\wf[2]}(\emom[2]) \exp{\frac{\im}{\hbar} \co{\impactParameter} \ct{\emom[1]}}\ket[in]{\emom[1],\emom[2]}.
$$ {#eq-instate}


From now on we will drop the breve and infer from the arguments the type of $\wf$ we are dealing with. Observe that by extracting the impact parameter in this way, the wavefunctions can be identitcal in form, and will still be separated as required.

### Change in observable

The (?:kmoc) framework concerns itself with the change of an observable quantity during a scattering event encoded in an operator $\op{O}$. For such an observable quantitiy $\obs{O}$ , its change is  obtained by evaluating the difference of the expectation value of $\op{O}$, between in and out states
$$
\Delta O=\ev{\op{O}}{\text{out}}-\ev{\op{O}}{\text{in}}.
$$

In quantum mechanics, the out states are related to the in states by the time evolution operator, i.e. the S-matrix, $\ket{\text{out}}=\Smat \ket{\text{in}}$. Thus: 

::: {.aside}
In order, we use the unitarity of the S-matrix, then express the S-matrex as the identity (no actual interaction) and the transfer matrix $\Tmat$. The commutators are then expanded and the part with the identity vanish (as $\id$ commutes with everything). 
:::

$$
\begin{aligned}
\Delta O    &amp;=\ev{\adj{\Smat}\op{O}\Smat}{\text{in}}-\ev{\op{O}}{\text{in}}\\
            &amp;\stackrel{\adj{\Smat} \Smat=\id}{=}      \ev{\adj{\Smat} \com{\op{O}}{\Smat}}{\text{in}}\\
            &amp;\stackrel{\Smat=\id+\im \Tmat}{=}          \ev{\com{\op{O}}{\id+\im \Tmat}}{\text{in}}
                                                      -\ev{\im \adj{\Tmat} \com{\op{O}}{\id+\im \Tmat}}{\text{in}}\\
            &amp;=    \ev{\im\com{\op{O}}{\Tmat}}{\text{in}}
                  +\ev{ \adj{\Tmat} \com{\op{O}}{\Tmat}}{\text{in}}\\
            &amp;=\vchangeob+\Delta O_\text{r}.
\end{aligned}
$${#eq-DeltaO}


If we put in the definition of our in state (@eq-instate), we have


$$
\Delta O = \int \ddP[4]{\emom[1],\emom[2],\emom[1]',\emom[2]'} 
                  \wf[1](\emom[1]) \wf[2](\emom[2]) \cwf[1](\emom[1]') \cwf[2](\emom[2]')
                  \,\exp{\im \co{\impactParameter} \frac{\ct{\emom[1]}-\ct{\emom[1]'}}{\hbar}}
                  \brc[\big]{\vInt-\rInt},
$$

where we defined the real integrand $\rInt$ and the virtual integrand $\vInt$ as the following matrix elements ^[NB: the notation is slightly different in the @Bern:2021xze paper]

$$
\begin{aligned}
\vInt &amp;=\bra[in]{\emom[1]'\emom[2]'}{\im\com{\op{O}}{\Tmat}           }\ket[in]{\emom[1]\emom[2]}\\
\rInt &amp;=\bra[in]{\emom[1]'\emom[2]'}{\adj{\Tmat}\com{\op{O}}{\Tmat}   }\ket[in]{\emom[1]\emom[2]}.
\end{aligned}
$$



Let us first look at the virtual integrand $\vInt$:^[Here we define $$\obs{O}_{\text{in}}\ket{\emom[1]\emom[2]}=\op{O}\ket{\emom[1]\emom[2]}$$ aswell as, $$\obs{O}_{\text{in}}'\bra{\emom[1]'\emom[2]'}=\bra{\emom[1]'\emom[2]'}\op{O}$$ and finally $$\obschange{\emom'-\emom}=\obs{O}_{\text{in}}'-\obs{O}_{\text{in}}$$]

$$
\begin{aligned}
\vInt &amp;=\bra[in]{\emom[1]'\emom[2]'}{\im\com{\op{O}}{\Tmat}     }\ket[in]{\emom[1]\emom[2]}  \\
      &amp;=\bra[in]{\emom[1]'\emom[2]'}{\im\op{O}\Tmat             }\ket[in]{\emom[1]\emom[2]}   
      - \bra[in]{\emom[1]'\emom[2]'}{\im \Tmat\op{O}            }\ket[in]{\emom[1]\emom[2]}\\
      &amp;=\im \obs{O}_{\text{in}'}  \; \bra[in]{\emom[1]'\emom[2]'}{\Tmat}\ket[in]{\emom[1]\emom[2]}
      - \im \obs{O}_{\text{in}} \;    \bra[in]{\emom[1]'\emom[2]'}{\Tmat}\ket[in]{\emom[1]\emom[2]}\\
      &amp;=\im \obschange{\emom'-\emom} \,    \bra[in]{\emom[1]'\emom[2]'}{\Tmat}\ket[in]{\emom[1]\emom[2]}\\
      &amp;=\im \obschange{\emom'-\emom}\,\ndeltafn[4]{\emom[1]+\emom[2]-\emom[1]'-\emom[2]'} 
                                    \amp{\emom[1],\emom[2]}{\emom[1]',\emom[2]'}.
\end{aligned}
$$ {#eq-vInt}

Note that the amplitude is from in states to in states. In order to obtain the real integrand $\rInt$, we insert a complete set of states :[^complete]

$$
\begin{aligned}
\rInt &amp;=\bra[in]{\emom[1]'\emom[2]'}{\adj{\Tmat}\com{\op{O}}{\Tmat}}\ket[in]{\emom[1]\emom[2]}\\
      &amp;=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}   \bra[in]{\emom[1]'\emom[2]'}\adj{\Tmat}\vert{r_1 r_2 X}\rangle\langle {r_1 r_2 X} \vert
                        \com{\op{O}}{\Tmat}\ket[in]{\emom[1]\emom[2]}\\
      &amp;=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}  \ndeltafn[4]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}}\,
      \amp{\emom[1], \emom[2]}{r_{1}, r_{2}, r_{X}} \\
      &amp;\qquad \obschange{rX-\emom}\,\ndeltafn[4]{\emom[1]'+\emom[2]'-r_{1}-r_{2}-r_{X}}\,
      \aamp{\emom[1]', \emom[2]'}{r_{1}, r_{2}, r_{X}},
\end{aligned}
$$ {#eq-rInt}

where the $X$ encodes any number of additional messenger states, and $r_{X}$ is the sum of their momenta. For both integrands we can preform some variable changes and eliminate certain Dirac delta functions. We introduce momentum shifts $q_i=\emom[i]'-\emom[i]$ and then integrate over $q_2$, and finally relabel $q_1 \to \tm$   [^measureshift]. Thus we have

$$
\begin{aligned}
\vchangeob=\int &amp;\ddP[2]{\emom[1],\emom[2]} \dn[4]{\tm}
      \ndeltafn{2 \emom[1] \cdot \tm+\tm^2} \thetafn{\ct[0]{\emom[1]}+\tm^0}\, \ndeltafn{2 \emom[2] \cdot \tm-\tm^2} \thetafn{\ct[0]{\emom[2]}-\tm^0}\\
      &amp;\times\wf[1](\emom[1])\wf[2](\emom[2])\cwf[1](\emom[1]+\tm)\cwf[2](\emom[2]-\tm)\,\exp{-\frac{\im}{\hbar} \co{\impactParameter} \tm^\mu}\\
      &amp;\times \im \obschange{\tm} \amp{\emom[1],\emom[2] }{\emom[1]+\tm,\emom[2]-\tm},
\end{aligned}
$${#eq-DeltaOv}


$$
\begin{aligned}
\rchangeob=\sum\limits_X \int &amp;\ddP[2+\abs{X}]{r_1, r_2,X}
      \ddP[2]{\emom[1],\emom[2]} \dn[4]{\tm} \ndeltafn{2 \emom[1] \cdot \tm+\tm^2} \thetafn{\ct[0]{\emom[1]}+\tm^0}\\
            &amp;\times \ndeltafn{2 \emom[2] \cdot \tm-\tm^2} \thetafn{\ct[0]{\emom[2]}-\tm^0}\\
            &amp;\times\wf[1](\emom[1])\wf[2](\emom[2])\cwf[1](\emom[1]+\tm)\cwf[2](\emom[2]-\tm)\,\exp{-\frac{\im}{\hbar} b_\mu \tm^\mu}\\
            &amp;\times\obschange{rX-\emom}\ndeltafn[(4)]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}} \\
            &amp;\times   \amp{\emom[1], \emom[2] }{ r_{1}, r_{2}, r_{X}}\aamp{\emom[1]+\tm, \emom[2]-\tm }{r_{1}, r_{2}, r_{X}}.
\end{aligned}
$${#eq-DeltaOr}

We have arrived at an integral expression for the change in observable $\Delta\obs{O}$. Luckily for us, we will not need to perform these integrals in the classical limit. We will just have carefully chosen replacement rules for the integrated variables! Let us look at this in more detail now.



### Classical limit

Since we are concerned with classical observables we need to explore the classical limit of @eq-DeltaO, i.e. the limit of $\hbar \to 0$. We first discuss the classical limit of wavefunctions. We impose multiple conditions on the wavefunctions. The first are those imposed by (?:lsz) reduction. That is,

- Compact support momentum space wavefunction
- Peaked around one value of momenta

Furthermore the classical limit of the wavefunctions should make sense, i.e. 

1. as $\hbar \to 0$ the position and momentum wavefunction should approach Dirac delta functions, centered around their classical values.
3. The overlap between the wavefunction and its conjugate should be nearly full, since they represent the same particle classically.

Consider for example a nonrelativistic wavefunction for a particle of mass  $\mass$:

$$
f(\tv{\emom})=\Exp[\Big]{-\frac{\abs{\tv{\emom}}}{2 \hbar m \comptlen/\wfwidth^2}}\stackrel{\hbar=\comptlen m}{=}\Exp[\Big]{-\frac{\abs{\tv{\emom}}}{2 m^2 \comptlen^2 /\wfwidth^2}},
$$

where $\comptlen=\frac{\hbar}{m}$ is the compton wavelength of the particle and $\wfwidth$ is a  characteristic width. This wavefunction, with the proper normalization, grows sharper in the $\hbar \to 0$ limit. If we now take the Fourier transform of $f(\tv{\emom})$ to obtain the position "probability density", we have:[^constA]
$$
\begin{aligned}
\invFT[\tv{\emom}]{f}{\tv{x}}(\tv{x})   &amp;=\int \frac{\dd{\tv{\emom}}}{2 \pi} \Exp[\Big]{-\pa[\big]{\frac{\tv{\emom}}{A}}^2}\Exp[\Big]{-\frac{\im}{\hbar} \tv{\emom}\cdot \tv{x}}\\
            &amp;=\frac{1}{2\pi}\underbracket{\int \dd{\tv{\emom}} \Exp[\Big]{-\pa[\Big]{\frac{\tv{\emom}}{A}-\frac{\im\tv{x}A}{2 \hbar}}^2}}_{\sqrt{\pi}A}\Exp[\Big]{- \frac{\tv{x}^2A^2}{4 \hbar^2}}\\
      &amp;=\frac{\sqrt{2}A}{2 \pi}\Exp[\Big]{-\frac{\tv{x}^2}{2 \wfwidth^2}}.
\end{aligned}
$$

This elucidates more clearly the meaning of characteristic width, as $\wfwidth$ is the standard deviation of the wavefunction in position space. Thus, the position-space wavefunction grows sharper in the $\wfwidth^2 \to 0$ limit. For both wavefunctions to simultaneously grow sharper in the classical limit, we must then have that $\xi=\pa{\frac{\comptlen}{\wfwidth}}^2\to0$ remembering that the $\hbar \to 0$ limit is just given by the $\comptlen\to0$ one. Finally the meaning of classical limit in this context is the $\xi \to 0$ limit. 


Going back to the general conditions, we want a wavefunction $\wf[i](\emom[i])$ such that in the classical limit the momentum reaches its classical value: $\cls{\emom[i]}=\mass[i]\cls{\vel[i]}$, with $\cls{\vel[i]}$ the classical four-velocity of particle $i$, normalized to $\cls{\vel[i]}^2=1$. In other words,

$$
\av{\ct{\emom[i]}}=\int \ddP{\emom[i]} \ct{\emom[i]} \abs{\wf[i](\emom[i])}^2\stackrel{!}{=}m_i \breve{u}_i^\mu (1+\order[\beta']{\xi}),
$$

where $\beta'$ encodes the speed at which the classical value is reached in the $\xi\to0$ limit. The velocity normalization convergence is controlled by $\beta''$
$$\breve{u}_i \cdot u_i = 1+ \order[\beta'']{\xi},$$

Finally wavefunction's spread is controlled by $\beta$, and must converge to 0:
$$\begin{aligned} \sigma^2(\emom[i])/m_i^2&amp;=\inv{m_i^2}\av{(\emom[i]-\av{\emom[i]})^2}\\&amp;=\inv{m_i^2}(\av{\emom[i]^2}-\av{\emom[i]}^2)\\&amp;=\inv{\mass[i]^2}(\mass[i]^2-(\mass[i]\cls{\vel[i]}(1+\order[\beta']{\xi}))^2)
\\&amp;\propto\xi^\beta,\end{aligned}$$

where $\av{\emom[i]^2}=m_i^2$ is enforced by the measure $\ddP{\emom}$. 

Additionally, the wavefunction should be Lorentz invariant, and naively we would have that $\wf(\emom[i]^\mu)=\wf'(\emom[i]^2)$. However the integration measure enforces an on-shell condition: $m_i^2=\emom[i]^2$. Thus the wavefunction cannot depend on $\emom[i]^2$, and we need to introduce at least one additional four vector parameter $u$. The simplest dimensionless combination of parameters it then $\frac{\emom \cdot u }{m}$. Of course the wavefunction must also depend on $\xi$ and the simplest form of argument will thus be $\frac{\emom \cdot u }{m \xi}$ so that any $\emom$ not aligned with $u$ will be strongly suppressed in the $\xi \to0$ limit.

We now have control over most of the conditions:

- The classical limit is well defined
- The wavefunction spread is controlled
- The arguments of the wavefunction are clear

We can write a general wavefunction that satisfies the above as:

$$
f(\frac{\emom \cdot u }{m}\vert\cls{\vel[i]};\mass[i] ;\beta^{(i)}).
$$

This function can take the form of a gaussian, or something similar to @eq-peak. Now there is one final requirement, that concerns the overlap of $\wf$ and $\cwf$ must be $\mathcal{O}(1)$, equivalently and more precisely:

$$
\cwf(\emom+\tm)\sim \cwf(\emom) \implies \cwf(\emom+\tm)- \cwf(\emom)\ll 1 \implies \ct{\tm}\pdv{}{\ct{p}}\cwf(\emom)\ll1.
$$
Making explicit the $\frac{\emom \cdot u }{m \xi}$ dependence: $\wf(\emom)=\varphi(\frac{\emom \cdot u }{m \xi})$   for $\varphi(x)$ a scalar function.
$$\implies \frac{\ct{\tm} u_\mu}{m \xi}\odv{\varphi^*(x)}{x}\Bigr|_{\frac{\emom \cdot u }{m \xi}}\ll  1.$$

Thus we require that for a characteristic value of $\tm=\co[0]{\tm}$ we have:

$$
\frac{\co[0]{\tm}\cdot u}{m \xi}=\co[0]{\tw} \cdot u\frac{\wfwidth^2}{\comptlen}\ll1\iff \co[0]{\tw} \cdot u\,\wfwidth\ll \sqrt{ \xi},
$$

having we denoted by a bar any quantity that has been rescaled by $\hbar$. Thus, a momentum $\emom$, when divided by $\hbar$ will be written $\bar{\emom}$ and called wavenumber. We will combine this inequality with ones we obtain from the specific cases of integrations required above. 

We now want to examine the classical limit of the integrands of the form @eq-DeltaOv. If we consider just the integration over the initial momenta $\emom[i]$ and the initial wavefunctions with $\ndeltafn{2 \emom[i] \cdot \tm+\tm^2}$, the delta function will smear out to a sharply peaked function whose scale is of the same order as the original wavefunctions. As $\xi$ gets smaller, this function will turn back into a Dirac delta function imposed on the $\tm$ integration. Let us examine this statement more closely. We are interested in the classical limit of the integrals such as:


$$
d(m,\xi,u,\tm)=\int \ddP{\emom} \ndeltafn{2 \emom \cdot \tm+\tm^2} \thetafn{\emom^0+\tm^0}\varphi \pa[\Big]{\frac{\emom \cdot u }{m \xi}}\varphi^*\pa[\Big]{\frac{(\emom+\tm) \cdot u }{m \xi}}.
$${#eq-dfunct}


This integral must be Lorentz invariant and depends on $m,\xi, u,\tm$ thus it must manifestly only depend on the following Lorentz invariants: $u^2,\tm^2,u \cdot \tm, \xi$. One of these is not actually a variable as we will normalise $u^2=1$. The rest are not fully dimensionless, but we can render them dimensionless:

$$
\begin{aligned}
\brc{\tm^2} &amp;=[\hbar \tw]^2=[M]^2\implies[\comptlen \sqrt{-\tw^2}]=[\frac{\hbar}{m}\sqrt{-\tw^2}]=\frac{[M]}{[M]}=1,\\
[u \cdot \tm]&amp;=[M]\implies [\frac{u \cdot\tw}{\sqrt{-\tw^2}}]= [\frac{u \cdot{\tm}}{\sqrt{-{\tm}^2}}]=\frac{[M]}{[M]}=1,\\
[\xi]&amp;=1.
\end{aligned}
$$

If we call $\frac{1}{\sqrt{-\tw^2}}=\scatlen$ a scattering length[^7] then our dimensionless ratios become :

$$\frac{\comptlen}{\scatlen} \quad \text{and}\quad \scatlen\,\tw \cdot u .$$

The Dirac delta function can then be rewritten as:
$$
\ndeltafn{2 \emom \cdot \tm+\tm^2}=\ndeltafn{2\hbar m\, u\cdot \tw+\hbar^2 \tw^2}=\frac{1}{\hbar m}\ndeltafn{2 \tw \cdot u-\frac{\comptlen}{\scatlen^2}}=\frac{\scatlen}{\hbar m}\ndeltafn{2\scatlen\, \tw \cdot u-\frac{\comptlen}{\scatlen}}.
$$

Performing the integration over $\emom$ in @eq-dfunct we obtain symbolically:

$$
d(m,\xi,u,\tm)=\text{peaked function imposing that } {2\scatlen\, \tw \cdot u=\frac{\comptlen}{\scatlen}}\text{ with width } \xi^\beta.
$$







quarto-executable-code-5450563D

```julia
#| echo: false
#| label: fig-gaussian
#| fig-cap: "Sharpening gaussian"
#| column: margin
using Plots

function delta(x)
    if abs(x)&lt;1e-3
        return 1
    else
        return 0
    end
end

function gauss(x)
    return exp(-x^2)
end

function sharpen(f,eps,power)
    return x-&gt;f(x/eps^power)/eps^power
end

epss=0.02:0.01:0.1



p=plot([sharpen(gauss,eps,1) for eps in epss], -0.5,0.5,label=epss')
```


Let us disucss the wavefunction and the scales from a physical perspective. The characteristic width $\wfwidth$ is the particle's position uncertainty, $\frac{\hbar}{\wfwidth}$ is the associated momentum uncertainty. In the classical limit the position uncertainty is neglible with respect to minimum distance between the particles $\scatlen$:

$$
\wfwidth\ll \scatlen,
$$

and the momentum uncertainty is neglible with respect to the masses of the particles:

$$
\frac{\hbar}{\wfwidth}\ll m \implies \comptlen\ll \wfwidth.
$$

Putting these together we obtain the goldilocks inequality:

$$
\comptlen\ll\wfwidth\ll\scatlen.
$$

Looking back at the arguments of $d$ we see that 

$$
\scatlen\, \tw \cdot u\gg\wfwidth \tw \cdot u \sim \sqrt{\xi} =   \frac{\comptlen}{\wfwidth}\gg\frac{\comptlen}{\scatlen}.
$$

Thus in the classical limit we have that $d$ collapses to:

$$
d(m,\xi,u,\tm)\propto\ndeltafn{ \tw \cdot u}.
$$

Thus, the wavefunction-weighted on-shell phase-space integration disappears in the classical limit. The resulting condition is that the integration momenta take on their physical values. The sequence that we have gone through should be done for all the integrands of type $d$. We will not do this explicitly every time but instead apply the following rules:

1. Just as for the massless transfer momentum any messenger momentum, be it transfer, virtual-loop or real emmission, shall become a wavenumber: $k\to \hbar \bar{k}$. 
2. Replace all couplings with their dimensionless counterparts: $\coupling\to \frac{\coupling}{\sqrt{\hbar} }$ (this is only precisely true for (?:sqed) and gravity, which are the applications we are interested in).
2. Eliminate all on-shell integrations by approximating $\wf(\emom+\hbar\tw)$ by $\wf(\emom)$.
3. Laurent expand all the integrands in $\hbar$.
3. Make the integration momenta take on their physical values: $\emom[i]\to \mass[i]\cls{\vel[i]}$.

To make this idea explicit we introduce the following notation, meaning that the steps above have been applied


$$
\AAngle{g(\emom[1],\emom[2],\dots)}\defeq \int\limits \ddP{\emom[1]}\ddP{\emom[2]} \abs{\wf[1](\emom[1])}^2\abs{\wf[2](\emom[2])}^2\,g(\emom[1],\emom[2],\dots)
$$

We can now rewrite @eq-DeltaO

$$
\changeob = \AAngle{\int \overbracket{\dn[4]{\tm} \ndeltafn{2\emom[1]\cdot \tm +\tm^2}\thetafn{\ct[0]{\emom[1]}+\tm^0}  
                                          \ndeltafn{2\emom[2]\cdot \tm -\tm^2}\thetafn{\ct[0]{\emom[2]}+\tm^0}}^{\dPs{\tm}}
                  \exp{{-\frac{\im}{\hbar}}\tm^\mu b_\mu}\pa[\Big]{\vIntp+\rIntp} },
$$ {#eq-DeltaOclas}

where 
$$
\begin{aligned}
\vIntp      &amp;=\im\,  \obschange{\tm} \amp{\emom[1],\emom[2] }{\emom[1]+\tm,\emom[2]-\tm}\\
\rIntp      &amp;=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}\obschange{rX-\emom} 
                  \ndeltafn[(4)]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}} \\
            &amp;\times   \amp{\emom[1], \emom[2] }{ r_{1}, r_{2}, r_{X}} \aamp{\emom[1]+\tm, \emom[2]-\tm }{ r_{1}, r_{2}, r_{X}}.
\end{aligned}
$$

Additionally, we make clear the dependence on $\hbar$ since we want to eventually take the $\hbar \to0$ limit. We apply step 1. above, and change integration variables to $\tw=\frac{\tm}{\hbar}$ and absorb the $\hbar$ dependence into the redefinition of the integrands and the measure:

$$
\begin{aligned}
\dPs{\tm}
&amp;=\hbar^2\dPsb{\tw}
=\hbar^{\cancelto{2}{4}}\dn[4]{\tw} 
\cancel{\frac{1}{\hbar}}\ndeltafn{2\emom[1]\cdot\tw+\hbar\tw^2}
\thetafn{\ct[0]{\emom[1]}+\tm^0}
\cancel{\frac{1}{\hbar}}\ndeltafn{2\emom[1]\cdot \tw +\hbar\tw^2}
\thetafn{\ct[0]{\emom[2]}+\tm^0},
\end{aligned}
$$

$$
\begin{aligned}
\vIntb&amp;=\hbar^2\vIntp,\\
\rIntb&amp;=\hbar^2\rIntp.
\end{aligned}$$

We can finally neatly write:

$$\Delta O=\AAngle{\int \dPsb{\tw}\exp{-\im\tw^\mu b_\mu}\pa[\Big]{\vIntb+\rIntb}}  .$$

The $\hbar$ dependence is now entirely contained in the integrands  (ignoring the $\hbar \tw^2$ factors in the delta function). The classical limit of this observable is then simply, 

$$
\Delta O_{\text{classical}}=\lim_{\hbar\to0}\hbar^{\beta_{LO}}\brc[\Big]{\int \dPsb{\tw}\pa[\Big]{\vIntb+\rIntb}},
$$
 
dropping the angle brackets, since these dissappear in the classical limit. Here $\beta_{LO}$ is the (?:lo) $\hbar$-dependence of the observable. This is so that $\Delta O_{\text{classical}}\sim\hbar^0$ i.e. classical scaling.


## Impulse in (?:kmoc)



We can now explore the integrands for a specific observable. Consider the change in momentum, or impulse of particle 1. The (?:kmoc) formalisms gives us a way to write this as:


$$\Delta \ct{\emom[1]}=\AAngle{\int \dPsb{\tw}\Exp[\Big]{-\im\tw^\mu b_\mu}\pa[\Big]{\vIntb[\ct{\emom[1]}]+\rIntb[\ct{\emom[1]}]}}  .$$


We then have: 

$$
\begin{aligned}
\vIntb[\ct{\emom[1]}]&amp;=\hbar^2\im\,  \tm\, \amp{\emom[1],\emom[2] }{ \emom[1]+\hbar \tw,\emom[2]-\hbar \tw}\\
\rIntb[\ct{\emom[1]}]&amp;=\hbar^2\sumint\ddP[2+\abs{X}]{r_1,r_2,r_X}(r_1^\mu-\emom[1]^\mu)\,\ndeltafn[(4)]{\emom[1]+\emom[2]-r_{1}-r_{2}-r_{X}} \\
&amp;\times   \amp{\emom[1], \emom[2] }{ r_{1}, r_{2}, r_{X}} \aamp{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{ r_{1}, r_{2}, r_{X}}.
\end{aligned}
$$


We can extract $\hbar$ from $\tm$ and from the amplitude. In order to determine the $\hbar$ scalin of $\ampl$ we extract each coupling constant $\kappa$ along with an $\frac{1}{\sqrt{\hbar}}$, so that quartic vertices yield a factor of $\frac{\coupling^2}{\hbar}$ whereas cubic ones yield $\frac{\kappa}{\sqrt{\hbar}}$^[as mentioned in the last section, this is true for gravity and (?:sqed) and we will extend this fact to schematically rescale the vertex coupling by $\hbar^-\Half[d-2]$, for $d$ the degree of the vertex in question.].  If we count the number $V_3$ of all cubic vertices, $V_4$ the number of quartic vertices, and so on,  we have that the number of internal lines is $I=\frac{1}{2}(\sum_{d=3}dV_d-E)$. This is because we have $\sum_{d=3}dV_d$  lines to start with, out of which $E$ are chosen to be external. The remaining $(\sum_{d=3}dV_d-E)$ ones are contracted in pairs among themselves to form $I$ internal lines, yielding the factor of $\half$. In our case we have $E=4+M$ where $M=\abs{X}$ is the number of messenger particles. Using the argument from loop counting we have that the number of loops of our graph $L$ is given by:
$$
\begin{aligned}
        L=I-V+N=&amp;\frac{1}{2}(\sum_{d=3}d\cdot V_d-4-M)-\sum_{d=3}V_d+1\\
=&amp;\frac{1}{2}(\sum_{d=3}(d-2)V_d)-1-\frac{M}{2},
\end{aligned}
$$

where $N$ is the number of connected components ($=1$ in our case) . Thus we see that the amount of extracted $\hbar$s corresponds directly to the number of loops plus one plus the number of additonal messenger particles. ^[The number of extracted couplings being twice that.] We can thus write the amplitude $\ampl$ as a sum over reduced $L$-loop amplitudes $\redampl[(L)]$:

$$\amp{\emom[1],\emom[2]}{ r_1,r_2,X}=\sum\limits_{L=0}^\infty\pa[\Big]{\frac{\coupling^{2}}{\hbar}}^{(L+1+\frac{\abs{X}}{2})}\redamp[(L)]{\emom[1],\emom[2]}{r_1,r_2,X}.$$


Going back to the integrands we have:

$$
\begin{aligned}
\vIntb[\ct{\emom[1]}]&amp;=\hbar^3\im\,  \tw\, \sum\limits_{L=0}^\infty\pa[\Big]{\frac{\coupling^{2}}{\hbar}}^{(L+1)}\redamp[(L)]{\emom[1],\emom[2]}{\emom[1]+\hbar \tw,\emom[2]-\hbar\tw}\\
&amp;=\im\, \hbar  \tw\, \sum\limits_{L=0}^\infty \coupling^{2(L+1)}{\hbar}^{(1-L)}\redamp[(L)]{\emom[1],\emom[2]}{\emom[1]+\hbar \tw,\emom[2]-\hbar\tw},
\end{aligned}
$$ {#eq-impulseIv}

as well as the real kernel:[^measurech]

$$
\begin{aligned}
\rIntb[\ct{\emom[1]}]&amp;=\hbar^2\sumint\ddP[\abs {X}]{r_X}\brc[\Big]{\prod\limits_{i=1,2}\dn[4]{w_i}\ndeltafn{2\emom[i] \cdot w_i+w_i^2}\thetafn{\emom[i]^0+w_i^0}} \\
&amp;\times w_1^\mu\,\ndeltafn[(4)]{w_1+w_2+r_{X}}
\\
&amp;\times\amp{\emom[1], \emom[2] }{ \emom[1]+w_{1}, \emom[2]+w_{2}, r_{X}} 
\aamp{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{ \emom[1]+w_{1}, \emom[2]+w_{2}, r_{X}}\\
\end{aligned}
$$

$$
\begin{aligned}
=\hbar^2\sumint&amp;\ddP[\abs {X}]{{r}_X}\brc[\Big]{\prod\limits_{i=1,2}\hbar^3\dn[4]{\bar{w}_i}\ndeltafn{2\emom[i] \cdot \bar{w}_i+\hbar\bar{w}_i^2}\thetafn{\emom[i]^0+\hbar \bar{w}_i^0}} \\
&amp;\times   \hbar \bar{w}_1^\mu\,\hbar^{-4}\ndeltafn[(4)]{\bar{w}_1+\bar{w}_2+\bar{r}_{X}}
\\
&amp;\times\sum\limits_{L=0}^\infty\pa[\Big]{\frac{\coupling^{2}}{\hbar}}^{(2L+2+\abs{X})}\redamp[(L)]{\emom[1], \emom[2] }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}} \\
&amp;\times\aredamp[(L)]{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}}
\end{aligned}
$$

$$
\begin{aligned}
=\sumint&amp;\ddP[\abs {X}]{{r}_X}\brc[\Big]{\prod\limits_{i=1,2}\dn[4]{\bar{w}_i}\ndeltafn{2\emom[i] \cdot \bar{w}_i+\hbar\bar{w}_i^2}\thetafn{\emom[i]^0+\hbar \bar{w}_i^0}} \\
&amp;\times    \hbar\bar{w}_1^\mu\,\ndeltafn[(4)]{\bar{w}_1+\bar{w}_2+\bar{r}_{X}}
\\
&amp;\times\sum\limits_{L=0}^\infty \coupling^{2(2L+2+\abs{X})}{\hbar}^{2-2L-\abs{X}}\redamp[(L)]{\emom[1], \emom[2] }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}} \\
&amp;\times\aredamp[(L)]{\emom[1]+\hbar \tw,\emom[2]-\hbar \tw }{\emom[1]+\hbar\bar{w}_{1}, \emom[2]+\hbar\bar{w}_2, r_{X}}.\\
\end{aligned}
$$ {#eq-impulseIr}

Schematically we have 

$$
\begin{aligned}
\vIntb[\ct{\emom[1]}]&amp;=\sum\limits_{L=0}^\infty \order[{2(L+1)}]{\coupling},\\
\rIntb[\ct{\emom[1]}]&amp;=\sum\limits_{L=0}^\infty \order[{4(L+1)+2\abs{X}}]{\coupling}
\end{aligned}
$$

The contributions from the virtual kernel are lower order in the coupling $\coupling$ for a given loop order. Both kernels contribute together provided that the following equation is verified:

$$L-1=2L'+\abs{X}.$$ {#eq-rvloopmatch}

where $L$ is the loop count for the virtual kernel and $L'$, $\abs{X}$ are the real kernel loop count and messenger particle count respectively. Note that for a tree level virtual kernel, the real-kernel match does not exist. The real kernel is only present for $L&gt;0$. When taking the classical limit we will only retain contributions from graphs that cancel the $\hbar$ divergences in each corresponding kernel. Thus at the $L$-loop level, the amplitude in the virtual kernel must cancel with terms of order

$$
\hbar^{1-L+O},
$$ {#eq-hbarvirt}

where the $O$ term is the order of $\hbar$ that is present as a result of the observable. In the case of particle 1's momentum, $O=1$. Similarly, the amplitudes in the real kernel must cancel with:

$$
\hbar^{2-2L'-\abs{X}+O}.
$$ {#eq-hbarreal}

Now we see that the (?:lo) contribution [^expand]to the impulse, which we denote $\Delta \emom[1]^{\mu,(0)}$  can only be from the virtual kernel at tree level. Thus, we have the following equation,

$$
\Delta \emom[1]^{\mu,(0)}=\AAngle{\int \dPsb{\tw}\Exp[\big]{-\im\tw^\mu b_\mu}\ \vIntb[\ct{\emom[1]}]^{(L=0)}}.
$$ {#eq-impulseLO}

And the integrand is given by the tree level 4 point amplitude.

$$
\vIntb[\ct{\emom[1]}]^{L=0}=\im\,  \tw^\mu\,  \coupling^{2}{\hbar}^{2}\bar{\mathcal{A}}^{(0)}(\emom[1],\emom[2]\to \emom[1]+\hbar \tw,\emom[2]-\hbar\tw).
$$

At (?:nlo), i.e. $\kappa^4$ order, both integrands contribute, as @eq-rvloopmatch can be satisfied for $L=1$, $L'=0$ and $\abs{X}=2$. Thus we have the following equation:

$$
\Delta \emom[1]^{\mu,(1)}=\AAngle{\int \dPsb{\tw}\Exp[\big]{-\im\tw^\mu b_\mu} \pa[\Big]{\vIntb[\ct{\emom[1]}]^{(L=1)}+\rIntb[\ct{\emom[1]}]^{(L'=0)}}}.
$$ {#eq-impulseNLO}

The virtual integrand is now given by the 1-loop level amplitude, and the real integrand is given by the square of a the tree level amplitude. This process can go on indefinetely, and is independent of the type of observable and the theory. Here we considered the change of momentum a particle, which for a black hole very far away would be very difficult to measure. However, we can also consider an observable such as the four-momentum of the radiated particles, or more precisely its expection value. Of course, the operator corresponding to this observable gives zero when acting on the initial momentum states, and only gives a non-zero result when acting on the messenger states. Thus, for this observable only the real integrand, starting with $\abs{X}=1$ will contribute, the (?:lo) contribution being given by what is essentially the unitarity cut of a two loop amplitude. We see that regardless of observable, the objects that are needed are the amplitudes. 

For each loop level, many diagrams can contribute, but the classical limit enforces that they must cancel the $\hbar$ orders given by @eq-hbarreal and @eq-hbarvirt. The cancellation order is dependent on the considered observable and filters the contributing diagrams. It can also be reformulated in the language of the method of regions. 

To see the whole machinery in action, let us take (?:sqed) as an example theory, that shows the relevant subleties of the formalism.


## (?:sqed) amplitudes 

We want to couple a set of massive scalar fields to electromagnetism. We will use the minimal coupling prescription to ensure that the resulting lagrangian exhibits the required gauge symmetry. The minimal coupling prescription works provided that our free mass lagrangian admits a conserved current. Our free mass lagrangian for two complex scalar fields with different masses is: 

$$
\mathcal{L}_m=\sum\limits_{i=1}^2 \partial_\mu \phi_i^\dagger\,\partial^\mu \phi_i - m_i^2 \phi^\dagger_i \phi_i.
$$

Notice that under the following transformation:

$$
\begin{aligned}
\phi_i(x) &amp;\rightarrow \exp{-\im \charge[i] \lambda} \phi_i(x), \\
\phi_i^{\dagger}(x) &amp;\rightarrow \exp{\im \charge[i] \lambda} \phi_i^\dagger(x) ,\\
\end{aligned}
$$

or infinitesimally:

$$
\begin{aligned}
\delta\phi_i &amp;= -\im  \phi_i \charge[i] \delta\lambda ,\\
\delta\phi_i^{\dagger} &amp;= \im  \phi_i^\dagger \charge[i]\delta \lambda,\\
\end{aligned}
$$

the above Lagrangian is unchanged. We will identitfy $\charge[i]$ with the charge, in units of $\elch$, of each particle. If we upgrade the parameter $\lambda$ to a spacetime function $\lambda(x)$, the Lagrangian is not invariant anymore and invariance is restored if we replace all the derivatives $\partial_\mu$ with the gauge-covariant derivatives $D_\mu$:

$$D_\mu=\partial_\mu+\im \,\elch\,\charge[i]\,A_\mu,$$


 i.e. if along with the transformation above, we perform a gauge transformation of the photon field:

$$A_\mu\rightarrow A_\mu + \frac{1}{\elch} \partial_\mu \lambda$$

or infinitesimally

$$\delta A_\mu = \frac{1}{\elch} \partial_\mu \delta \lambda,$$

then the whole lagrangian: 

$$\mathcal{L}_{ED}+\mathcal{L}_{m}(\phi_i,\partial_\mu \phi_i)\rightarrow \mathcal{L}_{ED}+\mathcal{L}_{m}(\phi_i,D_\mu \phi_i),$$

is invariant under the above defined gauge transformation. The final lagrangian is:


$$\mathcal{L}=-\frac{1}{4} F_{\mu \nu} F^{\mu \nu}+\sum_{i=1}^{2}\left[\left(D_{\mu} \phi_{i}\right)^{\dagger}\left(D^{\mu} \phi_{i}\right)-m_{i}^{2} \phi_{i}^{\dagger} \phi_{i}\right],$$

with $F_{\mu \nu} \equiv \partial_{\mu} A_{\nu}-\partial_{\nu} A_{\mu}$. Expanding and then integrating by parts:

$$
\begin{aligned}
\mathcal{L} &amp;=-\frac{1}{4}\left(\partial_{\mu} A_{\nu}-\partial_{\nu} A_{\mu}\right)\left(\partial^{\mu} A^{\nu}-\partial^{\nu} A^{\mu}\right)
+\sum_{i=1}^{2}\left[
    \left(\partial_{\mu}-\im\, \elch\,\charge[i]\, A_{\mu} \right)\phi_{i}^{\dagger}
    \left(\partial_{\mu}+\im\, \elch\,\charge[i]\, A_{\mu}\right)\phi_{i}
    -m_{i}^{2} \phi_{i}^{\dagger} \phi_{i}
    \right]
 \\
&amp;=\underbrace{
    \frac{1}{2} A_{\mu}\left[\eta^{\mu \nu}\partial^{2}-\partial^{\mu} \partial^{\nu}\right] A_{\nu}
    +\sum\limits_{i=1}^2-\phi_i^{\dagger}\left(\partial^{2}+m_i^{2}\right) \phi_i
    }_{\mathcal{L}_{0}}
+\underbrace{
    \sum\limits_{i=1}^2q_i^2\,\elch^{2} A_{\mu} A^{\mu} \,\phi^{\dagger}_i \phi_i
    -\im\, \elch\,\charge[i]\, A_{\mu}\left(\phi^{\dagger}_i \partial^{\mu} \phi_i-\left(\partial^{\mu} \phi^{\dagger}_i\right) \phi_i\right)
    }_{\mathcal{L}^{\prime}}.
\end{aligned}
$$

Since we have a massless photon, and still have gauge freedom we have to implement gauge fixing in the usual way:

$$
\begin{aligned}\mathcal{L}_{\text{eff}}
      &amp;=\mathcal{L}+\overbracket{\frac{-1}{2 \xi}(\partial_\mu A^\mu)^2}^{\mathcal{L_\text{GF}}}\\
      &amp;=
    \frac{1}{2} A_{\mu}\underbracket{\brc[\Bigg]{g^{\mu \nu}\partial^{2}-\pa[\Big]{1-\frac{1}{\xi}}\partial^{\mu} \partial^{\nu}}}_{\rightarrow \phprop_\xi(k)=\frac{-\im}{k^{2}+\im \varepsilon}\left[g_{\mu \nu}-(1-\xi) \frac{k_{\mu} k_{\nu}}{k^{2}}\right]} A_{\nu}
    +\sum\limits_{i=1}^2-\phi_i^{\dagger}\underbracket{\pa{\partial^{2}+m_i^{2}}}_{\feynprop(q^2)=\frac{\im}{p^{2}-m^{2}+\im \varepsilon}} \phi_i\\
&amp;+
    \sum\limits_{i=1}^2\underbracket{\charge[i]^2\,\elch^{2}\,\eta^{\mu \nu}}_{\times 2\im\rightarrow \mathrm{4-vertex} } A_{\mu} A_{\nu} \,\phi^{\dagger}_i \phi_i
    \underbracket{-\im\, \elch\,\charge[i]\, A_{\mu}\left(\phi^{\dagger}_i \partial^{\mu} \phi_i-\left(\partial^{\mu} \phi^{\dagger}_i\right) \phi_i\right)}_{\times \im\rightarrow \mathrm{3-vertex}}.
\end{aligned}
$$

In the last lines we identify the terms contributing to the Feynman rules. They are given in @tbl-sqedfrules

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
     \graph[ empty nodes,spring layout,node distance=20mm,horizontal=p1 to p4 ,random seed=4,anchor node=a,anchor at={(0,0.5)}] 
{
  p1[as=$\mu$] --[photon,thick,postaction={draw,-&gt;, 
     shorten &gt;=5mm, shorten &lt;=5mm, 
     decoration={sl,raise=3mm},decorate},"$\ell$" {auto=left ,inner sep=4mm}]  p4[as=$\nu$];
};

"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/photonprop"; limit_to=:picture), tp)
save(PDF("./tikz/photonprop"), tp)
save(SVG("./tikz/photonprop"), tp)
tp
```

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
     \graph[ empty nodes,spring layout,node distance=12mm,horizontal=p1 to p4 ,random seed=4,anchor node=a,anchor at={(0,0.5)}] 
{
  p1[as=$\mu$] --[photon,thick,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$k$" {auto=left ,inner sep=4mm}]  p4[fill = red!20, draw = black, ultra thick, circle,scale=.6];
};

"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/extphoton"; limit_to=:picture), tp)
save(SVG("./tikz/extphoton"), tp)
save(PDF("./tikz/extphoton"), tp)
tp
```



quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
     \graph[ empty nodes,spring layout,node distance=20mm,horizontal=p1 to p4 ,random seed=4,anchor node=a,anchor at={(0,0.5)}] 
{
  p1 --[thick,-&gt;-=.55,postaction={draw,-&gt;, 
     shorten &gt;=5mm, shorten &lt;=5mm, 
     decoration={sl,raise=3mm},decorate},"$k$" above=3mm]  p4;
};

"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes,arrows.meta}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/scalarprop"; limit_to=:picture), tp)
save(SVG("./tikz/scalarprop"), tp)
save(PDF("./tikz/scalarprop"), tp)
tp
```

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
     \graph[ empty nodes,spring layout,node distance=12mm,horizontal=p1 to p4 ,random seed=4,anchor node=a,anchor at={(0,0.5)}] 
{
  p1 --[thick,-&gt;-=.55,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$k$" above=3mm]  p4[fill = red!20, draw = black, ultra thick, circle,scale=.6];
};

"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes,arrows.meta}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/extscalar"; limit_to=:picture), tp)
save(SVG("./tikz/extscalar"), tp)
save(PDF("./tikz/extscalar"), tp)
tp
```

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
     \graph[ empty nodes,spring layout,node distance=15mm,horizontal=p1 to p3 ,random seed=4,anchor node=a,anchor at={(0,0.5)}] 
{
  p1 --[thick,-&gt;-=.55]  p4[fill = red!20, draw = black, ultra thick, circle,scale=.6] --[thick,-&gt;-=.55] p3;
     q1[as=$\mu$] --[thick,photon]  p4 --[thick,photon] q3[as=$\nu$];
};

"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes,arrows.meta}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/seagull"; limit_to=:picture), tp)
save(SVG("./tikz/seagull"), tp)
save(PDF("./tikz/seagull"), tp)
tp
```

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L""" 
     \graph[ empty nodes,spring layout,node distance=15mm,horizontal=q3 to p4 ,random seed=4,anchor node=a,anchor at={(0,0.5)}] 
{
  p1 --[thick,-&gt;-=.55,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$k_i$" {auto=left ,inner sep=3mm}]  p4[fill = red!20, draw = black, ultra thick, circle,scale=.6] --[thick,-&gt;-=.55,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$k_i'$" {auto=left ,inner sep=3mm}] p3;
    q3[as=$\nu$] --[thick,photon,] p4;
};

"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes,arrows.meta}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/cubic"; limit_to=:picture), tp)
save(SVG("./tikz/cubic"), tp)
save(PDF("./tikz/cubic"), tp)
tp
```

:::{.fullwidth}

+--------------------------------------------+------------------------+------------------------------------------------+
| For every                                  |                        | Write                                          |
+:===========================================+:=======================+:===============================================+
| ::: {.content-hidden unless-format="html"} |                        |                                                |
| ![](./tikz/photonprop.svg)                 |internal photon line    | $\phprop_\xi( \ell)=\frac{-\im}{ \ell^{2}+     |
| :::                                        |                        | \im \varepsilon}\left[\eta_{\mu \nu}-(1-\xi)   |
| ::: {.content-hidden unless-format="pdf"}  |                        | \frac{\ell_{\mu} \ell_{\nu}}{ ell^{2}}\right]$ |
| ![](./tikz/photonprop.pdf)                 |                        |                                                |
| :::                                        |                        |                                                |
+--------------------------------------------+------------------------+------------------------------------------------+
| ::: {.content-hidden unless-format="html"} |                        |                                                |
| ![](./tikz/scalarprop.svg)                 |internal scalar         | $\feynprop(k^2)=\frac{\im}{k^{2}-m^{2}         |
| :::                                        |                        | +\im \varepsilon}$                             |
| ::: {.content-hidden unless-format="pdf"}  |                        |                                                |
| ![](./tikz/scalarprop.pdf)                 |                        |                                                |
| :::                                        |                        |                                                |
+--------------------------------------------+------------------------+------------------------------------------------+
| ::: {.content-hidden unless-format="html"} |                        |                                                |
| ![](./tikz/seagull.svg)                    | $\phi_i \phi_i^\dagger | $2 \im \charge[i]^2\,\elch^2\,\eta^{\mu \nu}$  |
| :::                                        |  A_\mu A_\nu$  vertex  |                                                |
| ::: {.content-hidden unless-format="pdf"}  |                        |                                                |
| ![](./tikz/seagull.pdf)                    |                        |                                                |
| :::                                        |                        |                                                |
+--------------------------------------------+------------------------+------------------------------------------------+
| ::: {.content-hidden unless-format="html"} |                        |                                                |
| ![](./tikz/cubic.svg)                      | $\phi_i(k_i)           | $\im \elch\,\charge[i]\,(k_i^\mu-              |
| :::                                        | \phi_i^\dagger(k'_i)   |           k_i^{\prime\mu})$                    |
| ::: {.content-hidden unless-format="pdf"}  |  A_\mu$ vertex         |                                                |
| ![](./tikz/cubic.pdf)                      |                        |                                                |
| :::                                        |                        |                                                |
+--------------------------------------------+------------------------+------------------------------------------------+
| ::: {.content-hidden unless-format="html"} |                        |                                                |
| ![](./tikz/extscalar.svg)                  | External scalar        | $\times 1$                                     |
| :::                                        |                        |                                                |
| ::: {.content-hidden unless-format="pdf"}  |                        |                                                |
| ![](./tikz/extscalar.pdf)                  |                        |                                                |
| :::                                        |                        |                                                |
+--------------------------------------------+------------------------+------------------------------------------------+
| ::: {.content-hidden unless-format="html"} |                        |                                                |
| ![](./tikz/extphoton.svg)                  |$\left\{\begin{array}{c}|$\times \left\{\begin{array}{c}\varepsilon_{\mu}|
| :::                                        |  \text { incoming } \\ |   \\ \varepsilon_{\mu}^{* \prime}              |
| ::: {.content-hidden unless-format="pdf"}  |  \text { outgoing }    |     \end{array}\right\}$, with                 |
| ![](./tikz/extphoton.pdf)                  | \end{array}\right\}$   |  $\varepsilon \cdot k=0,                       |
| :::                                        |       photon           |      \varepsilon^{\prime} \cdot k^{\prime}=0$  |
+--------------------------------------------+------------------------+------------------------------------------------+

: Feynman rules for (?:sqed) {#tbl-sqedfrules tbl-colwidths="[25,25,50]"}
:::

where we consider only incoming momenta and the arrows denote incoming or outgoing particles. For the photon, we will take the Feynamn gauge, setting $\xi=1$ and thus $\phprop_1(\ell)=\phprop(\ell)=\frac{-\im \eta^{\mu \nu}}{\ell^{2}+\im \varepsilon}$. 

### Expansions and simplifications

Notice that if we rescale all photon momenta (taking them to be the loop momenta) by $\hbar$ or equivalently take them to be in the soft region: $\abs{k}\sim\abs{q}\ll \abs{p}$, where $p$ is the external momenta, then the photon propagator scales homgeneously in $\hbar$, typically:

$$
\inv{(\ell-\tm)^2}=\inv{\hbar^2}\inv{(\bar{\ell}-\tw)^2},
$$ {#eq-photonscale}

thus contributes $\order[-2]{\hbar}$ to the overall diagram. The matter propagator on the other hand, has inhomgeneous $\hbar$ scaling, as we do not rescale the external momenta, (or equivalently the external momenta are not restricted by the regions). Note that we will not consider internal mass loops as the soft limit means that massive pair production is forbidden, thus massive propagators necessarily route an external momentum. We can nonetheless expand a generic massive propagator in the soft limit:

$$
\begin{aligned}
\inv{(\ell-\emom[i])^2-\mass[i]^2}&amp;=\inv{\ell^2-2\ell\cdot\emom[i] +\cancel{\emom[i]^2}-\cancel{\mass[i]^2}}= \inv{\hbar^2\bar{\ell}^2-2\hbar \bar{\ell}\cdot \emom[i]}\\
&amp;=-\inv{\hbar} \inv{2\bar{\ell}\cdot\emom[i]}\pa{1+\hbar\frac{ \bar{\ell}^2}{2\bar{\ell}\cdot\emom[i]}+\hbar^2\frac{ \bar{\ell}^4}{(2\bar{\ell}\cdot\emom[i])^2}+\dots}.\\
\end{aligned}
$$ {#eq-massiveScale}

In other contexts one may say that the matter propagator has eikonalized (it is now linear in $\ell$). Before we compute the amplitudes let us set up some useful kinematic identities and variables. If we consider the two-to-two particle scattering, taking an all outgoing momentum convention we have the following masses:

$$
 \mass[1]^2=\emom[4]^2 =\emom[1]^2,\quad \mass[2]^2=\emom[2]^2 =\emom[3]^2,
$$ {#eq-masses}

and Mandelstahm variables:

$$
 \mands=(\emom[1]+\emom[2])^2,\quad \mandt=\tm^2=(\emom[1]+\emom[4])^2,\quad \mandu=(\emom[1]+\emom[3])^2   ,
$$

subject to the usual equation:

$$
\mands+\mandt+\mandu=2(\mass[1]^2+\mass[2]^2).
$$

We can also change the external momentum variables to ones more amenable to the soft limit, namely:


$$
\emom[1]=-\pa[\big]{\semom[1]-\Half[\tm]}, \emom[2]=-\pa[\big]{\semom[2]+\Half[\tm]}, \emom[3]=\pa[\big]{\semom[2]-\Half[\tm]}, \emom[4]=\pa[\big]{\semom[1]+\Half[\tm]} .
$$ {#eq-newmom}

The new momentum variables $\semom[i]$ are crucially orthogonal to momentum transfer $\tm$ :^[we use @eq-masses ]

$$
\semom[i]\cdot\tm=0,
$$ {#eq-orthog}


 and the physical scattering region, given by $\mands&gt;(\mass[1]+\mass[2])^2$ and $\tm^2&lt;0$ is the given by the same formulas:

$$
\mands=\pa[\Big]{-\pa[\big]{\semom[1]-\Half[\tm]}-\pa[\big]{\semom[2]+\Half[\tm]}}^2=(\semom[1]+\semom[2])^2
$$

and 

$$
\mandt=\pa[\Big]{-\pa[\big]{\semom[1]-\Half[\tm]}+\semom[1]+\Half[\tm]}^2 = \tm^2.
$$

With all the ingredients in place, we can now go on to compute the amplitudes. 

### Tree level

We start with the tree level amplitude, the only (?:lo) contribution in for example @eq-impulseLO. The only possible diagram we can build with four external scalar legs, and vertices as defined in @tbl-sqedfrules, is the following tree:


quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false
using TikzPictures

tp = TikzPicture(L"""
\matrix{
      \node{$\displaystyle \im\redamp[(0)]{\semom[1]-\Half[\tm],\semom[2]+\Half[\tm]}{\semom[1]+\Half[\tm],\semom[2]-\Half[\tm]}$};&amp;
      \node{$=$};&amp;
     \graph[nodes=coordinate, empty nodes,spring layout,node distance=20mm,vertical=p1 to p2,random seed=1,anchor node=a,anchor at={(0,0.5)}] 
{
  p1 --[-&gt;-=.5,thick,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm,mirror},decorate},"$\semom[1]-\Half[\tm]$" {auto=right ,inner sep=4mm}]  a[fill = red!20, draw = black, ultra thick, circle,scale=.6] --[-&gt;-=.7,thick,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm,mirror},decorate},"$\semom[1]+\Half[\tm]$" {auto=right ,inner sep=4mm}] p4;
  a -- [photon,thick,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$q$" {auto=left ,inner sep=4mm}]] b[fill = red!20, draw = black, ultra thick, circle,scale=.6];
  p2 --[-&gt;-=.5,thick,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$\semom[2]+\Half[\tm]$" {auto=left ,inner sep=4mm}]]  b --[-&gt;-=.7,thick,postaction={draw,-&gt;, 
     shorten &gt;=3mm, shorten &lt;=3mm, 
     decoration={sl,raise=3mm},decorate},"$ \semom[2]-\Half[\tm]$" {auto=left ,inner sep=4mm}]] p3;
};\\
};"""
,preamble="\\usepackage{adjustbox}\\usepackage{amsmath}\\usetikzlibrary{decorations.markings,graphs,decorations.pathmorphing,graphdrawing,quotes,arrows.meta}\\usegdlibrary{trees,force}\\input{../latexmacros.tex}")

save(TEX("./tikz/treelevelsqed"; limit_to=:picture), tp)
save(PDF("./tikz/treelevelsqed"), tp)
save(SVG("./tikz/treelevelsqed"), tp)
tp
```


![Tree](./tikz/treelevelsqed)



The amplitude is read off diagram and using Feynman rules for SQED we have: 

$$
\redampl[(0)] = \im\phprop(q)\cdot \,\elch^2\charge[1] \charge[2]2 \ct{\semom[1]} 2\ct[\nu]{\semom[2]}=\frac{4\elch^2\charge[1] \charge[2]\semom[1]\cdot\semom[2]}{\tm^2} ,
$$

using the Mandelstahm invariants described above we can infact write this as:

$$
\redampl[(0)] =\elch^2\charge[1] \charge[2] \frac{4\mass[1]\mass[2]\relfact}{\hbar^2\tw^2},
$$ {#eq-treeampl}


where $\relfact$ is the relativistic factor of particle 1 in the rest frame of particle 2:

$$
\relfact=\frac{\mands-\mass[1]^2-\mass[2]^2}{2\mass[1]\mass[2]}=\frac{\emom[1]\cdot\emom[2]}{\mass[1]\mass[2]}=\frac{\semom[1]\cdot\semom[2]}{\mass[1]\mass[2]}+ \order{\hbar}.
$$ {#eq-relfact}

We now input the reduced version $\redampl[(0)]\elch^2=\ampl[(0)]$ of the amplitude, and take the $\hbar\to0$ limit of @eq-impulseLO. We can safely take the $\hbar \to 0$ limit as the integrand contains no terms singular in $\hbar$ (the $\frac{1}{\hbar^2}$ is cancelled by the $\hbar^2$ pre-factor).  Notice that the integration measure @eq-DeltaOclas simplifies in the classical limit:[^comp]

$$
\lim\limits_{\hbar \to0} \dPsb{\tw}=\dn[4]{\tw} \cancel{\ndeltafn{2\semom[1]\cdot\tw}}\cancel{\ndeltafn{2\semom[1]\cdot \tw }}.
$$

The integrand corresponding to the (?:lo) contribution to the impulse is then:

$$
\Delta \emom[1]^{\mu,(0)}=4e^2Q_1Q_2\mass[1]\mass[2]\relfact\int\dn[4]{\tw}\exp{-\im\tw\cdot b}\tw^\mu \frac{\cancel{\hbar^2}}{\cancel{\hbar^2}\tw^2}.
$$

This can be analytically computed (see LO impulse SQED) to find a closed form for the (?:lo) impulse.

$$
\Delta \emom[1]^{\mu,(0)}=-\frac{e^{2} Q_{1} Q_{2}}{2 \pi} \frac{\gamma}{\sqrt{\gamma^{2}-1}} \frac{b^{\mu}}{b^{2}}
$$


### One loop

Already at one loop the number of possible diagrams one can for increases dramatically from 1 to 13. One can nonetheless relatively easily enumerate them. As we increase loop count, the number of diagrams increases exponentially. It is therefore very useful to have a systematic, programmatic way to handle these diagrams, and while we are at it, also to compute the amplitudes. Note that all the code needed to do these computations can be found on the repository for this book.

The first tool we will use is `QGRAF` @Nogueira:1993a, a fortran program that can generate Feynman diagrams for a given set of vertices and external legs. The first step to is to define the theory we are working in. This is essentially writing down the Feynman rules, without actually specifying what the graphical objects are. For (?:sqed) the model file is short:


```{.default filename="SQEDmodel"}
* propagators
 [Phi1,Phi1c,+]
 [Phi2,Phi2c,+]
 [Photon,Photon,+]

* vertices
 [Phi1c,Photon,Phi1]
 [Phi2c,Photon,Phi2]
 [Phi1c,Photon,Photon,Phi1]
 [Phi2c,Photon,Photon,Phi2]
```

This file also defines the names of the fields in question. We can then give `QGRAF` additional options, such as the number of external legs, and the number of loops, written in a `qgraf.dat` file that can look like this:

```{.default filename="qgraf.dat"}
output= '{{output filename}}' ;
style= './styles/julia.sty' ; 

model= './qgraf/SQEDmodel';

in= Phi1,  Phi2;
out= Phi1,Phi2;
loops= 1;
loop_momentum= k;

options=  notadpole,nosnail,onshell ;
```

where we specify what process we are interested in (two-to-two scattering). We also specify that we want to compute the one loop amplitude, and that we want to use the `julia.sty` style file. The `julia.sty` file is a style file that is used to generate the output in a format that can be read by a `Julia` [@Bezanson:2015]  package built to process and visualise the outputted graphs. This package is called (maybe too broadly) `QFT.jl` is hosted on [github](https://github.com/lcnhb/QFT.jl) . Let us see it in action. We can run `QGRAF` from the command line, and it will generate a file called `{{output filename}}` that contains the output of the program. We can then use this in a `Julia`  file to visualise the diagrams.

quarto-executable-code-5450563D

```julia
#| output: asis
using Images
using QFT
using QFT.Diagrams
using QFT.FieldGraphs
using QFT.Fields
import  Catlab.Graphics.Graphviz: pprint
include("SQED.jl")
diags=include("QGRAFout/julia/1lSQED.jl")


qDiags=[qDiagram(;diag...) for diag in diags]
grafs=(x -&gt; x.g).(qDiags)
println("::: {#fig-oneloopsqed  layout-ncol=3}")
for (i,graf) in enumerate(grafs)
println("```{dot}")
println("//| fig-width: 1.5")
    pprint(stdout,to_graphviz(graf,graph_attrs=Dict("layout"=&gt;"neato")))
    println("```")
end
println("all one loop graphs in (?:sqed)")
println(":::")
nothing
```



We can notice a few things about the diagrams above. Not all the diagrams contribute to the classical limit. Clearly the diagrams with internal matter loops cannot be allowed when the momenta incoming to the loop is soft ^[scales like $\hbar$]. In the classical limit this momenta will go to 0, and since the scalars are massive, they need momentum greater than their mass to be pair produced, thus these diagrams do not contribute. Another class of diagrams that does not contribute to the classical limit are the ones with photon loops that start and end on the same matter line. These do not contribute because they are scaleless. An integral is scaleless when its integrand $\mathcal{I}_\text{scaleless}(\brk{\ell_i})$ scales homegenously under any rescaling of the loop momentum $\ell_i$:

$$
\mathcal{I}_\text{scaleless}(\brk{\ell_i})\stackrel{\ell_j\to\lambda \ell_j}{\longrightarrow}\lambda^\eta \mathcal{I}_\text{scaleless}(\brk{\ell_i})
$$

Thus any diagram that has a basis of loops that does not contain both scalar fields (i.e. does not cross over) cannot have its scale set by the momentum transfer, and is thus scaleless. Dimensionally regularised scaleless integrals vanish, thus we can also discard these diagrams. We can easily implement such a filter programatically, by checking that if cycles are present they touch either both types of scalars, or neither. To compute the cycle basis we use an algorithm derived from @Paton:1969, implemented in the [DirectedHalfEdgeGraphs.jl](https://github.com/lcnhb/DirectedHalfEdgeGraphs.jl) package.


quarto-executable-code-5450563D

```julia
#| output: asis
using Logging
Logging.disable_logging(Logging.Info)
function scaleless(g::AbstractFieldGraph)
  cycles =cycle_basis(g)
  isscaleless=false
  for c in cycles
    hs= collect(Iterators.flatten(half_edges.(Ref(g),c)))
    fields=unique!(typeof.(field.(Ref(g),hs)))
    if Bool(Phi1 in fields) ⊻  Bool(Phi2 in fields)
      isscaleless=true
    end
  end
  return isscaleless
end

noscalelessdiags=qDiags[.!scaleless.(grafs)]
classicaldiags=noscalelessdiags[2:end]
for (i,d) in enumerate(classicaldiags)
  d.ID=i
end

println("::: {#fig-onefilterloopsqed  layout-ncol=5 fig-cap-location=margin}")
for (i,graf) in enumerate(grafs[.!scaleless.(grafs)])
println("```{dot}")
println("//| fig-width: 1")
    pprint(stdout,to_graphviz(graf,graph_attrs=Dict("layout"=&gt;"neato")))
    println("```")
end
println("one loop graphs that contribute to the classical limit in (?:sqed)")
println(":::")
nothing
```

There is one final simplification we can do. The first diagram above has two photon propagators, and two quartic vertices, which give it its name: the double-seagull. The photon propagators have homogeonous $\hbar^{-2}$ scaling (see @eq-photonscale), the vertices only bring constants, and the loop integration has $\hbar^4$ scaling. Together this means that the reduced amplitude has $\hbar^0$ scaling. However in the virtual integrand the reduced amplitude has to cancel with the transfer momentum's $\hbar$ scale (see @eq-impulseIr). Thus the double seagull diagram dies in the classical limit.

We are left with only 4 diagrams, the two triangle diagrams, the box and cross box, which we can now compute. At this point we can do this manually, but again, putting in place a programattic framework means that subsequent loops can be treated systematically^[at least at the unintegrated level]. We will also extract one of these integrands by hand, for completeness and comparison. 

The first step is to define the Feynman rules in a computer readable format. We will use `Julia`  to apply these rules at every vertex and every edge, but for the actual computation we will use `FORM` [@Vermaseren:2000nd;@Kuipers:2012rf] which can automatically contract indices and does expression manipulations in an extremely fast way. The Feynman rules implementation in the package developped for this thesis make use of `Julia`s defining paradigm of multiple dispatch. This allows us to define the rules for each vertex and each edge in a very compact way. We can define the rules for (?:sqed) as follows:

quarto-executable-code-5450563D

```julia
#| output: false
#| eval: false
#| code-overflow: wrap
function feynmanRule(mime::MIME"text/FORM",p,f1::Photon,f2::Photon)
  momen = repr(mime,p.symbol)
  indx1 = repr(mime,index(f1))
  indx2 = repr(mime,index(f2))
  "_i* prop(-1,0,$momen)*d_($indx1,$indx2)"
end

@symmetric function feynmanRule(mime::MIME"text/FORM",p,[f1::Phi1,f2::Phi1c])
  momen = repr(mime,p.symbol)
  "_i* prop(-1,1,$momen)"
end

@symmetric function feynmanRule(mime::MIME"text/FORM",p,[f1::Phi2,f2::Phi2c])
  momen = repr(mime,p.symbol)

  "_i* prop(-1,2,$momen)"
end

@symmetric function feynmanRule(mime::MIME"text/FORM",[(pᵩ₁,a)::Tuple{Any,ScalarField{S}},
            (pᵩ₂,b)::Tuple{Any,AdjointField{ScalarField{S}}},
            (pᵧ,γ)::Tuple{Any,Photon}]) where {S}
  p1 = repr(mime,pᵩ₁(index(γ)))
  p2 = repr(mime,pᵩ₂(index(γ)))
  q = repr(mime,charge(a))
  "_i*e*$q*($p2-$p1)"
end

@symmetric function feynmanRule(mime::MIME"text/FORM",[(pᵧ₁,γ₁)::Tuple{Any,Photon},
            (pᵧ₂,γ₂)::Tuple{Any,Photon},(pᵩ₂,b)::Tuple{Any,AdjointField{ScalarField{S}}},
            (pᵩ₁,a)::Tuple{Any,ScalarField{S}}]) where {S}    
  mu = repr(mime,index(γ₁))
  nu = repr(mime,index(γ₂)) 
  q = repr(mime,charge(a))
  "2*_i*$q^2*e^2*d_($mu,$nu)"
end 
```

where we define `prop(n,i,p)` as representing a generic Feynman propagator, which we will denote:

$$
 D_{-}(n,i,p)=\mathtt{prop(n,i,p)}=\pa{p^2-m_i^2+i\epsilon}^{n} \quad \text{thus} \quad \mathtt{prop(-1,i,p)}=\frac{1}{p^2-m_i^2+i\epsilon}.
$$

We can now apply these feynamn rules to the graphs we have left, obtaining `FORM` readable integrands. For example the box diagram gives:

quarto-executable-code-5450563D

```julia
#| echo: false
#| output: false
#| eval: false


open("diags.frm";create=true,write=true) do io
  write(io,"""
  Symbol x;
Auto V p;
Auto V p;
Auto V q;
Auto S m;
S e;
Auto S Q;
Auto I nu;
CF prop;
CF inv;
  """)
  for qd in classicaldiags
    toform(io,qd)
    println(io,"")
  end
end;
```

quarto-executable-code-5450563D

```julia
#| echo: fenced
toform(stdout,classicaldiags[3])
```

Notice that we also define the momentum routing by imposing the replacement rules, one per vertex. This can be done in many ways but to ensure proper scaling we set the loop momenta on the massless lines. This is done by the `Julia` program, using kruskal's algorithm [@Kruskal:1956] to find the maximal-mass spanning tree of the graph, and then setting the loop momenta to be those internal edges that are missing from the tree. Using `FORM` we can contract indices and apply the momentum conservation rules. Finallly we also apply the relableing rules described in @eq-newmom. The `FORM` version of the box integrand is then:

```{.default #lst-formBox .sql lst-cap="Box integrand in FORM"}

   [d3l1|o.3.4|i.3.4|i|o|] =
         ( prop(-1,0,q - l1) )
       * ( prop(-1,0,l1) )
       * ( prop(-1,1,1/2*q - l1 + pb1) )
       * ( prop(-1,2, - 1/2*q + l1 + pb2) )
       * ( dot(q,q) - 2*dot(q,l1) - 2*dot(q,pb2) + 2*dot(q,pb1) + dot(l1,l1)
          + 2*dot(l1,pb2) - 2*dot(l1,pb1) - 4*dot(pb2,pb1) )
       * ( dot(l1,l1) + 2*dot(l1,pb2) - 2*dot(l1,pb1) - 4*dot(pb2,pb1) )
       * ( qch2 ) * ( qch2 ) * ( qch1 ) * ( qch1 )
       * ( e ) * ( e ) * ( e ) * ( e );
```

When applied to all 4 diagrams we obtain precisely the same integrands as those in @Kosower:2018adc. Additionally we notice that the two triangles and the box diagram have overlapping propagators. In fact the denominators of the integrands for all three can be written as:

$$
\Box_{i_1,i_2,i_3,i_4}=\inv{\rho_1^{i_1}\rho_2^{i_2}\rho_3^{i_3}\rho_4^{i_4}},
$$ {#eq-boxfam}

for powers $\brk{i}\in\brk{0,1}^4$, where the inverse propagators $\rho_i$ are:

$$
\rho_1=\ell^2+\im \epsilon,\quad \rho_2=(\ell-q)^2+\im \epsilon,\quad \rho_3=(\Half[q]-\ell+\semom[1])^2-\mass[1]^2+\im \epsilon,\quad \rho_4=(-  \Half[q]+\ell+\semom[2])^2-\mass[2]^2+\im \epsilon
$$

Note that in the classical limit we can expand the massive propagators as shown in @eq-massiveScale and obtain to first order in $\hbar$:

$$
\rho_3=2\ell\cdot\semom[1]+\im \epsilon,\quad \rho_4= -2\ell\cdot\semom[2]+\im \epsilon,
$$

where we used @eq-orthog. The cross box can in fact extend this family, by adding just one more inverse propagator. We now have the complete descripition of the denominators of all 1-loop contributing diagrams. The numerators in fact do not complicate things much. They are all composed of scalar products of momenta. If these do not contain loop-momenta they are just constant factors in front of the integral. The scalar products that do contain loop momenta can be intelligently written as inverse powers of the propagators. This is the case for any feynman like integrand. Consider the following general integrand:

$$
\mathcal{I}= \frac{\mathcal{N}}{\mathcal{D}}=\frac{\prod\limits_{S'}N_{S'}}{\prod\limits_{S}D_S}=\frac{\prod\limits_{S'}\sum\limits_{i\geq j} S'_{ij}p_i\cdot p_j}{\prod\limits_{S}\sum\limits_{i\geq j} S_{ij}p_i\cdot p_j},
$$

where ${S}$ and ${S'}$ are sets of coefficient matrices for all possible dot products. If we have a quadruplet $\brk{A,B,a,b}$ such that $A_{a,b}\neq0$ and $B_{a,b}neq0$ and $p_{a}$or $p_{b}$ is a loop momentum $\ell$, say $p_a=\ell$ then it is useful to write this component of the integrand as:

$$
\frac{N_{B}}{D_{A}}=\frac{\tilde{N}_B+B_{ab}\ell\cdot p_b}{A_{ab}\ell\cdot p_b +\sum\limits_{\substack{i\geq j \\ i,j\neq a,b}}A_{ij}p_i\cdot p_j}=\frac{\tilde{N}_B}{D_A}+\frac{B_{ab}}{A_{ab}}\pa[\Big]{1-\frac{\tilde{D}_A}{D_A}}.
$$ {#eq-scalarred}

where the tilde means that we have remove the $ab$ contribution. Thus we see that we obtain in the numerator, a sum of objects, none of which contain the dot product: $\ell\cdot p_b$. We can do this for every quadruplet $\brk{A,B,a,b}$, after every replacement and obtain an integrand containing only so called *irreducible* loop-momenta scalar products. In the cases we have here, they all dissapear, leaving us truely with a family of integrands like @eq-boxfam. This can be readily fed into a IBP solver, such as `AIR` [@Anastasiou:2004], `FIRE` [@Smirnov:2020] or `Kira` [@Maierhofer:2018]. 

With such a solver we can obtain a complete family of integrals, that one can then look up. We are thus able to obtain the integrated integrands at (?:nlo) that are then used in @eq-impulseIr and @eq-impulseIv. The algorithm described above was implemented in `FORM` and is able to rapibly process the 1-loop diagrams. The code is available at the repository for this document. 

Importantly we still need to take the classical limit. At this point a problem shows up. The box and cross box integrals are divergent in the classical limit (some authors call this super classical). Let us see this for the box integral. We have from @lst-formBox that the integral for the box diagram $B$ is: 

$$
\im B = \elch^4 Q_{1} Q_{2} \int \dn[D]{\ell} \Box_{1,1,1,1}\pa{4 \semom[1]\cdot \semom[2]  + 2\ell\cdot\pa{\semom[2] -\semom[1]} -\pa{\tm-\ell}^2}\pa{4 \semom[1]\cdot \semom[2]  + 2\ell\cdot\pa{\semom[2] -\semom[1]} -\pa{\ell}^2}
$$

we can apply the procedure described above, turning messenger momenta into wavenumbers:

$$
\im B = \elch^4 Q_{1} Q_{2} \int \dn[D]{\bar{\ell}}\frac{\hbar^D}{\hbar^6} \Box_{\bar{1},\bar{1},\bar{1},\bar{1}}\pa{4 \semom[1]\cdot \semom[2]  + \hbar2\bar{\ell}\cdot\pa{\semom[2] -\semom[1]} -\hbar^2\pa{\tw-\bar{\ell}}^2}\pa{4 \semom[1]\cdot \semom[2]  + \hbar2\bar{\ell}\cdot\pa{\semom[2] -\semom[1]} -\hbar^2\pa{\bar{\ell}}^2},
$$
where $\Box_{\bar{i}_1,\bar{i}_2,\bar{i}_3,\bar{i}_4} =\inv{\hbar^{2(i_1+i_2)+i_3+i_4}} \Box_{i_1,i_2,i_3,i_4}$ is the box family with wavenumber instead of messenger momenta, and $\hbar$s extracted. We notice that if we apply the scalar product reduction @eq-scalarred, we will necessarily still have an integral of the form^[along with ones that are of the form $\Box_{1,1,1,0}$ and other permutations. These are not divergent in the classical limit, as they have one less propagator, thus one less $\hbar$, just enough to cancel what is left of the $\hbar$ in the numerator, and have an overall $\order[0]{\hbar}$ scaling.]:

$$
\elch^4 Q_{1} Q_{2} 16 (\semom[1]\cdot \semom[2])^2 \int \dn[D]{{\ell}}\Box_{1,1,1,1}=\order[D-6]{\hbar}
$$

whislt we need to cancel with the $\hbar$ in the classical limit (@eq-hbarvirt), here we have one too many orders in the denominator (if D=4). Thus we would get a divergent ($\inv{\hbar}$) contribution when taking the classical $\hbar\to 0$ limit. If we consider now the cross box, which is the same family as above but with an extra minus sign:

$$
\tilde{\rho}_4=( \Half[q] -\ell+\semom[2])^2-\mass[2]^2+\im \epsilon\simeq  2\ell\cdot\semom[2]+\im \epsilon.
$$

If we write that $\Box_{+i_1,+i_2,+i_3,+i_4}=\Box_{i_1,i_2,i_3,i_4}$ where the sign is the sign of the $\im\epsilon$ presciption, then we can write the cross box integral as:
$$
\int \dn[D]{\ell} -\Box_{1,1,1,-1}
$$

thus summing up the two divergent contributions from the box and cross box we have:


$$
\Box_{1,1,1,1}-\Box_{1,1,1,-1}=\Box_{1,1,1,0}\pa[\Big]{\inv{-2\ell\cdot\semom[2]+\im \epsilon}-\inv{    2\ell\cdot\semom[2]+\im \epsilon}}=-\im\Box_{1,1,1,0}\ndeltafn{2\ell\cdot\semom[2]},
$$ {#eq-boxcross}

where in the equation line we used *reverse unitarity* [@Anastasiou:2002yz;@Anastasiou:2002qz;@Anastasiou:2003yy]. This idea was developped in the context of cross-section calculations in the for collider physics computations. It enables to set on equal footing real contributions ^[such as ones in the real integrand @eq-rInt] where we integrate over on shell momenta ^[thus three dimensional momentum space] and virtual integrals, where the integration is over all possible four-momentum ^[as virtual particles can be off shell]. The idea is to trade the on-shell delta functions and their $n$-th derivatives for differences of (powers of) propagators with alternating $\im \epsilon$:

$$
\frac{\im}{(-1)^ nn!} \odv[n]{}{z} \ndeltafn{z}   = \inv{\pa{z  -\im \epsilon}^{(n+1)}}  - \inv{\pa{z+\im \epsilon}^{(n+1)}}.
$$ {#eq-reverseunitarity}

In our case @eq-reverseunitarity implies the following identities:

$$
\ndeltafn{-2\ell\cdot\semom[2]}=\im\pa{\Box_{0,0,0,1}-\Box_{0,0,0,-1}}
$$ {#eq-revone}

$$
\ndeltafn{2\ell\cdot\semom[1]}=\im\pa{\Box_{0,0,1,0}-\Box_{0,0,-1,0}}
$$ {#eq-revtwo}

Since we where able to write this difference of propagators as a sort of cut, we could further compare the divergent part of the box and cross box with the corresponding real contribution, which is at tree level, with no cut messengers: $L'=0$ and $\abs{X}=0$ such that @eq-rvloopmatch is satisfied. We have:


$$
\begin{aligned}
\int &amp;\dn[4]{\bar{w}}\ndeltafn{2\semom[1]\cdot \bar{w}-\hbar\Half[\tw] \cdot \bar{w}  +\hbar\bar{w}^2}\ndeltafn{-2\semom[2] \cdot \bar{w}+\hbar\Half[\tw] \cdot \bar{w}+\hbar\bar{w}^2} \\
&amp;\times    \hbar\bar{w}^\mu\\
&amp;\times\coupling^{4}{\hbar}^{2}\redamp[(0)]{\semom[1]-\hbar\Half[\tw],\semom[2]+\hbar\Half[\tw] }{\semom[1]+\hbar\Half[\tw]+\hbar\bar{w}, \semom[2]-\hbar\Half[\tw]-\hbar\bar{w}_2} \\
&amp;\times\aredamp[(0)]{\semom[1]+\hbar\Half[\tw],\semom[2]+\hbar\Half[\tw]-\hbar \tw}{\semom[1]-\hbar\Half[\tw]+\hbar\bar{w}, \semom[2]+\hbar\Half[\tw]-   \hbar\bar{w}_2}.
\end{aligned}
$$

where the $\redampl[(0)]$ we already computed in @eq-treeampl, and we have eliminated the theta functions in prepartation of taking the classical limit. Thus it is essentially a cut of a one-loop box. Notice that in the classical limit we must cancel with $\hbar^3$ (@eq-hbarreal) which at leading order is again overdone. The $\semom[1]\cdot \semom[2]$ contribution from each tree scales like $\inv{\hbar^4}$, and is thus classically divergent as the box and cross box before it. We also notice it has the following form:

$$
\elch^4 Q_{1} Q_{2} 16 (\semom[1]\cdot \semom[2])^2\inv{\hbar}\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\ndeltafn{2\semom[1] \cdot \bar{\ell}}\ndeltafn{-2\semom[2] \cdot \bar{\ell}}\Box_{\bar{1},\bar{1},\bar{0},\bar{0}},
$$

where we've changed variables from $\bar{w}$ to $\bar{\ell}$ and removed the $\hbar(\Half[\tw] \cdot \bar{\ell}\pm\bar{ \ell}^2)$ term in the delta functions, in prepation for the classical limit. We can now apply reverse unitarity (@eq-revone,@eq-revtwo) and focus on the integral without the prefactors:

$$
\begin{aligned}
\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu&amp;\ndeltafn{2\semom[1] \cdot \bar{\ell}}\ndeltafn{-2\semom[2] \cdot \bar{\ell}}\Box_{\bar{1},\bar{1},\bar{0},\bar{0}}  =    \int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\ndeltafn{2\semom[1] \cdot \bar{\ell}}\im\pa{\Box_{0,0,0,1}-\Box_{0,0,0,-1}}\Box_{\bar{1},\bar{1},\bar{0},\bar{0}}  \\  
&amp;=-\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\pa{\Box_{0,0,1,0}-\Box_{0,0,-1,0}}\pa{\Box_{1,1,0,1}-\Box_{1,1,0,-1}} ,\\
&amp;=\int \dn[4]{\bar{\ell}}\bar{\ell}^\mu\brc{\pa{\Box_{1,1,1,-1}-\Box_{1,1,1,1}}+\pa{\Box_{1,1,-1,1}-\Box_{1,1,-1,-1}}} .
\end{aligned}
$$

We now notice something interesting, this cut integral has a sort of horizontal flip symmetry, i.e. if we average over the existing 'loop' momentum labelling and a new $\ell'=q-\ell$ we eliminate the $\ct{\ell}$ dependence in the numerator:

$$
\Half\brc{\ct{\ell}+\pa{\ct{q}-\ct{\ell}}}=\ct{q}
$$

since the box families transform as:

$$
\Box'_{i,j,m,n}=(-1)^m(-1 )^n\Box_{j,i,-m,-n}.
$$ {#eq-boxtrans}

Thus we have that the cut integral with the $\ct{\tw}$ factored out:

$$
\int \dn[4]{\bar{\ell}}\Half\brc{\pa{\Box_{1,1,1,-1}-\Box_{1,1,1,1}}+\pa{\Box_{1,1,-1,1}-\Box_{1,1,-1,-1}}} .
$$

We can apply the relabelling only this time only for the last two integrands, and the integral becomes, applying @eq-boxtrans:

$$
\int \dn[4]{\bar{\ell}}\Half\brc{\pa{\Box_{1,1,1,-1}-\Box_{1,1,1,1}}+\pa{\Box'_{1,1,-1,1}-\Box'_{1,1,-1,-1}}}= \int \dn[4]{\bar{\ell}}\pa{\Box_{1,1,1,-1}-\Box_{1,1,1,1}}  .
$$

If we now add the box and cross box contributions from @eq-boxcross we get:

$$
\int \dn[4]{\bar{\ell}}\pa{\bcancel{\Box_{1,1,1,-1}}-\cancel{\Box_{1,1,1,1}}}+\cancel{\Box_{1,1,1,1}}-\bcancel{\Box_{1,1,1,-1}}  =  0.
$$

The classically divergent terms have cancelled leaving us with only the finite terms!



[^measurech]: We changed the integration variable from $r_i$ to $w_i=r_i-\emom[i]$ thus the measure changes:$$\ddP[2+\abs{X}]{r_1,r_2,X}=\ddP[\abs {X}]{r_X}\prod\limits_{i=1,2}\dn[4]{w_i}\ndeltafn{2\emom[i] \cdot w_i+w_i^2}\thetafn{\emom[i]^0+w_i^0}$$ where we used the same reasoning as for the $q_i$ variable change.
    
[^expand]: Here the expansion is in powers of the coupling constant, so even though we want $\hbar$s to cancel, the loop order will still affect the order of the contribution through the coupling constant  $\coupling$  and the (?:lo) corresponds to $\coupling$
[^comp]: Compare to $$\begin{aligned}\dPsb{\tw}&amp;=\dn[4]{\tw} \ndeltafn{2\emom[1]\cdot\tw+\hbar\tw^2}\thetafn{\ct[0]{\emom[1]}+\tm^0}\\&amp; \ndeltafn{2\emom[1]\cdot \tw +\hbar\tw^2}\thetafn{\ct[0]{\emom[2]}+\tm^0}\end{aligned}$$ The theta functions cancel as $\tm^0\to0$ and $\emom[i]$ becomes classical. Changing to the special kinematic variables @eq-newmom we can even eliminate the delta functions, since by constuction $\semom[1]\cdot\tw=0$.




[^shift]: $f(x)=\int \ddP{\emom} \shellft{f}({\emom})\exp{-\frac{\im}{\hbar} \emom^\mu x_\mu}$. Then a shifted, i.e. translated version of $f(x)$ can be written:$$\begin{aligned}f(x-x_0)&amp;=\int \ddP{\emom} \shellft{f}({\emom})\,\exp{-\frac{\im}{\hbar} p_\mu (x^\mu-x_0^\mu)}\\&amp;=\int \ddP{\emom} \shellft{f}({\emom})\,\exp{\frac{\im}{\hbar}p_\mu x^\mu_0}\,\exp{-\frac{\im}{\hbar} p_\mu x^\mu}\end{aligned}$$ Thus the associated, translated state is:$$\ket{f}=\int \ddP{\emom} \shellft{f}({\emom})\,\exp{\frac{\im}{\hbar}p_\mu x^\mu_0}\,\ket{\emom }$$

[^complete]: $1=\sum\limits_X \int \ddP[2+\abs{X}]{r_1,r_2,X}\dyad{r_1 r_2 X}$ Where we could consider the states ${r_1,r_2,X}$ to be the final states after the scattering. Note that we always impose having two (?s:bh), at all times, as we have no pair annihilation, which is why the sum always has a two particle dyad. The additional states encoded in $X$ are all possible additional messenger states (we also have no (?:bh) pair production).

[^measureshift]: Introducing the momentum shifts modifies the measure in the following way:
    $$\begin{aligned}\ddP{\emom[i]'}&amp;=\ddP{\emom[i]+q_i}\\=&amp;\dn[4]{q_i}\,\ndeltafn{{(\emom[i]+q_i)^2-m_i^2}} \thetafn{{\emom[i]^0+q_i^0}}\end{aligned}$$
            Now since we also have the on-shell enforcing delta function from $\ddP{\emom[i]}$ we can rewrite the delta functions:     $$\begin{aligned}\ddP{\emom[i]}&amp;\,\ndeltafn{(\emom[i]+q_i)^2-m_i^2}\\&amp;=\ddP{\emom[i]}\ndeltafn{\underbracket{(\emom[i]^2-m_i^2)}_{\text{redundant}}+2 \emom[i] \cdot q_i+q_i^2}\\&amp;=\ddP{\emom[i]}\ndeltafn{2 \emom[i] \cdot q_i+q_i^2}\end{aligned}$$
            Finally we integrate $q_2$ by solving  $\ndeltafn[(4)]{\emom[1]+\emom[2]-\emom[1]'-\emom[2]'}=\ndeltafn[(4)]{q_1+q_2}$ and thus we just set $q_2=-q_1$

[^constA]: $A$ absorbs the various constants, with $A=\sqrt{2}m\frac{\comptlen}{\wfwidth}$ and $\tv[0]{x}$ 

&lt;!-- [^5]: Here $\tw=\frac{\tm}{\hbar}$ is the wavenumber --&gt;
[^7]: t     $[\frac{1}{\sqrt{-\tw^2}}]=[T]=[L]=[\scatlen]$</code></pre>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>